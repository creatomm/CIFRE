!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PPTLiveBroadcast=t():e.PPTLiveBroadcast=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=19)}([function(e,t,n){"use strict";var i=n(8),s=Object.prototype.toString;function r(e){return"[object Array]"===s.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==s.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===s.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),r(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:r,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:o,isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:l,isStream:function(e){return a(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,i){c(t[i])&&c(n)?t[i]=e(t[i],n):c(n)?t[i]=e({},n):r(n)?t[i]=n.slice():t[i]=n}for(var i=0,s=arguments.length;i<s;i++)u(arguments[i],n);return t},extend:function(e,t,n){return u(t,(function(t,s){e[s]=n&&"function"==typeof t?i(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageTrackingOption=t.ConnectionState=t.ServiceGeneratedClientIdName=t.SystemCommandsStateName=t.ConfigurationName=t.SystemSessionStateName=t.StateSubscriptionsName=void 0,t.StateSubscriptionsName="ConfigStateSubscriptions",t.SystemSessionStateName="systemSessionState",t.ConfigurationName="config",t.SystemCommandsStateName="systemCommands",t.ServiceGeneratedClientIdName="serviceGeneratedClientId",function(e){e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting"}(t.ConnectionState||(t.ConnectionState={})),function(e){e[e.All=0]="All",e[e.Last=1]="Last",e[e.None=2]="None"}(t.MessageTrackingOption||(t.MessageTrackingOption={}))},function(e,t,n){"use strict";var i,s="object"==typeof Reflect?Reflect:null,r=s&&"function"==typeof s.apply?s.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,n,i){var s,r,o,a;if(l(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),o=r[t]),void 0===o)o=r[t]=n,++e._eventsCount;else if("function"==typeof o?o=r[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(s=u(e))>0&&o.length>s&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=d.bind(i);return s.listener=n,i.wrapFn=s,s}function p(e,t,n){var i=e._events;if(void 0===i)return[];var s=i[t];return void 0===s?[]:"function"==typeof s?n?[s.listener||s]:[s]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(s):g(s,s.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var l=c.length,u=g(c,l);for(n=0;n<l;++n)r(u[n],this,t)}return!0},a.prototype.addListener=function(e,t){return h(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return h(this,e,t,!0)},a.prototype.once=function(e,t){return l(t),this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,f(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,s,r,o;if(l(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){o=n[r].listener,s=r;break}if(s<0)return this;0===s?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,s),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(s=r[i])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){var i=n(20),s=n(21),r=s;r.v1=i,r.v4=s,e.exports=r},function(e,t,n){"use strict";(function(t){var i=n(0),s=n(31),r=n(10),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,l={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(c=n(11)),c),transformRequest:[function(e,t){return s(t,"Accept"),s(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,n){if(i.isString(e))try{return(0,JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,s=t&&t.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||s&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw r(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){l.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){l.headers[e]=i.merge(o)})),e.exports=l}).call(this,n(30))},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,s=n;return[s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info"}(t.TraceLevel||(t.TraceLevel={}))},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},function(e,t,n){"use strict";var i=n(0);function s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(i.isURLSearchParams(t))r=t.toString();else{var o=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),o.push(s(t)+"="+s(e))})))})),r=o.join("&")}if(r){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}},function(e,t,n){"use strict";e.exports=function(e,t,n,i,s){return e.config=t,n&&(e.code=n),e.request=i,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var i=n(0),s=n(32),r=n(33),o=n(9),a=n(34),c=n(37),l=n(38),u=n(12);e.exports=function(e){return new Promise((function(t,n){var h=e.data,d=e.headers,f=e.responseType;i.isFormData(h)&&delete d["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";d.Authorization="Basic "+btoa(m+":"+g)}var v=a(e.baseURL,e.url);function _(){if(p){var i="getAllResponseHeaders"in p?c(p.getAllResponseHeaders()):null,r={data:f&&"text"!==f&&"json"!==f?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:i,config:e,request:p};s(t,n,r),p=null}}if(p.open(e.method.toUpperCase(),o(v,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,"onloadend"in p?p.onloadend=_:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(_)},p.onabort=function(){p&&(n(u("Request aborted",e,"ECONNABORTED",p)),p=null)},p.onerror=function(){n(u("Network Error",e,null,p)),p=null},p.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(u(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",p)),p=null},i.isStandardBrowserEnv()){var y=(e.withCredentials||l(v))&&e.xsrfCookieName?r.read(e.xsrfCookieName):void 0;y&&(d[e.xsrfHeaderName]=y)}"setRequestHeader"in p&&i.forEach(d,(function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(p.withCredentials=!!e.withCredentials),f&&"json"!==f&&(p.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),n(e),p=null)})),h||(h=null),p.send(h)}))}},function(e,t,n){"use strict";var i=n(10);e.exports=function(e,t,n,s,r){var o=new Error(e);return i(o,t,n,s,r)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var i=n(0);e.exports=function(e,t){t=t||{};var n={},s=["url","method","data"],r=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function l(s){i.isUndefined(t[s])?i.isUndefined(e[s])||(n[s]=c(void 0,e[s])):n[s]=c(e[s],t[s])}i.forEach(s,(function(e){i.isUndefined(t[e])||(n[e]=c(void 0,t[e]))})),i.forEach(r,l),i.forEach(o,(function(s){i.isUndefined(t[s])?i.isUndefined(e[s])||(n[s]=c(void 0,e[s])):n[s]=c(void 0,t[s])})),i.forEach(a,(function(i){i in t?n[i]=c(e[i],t[i]):i in e&&(n[i]=c(void 0,e[i]))}));var u=s.concat(r).concat(o).concat(a),h=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return i.forEach(h,l),n}},function(e,t,n){"use strict";function i(e){this.message=e}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,e.exports=i},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i,s,r,o=n(2),a=n(3),c=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(i={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard"}(s||(s={})),function(){function e(){}e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,n,i){return"tag_"+e.tagIntToString(t)+" ["+s[n]+"] "+i},e.prototype.sendTraceTag=function(t,n,s,r){var o=console.log;switch(s){case i.Error:o=console.error;break;case i.Warning:o=console.warn;break;case i.Info:o=console.info;break;case i.Verbose:o=console.debug;break;case i.Spam:default:o=console.log}try{o(e.getLogMessage(t,n,r))}catch(e){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw e}},e.prototype.shipAssertTag=function(t,n,i,s){console.assert(i,e.getLogMessage(t,n,s))},e.prototype.debugAssertTag=function(e,t,n,i){this.shipAssertTag(e,t,n,i)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789"}(),new(function(){function e(){this.externalLogger=new c}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,i){this.externalLogger.sendTraceTag(e,t,n,i)},e.prototype.debugAssertTag=function(e,t,n,i){this.externalLogger.debugAssertTag(e,t,n,i)},e.prototype.shipAssertTag=function(e,t,n,i){this.externalLogger.shipAssertTag(e,t,n,i)},e}()),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(r||(r={})),function(){function e(t,n){var i=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){i.triggerUpload(!1,!1)},this.flush=function(){i.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return i.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,n){window.clearTimeout(i.timeoutId),i.logCache.length>0&&(i.uploadId+=1,function(e,t,n){if(""!==t){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",t,n),i.send(e))}}(function(e,t,n,i){var s=e.map((function(e){return function(e,t){var n={};n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category;var i=1e3*e.type+e.level;return n.D=i,n}(e,i)})),r=function(e,t,n,i){var s={};return s.T=e,s.L=t,s.S=n,s.I=i,s.V=1,s}(i,s,t,n);return JSON.stringify(r)}(i.logCache,i.userSessionId,i.uploadId,i.timestampBase),i.remoteUrlEndpoint,n),i.logCache=[],i.timestampBase=Date.now()),t&&(i.timeoutId=window.setTimeout(i.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=n+"?usid="+t,window.setTimeout((function(){return i.triggerUpload(!0,!0)}),0)}e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===i.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]"}(),i.Info;var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};!function(e){!function(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(c);var u=n(18);class h{constructor(e){this.m_logger=e}sendTraceTag(e,t,n){this.m_logger.sendTraceTag(e,s.msoulscat_Wac_PptLive,t,n)}}class d{constructor(){this.events=new o.EventEmitter,this.clientId=Object(a.v4)()}on(e,t){return this.events.on(e,t),this}off(e,t){return this.events.off(e,t),this}removeAllListeners(e){return this.events.removeAllListeners(e),this}async init(e){this.m_logger=e.logger||new c;const t=e.pragueDocID,n=e.timeoutDurationInMs;if(!t)throw this.m_logger.sendTraceTag(595630088,s.msoulscat_Wac_PptLive,i.Error,"PPTLiveBroadcast::init - Empty prague docID"),new Error("Empty prague docID");let r=[new Promise((t,n)=>{t(this.initImpl(e))})];if(n){this.m_logger.sendTraceTag(595630089,s.msoulscat_Wac_PptLive,i.Info,`PPTLiveBroadcast::init - Creating competing promise with timeout of ${n}ms`);const e=new Promise((e,t)=>{setTimeout(()=>{t(`reached timeout of ${n} ms`)},n)});r.push(e)}return this.m_logger.sendTraceTag(595630090,s.msoulscat_Wac_PptLive,i.Info,"PPTLiveBroadcast::init - start init tasks"),await Promise.race(r).catch(e=>{const t=new Error("PPTLiveBroadcast::Init - issues due to: "+e);throw t.stack=e.stack,t})}async initImpl(e){this.m_logger.sendTraceTag(595630091,s.msoulscat_Wac_PptLive,i.Info,"PPTLiveBroadcast::initImpl - Start creating prague proxy");let t=Date.now();const n=e.isPresenter?"presenter":"participant";this.stateServiceProxy=await Object(u.createStateServiceProxyAsync)(e.pragueDocID,n,e.routerlicious,new h(this.m_logger),e);let r=Date.now();this.m_logger.sendTraceTag(595630092,s.msoulscat_Wac_PptLive,i.Info,`PPTLiveBroadcast::initImpl - Completed creating prague proxy in ${r-t}ms`),this.clientId=this.stateServiceProxy.clientId(),this.stateServiceProxy.on("activeClientCountChanged",()=>{if(this.clientId!==this.stateServiceProxy.clientId()){const e=this.preferredSubtitleLanguage;this.clientId=this.stateServiceProxy.clientId(),this.preferredSubtitleLanguage=e}else this.clientId=this.stateServiceProxy.clientId();this.events.emit("activeParticipantCountChanged",this.activeParticipantCount)}),this.connectionState=this.stateServiceProxy.getConnectionState(),this.stateServiceProxy.on("connectionStateChanged",()=>{this.connectionState=this.stateServiceProxy.getConnectionState(),this.events.emit("connectionStateChanged",this.connectionState)}),this.stateServiceProxy.on("messageRoundTripped",t=>{this.m_logger.sendTraceTag(594916566,s.msoulscat_Wac_PptLive,i.Info,`IStateServiceProxy::messageRoundTripped: {isPresenter:${e.isPresenter}, details:${JSON.stringify(t)}}`)}),this.m_logger.sendTraceTag(595630093,s.msoulscat_Wac_PptLive,i.Info,"PPTLiveBroadcast::initImpl - Init presenter cell"),t=Date.now(),await this.initPresenterCell(e.isPresenter),r=Date.now(),this.m_logger.sendTraceTag(595630094,s.msoulscat_Wac_PptLive,i.Info,`PPTLiveBroadcast::initImpl - Finished init presenter cell in ${r-t}ms`),t=Date.now(),await Promise.all([this.initSessionStateCell(),this.initPresenterStateCell(),this.initWelcomeScreenStateCell(),this.initPollInfoStateCell(),this.initNavigationStateCell(),this.initFileInfoCell(),this.initParticipantsMap(e.preferredSubtitleLanguage),this.initFinalSubtitlesMap(),this.initPartialSubtitlesMap(),this.initSubtitlesEnabledCell(),this.initLastTriggeredSurveyInfoCell(),this.initReactionsMap(),this.initDefaultSubtitleLanguageCell(),this.initAudienceFeedbackInfoCell(),this.initSlideInfoMap(),this.initAggregatedReactions(),this.initHolographURLCell()]),r=Date.now(),this.m_logger.sendTraceTag(595630095,s.msoulscat_Wac_PptLive,i.Info,`PPTLiveBroadcast::initImpl - Finished init remaining cells in ${r-t}ms`)}close(){this.stateServiceProxy?(this.m_logger.sendTraceTag(594883807,s.msoulscat_Wac_PptLive,i.Info,"PPTLiveBroadcast::close - "+JSON.stringify(this.stateServiceProxy.getServiceTelemetry())),this.stateServiceProxy.close()):this.m_logger.sendTraceTag(589641427,s.msoulscat_Wac_PptLive,i.Warning,"PPTLiveBroadcast::close - stateServiceProxy is not set.")}onFocusChanged(e){this.stateServiceProxy.onFocusChanged(e)}throwIfDocNotInitialized(){if(!this.stateServiceProxy)throw new Error("Tried to initialize without Prague doc")}throwIfObjectNotInitialized(e,t){if(!e)throw new Error(`Attempted to access ${t} before initialized`)}async initCell(e,t){let n;n=this.isPresenter()?await this.stateServiceProxy.createCellAsync(e):await this.stateServiceProxy.waitCellAsync(e);const i=await n.getAsync();return i&&t(i),n}async initMap(e,t){let n;n=this.isPresenter()?await this.stateServiceProxy.createMapAsync(e):await this.stateServiceProxy.waitMapAsync(e);const i=new Map;return n.forEach((e,t)=>{i.set(t,e)}),t(i),n}async initSessionStateCell(){this.throwIfDocNotInitialized(),this.sessionStateCell=await this.initCell("sessionState",e=>this._sessionState=e),this.sessionStateCell.on("valueChanged",e=>{this._sessionState=e,this.events.emit("sessionStateChanged",this.sessionState)})}set sessionState(e){this.throwIfObjectNotInitialized(this.sessionStateCell,"session state"),this._sessionState!==e&&(this._sessionState=e,this.sessionStateCell.setAsync(this._sessionState))}get sessionState(){return this.throwIfObjectNotInitialized(this.sessionStateCell,"session state"),this._sessionState}async initPresenterStateCell(){this.throwIfDocNotInitialized(),this.presenterStateCell=await this.initCell("presenterState",e=>this._presenterState=e),this.presenterStateCell.on("valueChanged",e=>{this._presenterState=e,this.events.emit("presenterStateChanged",this.presenterState)})}set presenterState(e){this.throwIfObjectNotInitialized(this.presenterStateCell,"presenter state"),this._presenterState!==e&&(this._presenterState=e,this.presenterStateCell.setAsync(this._presenterState))}get presenterState(){return this.throwIfObjectNotInitialized(this.presenterStateCell,"presenter state"),this._presenterState}async initWelcomeScreenStateCell(){this.throwIfDocNotInitialized(),this.welcomeScreenStateCell=await this.initCell("welcomeScreenState",e=>this._welcomeScreenState=e),this.welcomeScreenStateCell.on("valueChanged",e=>{this._welcomeScreenState=e,this.events.emit("welcomeScreenStateChanged",this.welcomeScreenState)})}set welcomeScreenState(e){this.throwIfObjectNotInitialized(this.welcomeScreenStateCell,"welcome screen state"),this._welcomeScreenState!==e&&(this._welcomeScreenState=e,this.welcomeScreenStateCell.setAsync(this._welcomeScreenState))}get welcomeScreenState(){return this.throwIfObjectNotInitialized(this.welcomeScreenStateCell,"welcome screen state"),this._welcomeScreenState}async initPollInfoStateCell(){this.throwIfDocNotInitialized(),this.pollInfoStateCell=await this.initCell("pollInfoState",e=>this._pollInfoState=e),this.pollInfoStateCell.on("valueChanged",e=>{this._pollInfoState=e,this.events.emit("pollInfoStateChanged",this.pollInfoState)})}set pollInfoState(e){this.throwIfObjectNotInitialized(this.pollInfoStateCell,"pollInfo state"),this._pollInfoState!==e&&(this._pollInfoState=e,this.pollInfoStateCell.setAsync(this._pollInfoState))}get pollInfoState(){return this.throwIfObjectNotInitialized(this.pollInfoStateCell,"pollInfo state"),this._pollInfoState}async initNavigationStateCell(){this.throwIfDocNotInitialized(),this.navigationStateCell=await this.initCell("navigationState",e=>this._navigationState=e),this.navigationStateCell.on("valueChanged",e=>{this._navigationState=e,this.events.emit("navigationStateChanged",this.navigationState)})}set navigationState(e){this.throwIfObjectNotInitialized(this.navigationStateCell,"navigation state"),this._navigationState!==e&&(this._navigationState=e,this.navigationStateCell.setAsync(this._navigationState))}get navigationState(){return this.throwIfObjectNotInitialized(this.navigationStateCell,"navigation state"),this._navigationState}async initFileInfoCell(){this.throwIfDocNotInitialized(),this.fileInfoCell=await this.initCell("fileInfo",e=>this._fileInfo=e),this.fileInfoCell.on("valueChanged",e=>{this._fileInfo=e,this.events.emit("fileInfoChanged",this._fileInfo)})}set fileInfo(e){this.throwIfObjectNotInitialized(this.fileInfoCell,"file info"),this._fileInfo!==e&&(this._fileInfo=e,this.fileInfoCell.setAsync(this._fileInfo))}get fileInfo(){return this.throwIfObjectNotInitialized(this.fileInfoCell,"file info"),this._fileInfo}async initAudienceFeedbackInfoCell(){this.throwIfDocNotInitialized(),this.audienceFeedbackInfoCell=await this.initCell("audienceFeedbackInfo",e=>this._audienceFeedbackInfo=e),this.audienceFeedbackInfoCell.on("valueChanged",e=>{this._audienceFeedbackInfo=e,this.events.emit("audienceFeedbackInfoChanged",this._audienceFeedbackInfo)})}set audienceFeedbackInfo(e){this.throwIfObjectNotInitialized(this.audienceFeedbackInfoCell,"audience feedback info"),this._audienceFeedbackInfo!==e&&(this._audienceFeedbackInfo=e,this.audienceFeedbackInfoCell.setAsync(this._audienceFeedbackInfo))}get audienceFeedbackInfo(){return this.throwIfObjectNotInitialized(this.audienceFeedbackInfoCell,"audience feedback info"),this._audienceFeedbackInfo}async initParticipantsMap(e){this.throwIfDocNotInitialized(),this.participantsMap=await this.initMap("participants",e=>this._participants=e),this.participantsMap.on("valueChanged",async e=>{let t=await this.participantsMap.get(e),n=this._participants.get(e);this._participants.set(e,t),n&&n.preferredSubtitleLanguage!==t.preferredSubtitleLanguage&&this.events.emit("preferredSubtitleLanguageChanged",t.preferredSubtitleLanguage,e),this.events.emit("participantsChanged",this._participants),this.events.emit("activeParticipantCountChanged",this.activeParticipantCount)}),this.preferredSubtitleLanguage=e}get participants(){return this.throwIfObjectNotInitialized(this.participantsMap,"participant preferences"),new Map(JSON.parse(JSON.stringify([...this._participants])))}get activeParticipants(){this.throwIfObjectNotInitialized(this.participantsMap,"participant preferences");let e=this.stateServiceProxy.activeClientIds(),t=[...this.participants.entries()].filter(([t,n])=>e.has(t)&&"participant"===n.type);return new Map(t)}get activeParticipantCount(){return this.activeParticipants.size}set preferredSubtitleLanguage(e){this.throwIfObjectNotInitialized(this.participantsMap,"subtitle preferences");let t=this._participants.get(this.clientId);if(t){if(e&&t.preferredSubtitleLanguage!==e){let n=t;n.preferredSubtitleLanguage=e,this._participants.set(this.clientId,n),this.participantsMap.set(this.clientId,n)}}else if(e){let t={preferredSubtitleLanguage:e,lastAccess:new Date,type:this.isPresenter()?"presenter":"participant"};this._participants.set(this.clientId,t),this.participantsMap.set(this.clientId,t)}}get preferredSubtitleLanguage(){this.throwIfObjectNotInitialized(this.participantsMap,"subtitle preferences");let e=this._participants.get(this.clientId);if(e)return e.preferredSubtitleLanguage}async initDefaultSubtitleLanguageCell(){this.throwIfDocNotInitialized(),this.defaultSubtitleLanguageCell=await this.initCell("defaultSubtitleLanguageCell",e=>this._defaultSubtitleLanguage=e),this.defaultSubtitleLanguageCell.on("valueChanged",e=>{this._defaultSubtitleLanguage=e,this.events.emit("defaultSubtitleLanguageChanged",this.defaultSubtitleLanguage)})}set defaultSubtitleLanguage(e){this.throwIfObjectNotInitialized(this.defaultSubtitleLanguageCell,"default subtitle language"),this._defaultSubtitleLanguage!==e&&(this._defaultSubtitleLanguage=e,this.defaultSubtitleLanguageCell.setAsync(this._defaultSubtitleLanguage))}get defaultSubtitleLanguage(){return this.throwIfObjectNotInitialized(this.defaultSubtitleLanguageCell,"default subtitle language"),this._defaultSubtitleLanguage}async initPresenterCell(e){this.throwIfDocNotInitialized(),e?(this.presenterCell=await this.stateServiceProxy.createCellAsync("presenter"),this._presenter=this.clientId,this.presenterCell.setAsync(this.clientId)):this.presenterCell=await this.stateServiceProxy.waitCellAsync("presenter"),this.presenterCell.on("valueChanged",e=>{this._presenter=e,this.events.emit("presenterChanged",this.presenter)});const t=await this.presenterCell.getAsync();t&&(this._presenter=t)}get presenter(){return this.throwIfObjectNotInitialized(this.presenterCell,"presenter"),this._presenter}set presenter(e){if(this.throwIfObjectNotInitialized(this.presenterCell,"presenter"),!this.isPresenter())throw new Error("Attempted to modify presenter without permission");if(!this._participants.has(this._presenter))throw new Error("Attempted to set presenter without being registered");if(!this._participants.has(e))throw new Error("Attempted to set presenter to an invalid client ID");if(this._presenter!==e){const t=this._participants.get(this._presenter);t.type="participant",this._participants.set(this._presenter,t),this.participantsMap.set(this._presenter,t);const n=this._participants.get(e);n.type="presenter",this._participants.set(e,n),this.participantsMap.set(e,n),this._presenter=e,this.presenterCell.setAsync(e)}}isPresenter(){return this._presenter===this.clientId}async initSubtitlesEnabledCell(){this.throwIfDocNotInitialized(),this.subtitlesEnabledCell=await this.initCell("subtitlesEnabled",e=>this._subtitlesEnabled=e),this.subtitlesEnabledCell.on("valueChanged",e=>{this._subtitlesEnabled=e,this.events.emit("subtitlesEnabledChanged",this.subtitlesEnabled)})}get subtitlesEnabled(){return this.throwIfObjectNotInitialized(this.subtitlesEnabledCell,"subtitles enabled state"),this._subtitlesEnabled}set subtitlesEnabled(e){this.throwIfObjectNotInitialized(this.subtitlesEnabledCell,"subtitles enabled state"),this._subtitlesEnabled!==e&&(this._subtitlesEnabled=e,this.subtitlesEnabledCell.setAsync(this._subtitlesEnabled))}async initFinalSubtitlesMap(){this.throwIfDocNotInitialized(),this.finalSubtitlesMap=await this.initMap("finalSubtitles",e=>this._finalSubtitles=e),this.finalSubtitlesMap.on("valueChanged",e=>{this._finalSubtitles.set(e,this.finalSubtitlesMap.get(e)),this.events.emit("finalSubtitlesChanged",this._finalSubtitles,e),this.preferredSubtitleLanguage&&e===this.preferredSubtitleLanguage&&this.events.emit("preferredFinalSubtitlesChanged",this._finalSubtitles.get(this.preferredSubtitleLanguage))})}set finalSubtitles(e){this.throwIfObjectNotInitialized(this.finalSubtitlesMap,"final subtitles"),this._finalSubtitles=e,this._finalSubtitles.forEach((e,t)=>{e.timestamp||(e.timestamp=new Date),e.slideState||(e.slideState=this.navigationState.to),this.finalSubtitlesMap.set(t,e)})}get finalSubtitles(){return this.throwIfObjectNotInitialized(this.finalSubtitlesMap,"final subtitles"),this._finalSubtitles}async getFinalSubtitlesHistory(){let e=new Map;const t=await this.stateServiceProxy.getHistoryAsync(this.finalSubtitlesMap.id());for(let n of t)void 0!==n.property&&(e.has(n.property)||e.set(n.property,[]),e.get(n.property).push(n.value));return e}get preferredFinalSubtitles(){if(this.throwIfObjectNotInitialized(this.finalSubtitlesMap,"preferred final subtitles"),this.preferredSubtitleLanguage)return this._finalSubtitles.get(this.preferredSubtitleLanguage)}async getPreferredFinalSubtitlesHistory(e){let t=[];const n=await this.stateServiceProxy.getHistoryAsync(this.finalSubtitlesMap.id(),e||this.preferredSubtitleLanguage);for(let e of n)t.push(e.value);return t}async getPreferredFinalSubtitlesHistoryWithPagination(e,t){let n={cursor:"",finalSubtitles:[]};const i=await this.stateServiceProxy.getHistoryWithPaginationAsync(this.finalSubtitlesMap.id(),e||this.preferredSubtitleLanguage,t);n.cursor=i.cursor;const s=i.messages;for(let e of s)n.finalSubtitles.push(e.value);return n}getServiceTelemetry(){return this.stateServiceProxy?this.stateServiceProxy.getServiceTelemetry():(this.m_logger.sendTraceTag(589641428,s.msoulscat_Wac_PptLive,i.Warning,"PPTLiveBroadcast::getServiceTelemetry - stateServiceProxy is not set."),null)}async initPartialSubtitlesMap(){this.throwIfDocNotInitialized(),this._partialSubtitles=new Map,this.partialSubtitlesCell=await this.initCell("partialSubtitles",e=>{let t=new Map(JSON.parse(e));t&&(this._partialSubtitles=t)});let e=this._partialSubtitles.set;this._partialSubtitles.set=(t,n)=>(e.apply(this._partialSubtitles,[t,n]),this.partialSubtitles=this._partialSubtitles,this._partialSubtitles),this.partialSubtitlesCell.on("valueChanged",async e=>{if(e){let t=new Map(JSON.parse(e));t&&(this.preferredSubtitleLanguage&&t.has(this.preferredSubtitleLanguage)&&this._partialSubtitles.get(this.preferredSubtitleLanguage)!==t.get(this.preferredSubtitleLanguage)&&this.events.emit("preferredPartialSubtitlesChanged",t.get(this.preferredSubtitleLanguage)),this._partialSubtitles=t,this.events.emit("partialSubtitlesChanged",this._partialSubtitles))}})}set partialSubtitles(e){this.throwIfObjectNotInitialized(this.partialSubtitlesCell,"partial subtitles"),this._partialSubtitles=e,this.partialSubtitlesCell.setAsync(JSON.stringify([...e]))}get partialSubtitles(){return this.throwIfObjectNotInitialized(this.partialSubtitlesCell,"partial subtitles"),this._partialSubtitles}get preferredPartialSubtitles(){if(this.throwIfObjectNotInitialized(this.partialSubtitlesCell,"preferred partial subtitles"),this.preferredSubtitleLanguage)return this._partialSubtitles.get(this.preferredSubtitleLanguage)}async initLastTriggeredSurveyInfoCell(){this.throwIfDocNotInitialized(),this.lastTriggeredSurveyInfoCell=await this.initCell("lastTriggeredSurveyInfo",e=>this._lastTriggeredSurveyInfo=e),this.lastTriggeredSurveyInfoCell.on("valueChanged",e=>{this._lastTriggeredSurveyInfo=e,this.events.emit("surveyTriggered",this.lastTriggeredSurveyInfo)})}get lastTriggeredSurveyInfo(){return this.throwIfObjectNotInitialized(this.lastTriggeredSurveyInfoCell,"last triggered survey"),this._lastTriggeredSurveyInfo}set lastTriggeredSurveyInfo(e){this.throwIfObjectNotInitialized(this.lastTriggeredSurveyInfoCell,"last triggered survey"),this._lastTriggeredSurveyInfo!==e&&(this._lastTriggeredSurveyInfo=e,this.lastTriggeredSurveyInfoCell.setAsync(this._lastTriggeredSurveyInfo))}async initReactionsMap(){this.throwIfDocNotInitialized(),this.reactionsMap=await this.initMap("reactions",e=>this._reactions=e),this.reactionsMap.on("valueChanged",async e=>{let t=await this.reactionsMap.get(e);this._reactions.set(e,t),this.events.emit("newReaction",t,e)})}get reactions(){return this.throwIfObjectNotInitialized(this.reactionsMap,"reactions"),new Map(JSON.parse(JSON.stringify([...this._reactions])))}set lastReaction(e){this.throwIfObjectNotInitialized(this.reactionsMap,"reactions");let t=this._reactions.get(this.clientId);e&&t!==e&&(e.slideId=e.slideId||this.navigationState.to.location.slideId,e.timestamp=e.timestamp||new Date,this._reactions.set(this.clientId,e),this.reactionsMap.set(this.clientId,e))}get lastReaction(){return this.throwIfObjectNotInitialized(this.reactionsMap,"reactions"),this._reactions.get(this.clientId)||void 0}async initAggregatedReactions(){this.throwIfDocNotInitialized(),this.aggregatedReactionsCell=await this.initCell("aggregated_reactions",e=>{this._aggregatedReactions=e}),this.aggregatedReactionsCell.on("valueChanged",async e=>{e&&(this._aggregatedReactions=e,this.events.emit("aggregatedReactionsSubmitted",e))})}set aggregatedReactions(e){this.throwIfObjectNotInitialized(this.aggregatedReactionsCell,"reactions Count"),this._aggregatedReactions=e,this.aggregatedReactionsCell.setAsync([...this._aggregatedReactions])}get aggregatedReactions(){return this.throwIfObjectNotInitialized(this.aggregatedReactionsCell,"reactions Count"),this._aggregatedReactions}async initHolographURLCell(){this.throwIfDocNotInitialized(),this.holographURLCell=await this.initCell("holographURL",e=>this._holographURL=e),this.holographURLCell.on("valueChanged",e=>{this._holographURL=e,this.events.emit("holographURLChanged",this.holographURL)})}set holographURL(e){this.throwIfObjectNotInitialized(this.holographURLCell,"holograph URL"),this._holographURL!==e&&(this._holographURL=e,this.holographURLCell.setAsync(this._holographURL))}get holographURL(){return this.throwIfObjectNotInitialized(this.holographURLCell,"holograph URL"),this._holographURL}async initSlideInfoMap(){this.throwIfDocNotInitialized(),this.slideInfoMap=await this.initMap("slideInfo",e=>this._slideInfo=e),this.slideInfoMap.on("valueChanged",async e=>{let t=await this.slideInfoMap.get(e);this._slideInfo.set(e,t),this.events.emit("slideInfoChanged",this._slideInfo)})}get slideInfo(){return this.throwIfObjectNotInitialized(this.slideInfoMap,"slide info"),new Map(JSON.parse(JSON.stringify([...this._slideInfo])))}}function f(){return new d}},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(7),t),s(n(1),t),s(n(22),t)},function(e,t,n){"use strict";n.r(t);var i=n(17);n.d(t,"createPPTLiveBroadcast",(function(){return i.a}));var s=n(16);for(var r in s)["createPPTLiveBroadcast","default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return s[e]}))}(r)},function(e,t,n){var i,s,r=n(5),o=n(6),a=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],h=(e=e||{}).node||i,d=void 0!==e.clockseq?e.clockseq:s;if(null==h||null==d){var f=r();null==h&&(h=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==d&&(d=s=16383&(f[6]<<8|f[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=p-a+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(d=d+1&16383),(g<0||p>a)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,c=m,s=d;var v=(1e4*(268435455&(p+=122192928e5))+m)%4294967296;u[l++]=v>>>24&255,u[l++]=v>>>16&255,u[l++]=v>>>8&255,u[l++]=255&v;var _=p/4294967296*1e4&268435455;u[l++]=_>>>8&255,u[l++]=255&_,u[l++]=_>>>24&15|16,u[l++]=_>>>16&255,u[l++]=d>>>8|128,u[l++]=255&d;for(var y=0;y<6;++y)u[l+y]=h[y];return t||o(u)}},function(e,t,n){var i=n(5),s=n(6);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[r+a]=o[a];return t||s(o)}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createStateServiceProxyAsync=void 0;var r=n(23);t.createStateServiceProxyAsync=function(e,t,n,o,a,c){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){switch(s.label){case 0:return[4,(i=new r.SimpleStateServiceProxy(e,t,n,o,a,c)).connectAsync()];case 1:return s.sent(),[2,i]}}))}))}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleStateServiceProxy=void 0;var a=o(n(24)),c=n(2),l=n(3),u=n(44),h=n(45),d=n(7),f=n(1),p=n(46),m=n(47),g=n(49),v=n(50),_=[2e3,2e3,3e3,3e3,5e3],y=function(){function e(e,t,n,i,s,r){var o;this.m_events=new c.EventEmitter,this.m_clientId="",this.m_connectionState=f.ConnectionState.Disconnected,this.m_handlers=new Map,this.m_connection=null,this.m_clientIds=new Set,this.m_initTimeoutDurationInMS=0,this.m_retryAttempts=0,this.m_sessionRetryAttempts=0,this.m_maxSessionRetries=0,this.m_outboundMessageInfo=new Map,this.m_initPromise={promise:null,resolve:null,reject:null},this.m_messageBuffer=[],this.m_batchWaitTimeMS=20,this.m_batchMessageTypeName="list",this.m_closeConnectionTimer=null,this.m_lastCloseCode=0,this.m_lastCloseReason="",this.m_offlineMessageCache=[],this.m_unacknowledgedMessages=new Map,this.m_sessionId=e,this.m_logger=i,this.m_connectionAliveTimeAfterLoseFocusInMS=s.websocketAliveTimeAfterLoseFocusInMS,this.m_useServiceGeneratedClientId=s.useServiceGeneratedClientId||!1,this.m_wsUrl=n+"?docId="+this.m_sessionId+"&clientType="+t,s.correlationId&&(this.m_wsUrl+="&cid="+s.correlationId),s.isAutomation&&(this.m_wsUrl+="&automation=true"),s.autoRoutingEnabled&&(this.m_wsUrl+="&routing=true"),this.m_useServiceGeneratedClientId||(this.m_clientId=s.customClientId||l.v4(),this.m_wsUrl+="&clientId="+this.m_clientId),this.m_deltasBaseUrl=n.replace("wss://","https://").replace("ws://","http://"),this.setupSystemClientsCell(),this.setUpSystemCommandsCell(),this.setupServiceGeneratedClientIdCell(),this.m_useServiceGeneratedClientId&&(this.m_clientIdEvictingQueue=new h.EvictingQueue(20)),this.m_telemetry=new g.SimpleServiceTelemetry(this.m_clientId,this.m_sessionId,s.maxRoundtripRaw),this.m_verbose=s.verbose||!1,this.m_batchedRequestsEnabled=s.batchedRequestsEnabled,this.m_initTimeoutDurationInMS=s.initTimeoutDurationInMs||0,this.m_pingTimeoutInMs=s.pingTimeoutInMs,this.m_pongTimeoutInMs=s.pongTimeoutInMs,this.m_user=r,this.m_metadata=s.metadata,this.m_retryIntervalsInMs=s.retryIntervalsInMs||_,this.m_maxSessionRetries=s.maxSessionRetries,this.m_offlineMessageCacheEnabled=s.offlineMessageCacheEnabled,this.m_maxOfflineMessageCacheTimeInMs=s.maxOfflineMessageCacheTimeInMs,this.m_maxOfflineMessageCacheLength=s.maxOfflineMessageCacheLength,this.m_allowReconnectOnMessageSend=s.allowReconnectOnSendMessage||!1,this.m_unacknowledgedMaxTimeInMs=null!==(o=s.unacknowledgeMessageTimeoutInMs)&&void 0!==o?o:0,this.m_subscriptions=s.subscriptions,this.m_connectionSettings={getAuthTokenAsync:this.getAuthToken.bind(this),createSetupMessage:this.createSetupMessage.bind(this),metadata:this.m_metadata,subscriptions:this.m_subscriptions}}return Object.defineProperty(e.prototype,"lastCloseReason",{get:function(){return this.m_lastCloseReason},enumerable:!1,configurable:!0}),e.prototype.senderId=function(){return this.m_clientId},e.prototype.countOfOutboundMessagesNotRoundTrippedYet=function(){return this.m_outboundMessageInfo.size},e.prototype.canRetry=function(){return this.m_connectionState===f.ConnectionState.Disconnected&&4321!==this.m_lastCloseCode},e.prototype.getServiceTelemetry=function(){return this.m_telemetry.wsState=f.ConnectionState[this.getConnectionState()],this.m_telemetry.messagePendingAckCount=this.m_outboundMessageInfo.size,this.m_telemetry},e.prototype.activeClientCount=function(){return this.m_clientIds.size},e.prototype.activeClientIds=function(){return this.m_clientIds},e.prototype.clientId=function(){return this.m_clientId},e.prototype.getConnectionState=function(){return this.m_connectionState},e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.connectAsync=function(){return i(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return this.m_initPromise.promise=new Promise((function(t,n){e.m_initPromise.resolve=t,e.m_initPromise.reject=n})),this.setConnectionState(f.ConnectionState.Connecting),[2,new Promise((function(t,n){return i(e,void 0,void 0,(function(){var e,i=this;return s(this,(function(s){switch(s.label){case 0:return e=this,[4,v.StateServiceWebSocketConnection.CreateAsync(this.m_wsUrl,this.m_connectionSettings)];case 1:return e.m_connection=s.sent(),this.m_connection.onopen=function(){i.handleConnectionOpen(),i.startInitTimeoutTimer(i.m_initTimeoutDurationInMS,i.m_initPromise.reject),t()},this.m_connection.onerror=function(e){var t;i.m_logger.sendTraceTag(590213388,d.TraceLevel.Error,"SimpleStateServiceProxy::connect - "+(null===(t=i.m_connection)||void 0===t?void 0:t.name)+" onerror. {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+", Error: "+JSON.stringify(e)+"}"),i.retryConnection((function(e){var t,s="failed to reconnect after "+(null===(t=i.m_connection)||void 0===t?void 0:t.name)+" error: "+u.errorToString(e);i.m_logger.sendTraceTag(579463185,d.TraceLevel.Error,s),n(s)}),!1)},this.m_connection.onlog=function(e){var t;i.m_logger.sendTraceTag(556909603,e.detail.level,"SimpleStateServiceProxy::log - "+(null===(t=i.m_connection)||void 0===t?void 0:t.name)+" {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+", Message: "+e.detail.message+"}")},this.m_connection.onclose=function(e){var t,s;i.m_logger.sendTraceTag(590213389,d.TraceLevel.Error,"SimpleStateServiceProxy::connect - "+(null===(t=i.m_connection)||void 0===t?void 0:t.name)+" onclose. {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+", Code: "+e.code+", Reason: "+e.reason+"}"),i.m_lastCloseCode=e.code,i.m_lastCloseReason=e.reason,4321!==e.code?i.retryConnection((function(e){var t="failed to reconnect after service side disconnect: "+u.errorToString(e);i.m_logger.sendTraceTag(579463186,d.TraceLevel.Error,t),n(t)}),!1):(i.setConnectionState(f.ConnectionState.Disconnected),i.m_logger.sendTraceTag(588009741,d.TraceLevel.Error,"SimpleStateServiceProxy::connect - "+(null===(s=i.m_connection)||void 0===s?void 0:s.name)+" onclose. Not retryable close code. {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+"}"))},this.m_connection.onmessage=function(e){var t;try{i.handleConnectionMessage(e)}catch(e){i.m_logger.sendTraceTag(590213390,d.TraceLevel.Error,"SimpleStateServiceProxy::onmessage - "+(null===(t=i.m_connection)||void 0===t?void 0:t.name)+" error. {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+", Error: "+u.errorToString(e)+"}")}},[2]}}))}))}))]}))}))},e.prototype.close=function(){var e;this.m_logger.sendTraceTag(590213400,d.TraceLevel.Info,"SimpleStateServiceProxy::close. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.closeAndClearConnection(),this.m_retryTimer&&(clearTimeout(this.m_retryTimer),this.m_retryTimer=null),this.m_unacknowledgedMessages.clear(),this.clearPingPongTimer(),this.clearOfflineMessageCacheTimer(),this.clearInitTimeoutTimer(),this.clearUnacknowledgedTimer(),null===(e=this.m_clientIdEvictingQueue)||void 0===e||e.clear(),0!==this.countOfOutboundMessagesNotRoundTrippedYet()&&(this.m_events.emit("messageFailedToRoundTripOnClose",this.m_outboundMessageInfo.size),this.m_outboundMessageInfo.clear())},e.prototype.sendStateMessage=function(e){this.sendStateMessageImpl(e)},e.prototype.createMapAsync=function(e,t,n,r){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){return i=new m.SimpleSyncMap(e,this,t,n,r),this.m_handlers.set(e,i),[2,i]}))}))},e.prototype.getMapAsync=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){return(t=this.m_handlers.get(e))?[2,t]:[2,null]}))}))},e.prototype.waitMapAsync=function(e,t,n,r){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){switch(s.label){case 0:return[4,this.m_initPromise.promise];case 1:return s.sent(),[4,this.getMapAsync(e)];case 2:return(i=s.sent())?[3,4]:[4,this.createMapAsync(e,t,n,r)];case 3:i=s.sent(),s.label=4;case 4:return[2,i]}}))}))},e.prototype.createCellAsync=function(e,t,n,r){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){return i=new p.SimpleSyncCell(e,this,t,n,r),this.m_handlers.set(e,i),[2,i]}))}))},e.prototype.getCellAsync=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){return(t=this.m_handlers.get(e))?[2,t]:[2,null]}))}))},e.prototype.waitCellAsync=function(e,t,n,r){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){switch(s.label){case 0:return[4,this.m_initPromise.promise];case 1:return s.sent(),[4,this.getCellAsync(e)];case 2:return(i=s.sent())?[3,4]:[4,this.createCellAsync(e,t,n,r)];case 3:i=s.sent(),s.label=4;case 4:return[2,i]}}))}))},e.prototype.onFocusChanged=function(e){var t=this;e?(window.clearTimeout(this.m_closeConnectionTimer),this.m_connection||(this.m_logger.sendTraceTag(590213392,d.TraceLevel.Info,"SimpleStateServiceProxy::onFocusChanged - retryConnection due to getting focus again. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.retryConnection((function(e){t.m_logger.sendTraceTag(579463187,d.TraceLevel.Error,"failed to reconnect after regaining focus: "+u.errorToString(e))}),!0))):this.m_closeConnectionTimer=window.setTimeout((function(){var e;t.m_connection&&(t.m_logger.sendTraceTag(590213391,d.TraceLevel.Info,"SimpleStateServiceProxy::onFocusChanged - "+(null===(e=t.m_connection)||void 0===e?void 0:e.name)+" close due to losing focus. {sessionId: "+t.m_sessionId+", ClientId: "+t.m_clientId+"}"),t.m_connection.onclose=function(){},t.m_connection.close(),t.m_connection=null)}),this.m_connectionAliveTimeAfterLoseFocusInMS)},e.prototype.getHistoryAsync=function(e,t){return i(this,void 0,void 0,(function(){var n,i;return s(this,(function(s){switch(s.label){case 0:return(n=new URL(this.m_deltasBaseUrl)).searchParams.append("action","deltas"),n.searchParams.append("docId",this.m_sessionId),n.searchParams.append("cid",this.m_clientId),n.searchParams.append("objectId",e),t&&n.searchParams.append("property",t),[4,a.default.get(n.toString())];case 1:return(i=s.sent().data).forEach((function(e){return e.value=JSON.parse(e.value)})),[2,i]}}))}))},e.prototype.getHistoryWithPaginationAsync=function(e,t,n){return i(this,void 0,void 0,(function(){var i,r;return s(this,(function(s){switch(s.label){case 0:return(i=new URL(this.m_deltasBaseUrl)).searchParams.append("action","deltas"),i.searchParams.append("docId",this.m_sessionId),i.searchParams.append("cid",this.m_clientId),i.searchParams.append("objectId",e),i.searchParams.append("pagination","true"),n&&i.searchParams.append("cursor",n),t&&i.searchParams.append("property",t),[4,a.default.get(i.toString())];case 1:return(r=s.sent().data).messages.forEach((function(e){return e.value=JSON.parse(e.value)})),[2,r]}}))}))},e.prototype.setupSystemClientsCell=function(){var e=this;this.m_clientsCell=new p.SimpleSyncCell("systemClients",this),this.m_handlers.set(this.m_clientsCell.id(),this.m_clientsCell),this.m_clientsCell.on("valueChanged",(function(t){e.m_clientIds=new Set(t),e.m_events.emit("activeClientCountChanged")}))},e.prototype.setUpSystemCommandsCell=function(){var e=this;this.m_systemCommandsCell=new p.SimpleSyncCell(f.SystemCommandsStateName,this),this.m_handlers.set(this.m_systemCommandsCell.id(),this.m_systemCommandsCell),this.m_systemCommandsCell.on("valueChanged",(function(t){return i(e,void 0,void 0,(function(){var e,n,i;return s(this,(function(s){switch(s.label){case 0:switch(t){case"refreshToken":return[3,1]}return[3,6];case 1:if(!this.m_user||!this.m_user.getForceRefreshedTokenAsync)return[3,5];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.m_user.getForceRefreshedTokenAsync()];case 3:return e=s.sent(),n={},e&&(n.authorization=e.token,n.authProvider=e.authProvider,n.mri=e.mri||"",n.huid=e.hashedUserEmail||""),this.sendConfigMessage(n),[3,5];case 4:return i=s.sent(),this.m_logger.sendTraceTag(574107847,d.TraceLevel.Error,"Error getting force refreshed auth token: "+u.errorToString(i)),[3,5];case 5:return[3,7];case 6:return this.m_logger.sendTraceTag(574107848,d.TraceLevel.Error,"Unknown system command cell value: "+t),[3,7];case 7:return[2]}}))}))}))},e.prototype.setupServiceGeneratedClientIdCell=function(){var e=this;this.m_serviceGeneratedClientIdCell=new p.SimpleSyncCell(f.ServiceGeneratedClientIdName,this),this.m_handlers.set(this.m_serviceGeneratedClientIdCell.id(),this.m_serviceGeneratedClientIdCell),this.m_serviceGeneratedClientIdCell.on("valueChanged",(function(t){e.setClientId(t,!0),e.processClientIdQueue()}))},e.prototype.handleConnectionOpen=function(){var e;this.m_logger.sendTraceTag(590213387,d.TraceLevel.Info,"SimpleStateServiceProxy::connect - "+(null===(e=this.m_connection)||void 0===e?void 0:e.name)+" onopen. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_retryAttempts=0,this.setConnectionState(f.ConnectionState.Connected),this.startPingTimer(),this.processOfflineMessageCache(),this.clearOfflineMessageCacheTimer()},e.prototype.setConnectionState=function(e){this.m_connectionState!==e&&(this.m_connectionState=e,e===f.ConnectionState.Disconnected&&this.m_useServiceGeneratedClientId&&this.setClientId("",!1),this.m_events.emit("connectionStateChanged"))},e.prototype.setClientId=function(e,t){this.m_clientId!==e&&(this.m_clientId=e,t&&this.m_events.emit("clientIdChanged"))},e.prototype.processClientIdQueue=function(){var e=this;this.m_clientIdEvictingQueue&&this.m_clientIdEvictingQueue.forEach((function(t){t.senderId=e.m_clientId,e.sendConnectionMessage(t,!0)}))},e.prototype.createSetupMessage=function(e){var t=e.authToken,n=e.metadata,i=e.subscriptions,s=[];if(t||n){var r={};t&&(r.authorization=t.token,r.authProvider=t.authProvider,r.mri=t.mri||"",r.huid=t.hashedUserEmail||""),n&&(r.metadata=JSON.stringify(n));var o={messageId:l.v4(),senderId:this.senderId(),objectId:f.ConfigurationName,type:"",operation:"",value:JSON.stringify(r)};s.push(JSON.stringify(o))}return i&&(o={messageId:l.v4(),senderId:this.senderId(),objectId:f.StateSubscriptionsName,type:"",operation:"",value:JSON.stringify(i)},s.push(JSON.stringify(o))),s},e.prototype.sendConfigMessage=function(e){var t={messageId:l.v4(),senderId:this.senderId(),objectId:f.ConfigurationName,type:"",operation:"",value:JSON.stringify(e)};this.sendStateMessage(t)},e.prototype.retryConnection=function(e,t){var n=this;if(this.clearPingPongTimer(),this.clearInitTimeoutTimer(),this.m_retryAttempts>=this.m_retryIntervalsInMs.length||this.m_sessionRetryAttempts>=this.m_maxSessionRetries)return this.setConnectionState(f.ConnectionState.Disconnected),this.m_logger.sendTraceTag(590213393,d.TraceLevel.Error,"SimpleStateServiceProxy::retryConnection reached max retry attempts. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),void(e&&e(new Error("reached max retry attempts")));if(this.setConnectionState(f.ConnectionState.Connecting),t||this.m_connection&&!this.m_retryTimer){var r=this.m_retryIntervalsInMs[this.m_retryAttempts];this.m_retryAttempts+=1,this.m_sessionRetryAttempts+=1,this.m_telemetry.wsReconnectCount+=1,this.closeAndClearConnection(),this.m_retryTimer=setTimeout((function(){return i(n,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:this.m_logger.sendTraceTag(590213395,d.TraceLevel.Info,"SimpleStateServiceProxy::retryConnection. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_retryTimer=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.connectAsync()];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),this.setConnectionState(f.ConnectionState.Disconnected),this.m_logger.sendTraceTag(590213396,d.TraceLevel.Error,"SimpleStateServiceProxy::retryConnection failed. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}, "+u.errorToString(t)),this.m_retryAttempts>=this.m_retryIntervalsInMs.length&&e(t),[3,4];case 4:return[2]}}))}))}),r)}else this.m_logger.sendTraceTag(590213394,d.TraceLevel.Info,"SimpleStateServiceProxy::retryConnection skipped. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", NullConnection: "+(null===this.m_connection)+", NullRetryTimer: "+(null===this.m_retryTimer)+"}")},e.prototype.startPingTimer=function(){var e=this;this.m_connection&&this.m_connection.shouldSendPings&&(this.m_pingTimeoutInMs<=0||this.m_pongTimeoutInMs<=0||(this.clearPingPongTimer(),this.m_pingTimer=setTimeout((function(){return i(e,void 0,void 0,(function(){return s(this,(function(e){return this.sendPingMessage(),this.m_pingTimer=null,[2]}))}))}),this.m_pingTimeoutInMs)))},e.prototype.sendPingMessage=function(){var e=this;this.m_connection&&(this.m_connection.isOpen?(this.m_verbose&&this.m_logger.sendTraceTag(559952470,d.TraceLevel.Info,"SimpleStateServiceProxy::sendPingMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", __ping__"),this.m_connection.send("__ping__"),this.clearPongTimer(),this.m_pongTimer=setTimeout((function(){return i(e,void 0,void 0,(function(){var e=this;return s(this,(function(t){return this.retryConnection((function(t){e.m_logger.sendTraceTag(579463188,d.TraceLevel.Error,"failed to reconnect after missing ping: "+u.errorToString(t))}),!1),this.m_pongTimer=null,[2]}))}))}),this.m_pongTimeoutInMs)):(this.retryConnection((function(t){e.m_logger.sendTraceTag(579463189,d.TraceLevel.Error,"failed to reconnect after closed connection: "+u.errorToString(t))}),!1),this.clearPongTimer()))},e.prototype.clearPingPongTimer=function(){this.clearPingTimer(),this.clearPongTimer()},e.prototype.clearPingTimer=function(){this.m_pingTimer&&(clearTimeout(this.m_pingTimer),this.m_pingTimer=null)},e.prototype.clearPongTimer=function(){this.m_pongTimer&&(clearTimeout(this.m_pongTimer),this.m_pongTimer=null)},e.prototype.handleConnectionMessage=function(e){if("string"==typeof e.data){if(this.startPingTimer(),"__pong__"===e.data)return void(this.m_verbose&&this.m_logger.sendTraceTag(559952471,d.TraceLevel.Info,"SimpleStateServiceProxy::handleConnectionMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", __pong__"));var t=Date.now();try{var n=JSON.parse(e.data);Array.isArray(n)&&n.length>0?this.handleAggregatedStateMessages(n):this.handleStateMessage(n),this.m_telemetry.addMessageHandleLatency(Date.now()-t),n.objectId===f.SystemSessionStateName&&(this.m_initPromise.resolve(),this.clearInitTimeoutTimer())}catch(e){this.m_logger.sendTraceTag(578102302,d.TraceLevel.Error,"handleConnectionMessage: "+u.errorToString(e))}}else this.m_logger.sendTraceTag(590213397,d.TraceLevel.Error,"SimpleStateServiceProxy::handleConnectionMessage - Unknown data type. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Type: "+typeof e.data+"}")},e.prototype.handleAggregatedStateMessages=function(e){var t,n,i=this;if(e&&0!==e.length){var s=e.map((function(e){return JSON.parse(e)})),o={};s.forEach((function(e){return o[e.objectId]=1+(o[e.objectId]||0)})),Object.keys(o).forEach((function(e){if(o[e]>1){var t=i.m_handlers.get(e);t&&t.beginAggregatedStateUpdating&&t.beginAggregatedStateUpdating()}}));try{for(var a=r(s),c=a.next();!c.done;c=a.next()){var l=c.value;this.handleStateMessage(l)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}Object.keys(o).forEach((function(e){if(o[e]>1){var t=i.m_handlers.get(e);t&&t.endAggregatedStateUpdating&&t.endAggregatedStateUpdating()}}))}},e.prototype.handleStateMessage=function(e){var t=this;if(this.m_verbose&&this.m_logger.sendTraceTag(590213398,d.TraceLevel.Info,"SimpleStateServiceProxy::handleStateMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}"),"list"===e.type)JSON.parse(e.value).forEach((function(e){t.handleStateMessage(e)}));else{if(this.m_user&&this.m_user.validateMessage&&!this.m_user.validateMessage(e))return void this.m_logger.sendTraceTag(588009742,d.TraceLevel.Error,"SimpleStateServiceProxy::handleStateMessage rejected message: {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}");var n=this.getHandlerForMessage(e);if(e.senderId===this.senderId()&&(this.acknowledgeMessage(e,n),this.m_telemetry.incrementAcknowledgedCount(e.objectId)),this.measureMessageRoundTripLatency(e),this.m_telemetry.incrementReceivedCount(e.objectId),n)return void n.handleStateMessage(e)}},e.prototype.getAuthToken=function(){return i(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:if(!this.m_user||!this.m_user.getAuthTokenAsync)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.m_user.getAuthTokenAsync()];case 2:return e=n.sent(),[3,4];case 3:return t=n.sent(),this.m_logger.sendTraceTag(578102469,d.TraceLevel.Error,"Error getting auth token: "+u.errorToString(t)),[3,4];case 4:return[2,e]}}))}))},e.prototype.getHandlerForMessage=function(e){var t=this.m_handlers.get(e.objectId);return t||("cell"===e.type?t=new p.SimpleSyncCell(e.objectId,this):"map"===e.type?t=new m.SimpleSyncMap(e.objectId,this):this.m_logger.sendTraceTag(559204164,d.TraceLevel.Error,"SimpleStateServiceProxy::handleStateMessage - Unknown message type. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Type: "+e.type+"}"),t&&this.m_handlers.set(e.objectId,t),t)},e.prototype.sendStateMessageImpl=function(e){var t,n=this;if(this.m_verbose&&this.m_logger.sendTraceTag(590213403,d.TraceLevel.Info,"SimpleStateServiceProxy::sendStateMessageImpl. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}"),e.objectId!==f.StateSubscriptionsName&&e.objectId!==f.ConfigurationName){if(this.m_outboundMessageInfo.set(e.messageId,Date.now()),this.m_telemetry.incrementRequestedCount(e.objectId),this.m_unacknowledgedMaxTimeInMs>0){var i=null===(t=this.getHandlerForMessage(e))||void 0===t?void 0:t.messageTrackingOption();if(i&&i!==f.MessageTrackingOption.None){var s=this.getUnacknowledgedMessagesMapKey(e,i);this.m_unacknowledgedMessages.set(s,{message:e,timestamp:Date.now()}),this.startUnacknowledgeMessageTimer()}}if(this.m_useServiceGeneratedClientId&&this.m_clientIdEvictingQueue&&!this.m_clientId)return void this.m_clientIdEvictingQueue.enqueue(e)}this.m_user&&this.m_user.patchMessage&&this.m_user.patchMessage(e),this.m_batchedRequestsEnabled?(this.m_messageBuffer.push(e),this.m_processBufferTimer||(this.m_processBufferTimer=setTimeout((function(){n.processMessageBuffer()}),this.m_batchWaitTimeMS))):this.sendConnectionMessage(e,!0)},e.prototype.createListMessage=function(e){if(0!==e.length)return 1===e.length?e[0]:{value:JSON.stringify(e),type:this.m_batchMessageTypeName,operation:"",messageId:l.v4(),objectId:"batch",senderId:this.senderId()}},e.prototype.processMessageBuffer=function(){var e=this.m_messageBuffer.length,t=this.m_messageBuffer.splice(0,e),n=this.createListMessage(t);this.m_processBufferTimer&&clearTimeout(this.m_processBufferTimer),this.m_processBufferTimer=null,n&&this.sendConnectionMessage(n,!0)},e.prototype.processOfflineMessageCache=function(){var e=this;this.m_offlineMessageCacheEnabled&&(this.m_offlineMessageCache.forEach((function(t){e.sendConnectionMessage(t.message,!1),e.m_telemetry.offlineCacheTelemetry.resentCount+=1})),this.m_offlineMessageCache=[])},e.prototype.purgeOfflineMessageCache=function(){var e=this;if(this.m_offlineMessageCacheEnabled&&this.m_maxOfflineMessageCacheTimeInMs){var t=Date.now(),n=this.m_offlineMessageCache.filter((function(n){return e.m_maxOfflineMessageCacheTimeInMs&&n.timestamp+e.m_maxOfflineMessageCacheTimeInMs>=t}));this.m_telemetry.offlineCacheTelemetry.expiredCount+=this.m_offlineMessageCache.length-n.length,this.m_offlineMessageCache=n,0===this.m_offlineMessageCache.length&&this.clearOfflineMessageCacheTimer()}},e.prototype.clearOfflineMessageCacheTimer=function(){this.m_offlineMessageCacheEnabled&&this.m_offlineMessageCacheTimer&&(clearInterval(this.m_offlineMessageCacheTimer),this.m_offlineMessageCacheTimer=null)},e.prototype.getUnacknowledgedMessagesMapKey=function(e,t){return t===f.MessageTrackingOption.None?"":t===f.MessageTrackingOption.All?e.messageId:e.objectId},e.prototype.startUnacknowledgeMessageTimer=function(){var e=this;this.m_unacknowledgedMaxTimeInMs>0&&!this.m_unacknowledgedTimer&&(this.m_unacknowledgedTimer=setInterval((function(){e.notifyUnacknowledgedMessages(),e.m_unacknowledgedMessages.size<=0&&e.clearUnacknowledgedTimer()}),this.m_unacknowledgedMaxTimeInMs/2))},e.prototype.acknowledgeMessage=function(e,t){if(e.senderId===this.senderId()&&t&&!(this.m_unacknowledgedMessages.size<=0)){var n=this.getUnacknowledgedMessagesMapKey(e,t.messageTrackingOption()),i=this.m_unacknowledgedMessages.get(n);i&&e.messageId===i.message.messageId&&this.m_unacknowledgedMessages.delete(n)}},e.prototype.notifyUnacknowledgedMessages=function(){var e=this,t=Date.now();this.m_unacknowledgedMessages.forEach((function(n,i){if(n.timestamp+e.m_unacknowledgedMaxTimeInMs<t){var s=e.getHandlerForMessage(n.message);null==s||s.handleUnacknowledgedMessage(n.message),e.m_unacknowledgedMessages.delete(i),e.m_telemetry.unacknowledgedMessagesCount+=1}}))},e.prototype.clearUnacknowledgedTimer=function(){this.m_unacknowledgedTimer&&(clearInterval(this.m_unacknowledgedTimer),this.m_unacknowledgedTimer=null)},e.prototype.startInitTimeoutTimer=function(e,t){e>0&&(this.clearInitTimeoutTimer(),this.m_initTimeoutTimer=setTimeout((function(){t("Initialization timed out after "+e+" ms")}),e))},e.prototype.clearInitTimeoutTimer=function(){this.m_initTimeoutTimer&&clearTimeout(this.m_initTimeoutTimer)},e.prototype.sendConnectionMessage=function(e,t){var n,i,s=this;if(this.m_allowReconnectOnMessageSend&&this.m_connectionState===f.ConnectionState.Disconnected&&(this.updateRetryAttempts(),this.retryConnection((function(e){s.m_logger.sendTraceTag(559428289,d.TraceLevel.Error,"SimpleStateServiceProxy::sendConnectionMessage - failed to reconnect with error: "+u.errorToString(e)+" ")}),!1)),this.m_offlineMessageCacheEnabled&&t){if(!this.m_connection||this.m_connectionState!==f.ConnectionState.Connected)return!this.m_maxOfflineMessageCacheLength||this.m_offlineMessageCache.length>=this.m_maxOfflineMessageCacheLength?(this.m_telemetry.offlineCacheTelemetry.rejectedCount+=1,void this.m_logger.sendTraceTag(570807006,d.TraceLevel.Error,"SimpleStateServiceProxy::sendConnectionMessage - Dropping message because offline cache is full. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Status: "+(null===(n=this.m_connection)||void 0===n?void 0:n.readyState)+"}")):(!this.m_offlineMessageCacheTimer&&this.m_maxOfflineMessageCacheTimeInMs&&(this.m_offlineMessageCacheTimer=setInterval((function(){s.purgeOfflineMessageCache()}),this.m_maxOfflineMessageCacheTimeInMs/2)),this.m_offlineMessageCache.push({message:e,timestamp:Date.now()}),void(this.m_telemetry.offlineCacheTelemetry.cachedCount+=1))}else{if(!this.m_connection)return void this.m_logger.sendTraceTag(590213401,d.TraceLevel.Error,"SimpleStateServiceProxy::sendConnectionMessage - connection is not set. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}");if(!this.m_connection.isOpen)return void this.m_logger.sendTraceTag(590213402,d.TraceLevel.Error,"SimpleStateServiceProxy::sendConnectionMessage - "+this.m_connection.name+" status is not open. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Status: "+this.m_connection.readyState+"}")}null===(i=this.m_connection)||void 0===i||i.send(JSON.stringify(e))},e.prototype.closeAndClearConnection=function(){if(this.m_connection){if(this.m_connection.onclose=function(){},this.m_connection.isOpen)this.m_connection.close();else{var e=this.m_connection;e.onopen=function(){return e.close()}}this.m_connection=null}},e.prototype.updateRetryAttempts=function(){this.m_retryAttempts>=this.m_retryIntervalsInMs.length&&(this.m_retryAttempts=0),this.m_sessionRetryAttempts>=this.m_maxSessionRetries&&(this.m_sessionRetryAttempts=0)},e.prototype.measureMessageRoundTripLatency=function(e){if(e.senderId===this.senderId())try{var t=this.m_outboundMessageInfo.get(e.messageId);if(void 0!==t){this.m_outboundMessageInfo.delete(e.messageId);var n=Date.now()-t;this.m_events.emit("messageRoundTripped",{clientId:this.m_clientId,sessionId:this.m_sessionId,messageId:e.messageId,objectId:e.objectId,operation:e.operation,latencyInMs:n}),this.m_telemetry.addRoundtripLatency(n)}else this.m_verbose&&this.m_logger.sendTraceTag(590213404,d.TraceLevel.Info,"SimpleStateServiceProxy::measureMessageRoundTripLatency. Failed to find outbound message info for {SessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}")}catch(t){this.m_logger.sendTraceTag(590213405,d.TraceLevel.Error,"SimpleStateServiceProxy::measureMessageRoundTripLatency - Exception thrown error. {SessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", MessageId: "+e.messageId+", Error: "+t.message+"}")}},e}();t.SimpleStateServiceProxy=y},function(e,t,n){e.exports=n(25)},function(e,t,n){"use strict";var i=n(0),s=n(8),r=n(26),o=n(14);function a(e){var t=new r(e),n=s(r.prototype.request,t);return i.extend(n,r.prototype,t),i.extend(n,t),n}var c=a(n(4));c.Axios=r,c.create=function(e){return a(o(c.defaults,e))},c.Cancel=n(15),c.CancelToken=n(41),c.isCancel=n(13),c.all=function(e){return Promise.all(e)},c.spread=n(42),c.isAxiosError=n(43),e.exports=c,e.exports.default=c},function(e,t,n){"use strict";var i=n(0),s=n(9),r=n(27),o=n(28),a=n(14),c=n(39),l=c.validators;function u(e){this.defaults=e,this.interceptors={request:new r,response:new r}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:l.transitional(l.boolean,"1.0.0"),forcedJSONParsing:l.transitional(l.boolean,"1.0.0"),clarifyTimeoutError:l.transitional(l.boolean,"1.0.0")},!1);var n=[],i=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var s,r=[];if(this.interceptors.response.forEach((function(e){r.push(e.fulfilled,e.rejected)})),!i){var u=[o,void 0];for(Array.prototype.unshift.apply(u,n),u=u.concat(r),s=Promise.resolve(e);u.length;)s=s.then(u.shift(),u.shift());return s}for(var h=e;n.length;){var d=n.shift(),f=n.shift();try{h=d(h)}catch(e){f(e);break}}try{s=o(h)}catch(e){return Promise.reject(e)}for(;r.length;)s=s.then(r.shift(),r.shift());return s},u.prototype.getUri=function(e){return e=a(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,n,i){return this.request(a(i||{},{method:e,url:t,data:n}))}})),e.exports=u},function(e,t,n){"use strict";var i=n(0);function s(){this.handlers=[]}s.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},s.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},s.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=s},function(e,t,n){"use strict";var i=n(0),s=n(29),r=n(13),o=n(4);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=s.call(e,e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return a(e),t.data=s.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return r(t)||(a(e),t&&t.response&&(t.response.data=s.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var i=n(0),s=n(4);e.exports=function(e,t,n){var r=this||s;return i.forEach(n,(function(n){e=n.call(r,e,t)})),e}},function(e,t){var n,i,s=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var c,l=[],u=!1,h=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&f())}function f(){if(!u){var e=a(d);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,n){"use strict";var i=n(0);e.exports=function(e,t){i.forEach(e,(function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])}))}},function(e,t,n){"use strict";var i=n(12);e.exports=function(e,t,n){var s=n.config.validateStatus;n.status&&s&&!s(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var i=n(0);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,n,s,r,o){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(s)&&a.push("path="+s),i.isString(r)&&a.push("domain="+r),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var i=n(35),s=n(36);e.exports=function(e,t){return e&&!i(t)?s(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var i=n(0),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,r,o={};return e?(i.forEach(e.split("\n"),(function(e){if(r=e.indexOf(":"),t=i.trim(e.substr(0,r)).toLowerCase(),n=i.trim(e.substr(r+1)),t){if(o[t]&&s.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}})),o):o}},function(e,t,n){"use strict";var i=n(0);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function s(e){var i=e;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=s(window.location.href),function(t){var n=i.isString(t)?s(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var i=n(40),s={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){s[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var r={},o=i.version.split(".");function a(e,t){for(var n=t?t.split("."):o,i=e.split("."),s=0;s<3;s++){if(n[s]>i[s])return!0;if(n[s]<i[s])return!1}return!1}s.transitional=function(e,t,n){var s=t&&a(t);function o(e,t){return"[Axios v"+i.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,a){if(!1===e)throw new Error(o(i," has been removed in "+t));return s&&!r[i]&&(r[i]=!0,console.warn(o(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),s=i.length;s-- >0;){var r=i[s],o=t[r];if(o){var a=e[r],c=void 0===a||o(a,r,e);if(!0!==c)throw new TypeError("option "+r+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+r)}},validators:s}},function(e){e.exports=JSON.parse('{"_args":[["axios@0.21.4","D:\\\\a\\\\_work\\\\1\\\\s\\\\Packages\\\\PPTLiveBroadcast"]],"_from":"axios@0.21.4","_id":"axios@0.21.4","_inBundle":false,"_integrity":"sha1-xnuQ3AVo5cHPKwuFjEO6KOLtpXU=","_location":"/axios","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"axios@0.21.4","name":"axios","escapedName":"axios","rawSpec":"0.21.4","saveSpec":null,"fetchSpec":"0.21.4"},"_requiredBy":["/@powerpoint-webcomponents/stateservice-proxy"],"_resolved":"https://office.pkgs.visualstudio.com/_packaging/Office/npm/registry/axios/-/axios-0.21.4.tgz","_spec":"0.21.4","_where":"D:\\\\a\\\\_work\\\\1\\\\s\\\\Packages\\\\PPTLiveBroadcast","author":{"name":"Matt Zabriskie"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"bugs":{"url":"https://github.com/axios/axios/issues"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}],"dependencies":{"follow-redirects":"^1.14.0"},"description":"Promise based HTTP client for the browser and node.js","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"homepage":"https://axios-http.com","jsdelivr":"dist/axios.min.js","keywords":["xhr","http","ajax","promise","node"],"license":"MIT","main":"index.js","name":"axios","repository":{"type":"git","url":"git+https://github.com/axios/axios.git"},"scripts":{"build":"NODE_ENV=production grunt build","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","examples":"node ./examples/server.js","fix":"eslint --fix lib/**/*.js","postversion":"git push && git push --tags","preversion":"npm test","start":"node ./sandbox/server.js","test":"grunt test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json"},"typings":"./index.d.ts","unpkg":"dist/axios.min.js","version":"0.21.4"}')},function(e,t,n){"use strict";var i=n(15);function s(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new i(e),t(n.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var e;return{token:new s((function(t){e=t})),cancel:e}},e.exports=s},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.errorToString=void 0,t.errorToString=function(e,t){if(void 0===t&&(t=!0),null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,r(s(t)))}catch(e){return"Stringifying error failed"}};var s=function(e){return void 0===e&&(e=!1),function(t,n){return n instanceof Error?i({name:n.name,message:n.message,stack:e?[]:("string"==typeof n.stack?n.stack:"").split("\n").map((function(e){return e.trim()})).filter((function(e){return!!e}))},n):n}},r=function(e){var t=new WeakSet;return function(n,i){if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return e(n,i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EvictingQueue=void 0;var i=function(){function e(e){this.maxSize=e,this._store=[]}return Object.defineProperty(e.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._store.length},enumerable:!1,configurable:!0}),e.prototype.enqueue=function(e){this._store.length>=this.maxSize&&this._store.shift(),this._store.push(e)},e.prototype.dequeue=function(){return this._store.shift()},e.prototype.clear=function(){this._store=[]},e.prototype.forEach=function(e){this._store.forEach(e)},e}();t.EvictingQueue=i},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleSyncCell=void 0;var r=n(2),o=n(3),a=n(1),c=function(){function e(e,t,n,i,s){this.m_id=e,this.m_sender=t,this.m_shouldEmitEventForAllMessages=n,this.aggregation=s,this.m_events=new r.EventEmitter,this.m_emitUnacknowledgedEventFor=null!=i?i:a.MessageTrackingOption.None}return e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.off=function(e,t){return this.m_events.off(e,t),this},e.prototype.removeAllListeners=function(e){return this.m_events.removeAllListeners(e),this},e.prototype.id=function(){return this.m_id},e.prototype.messageTrackingOption=function(){return this.m_emitUnacknowledgedEventFor},e.prototype.getAsync=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.m_value]}))}))},e.prototype.setAsync=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){return this.m_value=e,t={messageId:o.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"cell",operation:"set",value:JSON.stringify(this.m_value)},this.m_sender.sendStateMessage(t),[2]}))}))},e.prototype.delete=function(){this.m_value=void 0;var e={messageId:o.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"cell",operation:"delete",value:""};this.m_sender.sendStateMessage(e)},e.prototype.handleStateMessage=function(e){switch(e.operation){case"set":return void((JSON.stringify(this.m_value)!==e.value||this.m_shouldEmitEventForAllMessages)&&(this.m_value=JSON.parse(e.value),this.m_events.emit("valueChanged",this.m_value,e)));case"delete":return this.m_value=void 0,void this.m_events.emit("valueDeleted",this.m_value,e);default:return}},e.prototype.handleUnacknowledgedMessage=function(e){this.m_events.emit("valueUnacknowledged",e)},e.prototype.beginAggregatedStateUpdating=function(){var e;null===(e=this.aggregation)||void 0===e||e.beginAggregatedStateUpdating()},e.prototype.endAggregatedStateUpdating=function(){var e;null===(e=this.aggregation)||void 0===e||e.endAggregatedStateUpdating()},e}();t.SimpleSyncCell=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleSyncMap=void 0;var i=n(2),s=n(3),r=n(1),o=n(48),a=function(){function e(e,t,n,s,o){this.m_id=e,this.m_sender=t,this.m_shouldEmitEventForAllMessages=n,this.aggregation=o,this.m_events=new i.EventEmitter,this.m_map=new Map,this.m_emitUnacknowledgedEventFor=null!=s?s:r.MessageTrackingOption.None}return e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.off=function(e,t){return this.m_events.off(e,t),this},e.prototype.removeAllListeners=function(e){return this.m_events.removeAllListeners(e),this},e.prototype.id=function(){return this.m_id},e.prototype.messageTrackingOption=function(){return this.m_emitUnacknowledgedEventFor},e.prototype.get=function(e){return this.m_map.get(e)},e.prototype.set=function(e,t){this.m_map.set(e,t);var n={messageId:s.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"set",property:e,value:JSON.stringify(t)};this.m_sender.sendStateMessage(n)},e.prototype.delete=function(e){var t={messageId:s.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"delete",property:e,value:""};this.performLocalDelete(t),this.m_sender.sendStateMessage(t)},e.prototype.deleteWithPrefix=function(e){var t={messageId:s.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"delete",property:e,value:"prefix"};this.performLocalDelete(t),this.m_sender.sendStateMessage(t)},e.prototype.forEach=function(e){this.m_map.forEach(e)},e.prototype.handleStateMessage=function(e){switch(e.operation){case"set":return void this.handleSet(e);case"delete":return void this.handleDelete(e);default:return}},e.prototype.handleSet=function(e){if(!e.property)throw new Error("property is missing for a map.");(JSON.stringify(this.m_map.get(e.property))!==e.value||this.m_shouldEmitEventForAllMessages)&&(this.m_map.set(e.property,JSON.parse(e.value)),this.m_events.emit("valueChanged",e.property,e))},e.prototype.handleDelete=function(e){this.performLocalDelete(e),o.isPrefixDeleteMessage(e)?this.m_events.emit("valuesDeletedWithPrefix",e.property,e):this.m_events.emit("valueDeleted",e.property||"",e)},e.prototype.handleUnacknowledgedMessage=function(e){this.m_events.emit("valueUnacknowledged",e)},e.prototype.beginAggregatedStateUpdating=function(){var e;null===(e=this.aggregation)||void 0===e||e.beginAggregatedStateUpdating()},e.prototype.endAggregatedStateUpdating=function(){var e;null===(e=this.aggregation)||void 0===e||e.endAggregatedStateUpdating()},e.prototype.performLocalDelete=function(e){var t=this;if(e.property){var n=e.property;o.isPrefixDeleteMessage(e)?this.m_map.forEach((function(e,i){i.startsWith(n)&&t.m_map.delete(i)})):this.m_map.delete(e.property)}else this.m_map.clear()},e}();t.SimpleSyncMap=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPrefixDeleteMessage=void 0,t.isPrefixDeleteMessage=function(e){return"delete"===e.operation&&"prefix"===e.value}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleServicePerformanceTelemetry=t.SimpleServiceTelemetry=void 0;var i=n(1),s=function(){function e(e,t,n){this.backendService="SimpleService",this.clientId=e,this.sessionId=t,this.wsReconnectCount=0,this.wsState=i.ConnectionState[i.ConnectionState.Disconnected],this.maxRoundtripRaw=n||0,this.roundtripTelemetry=new r,this.messageHandleTelemetry=new r,this.offlineCacheTelemetry={cachedCount:0,resentCount:0,expiredCount:0,rejectedCount:0},this.maxRoundtripRaw>0&&(this.roundtripRaw=[]),this.messagePendingAckCount=0,this.unacknowledgedMessagesCount=0,this.messageRequested={},this.messageReceived={},this.messageAcknowledged={}}return e.prototype.addRoundtripLatency=function(e){this.roundtripRaw&&this.roundtripRaw.length<this.maxRoundtripRaw&&this.roundtripRaw.push(e),this.roundtripTelemetry.addLatency(e)},e.prototype.addMessageHandleLatency=function(e){this.messageHandleTelemetry.addLatency(e)},e.prototype.incrementAcknowledgedCount=function(e){this.incrementMessageCount(this.messageAcknowledged,e)},e.prototype.incrementRequestedCount=function(e){this.incrementMessageCount(this.messageRequested,e)},e.prototype.incrementReceivedCount=function(e){this.incrementMessageCount(this.messageReceived,e)},e.prototype.incrementMessageCount=function(e,t){var n=e[t],i=void 0===n?1:n+1;e[t]=i},e}();t.SimpleServiceTelemetry=s;var r=function(){function e(){this.count=0,this.minValue=0,this.maxValue=0,this.avgValue=0}return e.prototype.addLatency=function(e){this.count+=1,this.avgValue=this.avgValue+(e-this.avgValue)/this.count,this.minValue=this.count>1?Math.min(e,this.minValue):e,this.maxValue=Math.max(this.maxValue,e)},e}();t.SimpleServicePerformanceTelemetry=r},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.StateServiceWebSocketConnection=void 0;var r=function(){function e(e,t){var n=this;this.onopen=null,this.onclose=null,this.onerror=null,this.onmessage=null,this.onlog=null,this.ws=new WebSocket(e),this.settings=t,this.ws.onopen=function(e){return i(n,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.onopen&&this.onopen(e),[4,this.sendSetupMessages()];case 1:return t.sent(),[2]}}))}))},this.ws.onclose=function(e){n.onclose&&n.onclose(e)},this.ws.onerror=function(e){n.onerror&&n.onerror(e)},this.ws.onmessage=function(e){n.onmessage&&n.onmessage(e)}}return e.CreateAsync=function(t,n){return i(this,void 0,void 0,(function(){return s(this,(function(i){return[2,new e(t,n)]}))}))},Object.defineProperty(e.prototype,"name",{get:function(){return"WebSocket"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this.ws.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this.ws.readyState===WebSocket.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldSendPings",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.close=function(){this.ws.close()},e.prototype.send=function(e){this.ws.send(e)},e.prototype.sendSetupMessages=function(){return i(this,void 0,void 0,(function(){var e,t,n,i,r,o,a=this;return s(this,(function(s){switch(s.label){case 0:return(t=this.settings.getAuthTokenAsync)?[4,this.settings.getAuthTokenAsync()]:[3,2];case 1:t=s.sent(),s.label=2;case 2:return e=t,n=this.settings,i=n.metadata,r=n.subscriptions,o={authToken:e,metadata:i,subscriptions:r},this.settings.createSetupMessage(o).forEach((function(e){return a.send(e)})),[2]}}))}))},e}();t.StateServiceWebSocketConnection=r}])}));
//# sourceMappingURL=PPTLiveBroadcast.js.map