"use strict";function asyncGeneratorStep(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _async_to_generator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){asyncGeneratorStep(a,r,o,i,s,"next",e)}function s(e){asyncGeneratorStep(a,r,o,i,s,"throw",e)}i(void 0)}))}}(globalThis.webpackChunk_1js_powerpoint_online_wp5=globalThis.webpackChunk_1js_powerpoint_online_wp5||[]).push([[7811],{22477:function(e,t,n){n.r(t),n.d(t,{OptionsButtonManagerFactory:function(){return p}});var r=n(30916),o=n(94638),a=n(98901),i=n(8189),s=n(52271),c=n(95716),l=n(108),u=n(9583);class d{enumerateDevicesAndBuildMenuControlsAsync(){var e=this;return _async_to_generator((function*(){try{if(!navigator.mediaDevices)return i.Hv.sendTraceTag(508916296,s.n.msoulscat_Wac_PptSlideshow,c.k.Warning,"CameraSelectionFlyout::enumerateDevicesAndBuildMenuControlsAsync - insecure context"),[];""===e.m_defaultCameraLabel&&""===e.m_selectedCameraId&&(e.m_defaultCameraLabel=yield e.getDefaultCameraLabelAsync());const t=(yield navigator.mediaDevices.enumerateDevices()).filter((e=>"videoinput"===e.kind)),n=t.map((e=>e.deviceId)),r=t.map((e=>e.label)),o=(0,a.sR)(),l=[];for(const t of r){const a=n[r.indexOf(t)];if(""===a)continue;const i=""===e.m_selectedCameraId?t===e.m_defaultCameraLabel:a===e.m_selectedCameraId;l.push({type:"AppToggleButtonProps",id:`${a}`,label:`${t}`,toggleUsingIcon:!0,icon:"checkmark_16",toggled:i,flipIconInRtl:!0,onExecute:()=>{e.selectCamera(a)},styles:o})}return l}catch(e){return i.Hv.sendTraceTag(508916295,s.n.msoulscat_Wac_PptSlideshow,c.k.Error,`CameraSelectionFlyout::enumerateDevicesAndBuildMenuControlsAsync - failed with error=${e}`),[]}}))()}selectCamera(e){this.m_selectedCameraId=e,this.settings.onCameraSelectionMenuActivity&&this.settings.onCameraSelectionMenuActivity({id:e})}getDefaultCameraLabelAsync(){var e=this;return _async_to_generator((function*(){try{const e=yield navigator.mediaDevices.getUserMedia({video:!0});if(!e)return i.Hv.sendTraceTag(508887050,s.n.msoulscat_Wac_PptSlideshow,c.k.Error,"CameraSelectionFlyout::getDefaultCameraLabelAsync - Failed to grab default video device MediaStream."),"";const t=e.getVideoTracks();if(!t||t.length<=0)return i.Hv.sendTraceTag(508887049,s.n.msoulscat_Wac_PptSlideshow,c.k.Error,"CameraSelectionFlyout::getDefaultCameraLabelAsync - Default video device MediaStream has no video tracks."),"";for(const e of t)e.stop();return t[0].label}catch(t){i.Hv.sendTraceTag(508887048,s.n.msoulscat_Wac_PptSlideshow,c.k.Error,`CameraSelectionFlyout::getDefaultCameraLabelAsync - Failed to grab default device info with error=${t}`);const n=t.toString();return e.settings.onCameraSelectionMenuActivity&&n&&(-1!==n.indexOf("NotAllowedError")||-1!==n.indexOf("SecurityError")||-1!==n.indexOf("TypeError"))&&e.settings.onCameraSelectionMenuActivity({id:"NoCameraPermission"}),""}}))()}getControlsInMenuAsync(){var e=this;return _async_to_generator((function*(){const t=yield e.enumerateDevicesAndBuildMenuControlsAsync();return[{type:"AppFlyoutAnchorProps",id:e.settings.id,label:e.settings.label,directionalHint:o.A.rightTopEdge,styles:u.t.isSlideShowToolbarEaseOfUse()?(0,l.qY)():(0,a.g3)(),menuClassNames:(0,a.KY)(),menuDefinition:{sections:[{controls:t}]},disabled:0===t.length}]}))()}selectNextCameraDevice(){var e=this;return _async_to_generator((function*(){const t=yield e.enumerateDevicesAndBuildMenuControlsAsync();if(t&&t.length>0){const n=t.findIndex((e=>e.toggled)),r=t[(n+1)%t.length];e.selectCamera(r.id)}}))()}constructor(e){var t;this.m_selectedCameraId="",this.settings=e,this.m_defaultCameraLabel=null!==(t=e.defaultCameraLabel)&&void 0!==t?t:""}}var m=n(98073),f=n(14264),g=n(7806);class y{getControlsInMenuAsync(e,t,n,o,i,s,c,d){var m=this;return _async_to_generator((function*(){const y=yield m.m_cameraSelectionFlyout.getControlsInMenuAsync(),p=e?{type:"AppFlyoutAnchorProps",icon:"LiveOff_20",id:"PPTLive",label:g.q.livePresentation,styles:(0,l.qY)(),menuClassNames:(0,a.KY)(),menuDefinition:t}:{type:"AppButtonProps",icon:"LiveOff_20",id:"PPTLive",label:g.q.livePresentation,secondaryText:"Ctrl+L",keyShortcuts:"Ctrl+L",onExecute:()=>{m.settings.onPPTLiveButtonActivity&&m.settings.onPPTLiveButtonActivity()},styles:(0,l.qY)()},h=[];return u.t.isSlideShowToolbarEaseOfUse()&&(h.push({type:"AppLabelProps",id:"optionsHeading",forId:"OptionsButton",label:"Presentation menu",styles:a.c8}),c||!i||e||h.push(p),n&&s&&h.push({type:"AppButtonProps",icon:"SlideMicrophone_20",id:"Coach",label:g.q.rehearsePresentation,secondaryText:"Alt+O",keyShortcuts:"Alt+O",onExecute:()=>{m.settings.onCoachButtonActivity&&m.settings.onCoachButtonActivity()},styles:(0,l.qY)()})),o&&h.push(...y),(0,f.isChangeGateEnabled)("SSToolBarFullScreenButtonShown")&&!c&&h.push({type:"AppButtonProps",icon:"EnterFullScreen_20",id:"PPTFullScreen",label:g.q.fullScreen,secondaryText:m.getFullScreenShortcut(),keyShortcuts:m.getFullScreenShortcut(),onExecute:()=>{m.settings.onFullscreenButtonActivity&&m.settings.onFullscreenButtonActivity()},styles:(0,l.qY)(),disabled:d}),(0,r.C)(h)}))()}selectNextCameraDevice(){this.m_cameraSelectionFlyout&&this.m_cameraSelectionFlyout.selectNextCameraDevice().catch((e=>{i.Hv.sendTraceTag(508895372,s.n.msoulscat_Wac_PptSlideshow,c.k.Error,`OptionsButtonManager::cycleCameraSelectionSource - failed with error=${e}`)}))}getFullScreenShortcut(){return-1!==window.navigator.userAgent.indexOf("Macintosh")?"âŒ˜+Shift+F":"Ctrl+Shift+F"}constructor(e){this.settings=e,this.m_cameraSelectionFlyout=new d({type:"AppFlyoutAnchorProps",id:"CameraSelectionFlyout",label:PowerpointSlideshowToolbarStringsManager.get(PowerpointSlideshowToolbarStringsEnum.Camera),controlInMenuRendererFunction:(0,m.wX)(),onCameraSelectionMenuActivity:this.settings.onCameraMenuActivity,defaultCameraLabel:this.settings.defaultCameraLabel})}}class p{static createOptionsButtonManager(e){return new y(e)}}},44923:function(e,t,n){n.d(t,{G7:function(){return l},J9:function(){return c},Kf:function(){return g},SH:function(){return m},ZI:function(){return f},Zb:function(){return s},Zp:function(){return d},gI:function(){return u}});var r=n(38757);let o,a,i;function s(e){o=e;try{a=JSON.parse(d("DisabledChangeGates","{}"))}catch(e){a={}}}function c(e){i=e}function l(e,t=!1){return(i?i(e):!!o&&!!o[e]&&"true"===o[e].toLowerCase())||(0,r.iP)(e,t)}function u(e,t){return(0,r.Z8)(e,t)}function d(e,t){return o&&o[e]?o[e]:t}function m(e){const t=d(e,"[]");return JSON.parse(t)}function f(e,t){const n=d(e,"");return!(a&&t in a||n.split(",").some((e=>e===t)))}function g(e,t,n){const r=d(e,"");return!(a&&t in a||r.split(n).some((e=>e.trim()===t)))}},38757:function(e,t,n){let r;n.d(t,{Z8:function(){return a},be:function(){return s},iP:function(){return i},jE:function(){return o}});const o=e=>{r=e},a=(e,t)=>r?r.getIntFeatureGate(e,t):t,i=(e,t=!1)=>r?r.getBooleanFeatureGate(e,t):t,s=(e,t)=>r?r.getStringFeatureGate(e,t):t}}]);
//# sourceMappingURL=optionsButton.min.js.map