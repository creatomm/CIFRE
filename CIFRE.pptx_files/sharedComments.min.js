function _define_property(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_define_property(e,t,n[t])}))}return e}(globalThis.webpackChunk_1js_powerpoint_online_wp5=globalThis.webpackChunk_1js_powerpoint_online_wp5||[]).push([[3378],{33195:function(e,t,n){"use strict";var r,o,i,a;n.d(t,{eT:function(){return a},IY:function(){return c},OX:function(){return r},jL:function(){return i},E$:function(){return y},Q8:function(){return T},Gs:function(){return v}}),function(e){e[e.HostDefaultOrder=0]="HostDefaultOrder",e[e.NewestFirst=1]="NewestFirst"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.UnableToReconcile=1]="UnableToReconcile",e[e.DivergentChange=2]="DivergentChange"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.RuntimeTeardown=1]="RuntimeTeardown",e[e.RangeObsolete=2]="RangeObsolete"}(i||(i={})),function(e){e[e.All=0]="All",e[e.ResolvedOnly=1]="ResolvedOnly",e[e.ActiveOnly=2]="ActiveOnly"}(a||(a={}));var s=n(77042),d=n(82639),c=function(){function e(e){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new s.mU("Method not implemented.",s.m2.reserveTag(537743701))},this.getExistingFilteredRange=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537743702))},this.updateFilterForFilteredRangeId=function(e,t){throw new s.mU("Method not implemented.",s.m2.reserveTag(537743703))},this.setActiveFilteredRange=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537743704))},this.getActiveFilteredRangeId=function(){throw new s.mU("Method not implemented.",s.m2.reserveTag(537743705))},this.onFilteredRangeUpdated=new d.ZO((function(){})),this.onUserFilterManagerEvent=new d.ZO((function(){})),this.onActiveFilterUpdated=new d.ZO((function(){}))}return e.prototype.getFilteredRange=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537743697))},e.prototype.teardownFilteredRange=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537743698))},e.prototype.getOrder=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537743699))},e.prototype.getFilterUsers=function(){throw new s.mU("Method not implemented.",s.m2.reserveTag(537743706))},e}(),u=n(13502),l=n(79248),m=n(65203),f=n(90853),p=function(){function e(e,t,n,r,o,i){this.id=e,this.filter=t,this.order=n,this.hostAPI=r,this.supportsUpdates=o,this.onTeardown=i,this.active=!0,this.onRangeUpdated=new d.ZO((function(){}))}return e.prototype.getFilter=function(){return this.filter},e.prototype.getOrder=function(){return this.order},e.prototype.isActive=function(){return this.active},e.prototype.teardown=function(){this.active=!1,this.hostAPI.teardownFilteredRange(this.id),this.onTeardown()},e.prototype.canBeUpdated=function(){return this.supportsUpdates},e.prototype.updateFilter=function(e){return!!this.supportsUpdates&&(this.filter=e,this.hostAPI.updateFilterForFilteredRangeId(this.id,(0,f.__assign)({},e)),!0)},e.prototype.onChangeEventReceived=function(e){if(this.active){for(var t=0,n=e.changes;t<n.length;t++){var r=n[t];if(this.active)switch(r.type){case"FilterUpdate":this.filter=r.updatedFilter;break;case"Insert":this.order=(0,f.__spreadArray)((0,f.__spreadArray)((0,f.__spreadArray)([],this.order.slice(0,r.index),!0),[r.content],!1),this.order.slice(r.index),!0);break;case"Remove":this.order=(0,f.__spreadArray)((0,f.__spreadArray)([],this.order.slice(0,r.index),!0),this.order.slice(r.index+1),!0);break;case"Reload":this.order=r.fullContent,(0,m.i7)().assertConditionTag(r.reason===o.DivergentChange,"Received a full reload for an error reason.",537743690);break;case"Teardown":this.active=!1}}this.onRangeUpdated.trigger(e)}},e}(),g=function(e){var t=this;this.hostApi=e,this.getFilterUsers=function(){return void 0!==t.cachedUsers?Promise.resolve(t.cachedUsers):t.hostApi.getFilterUsers().then((function(e){return t.cachedUsers=e,e}))},this.onUserFilterManagerEventReceived=function(e){if(t.cachedUsers){var n=e.payload.type;switch(n){case"UserAdded":t.cachedUsers=(0,f.__spreadArray)((0,f.__spreadArray)([],t.cachedUsers,!0),[e.payload.user],!1);break;case"UserRemoved":t.cachedUsers=t.cachedUsers.filter((function(t){return t.Provider!==e.payload.user.Provider||t.UserId!==e.payload.user.UserId}));break;default:(0,s.HB)(n)}}},this.onUserFilterManagerEvent=this.hostApi.onUserFilterManagerEvent,this.hostApi.onUserFilterManagerEvent.subscribe(this.onUserFilterManagerEventReceived)},C=function(e){var t=this;this.contentFilteredRangeHostAPI=e,this.filteredRanges=new Map,this.createFilteredRange=function(e){return t.contentFilteredRangeHostAPI.getFilteredRange({contentTypes:e.contentTypes,hostFilter:e.filters,supportsFilterUpdates:e.supportsFilterUpdates}).then((function(e){var n=e.filterId,r=new p(n,e.filter,e.content,t.contentFilteredRangeHostAPI,e.supportsFilterUpdates,(function(){return t.onFilterTearDown(n)}));return t.filteredRanges.set(n,r),r}))},this.getFilteredRange=function(e){return t.filteredRanges.has(e)?Promise.resolve(t.filteredRanges.get(e)):t.contentFilteredRangeHostAPI.getExistingFilteredRange(e).then((function(n){if(n){var r=new p(n.filterId,n.filter,n.content,t.contentFilteredRangeHostAPI,n.supportsFilterUpdates,(function(){return t.onFilterTearDown(e)}));return t.filteredRanges.has(e)||t.filteredRanges.set(e,r),r}}))},this.setActiveFilteredRange=function(e){t.contentFilteredRangeHostAPI.setActiveFilteredRange(e)},this.getActiveFilteredRangeId=function(){return t.contentFilteredRangeHostAPI.getActiveFilteredRangeId()},this.onEventReceived=function(e){var n=t.filteredRanges.get(e.filterId);n&&n.onChangeEventReceived(e.payload)},this.onFilterTearDown=function(e){t.filteredRanges.delete(e)},this.getCapabilities=function(){return t.contentFilteredRangeHostAPI.getCapabilities()},this.getHostSpecificLabels=function(){return t.contentFilteredRangeHostAPI.getHostSpecificLabels()},this.getUserFilterManager=function(){return t.userFilterManager},this.onActiveFilterUpdated=this.contentFilteredRangeHostAPI.onActiveFilterUpdated,this.contentFilteredRangeHostAPI.onFilteredRangeUpdated.subscribe(this.onEventReceived),this.userFilterManager=new g(e)},h=new Map;function v(e,t){(0,m.i7)().assertConditionTag(e===u.T,"Received unexpected API Context for Web. This is not fully supported for all APIs.",538035220);var n=h.get(e);n||(n=new l.m("ContentFilteredRange"),h.set(e,n)),n.injectInstance(new C(t))}function y(e){var t=h.get(e);if(!t)throw new s.mU("ContentFilteredRangeAPI not initialized for current apiContenxt ".concat(e,"."),s.m2.reserveTag(538035221));return t.getInstanceOrThrow()}function T(e){var t;return void 0!==(null===(t=h.get(e))||void 0===t?void 0:t.getInstance())}!function(){function e(){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new s.mU("Method not implemented.",s.m2.reserveTag(537421141))},this.getExistingFilteredRange=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537421142))},this.updateFilterForFilteredRangeId=function(e,t){throw new s.mU("Method not implemented.",s.m2.reserveTag(537421143))},this.setActiveFilteredRange=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537421144))},this.getActiveFilteredRangeId=function(){throw new s.mU("Method not implemented.",s.m2.reserveTag(537421145))},this.onFilteredRangeUpdated=new d.ZO((function(){})),this.onUserFilterManagerEvent=new d.ZO((function(){})),this.onActiveFilterUpdated=new d.ZO((function(){}))}e.prototype.getFilteredRange=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537421138))},e.prototype.teardownFilteredRange=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537421139))},e.prototype.getOrder=function(e){throw new s.mU("Method not implemented.",s.m2.reserveTag(537421140))},e.prototype.getFilterUsers=function(){throw new s.mU("Method not implemented.",s.m2.reserveTag(537421146))}}()},10717:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(90853);function o(e){var t=e;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t&&t.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e),!1)),t=void 0}}},72429:function(e,t,n){"use strict";n.d(t,{D:function(){return i}});var r=n(90853),o=n(57265);function i(e){var t=(0,r.__read)(e,1)[0];return(0,o.B)(t)}},55777:function(e,t,n){"use strict";n.d(t,{A7:function(){return c},EV:function(){return d},Mh:function(){return u},LO:function(){return s}});var r=n(79248),o=n(77042),i=function(){function e(e){if(!e)throw new o.mU("Missing required arguments in FeatureGateAPIImpl!",o.m2.reserveTag(589103760));this.appSettings=e.appSettings,this.gateMapping=e.mapping}return e.prototype.isTrue=function(e){return!!this.appSettings[e]&&"true"===this.appSettings[e]},e.prototype.isFeatureEnabled=function(e){if(!this.appSettings||!this.gateMapping)throw new o.mU("FeatureGate API not initialized!",o.m2.reserveTag(589103761));var t=this.gateMapping[e].webSettingName;return!!t&&this.isTrue(t)},e.prototype.isChangeGateEnabled=function(e,t){if(!this.appSettings||!this.gateMapping)throw new o.mU("FeatureGate API not initialized!",o.m2.reserveTag(589103762));var n=this.disabledChangeGates;return!n||n.split(",").indexOf(e)<0},Object.defineProperty(e.prototype,"disabledChangeGates",{get:function(){return this.appSettings.DisabledChangeGates},enumerable:!1,configurable:!0}),e}(),a=new r.m("FeatureGate",i);function s(e){return e}function d(e){return a.getAndInitialize(e)}function c(){return a.getInstanceOrThrow()}function u(){return void 0!==a.getInstance()}},20903:function(e,t,n){"use strict";var r,o,i;function a(e){return!!e&&void 0!==e.Id&&void 0!==e.Name&&void 0!==e.UserPrincipalName&&void 0!==e.EmailAddresses&&void 0!==e.SuggestionType&&void 0!==e.SuggestionSubtype&&void 0!==e.HostAppSuggestion&&void 0!==e.Source&&void 0!==e.SuggestionOrigin}function s(e){return!!e&&void 0!==e.UserId&&void 0!==e.Provider}n.d(t,{gx:function(){return i},ak:function(){return o},Ab:function(){return r},b2:function(){return s},pZ:function(){return a}}),function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(r||(r={})),function(e){e[e.None=0]="None",e[e.GetContactsForMentions=2]="GetContactsForMentions",e[e.GetAuthToken=4]="GetAuthToken",e[e.GetSuggestionsDetails=8]="GetSuggestionsDetails"}(o||(o={})),function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(i||(i={}))},60377:function(e,t,n){"use strict";n.d(t,{vJ:function(){return s},Zj:function(){return d}});var r,o=n(76149);n(90853);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){return e.apply(void 0,t)}),t)}function a(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r)throw new Error("Recursive calls of hooks is not supported!");r=e;var o=i.apply(void 0,t);return r=void 0,o}}a(o.useMemo);var s=a(o.useEffect),d=(a(o.useLayoutEffect),o.useCallback,function(e,t,n){return e()&&n?n(t):null})},79248:function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var r=n(90853),o=n(77042),i=function(){function e(e,t){var n=this;this.apiName=e,this.DefaultCtor=t,this.reset=function(){n.instance=void 0,n.ctorStack=void 0,n.injectionStack=void 0}}return e.prototype.getAndInitialize=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.instance)throw new o.mU("'".concat(this.apiName,"' singleton is already initialized"),o.m2.reserveTag(538035215));if(!this.DefaultCtor)throw new o.mU("'".concat(this.apiName,"' not initialized but no default constructor exists"),o.m2.reserveTag(538035216));return this.ctorStack=(0,o.Zm)(),this.instance=new((e=this.DefaultCtor).bind.apply(e,(0,r.__spreadArray)([void 0],t,!1)))},e.prototype.getInstanceOrThrow=function(){var e=this.instance;if(!e)throw new o.mU("'".concat(this.apiName,"' singleton has not been initialized"),o.m2.reserveTag(538035217));return e},e.prototype.getInstance=function(){return this.instance},e.prototype.injectImplementation=function(e){if(this.getInstance())throw new o.mU("API has already been initialized.\nFirst initialization: ".concat(this.ctorStack),o.m2.reserveTag(538035218));this.DefaultCtor=e},e.prototype.injectInstance=function(e){if(this.getInstance())throw new o.mU("API has already been initialized or injected.\nInitialize or Inject Callstack: ".concat(this.getInjectOrInitializeStack()),o.m2.reserveTag(538035219));this.injectionStack=(0,o.Zm)(),this.instance=e},e.prototype.getInjectOrInitializeStack=function(){var e,t;return null!==(t=null!==(e=this.ctorStack)&&void 0!==e?e:this.injectionStack)&&void 0!==t?t:"Callstack Not Retrieved"},e}()},39582:function(e,t,n){"use strict";var r,o,i;n.d(t,{$U:function(){return r},kd:function(){return o},u2:function(){return i}}),function(e){e.shade30="#004578",e.shade20="#005a9e",e.shade10="#106ebe",e.primary="#0078d4",e.tint10="#2b88d8",e.tint20="#c7e0f4",e.tint30="#deecf9",e.tint40="#eff6fc"}(r||(r={})),function(e){e.black="#000000",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(o||(o={})),function(e){e.pinkRed10="#750b1c",e.red20="#a4262c",e.red10="#d13438",e.redOrange20="#603d30",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan40="#005e50",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta40="#373277",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(i||(i={}))},50597:function(e,t,n){"use strict";n.d(t,{QF:function(){return i},gL:function(){return a},pn:function(){return d}});var r,o=n(65203);function i(e){r=e}function a(e,t){r?r.announceToScreenReader(e,t):(0,o.i7)().assertConditionTag(!1,"announceToScreenReader not registered",595632534)}var s=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(e){e&&i(e)},e}(),d=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new s),this.screenReaderNotifierManagerInstance},e}()},58605:function(e,t,n){"use strict";n.d(t,{aY:function(){return o},gL:function(){return r.gL},QF:function(){return r.QF}});var r=n(50597),o=new r.pn},57859:function(e,t,n){"use strict";var r,o,i;n.d(t,{SM:function(){return r},wI:function(){return s},G6:function(){return o},w:function(){return i},Nz:function(){return g},_1:function(){return f},cz:function(){return p},AA:function(){return m}}),function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"}(r||(r={})),function(e){e[e.Keyboarding=1]="Keyboarding",e[e.HostAction=2]="HostAction"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(i||(i={}));var a=n(77042),s=function(){function e(e){this.apiContext=e}return e.prototype.selectNextOrPreviousContent=function(e){throw new a.mU("Method not implemented.",a.m2.reserveTag(523633811))},e.prototype.moveFocus=function(e){throw new a.mU("Method not implemented.",a.m2.reserveTag(523633812))},e.prototype.bringContentIntoView=function(e){throw new a.mU("Method not implemented.",a.m2.reserveTag(523633813))},e.prototype.isAPIEnabled=function(){return!1},e}(),d=n(13502),c=n(79248),u=n(65203),l=new Map;function m(e,t){(0,u.i7)().assertConditionTag(t===d.T,"Received unexpected API Context for Web. This is not fully supported for all APIs.",507773649);var n=l.get(t);n||(n=new c.m("ContentNavigation"),l.set(t,n)),n.injectInstance(e)}function f(e){var t=l.get(e);if(!t)throw new a.mU("ContentNavigationAPI not initialized for current apiContext ".concat(e,"."),a.m2.reserveTag(507773648));return t.getInstanceOrThrow()}function p(e){var t;return void 0!==(null===(t=l.get(e))||void 0===t?void 0:t.getInstance())}function g(e){var t;null===(t=l.get(e))||void 0===t||t.reset()}!function(){function e(){}e.prototype.selectNextOrPreviousContent=function(e){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){}}()},1828:function(e,t,n){"use strict";n.d(t,{xe:function(){return l},jl:function(){return u}});var r,o,i=n(86392);!function(e){e[e.Enabled=0]="Enabled",e[e.Execute=1]="Execute",e[e.Query=2]="Query"}(o||(o={}));var a,s=((r={})[0]=i.DeltaFormattingType.Weight,r[1]=i.DeltaFormattingType.Highlight,r[2]=i.DeltaFormattingType.Hyperlink,r[3]=i.DeltaFormattingType.Italic,r[4]=i.DeltaFormattingType.Strikethrough,r[5]=i.DeltaFormattingType.Underline,r[6]=i.DeltaFormattingType.Color,r[7]=i.DeltaFormattingType.Image,r[8]=i.DeltaFormattingType.Paragraph,r[9]=i.DeltaFormattingType.Paragraph,r),d=n(65203),c=function(){function e(){var e=this;this.selectionChangedHandlers=[],this.keypressHandlers=[],this.onHyperlinkClick=function(t){return!!e.hyperlinkNavigator&&e.hyperlinkNavigator(t)},this.onSelectionChangeHandler=function(){e.invokeHandlers(e.selectionChangedHandlers)},this.onKeypressHandler=function(t){e.invokeHandlers(e.keypressHandlers,t)}}return e.prototype.executeCommand=function(e,t,n){var r,o,a,s,d;if(!this.richContentEditorActor)return 1;if(0===t)return this.isRootCommandEnabled(e)?2:0;if(this.isRootCommandEnabled(e)){if(2===t&&n){var c=this.richContentEditorActor.getFormattingAtCurrentSelection();switch(e){case 0:n.bold=c.bold;break;case 3:n.italic=c.italic;break;case 5:n.underline=c.underline;break;case 4:n.strikethrough=c.strikethrough;break;case 1:n.highlight=c.highlight;break;case 6:n.fontColor=c.fontColor;break;case 8:case 9:n.list=c.list}return 2}var u=void 0,l=void 0;switch(e){case 0:u={type:i.DeltaFormattingType.Weight};break;case 3:u={type:i.DeltaFormattingType.Italic};break;case 5:u={type:i.DeltaFormattingType.Underline};break;case 4:u={type:i.DeltaFormattingType.Strikethrough};break;case 2:if(null===(r=null==n?void 0:n.hyperlinkData)||void 0===r?void 0:r.link){var m=null===(o=null==n?void 0:n.hyperlinkData)||void 0===o?void 0:o.link,f=null!==(s=null===(a=null==n?void 0:n.hyperlinkData)||void 0===a?void 0:a.text)&&void 0!==s?s:m;l={type:i.DeltaFormattingType.Hyperlink,data:{text:f,link:m}}}break;case 7:(null===(d=null==n?void 0:n.imageData)||void 0===d?void 0:d.base64)&&(l={type:i.DeltaFormattingType.Image,data:{src:n.imageData.base64}});break;case 1:(null==n?void 0:n.highlight)&&(u={type:i.DeltaFormattingType.Highlight,data:{color:n.highlight.color}});break;case 6:(null==n?void 0:n.fontColor)&&(u={type:i.DeltaFormattingType.Color,data:{fontColor:n.fontColor.color}});break;case 8:case 9:(null==n?void 0:n.list)&&(u={type:i.DeltaFormattingType.Paragraph,data:{listType:n.list.listType}})}return u&&this.richContentEditorActor.applyFormattingToCurrentSelection(u),l&&this.richContentEditorActor.addContent(l),2}return 0},e.prototype.getSelection=function(){return this.richContentEditorActor?{text:this.richContentEditorActor.getSelection().text}:{text:""}},e.prototype.initRichContentEditor=function(e){(0,d.i7)().assertConditionTag(!this.richContentEditorActor,"[initRichContentEditor] RichContentEditor already set",590141192),this.richContentEditorActor=e,this.richContentEditorActor.registerSelectionChangeHandler(this.onSelectionChangeHandler),this.richContentEditorActor.registerKeypressHandler(this.onKeypressHandler)},e.prototype.registerSelectionChangeHandler=function(e){e&&this.selectionChangedHandlers.push(e)},e.prototype.registerKeypressHandler=function(e){e&&this.keypressHandlers.push(e)},e.prototype.registerSafelinksNavigator=function(e){e&&(this.hyperlinkNavigator=e)},e.prototype.setFocus=function(){this.richContentEditorActor&&this.richContentEditorActor.setFocus()},e.prototype.isRootCommandEnabled=function(e){return!!this.richContentEditorActor&&this.richContentEditorActor.isFormatEnabled(s[e])},e.prototype.invokeHandlers=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e)for(var r=0;r<e.length;r++)e[r].apply(e,t)},e}();function u(){return void 0===a&&(a=new c),a}var l=new(function(){function e(){}return e.prototype.getRichContentEditAPI=function(){return u()},e}())},63243:function(e,t,n){"use strict";var r;n.d(t,{N:function(){return r}}),function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"}(r||(r={}))},15311:function(e,t,n){"use strict";var r;n.d(t,{z:function(){return r}}),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},57518:function(e,t,n){"use strict";var r;n.d(t,{Ay:function(){return o},Ey:function(){return r}}),function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"}(r||(r={}));const o=r},54724:function(e,t,n){"use strict";var r;n.d(t,{O:function(){return r}}),function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested",e[e.SmartReplyPopulated=15]="SmartReplyPopulated"}(r||(r={}))},64307:function(e,t,n){"use strict";var r;n.d(t,{P:function(){return r}}),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew",e[e.DeleteRestricted=64]="DeleteRestricted",e[e.ReactionRestricted=128]="ReactionRestricted"}(r||(r={}))},15964:function(e,t,n){"use strict";n.d(t,{Jg:function(){return r},N_:function(){return o},XM:function(){return i},q3:function(){return a}});var r="CREATE",o="EDIT",i="REPLY",a="METADATA"},29698:function(e,t,n){"use strict";var r;n.d(t,{U:function(){return r}}),function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"}(r||(r={}))},91953:function(e,t,n){"use strict";var r;n.d(t,{J:function(){return r}}),function(e){e[e.Dialog=1]="Dialog",e[e.ForceDiscard=2]="ForceDiscard",e[e.TryAutoDiscard=3]="TryAutoDiscard"}(r||(r={}))},15918:function(e,t,n){"use strict";var r;n.d(t,{y:function(){return r}}),function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled",e[e.Failed=3]="Failed"}(r||(r={}))},38017:function(e,t,n){"use strict";var r;n.d(t,{d:function(){return r}}),function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"}(r||(r={}))},86240:function(e,t,n){"use strict";var r;n.d(t,{o:function(){return r}}),function(e){e[e.Like=1]="Like"}(r||(r={}))},58486:function(e,t,n){"use strict";var r;n.d(t,{u:function(){return r}}),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},5402:function(e,t,n){"use strict";n.d(t,{Ng:function(){return o.N},z5:function(){return i.z},Jg:function(){return c.Jg},Ey:function(){return a.Ey},Oj:function(){return s.O},PJ:function(){return d.P},Ue:function(){return u.U},y0:function(){return l.y},q3:function(){return c.q3},XM:function(){return c.XM},o:function(){return m.o}});var r,o=n(63243),i=n(15311),a=n(57518);!function(e){e[e.FailedToCommit=1]="FailedToCommit"}(r||(r={}));var s=n(54724),d=n(64307),c=n(15964),u=n(29698),l=n(15918),m=(n(38017),n(86240))},76198:function(e,t,n){"use strict";n.d(t,{C:function(){return s},L:function(){return a}});var r=n(65030),o=n(94828),i=n(5402),a=function(){function e(e,t,n){this.threadIds=e,this.commentData=t,this.pointer=0,this.pointer=Math.max(-1,Math.min(n,e.length))}return e.prototype.next=function(){var e=this.pointer,t=this.threadIds.length-1;if(this.pointer<t)do{++this.pointer}while(this.pointer<=t&&(0,r.ap)((0,o.YO)(this.commentData,this.threadIds[this.pointer])));return this.pointer<t||this.pointer===t&&e<t?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(0,r.ap)((0,o.YO)(this.commentData,this.threadIds[this.pointer])));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.currentIndex=function(){return this.pointer},e}(),s=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startThreadIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var e=this.pointer;if(this.pointer<this.model.length-1)do{++this.pointer}while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&i.PJ.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&i.PJ.Resolved));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},73588:function(e,t,n){"use strict";n.d(t,{UO:function(){return l},ce:function(){return c},og:function(){return u},pS:function(){return d},pi:function(){return a},vd:function(){return s}});var r=n(14503),o=n(57518),i=n(15964);function a(e){return e.sessionType===i.Jg}function s(e){return e.sessionType===i.XM&&void 0!==e.threadId}function d(e){return e.sessionType===i.N_&&void 0!==e.commentId}var c={CREATE:0,REPLY:1,EDIT:2,METADATA:3},u={CREATE:o.Ey.Insert,REPLY:o.Ey.Insert,EDIT:o.Ey.Modify,METADATA:o.Ey.Modify};function l(e){return a(e)?r.m.InitCreateCommentSession:s(e)?r.m.InitReplyCommentSession:d(e)?r.m.InitEditCommentSession:r.m.Unknown}},59575:function(e,t,n){"use strict";n.d(t,{C$:function(){return s},Gp:function(){return i},KD:function(){return r},fO:function(){return a}});var r,o=n(63243);function i(e){return e===o.N.CheckEnabled}function a(e){return e===o.N.CheckToggled}function s(e){return e===o.N.Execute}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"}(r||(r={}))},93172:function(e,t,n){"use strict";function r(e){return void 0!==e.numberOfComments&&void 0!==e.numberOfThreads}function o(e){return void 0!==e.comments||void 0!==e.threads}function i(e){return void 0!==e.threads&&void 0===e.comments}var a;function s(e){return void 0!==e.comments||void 0!==e.commentIds}function d(e){return void 0!==e.commentIds}function c(e){return void 0!==e.changes}function u(e){return void 0!==e.commentId}function l(e){return void 0!==e.commentId}function m(e){return void 0!==e.contextDetails}function f(e){return void 0!==e.modelCapabilityFlags}function p(e){return void 0!==e.errorType}function g(e){return void 0!==e.draftId}function C(e){return void 0!==e.draftId}function h(e){return void 0!==e.commentId&&void 0!==e.smartReplies}n.d(t,{$G:function(){return u},B5:function(){return o},F0:function(){return d},Fz:function(){return r},Rt:function(){return g},TI:function(){return l},Uz:function(){return h},Yy:function(){return p},ej:function(){return a},iR:function(){return s},k4:function(){return i},ne:function(){return C},tA:function(){return c},yt:function(){return f},yx:function(){return m}}),function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"}(a||(a={}))},99381:function(e,t,n){"use strict";function r(e){return""===e.parentId?e:void 0}function o(e){return e.parentId||e.commentId}n.d(t,{a:function(){return o},j:function(){return r}})},32601:function(e,t,n){"use strict";n.d(t,{kW:function(){return a},qH:function(){return o},w1:function(){return i}});var r=n(15964);function o(e){return e.sessionType===r.Jg}function i(e){return e.sessionType===r.XM&&void 0!==e.threadId}function a(e){return e.sessionType===r.N_&&void 0!==e.commentId}},18733:function(e,t,n){"use strict";n.d(t,{Bf:function(){return o},YK:function(){return r},Zv:function(){return a}});var r,o,i,a=function(){function e(){}return e.none="none",e.disc="disc",e.decimalParenthesis="decimal-parenthesis",e.decimalPeriod="decimal-period",e.lowerAlphaParenthesis="lower-alpha-parenthesis",e.lowerAlphaPeriod="lower-alpha-period",e.upperAlphaParenthesis="upper-alpha-parenthesis",e.upperAlphaPeriod="upper-alpha-period",e.lowerRomanParenthesis="lower-roman-parenthesis",e.lowerRomanPeriod="lower-roman-period",e.upperRomanParenthesis="upper-roman-parenthesis",e.upperRomanPeriod="upper-roman-period",e}();!function(e){e[e.None=0]="None",e[e.Bullet=1]="Bullet",e[e.NumberArabic=2]="NumberArabic",e[e.AlphabetLowerCase=3]="AlphabetLowerCase",e[e.AlphabetUpperCase=4]="AlphabetUpperCase",e[e.NumberRomanLowerCase=5]="NumberRomanLowerCase",e[e.NumberRomanUpperCase=6]="NumberRomanUpperCase"}(r||(r={})),function(e){e[e.Parenthesis=0]="Parenthesis",e[e.Period=1]="Period",e[e.Plain=2]="Plain",e[e.Minus=3]="Minus"}(o||(o={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Justify=3]="Justify"}(i||(i={}))},81199:function(e,t,n){"use strict";var r;n.d(t,{w:function(){return r}}),function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"}(r||(r={}))},33917:function(e,t,n){"use strict";n.d(t,{a9:function(){return o.a},Fz:function(){return r.Fz},qH:function(){return i.qH},ne:function(){return r.ne}}),n(59575);var r=n(93172),o=n(99381),i=n(32601);n(18733),n(81199)},71318:function(e,t,n){"use strict";n.d(t,{Ey:function(){return o.Ey},Jg:function(){return o.Jg},Ng:function(){return o.Ng},PJ:function(){return o.PJ},Ue:function(){return o.Ue},XM:function(){return o.XM},a9:function(){return r.a9},o:function(){return o.o},qH:function(){return r.qH},y0:function(){return o.y0},z5:function(){return o.z5}});var r=n(33917),o=n(5402)},78143:function(e,t,n){"use strict";n.d(t,{v:function(){return c}});var r,o=n(90853),i=n(77042),a=n(69084),s=n(94344),d=function(){function e(){}return e.prototype.getItem=function(e){return(0,s.cg)()?sessionStorage.getItem(e):null},e.prototype.setItem=function(e,t){(0,s.cg)()&&sessionStorage.setItem(e,t)},e.prototype.removeItem=function(e){(0,s.cg)()&&e&&sessionStorage.removeItem(e)},e.prototype.storeEditorContentFromDraftSave=function(e,t){if((0,s.cg)()){var n=e.draftContent.editorContent,r=e.draftContent.editorCursorPosition;Promise.all([n,r]).then((function(n){var r=(0,o.__read)(n,2),i={draftContent:{content:r[0],cursorPosition:r[1]},draftingParams:t};sessionStorage.setItem(e.draftId,JSON.stringify(i))})).catch((0,a.L)(i.m2.reserveTag(523362974)))}},e}();function c(){return r||(r=new d)}},33055:function(e,t,n){"use strict";n.d(t,{Kp:function(){return u},gM:function(){return l}});var r=n(77042),o=n(65203),i=n(75789),a=n(88652),s="en-us",d=function(){function e(e){this.localizationDetails=e}return e.prototype.isMac=function(){return window&&window.navigator&&window.navigator.userAgent.indexOf("Macintosh")>0},e.prototype.getLocaleInfo=function(){return{isRightToLeft:this.localizationDetails.isRightToLeft||!1,uiCulture:this.localizationDetails.uiCulture||s,dataCulture:this.localizationDetails.dataCulture||s}},e.prototype.getString=function(e){var t=this.getStringOrUndefined(e);if(void 0===t)throw new i.cP(a.w3,r.m2.reserveTag(589103688),-2130957554);return t},e.prototype.getStringOrUndefined=function(e){switch(e){case 1:return CommentPaneStrings.EditButtonText;case 2:return CommentPaneStrings.DeleteButtonText;case 120:return CommentPaneStrings.ContextMenuEditButtonText;case 121:return CommentPaneStrings.ContextMenuDeleteButtonText;case 3:return CommentPaneStrings.ResolveThreadButtonText;case 4:return CommentPaneStrings.ReopenThreadButtonText;case 5:return CommentPaneStrings.DeleteThreadButtonText;case 6:return CommentPaneStrings.GoToFirstCommentGhostCardText;case 7:return CommentPaneStrings.GoToNextCommentGhostCardText;case 8:return CommentPaneStrings.ReturnToFirstCommentGhostCardText;case 9:return CommentPaneStrings.View1MoreReplyExpandButtonText;case 10:return CommentPaneStrings.ViewNMoreRepliesExpandButtonText;case 106:return CommentPaneStrings.OneMoreReplyExpandButtonText;case 107:return CommentPaneStrings.NMoreRepliesExpandButtonText;case 11:return CommentPaneStrings.ReplyBoxPlaceholderText;case 12:return CommentPaneStrings.ReplyBoxPlaceholderTextNoMentions;case 13:return CommentPaneStrings.EmptyPaneMessage;case 14:return CommentPaneStrings.SaveButtonText;case 15:return CommentPaneStrings.CancelButtonText;case 16:return CommentPaneStrings.NewThreadPlaceholderText;case 17:return CommentPaneStrings.NewThreadPlaceholderTextNoMentions;case 21:return CommentPaneStrings.NormalPostA11yLabel;case 145:return CommentPaneStrings.NewNormalPostA11yLabel;case 122:return CommentPaneStrings.NormalPostBodyA11yLabel;case 22:return CommentPaneStrings.ResolvedPostA11yLabel;case 136:return CommentPaneStrings.NewResolvedPostA11yLabel;case 23:return CommentPaneStrings.EditingPostA11yLabel;case 25:return CommentPaneStrings.ReadOnlyPostA11yLabel;case 137:return CommentPaneStrings.NewReadOnlyPostA11yLabel;case 26:return CommentPaneStrings.LowFidelityWarningPostA11yLabel;case 27:return CommentPaneStrings.NormalCardA11yLabel;case 29:return CommentPaneStrings.ResolvedCardA11yLabel;case 30:return CommentPaneStrings.ReadOnlyCardA11yLabel;case 28:return CommentPaneStrings.DraftCardA11yLabel;case 31:return CommentPaneStrings.PaneA11yLabel;case 32:return CommentPaneStrings.ListA11yLabel;case 18:return CommentPaneStrings.PaneHeaderLabel;case 19:return CommentPaneStrings.CloseButtonTitle;case 20:return CommentPaneStrings.ClosePaneA11yLabel;case 35:return CommentPaneStrings.LowFidelityWarningOnEdit;case 36:return CommentPaneStrings.LowFidelityWarningOnDelete;case 37:return CommentPaneStrings.ProceedButtonText;case 39:return CommentPaneStrings.PostCancelEditA11yLabel;case 40:return CommentPaneStrings.PostEditA11yLabel;case 41:return CommentPaneStrings.PostDeleteA11yLabel;case 42:return CommentPaneStrings.PostProceedEditA11yLabel;case 43:return CommentPaneStrings.PostCancelDeleteA11yLabel;case 45:return CommentPaneStrings.CardContextMenuA11yLabel;case 123:return CommentPaneStrings.PostContextMenuA11yLabel;case 46:return CommentPaneStrings.CardCancelDraftA11yLabel;case 47:return CommentPaneStrings.PostCancelDraftA11yLabel;case 48:return CommentPaneStrings.SendButtonText;case 55:return this.isMac()?CommentPaneStrings.ReplyBoxA11yDescription_Mac:CommentPaneStrings.ReplyBoxA11yDescription;case 56:return CommentPaneStrings.EditorBoxA11yDescription;case 57:return CommentPaneStrings.PeoplePickerSearching;case 58:return CommentPaneStrings.PeoplePickerTypeToSearch;case 59:return CommentPaneStrings.PeoplePickerSearchDirectory;case 60:return CommentPaneStrings.PeoplePickerTopNResults;case 61:return CommentPaneStrings.PeoplePickerNoResultsFound;case 62:return CommentPaneStrings.PeoplePickerSuggestedContactsHeader;case 73:return CommentPaneStrings.PeoplePickerLoading;case 63:return CommentPaneStrings.DeleteCommentThreadA11yUpdate;case 64:return CommentPaneStrings.CancelledReplyA11yUpdate;case 103:return CommentPaneStrings.CancelledCommentDraftA11yUpdate;case 65:return CommentPaneStrings.DeletedCommentPostA11yUpdate;case 66:return CommentPaneStrings.CancelledEditingA11yUpdate;case 67:return CommentPaneStrings.CommentPostedA11yUpdate;case 124:return CommentPaneStrings.ResolveCommentThreadA11yUpdate;case 125:return CommentPaneStrings.ReopenCommentThreadA11yUpdate;case 68:return CommentPaneStrings.DiscardDialogTitle;case 69:return CommentPaneStrings.DiscardDialogBody;case 70:return CommentPaneStrings.DiscardDialogAbandon;case 71:return CommentPaneStrings.DiscardDialogResume;case 88:return CommentPaneStrings.EditCommentEditorA11yLabel;case 89:return CommentPaneStrings.ReplyCommentEditorA11yLabel;case 91:return CommentPaneStrings.NewCommentButtonText;case 92:return CommentPaneStrings.NewCommentButtonA11yLabel;case 108:return CommentPaneStrings.ReplyBoxDisabledPlaceholderText;case 230:return CommentPaneStrings.FocusMovedToUnpostedDraftA11yUpdate;case 110:return this.isMac()?CommentPaneStrings.PostDraftWarningText_Mac:CommentPaneStrings.PostDraftWarningText;case 111:return CommentPaneStrings.TaskHeaderAssignedToText;case 112:return CommentPaneStrings.TaskFooterAssignText;case 113:return CommentPaneStrings.TaskFooterReassignText;case 114:return CommentPaneStrings.TaskItemAssignedToText;case 115:return CommentPaneStrings.TaskItemReassignedToText;case 116:return CommentPaneStrings.TaskItemCompletedText;case 117:return CommentPaneStrings.TaskItemReopenedText;case 118:return CommentPaneStrings.TaskItemScheduleText;case 119:return CommentPaneStrings.TaskItemUnknownText;case 184:return CommentPaneStrings.RetryButtonText;case 183:return CommentPaneStrings.ContentErrorMessage;case 126:return CommentPaneStrings.ResolveTaskButtonText;case 127:return CommentPaneStrings.TaskHeaderAssignedToYouText;case 128:return CommentPaneStrings.TaskAssignerPeoplePickerA11yLabel;case 129:return CommentPaneStrings.TaskHeaderCheckboxA11yLabel;case 130:return CommentPaneStrings.TaskHeaderResolvedCheckboxA11yLabel;case 131:return CommentPaneStrings.TaskHeaderAssignedToYouCheckboxA11yLabel;case 132:return CommentPaneStrings.TaskHeaderAssignedToYouResolvedCheckboxA11yLabel;case 133:return CommentPaneStrings.TaskHeaderUnassigned;case 134:return CommentPaneStrings.FailedToCommitMentionText;case 234:return CommentPaneStrings.FailedToCommitMentionShareCanceledText;case 135:return CommentPaneStrings.CommitErrorMessage;case 165:return CommentPaneStrings.NormalCardTaskToYouA11yLabel;case 166:return CommentPaneStrings.ReadOnlyCardTaskToYouA11yLabel;case 167:return CommentPaneStrings.ResolvedCardResolvedTaskToYouA11yLabel;case 168:return CommentPaneStrings.CardResolvedTaskToYouA11yLabel;case 160:return CommentPaneStrings.NormalCardTaskA11yLabel;case 161:return CommentPaneStrings.ReadOnlyCardTaskA11yLabel;case 163:return CommentPaneStrings.ResolvedCardResolvedTaskA11yLabel;case 164:return CommentPaneStrings.CardResolvedTaskA11yLabel;case 169:return CommentPaneStrings.NormalCardTaskUnassignedA11yLabel;case 170:return CommentPaneStrings.ReadOnlyCardTaskUnassignedA11yLabel;case 171:return CommentPaneStrings.ResolvedCardResolvedTaskUnassignedA11yLabel;case 172:return CommentPaneStrings.CardResolvedTaskUnassignedA11yLabel;case 173:return this.isMac()?CommentPaneStrings.PostCommentTooltip_Mac:CommentPaneStrings.PostCommentTooltip;case 174:return this.isMac()?CommentPaneStrings.SendButtonTooltip_Mac:CommentPaneStrings.SendButtonTooltip;case 175:return CommentPaneStrings.CancelButtonTooltip;case 176:return CommentPaneStrings.ReopenTaskTooltip;case 177:return CommentPaneStrings.NewCommentButtonTooltip;case 178:return CommentPaneStrings.CommitButtonAssignTooltip;case 179:return CommentPaneStrings.ReplyButtonReassignTooltip;case 180:return CommentPaneStrings.TaskAssignedToYouTooltip;case 181:return CommentPaneStrings.TaskUnassignedTooltip;case 182:return CommentPaneStrings.TaskAssignerChevronTooltip;case 203:return CommentPaneStrings.SmartReplyPickerHeader;case 204:return CommentPaneStrings.TaskUnassignedHistoryString;case 202:return CommentPaneStrings.TaskHeaderResolved;case 197:return CommentPaneStrings.ResolvedCommentCardLabel;case 206:return CommentPaneStrings.DeleteTaskButtonText;case 207:return CommentPaneStrings.LinkToCommentButtonText;case 227:return CommentPaneStrings.PeoplePickerSuggestionSelectedA11yUpdate;case 229:return CommentPaneStrings.TruncationUIReadMoreText;case 231:return CommentPaneStrings.CommentLikeA11yLabel;case 232:return CommentPaneStrings.TaskHistoryItemA11yLabelDesktop;case 223:return CommentPaneStrings.DraftCardA11yLabelDesktop;case 225:return CommentPaneStrings.LoadingCardA11yLabelDesktop;case 216:return CommentPaneStrings.CardA11yLabelDesktopUnassignedTask;case 217:return CommentPaneStrings.CardA11yLabelDesktopUnassignedCompletedTask;case 219:return CommentPaneStrings.CardA11yLabelDesktopOneReplyModifier;case 221:return CommentPaneStrings.CardA11yLabelDesktopLoadingModifier;case 222:return CommentPaneStrings.CardA11yLabelDesktopDraftModifier;case 226:return CommentPaneStrings.A11yLabelSubstringDelimiterDesktop;case 224:return CommentPaneStrings.DraftCardA11yLabelDesktopHintText;case 209:return CommentPaneStrings.NewPostA11yLabelDesktop;case 208:return CommentPaneStrings.PostA11yLabelDesktop;case 210:return CommentPaneStrings.PendingPostA11yLabelDesktop;case 214:return CommentPaneStrings.CardA11yLabelDesktopAssignedTask;case 215:return CommentPaneStrings.CardA11yLabelDesktopAssignedCompletedTask;case 211:return CommentPaneStrings.CardA11yLabelDesktopBaseThread;case 212:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadWithTask;case 213:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadResolved;case 218:return CommentPaneStrings.CardA11yLabelDesktopAnchorHintModifier;case 220:return CommentPaneStrings.CardA11yLabelDesktopMultipleRepliesModifier;case 239:return CommentPaneStrings.CommentLikePluralA11yLabel;case 240:return CommentPaneStrings.CommentLikeDescriptionA11yLabel;case 233:return this.isMac()?CommentPaneStrings.CtrlEnterHint_Mac:CommentPaneStrings.CtrlEnterHint;case 241:return CommentPaneStrings.AtMentionsInfoCommentNotificationUber;case 242:return CommentPaneStrings.AtMentionsInfoCommentMentionsTwoPeopleModifier;case 243:return CommentPaneStrings.AtMentionsInfoCommentMentionsThreePeopleModifier;case 244:return CommentPaneStrings.AtMentionsInfoCommentMentionsMoreThanThreePeopleModifier;case 245:return CommentPaneStrings.FilterShowAllResolutions;case 246:return CommentPaneStrings.FilterShowResolvedOnly;case 247:return CommentPaneStrings.FilterShowActiveOnly;case 248:return CommentPaneStrings.FilterNewestFirst;case 249:return CommentPaneStrings.FilterAtMentionsToMe;case 250:return CommentPaneStrings.TaskHeaderAssignedToYouAndOthersText;case 251:return CommentPaneStrings.TaskHeaderAssignedToMultipleText;case 252:return CommentPaneStrings.TaskItemUnassignedFromText;case 256:return CommentPaneStrings.FilterItemCount;case 257:return CommentPaneStrings.FilterItemCountPlural;case 258:return CommentPaneStrings.FilterOldestFirst;case 260:return CommentPaneStrings.FilterSortBy;case 261:return CommentPaneStrings.FilterFilterBy;case 259:return CommentPaneStrings.FilterCollaborators;case 262:return CommentPaneStrings.FilterResetAll;case 254:return CommentPaneStrings.FilterButtonAccessibilityLabel;case 255:return CommentPaneStrings.FilterMenuAccessibilityLabel;case 265:return CommentPaneStrings.NewCardA11yLabelDesktopBaseThread;case 266:return CommentPaneStrings.NewCardA11yLabelDesktopBaseThreadWithTask;case 267:return CommentPaneStrings.FilterButtonWithFilterCountLabel;case 268:return CommentPaneStrings.FilterCollabMenuItemAllSelectedLabel;case 269:return CommentPaneStrings.FilterCollabMenuItemCountSelectedLabel;case 270:return CommentPaneStrings.FilterCollabMenuClearFilter;default:return}},e.prototype.getStringWithStandardPlaceholders=function(e){return this.getString(e)},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(e){return this.getStringOrUndefined(e)},e.prototype.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.toFormattedString(this.getString(e),t)},e.prototype.toFormattedString=function(e,t){for(var n="",r=0;;){var i=e.indexOf("{",r),a=e.indexOf("}",r);if(i<0&&a<0){n+=e.slice(r);break}if(a>0&&(a<i||i<0))n+=e.slice(r,a+1),r=a+2;else if(n+=e.slice(r,i),r=i+1,"{"!==e.charAt(r)){if(a<0)break;var s=e.substring(r,a),d=s.indexOf(":"),c=t[parseInt(d<0?s:s.substring(0,d),10)];null==c&&((0,o.i7)().assertConditionTag(!1,"Incorrect substitution provided to string",562937946),c=""),n+=c,r=a+1}else n+="{",r++}return n},e}(),c=void 0;function u(){if(!c)throw new i.cP(a.Hf,r.m2.reserveTag(589103748),-2130957552);return c}function l(e){return(0,o.i7)().assertConditionTag(void 0===c,"LocalizationAPI has already been initialized",589103749),void 0===c&&(c=new d(e)),c}},50577:function(e,t,n){"use strict";n.d(t,{I6:function(){return h},Kc:function(){return T},QU:function(){return u},RF:function(){return I},TO:function(){return p},UO:function(){return v},VS:function(){return y},ZO:function(){return c},cc:function(){return A},k4:function(){return m},u9:function(){return l},ut:function(){return f},vZ:function(){return g},vn:function(){return S},vu:function(){return C}});var r=n(77042),o=n(20903),i=n(65203),a=n(55925),s=n(75789),d=n(94344);function c(e,t){return!(!e||!t)&&e.UserId===t.UserId&&e.Provider===t.Provider}function u(e){return e?(0,o.pZ)(e)?e.Name:e.DisplayName:""}function l(e){if(!e)return"";if(!(0,o.pZ)(e))return(0,i.i7)().assertConditionTag(!d.u_()||"android"===(0,a.u)(),"LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return(0,i.i7)().assertConditionTag("win32"===(0,a.u)(),"UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new s.cP("UserPrincipalName and EmailAddresses, both not available",r.m2.reserveTag(589103706),-2130957499)}function m(e){if(!e)return"";if((0,o.b2)(e)){var t=e.Email||e.UserId;return(0,i.i7)().assertConditionTag(!!t,"Email and UserId are both not available on IUser object",529024399),t}return l(e)}function f(e){return e.UserId?e.UserId:p(e)}function p(e){return void 0!==e.DisplayName?e.DisplayName:((0,i.i7)().assertConditionTag(!1,"user.DisplayName is undefined",595133131),e.Email?e.Email:"")}function g(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function C(e){return 0===Object.keys(e).length&&(0,i.i7)().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function h(e,t){if(e.size!==t.size)return!0;var n=!1;return e.forEach((function(e){t.has(e)||(n=!0)})),n}function v(e,t){t.forEach((function(t){t.UserId&&e[t.UserId]?delete e[t.UserId]:t.Email&&e[t.Email]&&delete e[t.Email]}))}function y(e,t){return t.forEach((function(t){e[m(t)]={assignee:t}})),e}function T(e,t){Object.keys(t).forEach((function(n){e[n]={assignee:t[n].mentionee}}))}function I(e,t){var n=m(t);e[n]?delete e[n]:e[n]={assignee:t}}function S(e){var t={};for(var n in e)e[n].stillInDraft&&(t[n]=e[n]);return t}function A(e){return e.some((function(e){return e.IsCurrentUser}))}},56704:function(e,t,n){"use strict";n.d(t,{Eo:function(){return s},uR:function(){return d}});var r,o=n(77042),i=n(65203),a=n(75789);function s(e){if(r)throw(0,i.i7)().assertConditionTag(!1,"WebAppColors cannot be re-initialized.",578647955),new a.cP("WebAppColors cannot be re-initialized.",o.m2.reserveTag(577610271),-2130957508);r=e}function d(){if(!r)throw(0,i.i7)().assertConditionTag(!1,"WebAppColors is not initialized",578647956),new a.cP("WebAppColors is not initialized",o.m2.reserveTag(577610272),-2130957509);return r}},99553:function(e,t,n){"use strict";n.d(t,{JD:function(){return b},Bd:function(){return k},di:function(){return w},PY:function(){return F},GS:function(){return R}});var r=n(94423),o=n(65203),i=n(39582),a=n(13163),s=n(68926),d=n(88767),c=n(74835),u=n(79802);const l=c.TQ.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background1`]:d.mY,[`colorPalette${n}Background2`]:d.mY,[`colorPalette${n}Background3`]:d.Fn,[`colorPalette${n}Foreground1`]:d.Fn,[`colorPalette${n}Foreground2`]:d.Fn,[`colorPalette${n}Foreground3`]:d.Fn,[`colorPalette${n}BorderActive`]:d.Si,[`colorPalette${n}Border1`]:d.Fn,[`colorPalette${n}Border2`]:d.Fn};return Object.assign(e,r)}),{});l.colorPaletteRedForegroundInverted=d.Fn,l.colorPaletteGreenForegroundInverted=d.Fn,l.colorPaletteYellowForegroundInverted=d.Fn;const m=_object_spread({},l,c.dt.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background2`]:d.mY,[`colorPalette${n}Foreground2`]:d.Fn,[`colorPalette${n}BorderActive`]:d.Si};return Object.assign(e,r)}),{})),f=Object.entries(u.s).reduce(((e,[t,n])=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${r}Background1`]:d.mY,[`colorStatus${r}Background2`]:d.mY,[`colorStatus${r}Background3`]:d.Fn,[`colorStatus${r}Foreground1`]:d.Fn,[`colorStatus${r}Foreground2`]:d.Fn,[`colorStatus${r}Foreground3`]:d.Fn,[`colorStatus${r}BorderActive`]:d.Si,[`colorStatus${r}ForegroundInverted`]:d.Fn,[`colorStatus${r}Border1`]:d.Fn,[`colorStatus${r}Border2`]:d.Fn};return Object.assign(e,o)}),{});f.colorStatusDangerBackground3Hover=d.Si,f.colorStatusDangerBackground3Pressed=d.Si;var p=n(40095),g=n(2505),C=n(55974),h=n(53760),v=n(23438),y=n(49715),T=n(45741);const I=(()=>{const e={colorNeutralForeground1:d.Fn,colorNeutralForeground1Hover:d.fo,colorNeutralForeground1Pressed:d.fo,colorNeutralForeground1Selected:d.fo,colorNeutralForeground2:d.Fn,colorNeutralForeground2Hover:d.fo,colorNeutralForeground2Pressed:d.fo,colorNeutralForeground2Selected:d.fo,colorNeutralForeground2BrandHover:d.fo,colorNeutralForeground2BrandPressed:d.fo,colorNeutralForeground2BrandSelected:d.fo,colorNeutralForeground3:d.Fn,colorNeutralForeground3Hover:d.fo,colorNeutralForeground3Pressed:d.fo,colorNeutralForeground3Selected:d.fo,colorNeutralForeground3BrandHover:d.fo,colorNeutralForeground3BrandPressed:d.fo,colorNeutralForeground3BrandSelected:d.fo,colorNeutralForeground4:d.Fn,colorNeutralForegroundDisabled:d.m4,colorNeutralForegroundInvertedDisabled:d.m4,colorBrandForegroundLink:d.aJ,colorBrandForegroundLinkHover:d.aJ,colorBrandForegroundLinkPressed:d.aJ,colorBrandForegroundLinkSelected:d.aJ,colorNeutralForeground2Link:d.aJ,colorNeutralForeground2LinkHover:d.aJ,colorNeutralForeground2LinkPressed:d.aJ,colorNeutralForeground2LinkSelected:d.aJ,colorCompoundBrandForeground1:d.Si,colorCompoundBrandForeground1Hover:d.Si,colorCompoundBrandForeground1Pressed:d.Si,colorBrandForeground1:d.Fn,colorBrandForeground2:d.Fn,colorBrandForeground2Hover:d.Fn,colorBrandForeground2Pressed:d.Fn,colorNeutralForeground1Static:d.mY,colorNeutralForegroundStaticInverted:d.Fn,colorNeutralForegroundInverted:d.fo,colorNeutralForegroundInvertedHover:d.fo,colorNeutralForegroundInvertedPressed:d.fo,colorNeutralForegroundInvertedSelected:d.fo,colorNeutralForegroundInverted2:d.Fn,colorNeutralForegroundOnBrand:d.p1,colorNeutralForegroundInvertedLink:d.aJ,colorNeutralForegroundInvertedLinkHover:d.aJ,colorNeutralForegroundInvertedLinkPressed:d.aJ,colorNeutralForegroundInvertedLinkSelected:d.aJ,colorBrandForegroundInverted:d.Fn,colorBrandForegroundInvertedHover:d.fo,colorBrandForegroundInvertedPressed:d.fo,colorBrandForegroundOnLight:d.p1,colorBrandForegroundOnLightHover:d.fo,colorBrandForegroundOnLightPressed:d.fo,colorBrandForegroundOnLightSelected:d.fo,colorNeutralBackground1:d.mY,colorNeutralBackground1Hover:d.Si,colorNeutralBackground1Pressed:d.Si,colorNeutralBackground1Selected:d.Si,colorNeutralBackground2:d.mY,colorNeutralBackground2Hover:d.Si,colorNeutralBackground2Pressed:d.Si,colorNeutralBackground2Selected:d.Si,colorNeutralBackground3:d.mY,colorNeutralBackground3Hover:d.Si,colorNeutralBackground3Pressed:d.Si,colorNeutralBackground3Selected:d.Si,colorNeutralBackground4:d.mY,colorNeutralBackground4Hover:d.Si,colorNeutralBackground4Pressed:d.Si,colorNeutralBackground4Selected:d.Si,colorNeutralBackground5:d.mY,colorNeutralBackground5Hover:d.Si,colorNeutralBackground5Pressed:d.Si,colorNeutralBackground5Selected:d.Si,colorNeutralBackground6:d.mY,colorNeutralBackgroundInverted:d.mY,colorNeutralBackgroundStatic:d.mY,colorNeutralBackgroundAlpha:d.mY,colorNeutralBackgroundAlpha2:d.mY,colorSubtleBackground:"transparent",colorSubtleBackgroundHover:d.Si,colorSubtleBackgroundPressed:d.Si,colorSubtleBackgroundSelected:d.Si,colorSubtleBackgroundLightAlphaHover:d.Si,colorSubtleBackgroundLightAlphaPressed:d.Si,colorSubtleBackgroundLightAlphaSelected:d.Si,colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:d.Si,colorSubtleBackgroundInvertedPressed:d.Si,colorSubtleBackgroundInvertedSelected:d.Si,colorTransparentBackground:"transparent",colorTransparentBackgroundHover:d.Si,colorTransparentBackgroundPressed:d.Si,colorTransparentBackgroundSelected:d.Si,colorNeutralBackgroundDisabled:d.mY,colorNeutralBackgroundInvertedDisabled:d.mY,colorNeutralStencil1:d.Fn,colorNeutralStencil2:d.Fn,colorNeutralStencil1Alpha:d.Fn,colorNeutralStencil2Alpha:d.Fn,colorBackgroundOverlay:d.Q1[50],colorScrollbarOverlay:d.p6,colorBrandBackground:d.p6,colorBrandBackgroundHover:d.Si,colorBrandBackgroundPressed:d.Si,colorBrandBackgroundSelected:d.Si,colorCompoundBrandBackground:d.Si,colorCompoundBrandBackgroundHover:d.Si,colorCompoundBrandBackgroundPressed:d.Si,colorBrandBackgroundStatic:d.mY,colorBrandBackground2:d.mY,colorBrandBackground2Hover:d.mY,colorBrandBackground2Pressed:d.mY,colorBrandBackground3Static:d.mY,colorBrandBackground4Static:d.mY,colorBrandBackgroundInverted:d.p6,colorBrandBackgroundInvertedHover:d.Si,colorBrandBackgroundInvertedPressed:d.Si,colorBrandBackgroundInvertedSelected:d.Si,colorNeutralCardBackground:d.mY,colorNeutralCardBackgroundHover:d.Si,colorNeutralCardBackgroundPressed:d.Si,colorNeutralCardBackgroundSelected:d.Si,colorNeutralCardBackgroundDisabled:d.mY,colorNeutralStrokeAccessible:d.Fn,colorNeutralStrokeAccessibleHover:d.Si,colorNeutralStrokeAccessiblePressed:d.Si,colorNeutralStrokeAccessibleSelected:d.Si,colorNeutralStroke1:d.Fn,colorNeutralStroke1Hover:d.Si,colorNeutralStroke1Pressed:d.Si,colorNeutralStroke1Selected:d.Si,colorNeutralStroke2:d.Fn,colorNeutralStroke3:d.Fn,colorNeutralStrokeSubtle:d.Fn,colorNeutralStrokeOnBrand:d.mY,colorNeutralStrokeOnBrand2:d.Fn,colorNeutralStrokeOnBrand2Hover:d.Fn,colorNeutralStrokeOnBrand2Pressed:d.Fn,colorNeutralStrokeOnBrand2Selected:d.Fn,colorBrandStroke1:d.Fn,colorBrandStroke2:d.Fn,colorBrandStroke2Hover:d.Si,colorBrandStroke2Pressed:d.Si,colorBrandStroke2Contrast:d.mY,colorCompoundBrandStroke:d.Si,colorCompoundBrandStrokeHover:d.Si,colorCompoundBrandStrokePressed:d.Si,colorNeutralStrokeDisabled:d.m4,colorNeutralStrokeInvertedDisabled:d.m4,colorTransparentStroke:d.Fn,colorTransparentStrokeInteractive:d.Si,colorTransparentStrokeDisabled:d.m4,colorNeutralStrokeAlpha:d.Fn,colorNeutralStrokeAlpha2:d.mY,colorStrokeFocus1:d.mY,colorStrokeFocus2:d.Si,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"};return _object_spread({},p.V,g.GR,g.lm,g.aI,g.NM,C.k,T.b,T.F,v.S,y.L,e,m,f,(0,h.t)(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),(0,h.t)(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand"))})();var S,A=n(57766),_=n(3414),D=n(61197),E=n(9368),P=function(){function e(){}return e.prototype.getThemeMode=function(){return 0},e.prototype.registerOnThemeChanged=function(e){},e.prototype.convertColorForTheme=function(e,t){return e},e}(),x=function(e){return{AtMentionHighlight:i.kd.gray20,AtMentionMessageBackground:"#F0F0F0",AtMentionMessageText:i.kd.gray160,AtMentionText:i.kd.gray180,AtMentionToMeHighlight:e.palette.themeLighter,AtMentionToMeText:e.palette.themeDarkAlt,BlueDot:"#006bFF",CancelDraftButtonIcon:_.x.GRAY_E,CancelDraftButtonIconFocused:_.x.GRAY_J,CancelDraftButtonIconHovered:_.x.GRAY_J,CancelDraftButtonIconPressed:_.x.GRAY_J,CardBackground:e.palette.white,CardBorder:_.x.COMMENTS_GRAY,CardBorderEmphasis:_.x.COMMENTS_PURPLE,CardTopperContainerBorder:_.x.GRAY_B,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:E.im.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundCheckedHovered:E.im.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundHovered:"transparent",CheckBoxBackgroundPressed:"transparent",CheckBoxBorder:E.im.TASK_BORDER,CheckBoxBorderCheckedHovered:E.im.TASK_BORDER,CheckBoxBorderDisabled:E.im.TASK_DISABLED,CheckBoxBorderHovered:E.im.TASK_CHECKBOX_COLOR,CheckBoxCheckMark:E.im.TASK_TEXT,CheckBoxCheckMarkChecked:e.palette.white,ClosePaneButtonFocused:_.x.ACTIVE_COMMENT_TEXT,ClosePaneButtonHovered:i.kd.gray40,ClosePaneButtonPressed:i.kd.gray70,ClosePaneButtonIcon:_.x.GRAY_F,ClosePaneButtonIconHovered:_.x.GRAY_J,ClosePaneButtonIconPressed:_.x.GRAY_J,CommentLikeEmptyBorder:"#3A3A38",CommentLikeSolidBorder:"#DE6C00",CommentLikeSolidCenter:"#F8DB8F",CommonControlBorder:i.kd.gray110,CtrlEnterTip:i.kd.gray120,DefaultButton:"transparent",DefaultButtonHovered:void 0,DefaultButtonIcon:i.kd.gray200,DefaultButtonIconDisabled:i.kd.gray100,DefaultButtonPressed:void 0,DefaultFilterButtonBackground:i.kd.gray30,DraftWarning:i.u2.red10,ExpandButtonTextResolved:i.kd.gray130,ExpandButtonTextResolvedHovered:_.x.GRAY_H,ExpandButtonTextResolvedPressed:_.x.GRAY_H,FilterButtonBackground:"transparent",FilterButtonIconAndTextColor:"#313131",FilterMenuSectionHeaderText:i.kd.gray130,Hyperlink:"#0000EE",HyperlinkActive:"#FF0000",MenuIcon:_.x.GRAY_F,MenuIconDisabled:_.x.GRAY_C,MenuIconHoveredPressed:_.x.GRAY_J,MoreRepliesColor:e.palette.themePrimary,NewCommentButton:e.palette.white,NewCommentButtonBorderFocused:e.palette.black,NewCommentButtonDisabled:D.XD.BUTTON_DISABLED,NewCommentButtonHovered:void 0,NewCommentButtonLabel:i.kd.gray180,NewCommentButtonLabelHovered:_.x.GRAY_J,NewCommentButtonIconBorder:"#242424",NewCommentButtonIconBorderDisabled:"#8B8B8B",NewCommentButtonIconFill:"#FAFAFA",NewCommentButtonIconHoveredPressed:_.x.GRAY_J,NewCommentButtonIconPlusSign:"#639D54",NewCommentButtonIconPlusSignDisabled:"#717171",NewCommentButtonPressed:void 0,PaneBackground:i.kd.gray30,PersonaColorResolved:i.kd.gray130,PersonaInitialsTextColor:e.palette.white,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themeDarkAlt,PrimaryButtonHovered:e.palette.themeDarkAlt,PrimaryButtonIcon:e.palette.white,PrimaryButtonPressed:e.palette.themeDark,ResetFilterButtonBackground:i.kd.white,ResetFilterButtonBackgroundDisabled:i.kd.white,ResetFilterButtonText:i.u2.cyanBlue10,ResetFilterButtonTextDisabled:i.kd.gray70,ResolvedCardBackground:i.kd.gray20,ResolvedCardText:i.kd.gray130,ResolvedCardTitle:i.kd.gray160,SmartRepliesText:i.kd.gray140,SubText:_.x.GRAY_E,SuggestedItem:_.x.SUGGESTED_PICKER_ITEM,SuggestedItemHovered:_.x.SUGGESTED_PICKER_ITEM_HOVER,SuggestedItemPressed:_.x.SUGGESTED_PICKER_ITEM_HOVER,TaskAssignerFocus:E.im.TASK_BORDER_FOCUS,TaskAssignerText:e.palette.black,TaskBorder:E.im.TASK_BORDER,TaskPickerButton:E.im.TASK_BORDER,Text:_.x.ACTIVE_COMMENT_TEXT}},b=(S=new P,{setThemeAPI:function(e){S=e},getThemeAPI:function(){return S},resetThemeAPI:function(){S=new P}}),k=(0,a.J9)((function(e){switch(b.getThemeAPI().getThemeMode()){case 1:return function(e){return{AtMentionHighlight:i.kd.gray140,AtMentionMessageBackground:i.kd.gray140,AtMentionMessageText:i.kd.gray40,AtMentionText:i.kd.gray40,AtMentionToMeHighlight:e.palette.themeTertiary,AtMentionToMeText:e.palette.black,BlueDot:"#5099FF",CancelDraftButtonIcon:void 0,CancelDraftButtonIconFocused:void 0,CancelDraftButtonIconHovered:void 0,CancelDraftButtonIconPressed:void 0,CardBackground:i.kd.gray180,CardBorder:i.kd.gray120,CardBorderEmphasis:"#C480CB",CardTopperContainerBorder:i.kd.gray140,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:e.palette.themePrimary,CheckBoxBackgroundCheckedHovered:"#3D7CE8",CheckBoxBackgroundHovered:i.kd.gray190,CheckBoxBackgroundPressed:e.palette.white,CheckBoxBorder:i.kd.gray80,CheckBoxBorderCheckedHovered:"#3D7CE8",CheckBoxBorderDisabled:i.kd.gray130,CheckBoxBorderHovered:i.kd.gray80,CheckBoxCheckMark:i.kd.gray80,CheckBoxCheckMarkChecked:e.palette.black,ClosePaneButtonFocused:e.palette.black,ClosePaneButtonHovered:i.kd.gray160,ClosePaneButtonPressed:i.kd.gray150,ClosePaneButtonIcon:i.kd.gray20,ClosePaneButtonIconHovered:i.kd.gray20,ClosePaneButtonIconPressed:i.kd.gray20,CommentLikeEmptyBorder:"#D4D4D4",CommentLikeSolidBorder:"#F8DB8F",CommentLikeSolidCenter:"#E39123",CommonControlBorder:i.kd.gray120,CtrlEnterTip:i.kd.gray80,DefaultButton:"transparent",DefaultButtonHovered:i.kd.gray160,DefaultButtonIcon:i.kd.gray20,DefaultButtonIconDisabled:i.kd.gray130,DefaultButtonPressed:e.palette.white,DefaultFilterButtonBackground:"transparent",DraftWarning:"#F1BBBD",ExpandButtonTextResolved:i.kd.gray80,ExpandButtonTextResolvedHovered:i.kd.gray50,ExpandButtonTextResolvedPressed:i.kd.gray30,FilterButtonBackground:i.kd.black,FilterButtonIconAndTextColor:i.kd.gray90,FilterMenuSectionHeaderText:i.kd.gray40,Hyperlink:"#7DB0FF",HyperlinkActive:"#FF0000",MenuIcon:e.palette.black,MenuIconDisabled:i.kd.gray130,MenuIconHoveredPressed:e.palette.black,MoreRepliesColor:e.palette.themeDark,NewCommentButton:"transparent",NewCommentButtonBorderFocused:i.kd.gray20,NewCommentButtonDisabled:i.kd.gray130,NewCommentButtonHovered:i.kd.gray180,NewCommentButtonIconBorder:"#D4D4D4",NewCommentButtonIconBorderDisabled:"#8B8B8B",NewCommentButtonIconFill:"transparent",NewCommentButtonIconHoveredPressed:"#3D7CE8",NewCommentButtonIconPlusSign:"#73DD83",NewCommentButtonIconPlusSignDisabled:"#B0B0B0",NewCommentButtonLabel:i.kd.gray20,NewCommentButtonLabelHovered:i.kd.gray20,NewCommentButtonPressed:i.kd.gray160,PaneBackground:i.kd.gray200,PersonaColorResolved:i.kd.gray80,PersonaInitialsTextColor:e.palette.black,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themePrimary,PrimaryButtonHovered:"#3D7CE8",PrimaryButtonIcon:e.palette.black,PrimaryButtonPressed:e.palette.themeDarker,ResetFilterButtonBackground:"transparent",ResetFilterButtonBackgroundDisabled:"transparent",ResetFilterButtonText:i.kd.white,ResetFilterButtonTextDisabled:i.kd.gray130,ResolvedCardBackground:e.palette.white,ResolvedCardText:i.kd.gray80,ResolvedCardTitle:i.kd.gray50,SmartRepliesText:i.kd.gray20,SubText:i.kd.gray80,SuggestedItem:i.kd.gray140,SuggestedItemHovered:i.kd.gray120,SuggestedItemPressed:e.palette.white,TaskAssignerFocus:e.palette.black,TaskAssignerText:i.kd.gray20,TaskBorder:e.palette.black,TaskPickerButton:e.palette.black,Text:i.kd.gray20}}(e);case 99999:return function(e){return{AtMentionHighlight:i.kd.gray140,AtMentionMessageBackground:e.palette.red,AtMentionMessageText:"#1aebff",AtMentionText:"#1aebff",AtMentionToMeHighlight:"#1aebff",AtMentionToMeText:e.palette.black,BlueDot:"#1aebff",CancelDraftButtonIcon:void 0,CancelDraftButtonIconFocused:void 0,CancelDraftButtonIconHovered:void 0,CancelDraftButtonIconPressed:void 0,CardBackground:e.palette.black,CardBorder:"#1aebff",CardBorderEmphasis:"#1aebff",CardTopperContainerBorder:e.palette.white,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:"#1aebff",CheckBoxBackgroundCheckedHovered:"#1aebff",CheckBoxBackgroundHovered:e.palette.black,CheckBoxBackgroundPressed:"#1aebff",CheckBoxBorder:e.palette.white,CheckBoxBorderCheckedHovered:e.palette.white,CheckBoxBorderDisabled:i.kd.gray130,CheckBoxBorderHovered:"#1aebff",CheckBoxCheckMark:"#1aebff",CheckBoxCheckMarkChecked:e.palette.black,ClosePaneButtonFocused:e.palette.black,ClosePaneButtonHovered:i.kd.gray160,ClosePaneButtonPressed:i.kd.gray150,ClosePaneButtonIcon:i.kd.gray20,ClosePaneButtonIconHovered:i.kd.gray20,ClosePaneButtonIconPressed:i.kd.gray20,CommentLikeEmptyBorder:"#FFFFFF",CommentLikeSolidBorder:"#FFFFFF",CommentLikeSolidCenter:"#1aebff",CommonControlBorder:e.palette.white,CtrlEnterTip:e.palette.white,DefaultButton:e.palette.black,DefaultButtonHovered:i.kd.gray50,DefaultButtonIcon:e.palette.white,DefaultButtonIconDisabled:e.palette.white,DefaultButtonPressed:i.kd.gray50,DefaultFilterButtonBackground:"transparent",DraftWarning:"#FFFF00",ExpandButtonTextResolved:i.kd.gray80,ExpandButtonTextResolvedHovered:i.kd.gray50,ExpandButtonTextResolvedPressed:i.kd.gray30,FilterButtonBackground:i.kd.black,FilterButtonIconAndTextColor:i.kd.gray90,FilterMenuSectionHeaderText:i.kd.gray40,Hyperlink:"#1aebff",HyperlinkActive:"#1aebff",MenuIcon:e.palette.white,MenuIconDisabled:i.kd.gray130,MenuIconHoveredPressed:e.palette.black,MoreRepliesColor:e.palette.white,NewCommentButton:"transparent",NewCommentButtonBorderFocused:i.kd.gray20,NewCommentButtonDisabled:i.kd.gray130,NewCommentButtonHovered:i.kd.gray180,NewCommentButtonIconBorder:"#D4D4D4",NewCommentButtonIconBorderDisabled:"#8B8B8B",NewCommentButtonIconFill:"transparent",NewCommentButtonIconHoveredPressed:"#1aebff",NewCommentButtonIconPlusSign:"#73DD83",NewCommentButtonIconPlusSignDisabled:"#B0B0B0",NewCommentButtonLabel:i.kd.gray20,NewCommentButtonLabelHovered:i.kd.gray20,NewCommentButtonPressed:i.kd.gray160,PaneBackground:i.kd.gray200,PersonaColorResolved:i.kd.gray80,PersonaInitialsTextColor:e.palette.white,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.white,PrimaryButtonFocused:e.palette.white,PrimaryButtonHovered:"#1aebff",PrimaryButtonIcon:e.palette.black,PrimaryButtonPressed:"#1aebff",ResetFilterButtonBackground:"transparent",ResetFilterButtonBackgroundDisabled:"transparent",ResetFilterButtonText:i.kd.white,ResetFilterButtonTextDisabled:i.kd.gray130,ResolvedCardBackground:e.palette.black,ResolvedCardText:i.kd.white,ResolvedCardTitle:i.kd.white,SmartRepliesText:e.palette.red,SubText:e.palette.white,SuggestedItem:i.kd.gray140,SuggestedItemHovered:i.kd.gray120,SuggestedItemPressed:e.palette.white,TaskAssignerFocus:"#1aebff",TaskAssignerText:"#1aebff",TaskBorder:e.palette.white,TaskPickerButton:e.palette.white,Text:e.palette.white}}(e);case 0:return x(e);default:return(0,o.i7)().assertConditionTag(!1,"Could not determine theme for semantic colors. Defaulting to light theme.",507565713),x(e)}})),w=(0,a.J9)((function(e){switch(b.getThemeAPI().getThemeMode()){case 1:return function(e){return{BoxShadowLevel1:"0px 1px 4px 0px rgba(0,0,0,0.2)",BoxShadowLevel2:"0px 1px 8px 8px rgba(0,0,0,0.2)",BoxShadowLevel3:"0px 1px 16px 8px rgba(0,0,0,0.2)",BoxShadowLevel4:"0px 1px 32px 8px rgba(0,0,0,0.2)",BoxShadowLevel5:"0px 1px 48px 8px rgba(0,0,0,0.2)",CalloutBoxShadow:"0px 1px 16px 8px rgba(0,0,0,0.2)",CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(255, 255, 255, 0.2)",DefaultButtonFocusedBorder:"1px solid ".concat(e.palette.black),DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #323130",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px black",PostOverlay:"rgba(0,0,0,0.5)"}}(e);case 99999:return{BoxShadowLevel1:"none",BoxShadowLevel2:"none",BoxShadowLevel3:"none",BoxShadowLevel4:"none",BoxShadowLevel5:"none",CalloutBoxShadow:"none",CardBorder:"1px solid",DefaultButtonBoxShadow:"none",DefaultButtonFocusedBorder:"none",DisabledButtonBoxShadow:"none",FocusedButtonBoxShadow:"none",PostOverlay:"rgba(255,255,255,0.5)"};case 0:return{BoxShadowLevel1:"0px 1px 2px 0px rgba(0,0,0,0.1)",BoxShadowLevel2:"0px 1px 4px 0px rgba(0,0,0,0.1)",BoxShadowLevel3:"0px 1px 8px 0px rgba(0,0,0,0.1)",BoxShadowLevel4:"0px 1px 16px 0px rgba(0,0,0,0.1)",BoxShadowLevel5:"0px 1px 24px 0px rgba(0,0,0,0.1)",CalloutBoxShadow:void 0,CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(0,0,0,0.1)",DefaultButtonFocusedBorder:"1px solid",DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #F3F2F1",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px white",PostOverlay:"rgba(255,255,255,0.5)"};default:return(0,o.i7)().assertConditionTag(!1,"Could not determine theme for semantic styles. Defaulting to light theme.",507565712),{BoxShadowLevel1:"0px 1px 2px 0px rgba(0,0,0,0.1)",BoxShadowLevel2:"0px 1px 4px 0px rgba(0,0,0,0.1)",BoxShadowLevel3:"0px 1px 8px 0px rgba(0,0,0,0.1)",BoxShadowLevel4:"0px 1px 16px 0px rgba(0,0,0,0.1)",BoxShadowLevel5:"0px 1px 24px 0px rgba(0,0,0,0.1)",CalloutBoxShadow:void 0,CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(0,0,0,0.1)",DefaultButtonFocusedBorder:"1px solid",DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #F3F2F1",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px white",PostOverlay:"rgba(255,255,255,0.5)"}}})),R=(0,r.CT)((function(){return!!b.getThemeAPI().convertColorForTheme})),F=function(){switch(b.getThemeAPI().getThemeMode()){case 1:return s.C;case 99999:return I;default:return A.o}}},70167:function(e,t,n){"use strict";var r;n.d(t,{b:function(){return r}}),function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"}(r||(r={}))},30564:function(e,t,n){"use strict";var r;n.d(t,{Y:function(){return r}}),function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(r||(r={}))},12595:function(e,t,n){"use strict";var r;function o(e){if(!e)return!1;var t=e;return void 0!==t.displayMode&&"string"==typeof t.displayMode}n.d(t,{g1:function(){return r},qO:function(){return o}}),function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"}(r||(r={}))},38569:function(e,t,n){"use strict";var r;n.d(t,{F:function(){return r}}),function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"}(r||(r={}))},22245:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o},P:function(){return r}}),function(e){e.HalfPane="half-pane",e.FullPane="full-pane"}(r||(r={}));const o=r},56288:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(22245);function o(e){return e.containerType===r.A.HalfPane}},65336:function(e,t,n){"use strict";n.d(t,{bb:function(){return r.b},Pk:function(){return o.P}});var r=n(70167),o=(n(56288),n(12595),n(38569),n(22245))},10827:function(e,t,n){"use strict";n.d(t,{Ng:function(){return r.Ng},PJ:function(){return r.PJ},Ue:function(){return r.Ue},XM:function(){return r.XM},a9:function(){return r.a9},o:function(){return r.o},y0:function(){return r.y0},z5:function(){return r.z5}});var r=n(71318);n(65336)},63108:function(e,t,n){"use strict";n.d(t,{XR:function(){return Z},DI:function(){return $}});var r,o=n(90853),i=n(77042),a=n(69084),s=n(94344),d=n(55309),c=n(95187),u=n(91256),l=n(65203),m=n(15964),f=n(31236),p=n(78062),g=n(81913),C=n(85844),h=n(72429),v=n(20903),y=n(73588),T=n(32601),I=n(5326),S=n(28760),A=n(68083),_=n(79018),D=function(){function e(e,t){void 0===t&&(t=!0),this.rawDelta=e,this.onlyNewMentions=t,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._NumHyperlinks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._users},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasRichTextFormatting",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._hasRichTextFormatting},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var e,t,n=this;this._deserializedDelta=JSON.parse(this.rawDelta),null===(t=null===(e=this._deserializedDelta)||void 0===e?void 0:e.ops)||void 0===t||t.forEach((function(e){var t,r;if(null==e?void 0:e.attributes){e.attributes.link&&(n._NumHyperlinks+=1);var o=e.attributes.atmention,i=e.optional;!o||n.onlyNewMentions&&void 0!==(null===(t=null==i?void 0:i.atmention)||void 0===t?void 0:t.contentId)||null===(r=n._users)||void 0===r||r.push({UserId:o.email,Provider:_.K}),(e.attributes.weight||e.attributes.italic||e.attributes.underline)&&(n._hasRichTextFormatting=!0)}}))},e}(),E=n(75789),P=n(5627),x=n(59824),b=n(20478),k=n(14503),w=n(96138),R=n(55684),F=n(84809),N=n(8143),M=n(69349);function L(e,t,n,r,o,i){e((0,N.M)(d.chainActionDetails(i,r),t)),e((0,M.u)({draftWarningType:n,draftWarningReason:k.m.GrantUsersAccessFailure},d.chainActionDetails(i,o)))}function O(e,t,n,r,o,a,c,u,p){var g=function(e,t,n,r,o){try{switch(t.type){case"CREATE":e(d.commitDraft(d.chainActionDetails(r,i.m2.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:n},metadataUpdates:o}));break;case"EDIT":e(d.commitDraft(d.chainActionDetails(r,i.m2.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:n,commentId:t.commentId}}));break;case"REPLY":e(d.commitDraft(d.chainActionDetails(r,i.m2.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:n,parentId:t.parentId},metadataUpdates:o}));break;default:return(0,l.i7)().assertConditionTag(!1,"Unexpected session type '".concat(t.type,"'"),593278807),e((0,N.M)(d.chainActionDetails(r,i.m2.reserveTag(593278808)),n)),-2130957532}}catch(t){if(!(0,E.Ir)(t)&&!(0,P.G)(t))throw t;return e((0,N.M)(d.chainActionDetails(r,i.m2.reserveTag(593278809)),n)),s.dh()&&e((0,M.u)({draftWarningReason:k.m.CommitFailure,draftWarningType:w.u.CommitFailed},d.chainActionDetails(r,i.m2.reserveTag(593278810)))),(0,f.E)(t)}}(e,t,n,u,p);return g?(o.failTag(c,g),x.A.CommitFailed):r?(t.type===m.Jg?(o.addDataField("CreateThreadWithMentions",!0,l.LG.SystemMetadata,l.th.Critical),p&&p.Task&&o.addDataField("CreateThreadWithTaskAssigned",!0,l.LG.SystemMetadata,l.th.Critical)):t.type===m.XM&&(o.addDataField("CreateReplyWithMentions",!0,l.LG.SystemMetadata,l.th.Critical),p&&p.Task&&o.addDataField("CreateReplyWithTaskAssigned",!0,l.LG.SystemMetadata,l.th.Critical)),o.successTag(a),x.A.Success):(o.successTag(a),x.A.Success)}var B=n(67177),V=n(89181),U=n(12595),H=n(52700),G=n(44579),z=n(16610),q=n(67534),W=n(60344),Y=n(30387),j=n(97793),X=n(1855);function K(e,t){return{requestDeleteComment:function(t,n){e(d.requestDeletePost(t,n))},requestDeleteThread:function(t,n,r){e(d.requestDeleteThread(t,n,r))},requestReopenThread:function(t,n,r){e(d.requestReopenThread(t,n,r))},requestResolveThread:function(t,n,r){e(d.requestThreadResolve(t,n,r))},requestEditCommentSession:function(n,r,o){e((0,u.T)(n,t.commentAPI,{sessionType:"EDIT",commentId:r,rootCommentId:(0,s.cg)()?o:void 0},!1,t.peopleAPI)).catch((0,a.L)(i.m2.reserveTag(574362624)))},requestReplyCommentSession:function(n,r){e((0,u.T)(n,t.commentAPI,{sessionType:"REPLY",threadId:r},!1,t.peopleAPI)).catch((0,a.L)(i.m2.reserveTag(574362625)))},commitCommentAndFocus:function(n,a,c,u,f,p,_){return e(function(e,t,n,a,c,u){return function(f,p){var _,E,P=(0,l.i7)().createActivityObject("CommitComment",e.telemetryVisitor,(0,l.Zx)());P.addDocumentMetadata(l.$j.Basic);var B=y.ce[c.type],V=p(),U=R.x(V),H=C.CR(V);if(void 0===H||H.commentDraft.sessionConfiguration.sessionType!==c.type)return P.failTag(593278784,-2130957522),Promise.resolve(x.A.CommitFailed);var G="",z=!1;switch(c.type){case m.N_:G=c.commentId;break;case m.XM:G=c.parentId,z=!0;break;case m.Jg:H&&(G=H.commentDraft.sessionConfiguration.draftId||"")}var q=C.KU(V),W=!z||(0,S.$)(G,q,e.renderContextType)===I.A.Expanded;P.addDataField("IsCardExpanded",W,l.LG.SystemMetadata);var Y=function(e,t){var n;if(t&&!(0,T.kW)(t.commentDraft.sessionConfiguration)&&s.$H()){var r=void 0,o=s.kG()?(0,A.tM)(null!==(n=null==e?void 0:e.currentState.assignees)&&void 0!==n?n:[],t.selectedTaskAssignees):void 0;if(o)r={Task:{type:"Task",assigneeUpdate:o}};else{var i=t.selectedTaskAssignee;r=i?{Task:{type:"Task",assignee:i}}:void 0}return r}}(U[G],H);if((null==Y?void 0:Y.Task)&&!(0,g.aw)(V.commentState.modelCapabilities)&&((0,l.i7)().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),Y.Task=void 0),(s.$H()&&c.type===m.Jg||s.T$()&&c.type===m.XM)&&(P.addDataField("IsPreExistingTask",!!U[G],l.LG.SystemMetadata,l.th.Critical),P.addDataField("AffectingTaskMetadata",!!(null==Y?void 0:Y.Task),l.LG.SystemMetadata,l.th.Critical)),P.addDataField("SessionType",B,l.LG.SystemMetadata),c.type!==m.Jg){var j=(0,g.uv)(C.CA(V),G);j.valid&&(P.addDataField("MatchesCommentAuthor",j.matchesCurrentUser,l.LG.SystemMetadata),P.addDataField("ThreadCreationDeltaMs",j.timeElapsed,l.LG.SystemMetadata))}P.addDataField("AtMentionsEnabled",n,l.LG.SystemMetadata),P.addDataField("Trackback",e.trackback,l.LG.SystemMetadata),P.addDataField("RenderContextType",e.renderContextType,l.LG.SystemMetadata),P.addDataField("CommitSource",u,l.LG.SystemMetadata);var X=C.XU(V);return(0,b.hT)(X)?(null===(E=(_=(0,l.i7)()).logDiagnosticTrace)||void 0===E||E.call(_,(0,h.D)(r||(r=(0,o.__makeTemplateObject)(["NoCommitDueToCommitPending"],["NoCommitDueToCommitPending"]))),i.m2.reserveTag(556827598),l.AI.Info,l.b5.ProductServiceUsage,e.telemetryVisitor),Promise.resolve(x.A.CommitPending)):(f((0,F.e)(d.chainActionDetails(e,i.m2.reserveTag(593278785)))),a().then((function(r){if(!n){var o=O(f,c,r,0,P,i.m2.reserveTag(593278786),i.m2.reserveTag(593278787),e,Y);return Promise.resolve(o)}var a=new D(r),d=a.Mentions,u=(0,l.i7)();return s.UJ()&&d.length>0&&u.logFloodgateActivity&&u.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),P.addDataField("CreateCommentWithRichFormatting",a.HasRichTextFormatting,l.LG.SystemMetadata),d.length?t.grantUsersAccess(d).then((function(t){var n=function(e){var t=e.OperationResult;return"boolean"==typeof t?t:t===v.gx.Success}(t),o=function(e){return!!e.Details&&e.Details.Canceled}(t);if(P.addDataField("AllUsersGrantedAccess",n,l.LG.SystemMetadata),P.addDataField("ShareDialogCanceled",o,l.LG.SystemMetadata),t.OperationResult===v.gx.FailedSilently)return(0,i.fH)("Check Access Phase failed - share dialog not shown"),P.failTag(593278790,-2130957561),L(f,r,w.u.GrantAccessFailedSilently,i.m2.reserveTag(593278791),i.m2.reserveTag(593278792),e),Promise.resolve(x.A.ShareFailed);if(o)return(0,i.fH)("Share dialog was canceled by user"),P.successTag(593278793),L(f,r,w.u.GrantAccessCanceled,i.m2.reserveTag(593278794),i.m2.reserveTag(554801174),e),Promise.resolve(x.A.ShareFailed);if(!n)return(0,i.fH)("Not all users have been granted access - going back to initial state"),P.successTag(593278795),L(f,r,w.u.GrantAccessCanceled,i.m2.reserveTag(593278796),i.m2.reserveTag(554784648),e),Promise.resolve(x.A.ShareFailed);var a=O(f,c,r,d.length,P,i.m2.reserveTag(593278797),i.m2.reserveTag(593278798),e,Y);return Promise.resolve(a)}),(function(t){return P.failTag(593278799,-2130957561),(0,i.fH)("Grant Users Access has failed",(0,i.M5)(t)),L(f,r,w.u.GrantAccessFailedSilently,i.m2.reserveTag(593278800),i.m2.reserveTag(554784393),e),Promise.resolve(x.A.ShareFailed)})):(o=O(f,c,r,0,P,i.m2.reserveTag(593278788),i.m2.reserveTag(593278789),e,Y),Promise.resolve(o))}),(function(t){return P.failTag(593278801,-2130957539),f((0,N.M)(d.chainActionDetails(e,i.m2.reserveTag(593278802)),void 0)),(0,i.fH)("getCommentBody failed",(0,i.M5)(t)),s.dh()&&f((0,M.u)({draftWarningReason:k.m.CommitFailure,draftWarningType:w.u.CommitFailed},d.chainActionDetails(e,i.m2.reserveTag(593278803)))),Promise.resolve(x.A.CommitFailed)})))}}(n,t.peopleAPI,u,a,c,_)).then((function(e){return e===x.A.Success&&t.focusManager.focusCommentCardCommand(f,p),e}))},discardDraftAsync:function(t,n,r,o){return e((0,V.y)(t,n,r,o))},discardDraftIfEmpty:function(t,n,r){return e((0,B.u)(t,n,r))},showLowFidelityWarning:function(t,n,r){e(d.showLowFidelityWarning(t,n,r))},clearLowFidelityWarning:function(t){e(d.clearLowFidelityWarning(t))},saveDraft:function(t,n,r){e(d.saveDraft(t,{draftId:n,draftContent:r}))},clearCommentHighlight:function(t,n){e(d.clearCommentHighlight(t,c.A.SharedComments,n))},checkUserAccess:function(e){return t.peopleAPI.checkUserAccess(e)},updateMentioneesStillInDraft:function(t,n){e(d.updateMentioneesStillInDraft(t,n))},addToCurrentMentionees:function(t,n){e(d.addToCurrentMentionees(t,n))},updateSelectedTaskAssignee:function(t,n){e(d.updateSelectedTaskAssignee(t,n))},updateSelectedTaskAssignees:function(t,n){e(d.updateSelectedTaskAssignees(t,n))},toggleTaskAssigner:function(t){e(d.toggleTaskAssigner(t))},displayDraftWarning:function(t,n,r){e(d.displayDraftWarning({draftWarningType:n,draftWarningReason:r},t))},showPostErrorUI:function(t,n){e(d.showPostErrorUI(t,n))},clearPostErrorUI:function(t,n){e(d.clearPostErrorUI(t,n))},selectCommentCardAndShowLowFidelityWarning:function(t,n,r){e(function(e,t,n){return function(r,o){var i,a=o();(null===(i=C.$6(a))||void 0===i?void 0:i.selectedCardId)!==t&&r((0,Y.un)(e,t,void 0,Y.V9.ExpandCard,c.A.SharedComments)),r((0,j.G)(e,t,n))}}(t,n,r))},draftEmptinessChanged:function(t,n,r){e(d.draftEmptinessChanged(t,r,n))},selectComment:function(t,n,r,o){return e((0,X.S)(t,n,r,o))},collapseCard:function(t,n){e(d.collapseCard(t,n))},requestUpdateCommentReactions:function(n,r,o,i){e(function(e,t,n,r,o){return function(i,a){var s=(0,l.i7)().createActivityObject("CommentReaction",e.telemetryVisitor,(0,l.Zx)());s.addDataField("UserReactionAction",o,l.LG.SystemMetadata);var d=a();if(n.sessionType===m.q3){var c=(0,g.uv)(C.CA(d),n.threadId);c.valid&&(s.addDataField("MatchesCommentAuthor",c.matchesCurrentUser,l.LG.SystemMetadata),s.addDataField("ThreadCreationDeltaMs",c.timeElapsed,l.LG.SystemMetadata))}(0,p.Yi)(d,s),t.beginDraftingAsync(n).then((function(e){e.updateProperties("Reaction",{type:"Reaction",reactionType:r,isActive:o}),e.commit(),e.endDrafting(),s.successTag(587317280)})).catch((function(e){s.failTag(587317281,(0,f.E)(e))}))}}(n,t.commentAPI,{sessionType:"METADATA",threadId:r},o,i))},requestPresentLinkToComment:function(t,n){e(d.requestPresentLinkToComment(t,n))},onClickableTextClicked:function(e){var n,r;null===(r=(n=t.commentAPI).onClickableTextClicked)||void 0===r||r.call(n,e)}}}function $(e,t){return(0,o.__assign)((0,o.__assign)({},K(e,t)),{highlightComment:function(t,n){e(d.highlightComment(t,n,c.A.SharedComments))},discardDraftAndStartNewCommentSession:function(n){e((0,u.T)(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI)).catch((0,a.L)(i.m2.reserveTag(592314377)))},queueLoadThreads:function(t,n){e(d.queueLoadThreads(t,{threadIds:n}))},requestClosePane:function(t){e(d.requestClosePane(t))},requestDisplayConfiguration:function(t,n){return e((0,W.u)(t,n))},readyToRender:function(t){e(d.readyToRender(t))},requestModalConfirmation:function(t,n,r,o){e(d.requestModalConfirmation(t,n,r,o))},initializeView:function(n){e(function(e,t,n,r,o){return function(s){return s((0,z.p)({renderContextType:e,trackback:i.m2.reserveTag(595899542),telemetryVisitor:o})),t===H.A.NewThread?(e===G.A.HalfPane&&s((0,W.u)({renderContextType:e,trackback:i.m2.reserveTag(595899543),telemetryVisitor:o},{displayMode:U.g1.Variable,desiredHeight:0})).catch((0,a.L)(i.m2.reserveTag(595645966))),s((0,u.T)({renderContextType:e,trackback:i.m2.reserveTag(595898586),telemetryVisitor:o},n,{sessionType:"CREATE"},!1,r)).then((function(){s((0,q.t)({renderContextType:e,trackback:i.m2.reserveTag(595899545),telemetryVisitor:o}))}))):s((0,q.t)({renderContextType:e,trackback:i.m2.reserveTag(595899546),telemetryVisitor:o}))}}(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateRenderLocksForAllDrafts:function(t,n){e(d.updateDraftRenderContext(t,n))}})}function Z(e,t){return(0,o.__assign)((0,o.__assign)({},K(e,t)),{updateRenderLockForDraft:function(t,n,r){e(d.updateDraftRenderContext(t,n,r))},highlightComment:function(n){e(d.highlightComment(n,t.resource.id,c.A.SharedComments))},requestDisplayConfiguration:function(n,r){return t.componentTree.componentTreeId.renderContextType!==G.A.HalfPane?Promise.resolve(void 0):e((0,W.u)(n,r))},queueLoadThread:function(n){return e(d.queueLoadThreads(n,{threadIds:[t.resource.id]}))}})}},5326:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o}}),function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"}(r||(r={}));const o=r},38575:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o}}),function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"}(r||(r={}));const o=r},38024:function(e,t,n){"use strict";var r;n.d(t,{V:function(){return r}}),function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"}(r||(r={}))},52700:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o}}),function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"}(r||(r={}));const o=r},17886:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o}}),function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(r||(r={}));const o=r},6759:function(e,t,n){"use strict";var r;n.d(t,{o:function(){return r}}),function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"}(r||(r={}))},78984:function(e,t,n){"use strict";var r;n.d(t,{H:function(){return r}}),function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"}(r||(r={}))},12862:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o}}),function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"}(r||(r={}));const o=r},44579:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o}}),function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"}(r||(r={}));const o=r},35175:function(e,t,n){"use strict";n.d(t,{g:function(){return l}});var r=n(77042),o=n(65203),i=n(85526),a=n(78984),s=n(58462),d=n(9685),c=n(6946),u=n(88723);function l(e,t,n,m){if(!e)return a.H.NoCommand;var f=a.H.Handled;if((0,u.z)(e)){var p=e.component;f=function(e,t,n){return t?(i.KX&&(0,r.fH)("Calling focus for componentType: ".concat(e.component.componentType)),n(e.component),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),a.H.Handled):function(e){return 1!==e.priorityArgs.priority&&0!==e.priorityArgs.phase}(e)?a.H.ShouldRetry:a.H.ComponentNotFound}(e,(0,s.Xk)(p)?t.getComponentById(p):t.getComponent(p.componentType),m)}else if((0,c.U)(e))n.dispatch(e.action);else if((0,d.d)(e)){var g=l(e.first,t,n,m),C=l(e.then,t,n,m);(0,o.i7)().assertConditionTag(g!==a.H.ShouldRetry&&C!==a.H.ShouldRetry,"Compound command failed with status FocusManagerResult.ShouldRetry. No retry will occur.",559748948)}return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),f}},9685:function(e,t,n){"use strict";n.d(t,{d:function(){return i},s:function(){return o}});var r=n(15761);function o(e,t,n){return t?n?{type:r.X.Compound,priorityArgs:{priority:1},first:t,then:n,causedBy:e}:t:n}function i(e){return e.type===r.X.Compound&&void 0!==e.first&&void 0!==e.then}},6946:function(e,t,n){"use strict";n.d(t,{U:function(){return o},Y:function(){return i}});var r=n(15761);function o(e){return e.type===r.X.DispatchAction&&void 0!==e.action}function i(e,t){return{type:r.X.DispatchAction,action:t,causedBy:e,priorityArgs:{priority:1}}}},88723:function(e,t,n){"use strict";n.d(t,{F:function(){return a},z:function(){return i}});var r=n(90853),o=n(15761);function i(e){return e.type===o.X.FocusComponent&&void 0!==e.component}function a(e,t,n){return void 0===n&&(n={priorityArgs:{priority:1}}),(0,r.__assign)({type:o.X.FocusComponent,component:t,causedBy:e},n)}},17310:function(e,t,n){"use strict";n.d(t,{c:function(){return s},l:function(){return d}});var r=n(77042),o=n(85526),i=n(15761),a=n(35175),s=50;function d(e,t){var n=function(s,d,c,u,l){if(!t||!s||-1===t.indexOf(s.type)||3===s.priorityArgs.priority)return s&&-1!==(null==t?void 0:t.indexOf(s.type))&&(o.KX&&(null==s?void 0:s.type)===i.X.FocusComponent&&(0,r.fH)("Executing non-debounced focus command ".concat(JSON.stringify(s))),void 0!==n.pendingCommand&&clearTimeout(n.pendingCommand),n.pendingCommand=void 0),void u(s,(0,a.g)(s,d,c,l));void 0!==n.pendingCommand&&clearTimeout(n.pendingCommand),o.KX&&s.type===i.X.FocusComponent&&(0,r.fH)("Caching debounced command ".concat(JSON.stringify(s))),n.pendingCommand=setTimeout((function(){o.KX&&s.type===i.X.FocusComponent&&(0,r.fH)("Executing debounced command ".concat(JSON.stringify(s))),u(s,(0,a.g)(s,d,c,l)),n.pendingCommand=void 0}),e)};return n.pendingCommand=void 0,n}},68631:function(e,t,n){"use strict";n.d(t,{$R:function(){return d},AV:function(){return c},EY:function(){return u},XX:function(){return a},ny:function(){return s}}),n(90496);var r=n(81913),o=n(75847),i=n(58462);function a(e){var t="";return(0,i.Gl)(e.componentType)?t=s(e.componentType):(0,i.Xk)(e)&&(t=d(e)),t}function s(e){switch(e){case i.I5.ClosePaneButton:return o.Am();case i.I5.NextCommentButton:return o.h9();case i.I5.PreviousCommentButton:return o.jG();case i.I5.GhostCard:return o.TJ();case i.I5.NewCommentButton:return o.zV();case i.I5.PaneRoot:return o.E4();case i.I5.CommentsList:return o.pI();case i.I5.FilterButton:return o.Iv()}}function d(e){switch(e.componentType){case i.I5.Card:return o.u4(e,!1);case i.I5.DraftCard:return o.u4(e,!0);case i.I5.PostEditor:return o.a0(o.bt(e));case i.I5.CardEditor:return o.a0(o.LX(e));case i.I5.Post:return o.cF(e);case i.I5.DiscreteHostedCommentRoot:return o.$X(e);case i.I5.ReopenThreadButton:return o.Wf(e,o.Zf())}}function c(e){return e?i.I5.DraftCard:i.I5.Card}function u(e,t){return c((0,r.tN)(t)===e)}},58462:function(e,t,n){"use strict";var r;function o(e){return e===r.ClosePaneButton||e===r.NextCommentButton||e===r.PreviousCommentButton||e===r.GhostCard||e===r.NewCommentButton||e===r.PaneRoot||e===r.CommentsList||e===r.FilterButton}function i(e){return(t=e.componentType)===r.CardEditor||t===r.PostEditor||t===r.Card||t===r.Post||t===r.DraftCard||t===r.DiscreteHostedCommentRoot||t===r.ReopenThreadButton;var t}function a(e){switch(e){case r.CardEditor:case r.Card:case r.DraftCard:case r.DiscreteHostedCommentRoot:case r.ReopenThreadButton:return!0;case r.PostEditor:case r.Post:return!1}}function s(e,t){return i(e)&&i(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}n.d(t,{Gl:function(){return o},I5:function(){return r},Xk:function(){return i},nM:function(){return a},pL:function(){return s}}),function(e){e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton",e[e.CommentsList=14]="CommentsList",e[e.FilterButton=15]="FilterButton"}(r||(r={}))},15761:function(e,t,n){"use strict";var r;n.d(t,{X:function(){return r}}),function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"}(r||(r={}))},95389:function(e,t,n){"use strict";var r;n.d(t,{a:function(){return r}}),function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"}(r||(r={}))},79018:function(e,t,n){"use strict";n.d(t,{K:function(){return r},a:function(){return o}});var r="O365",o="@"},28760:function(e,t,n){"use strict";n.d(t,{$:function(){return i}});var r=n(5326),o=n(44579);function i(e,t,n){return n===o.A.HalfPane||t.includes(e)?r.A.Expanded:r.A.Collapsed}},51852:function(e,t,n){"use strict";n.d(t,{D:function(){return a}});var r=n(94344),o=n(81913),i=n(38024);function a(e,t,n){var a=(0,o.rB)(n);if(a)return a.threadId!==e?i.V.InOtherCard:r.W2()&&a.renderContextType!==t?i.V.InOtherContextOfThisCard:"EDIT"===a.commentDraft.sessionConfiguration.sessionType?i.V.InChildPost:i.V.InCard}},41566:function(e,t,n){"use strict";n.d(t,{Xp:function(){return J},y7:function(){return Q},x1:function(){return ae},$x:function(){return ce},Vw:function(){return ie},Q3:function(){return re},LM:function(){return oe},q6:function(){return K},rZ:function(){return ee},g6:function(){return ne},zS:function(){return X},n6:function(){return se},q$:function(){return de},ts:function(){return te},AO:function(){return ue},jj:function(){return ve},f1:function(){return me},yb:function(){return Ce},gF:function(){return he},Ew:function(){return le},qS:function(){return pe},TC:function(){return Se},rg:function(){return Ie},um:function(){return fe},c6:function(){return ge},Ed:function(){return j},j4:function(){return z},Zk:function(){return ye},Z$:function(){return W},DN:function(){return H},ki:function(){return q},qo:function(){return Z},E9:function(){return G},km:function(){return Te},vM:function(){return $},tt:function(){return Y},SH:function(){return V}});var r=n(77042),o=n(65203),i=n(58605),a=n(10827),s=n(64307),d=n(15918),c=n(99381),u=n(50577),l=n(12595),m=n(85526),f=n(69084),p=n(75789),g=n(94344);function C(e,t,n,r,i){if(!g.S()){var a=(0,o.i7)().createActivityObject("SelectionAttemptWhileDrafting",n,(0,o.Zx)());a.addDataField("Trackback",r,o.LG.SystemMetadata),a.addDataField("RenderContextType",i,o.LG.SystemMetadata),a.addDataField("SelectionAttemptType",e,o.LG.SystemMetadata),a.addDataField("IsDraftInCurrentContext",t.isInCurrentContext,o.LG.SystemMetadata),a.successTag(590206682)}}var h,v=n(55309),y=n(95187),T=n(1855),I=n(59824),S=n(81913),A=n(20478),_=n(47513),D=n(5326),E=n(38024);!function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"}(h||(h={}));const P=h;var x=n(6759),b=n(12862),k=n(44579),w=n(68631),R=n(95389),F=n(79018),N=n(17864),M=n(39760),L=n(55925),O=n(9749),B=n(89805);function V(e){var t=e.comment,n=e.threads,r=e.selectedComment,o=e.warningType,i=!t.parentId,a=!!(t.commentFlags&s.P.LowFidelity);if(!r)return!(!i||o!==_.xQ.DeleteThread||!a&&!B.oy(n,t.commentId))||g.cb()&&a&&i;var d=a||i&&(o===_.xQ.DeleteReply||o===_.xQ.DeleteThread)&&B.oy(n,t.commentId),c=(0,_.dF)(r.selectionDetails)?r.selectionDetails.selectedPostId:r.selectedCardId;return!(!d||c===t.commentId&&r.selectionDetails.lowFidelityWarningType===o)}function U(e){var t=e.result,n=e.localizationAPI;t===I.A.Success&&(0,i.gL)(n.getString(67))}function H(e){var t=e.trackback,n=e.id,a=e.data,s=e.selectedComment,d=e.renderContextType,c=e.actionDispatchers,u=e.telemetryVisitor,l=e.localizationAPI,m=B.eu(a,n);m?V({comment:m,threads:a,selectedComment:s,warningType:_.xQ.DeleteReply})?c.showLowFidelityWarning({renderContextType:d,telemetryVisitor:u,trackback:r.m2.reserveTag(593826118)},n,_.xQ.DeleteReply):((0,i.gL)(l.getString(65)),c.requestDeleteComment({renderContextType:d,telemetryVisitor:u,trackback:t},n)):(0,o.i7)().assertConditionTag(!1,"Comment not found",593826117)}function G(e){var t=e.trackback,n=e.id,r=e.data,i=e.renderContextType,a=e.actionDispatchers,s=e.telemetryVisitor,d=B.eu(r,n);d?a.showPostErrorUI({renderContextType:i,telemetryVisitor:s,trackback:t},d.commentId):(0,o.i7)().assertConditionTag(!1,"Comment not found",593875075)}function z(e){var t=e.trackback,n=e.id,r=e.data,i=e.renderContextType,a=e.actionDispatchers,s=e.telemetryVisitor,d=B.eu(r,n);d?a.clearPostErrorUI({renderContextType:i,telemetryVisitor:s,trackback:t},d.commentId):(0,o.i7)().assertConditionTag(!1,"Comment not found",593875076)}function q(e){var t=e.trackback,n=e.id,i=e.data,a=e.selectedComment,s=e.renderContextType,d=e.actionDispatchers,c=e.telemetryVisitor,u=B.eu(i,n);u?V({comment:u,threads:i,selectedComment:a,warningType:_.xQ.Edit})?d.showLowFidelityWarning({renderContextType:s,telemetryVisitor:c,trackback:r.m2.reserveTag(593826120)},n,_.xQ.Edit):d.requestEditCommentSession({renderContextType:s,telemetryVisitor:c,trackback:t},n,u.parentId||u.commentId):(0,o.i7)().assertConditionTag(!1,"Comment not found",593826119)}function W(e){var t=e.trackback,n=e.id,i=e.data,a=e.draftState,s=e.contentPromise,d=e.atMentionsEnabled,u=e.componentTree,l=e.actionDispatchers,m=e.telemetryVisitor,g=e.localizationAPI,C=e.commitSource;if((0,A.hT)(a))return Promise.resolve();if(!a.postIdToDraftIdMap[n])return(0,o.i7)().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new p.cP("Post draft to commit not found",r.m2.reserveTag(587850403),-2130957492));var h=B.eu(i,n);return h?l.commitCommentAndFocus({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:m,trackback:t},(function(){return s}),{commentId:n,type:"EDIT",previousCommentBody:h.commentBody},d,u,(0,c.a)(h),C).then((function(e){U({result:e,localizationAPI:g})})).catch((0,f.L)(r.m2.reserveTag(593826122))):((0,o.i7)().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject(new p.cP("Comment not found in model",r.m2.reserveTag(587850432),2130957505)))}function Y(e){var t=e.trackback,n=e.renderableItem,o=e.selectedComment,i=e.cardCollapsedState,a=e.dispatchProps,s=e.telemetryVisitor,d=e.componentTree,c=e.draftState_deprecated,u=e.shouldFocusAfter,l=B.Ee(n),m=B.OX(n);return a.discardDraftIfEmpty({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:s,trackback:r.m2.reserveTag(593237586)},y.A.SharedComments,void 0).then((function(e){if(g.S()||e.draftDiscardBehavior!==x.o.CannotAutoDiscard||o&&(0,_.dF)(o.selectionDetails)&&o.selectionDetails.selectedPostId===m){var n=i===D.A.Collapsed;a.selectComment(d,{renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:s,trackback:t},(0,T.E)(l,y.A.SharedComments,n?{selectType:v.SelectActionType.ExpandCard}:{selectType:v.SelectActionType.SelectPost,selectedPost:m}),u||n).catch((0,f.L)(r.m2.reserveTag(590104649)))}else{var p=(0,S.rB)(c);p&&C(2,p,s,r.m2.reserveTag(590206683),d.componentTreeId.renderContextType)}}),(0,f.L)(r.m2.reserveTag(593032901)))}function j(e){var t=e.trackback,n=e.commentId,a=e.setContents,s=e.data,c=e.draftState,u=e.shouldClosePaneAfterDiscardDraft,l=e.onWillDiscardCallback,m=e.renderContextType,p=e.dispatchProps,g=e.telemetryVisitor,C=e.localizationAPI,h=B.eu(s,n);c.postIdToDraftIdMap[n]&&h?((0,i.gL)(C.getString(66)),p.discardDraftAsync({renderContextType:m,telemetryVisitor:g,trackback:t},y.A.SharedComments,u,l).then((function(e){e===d.y.Handled&&h&&a&&a(h.commentBody)})).catch((0,f.L)(r.m2.reserveTag(593826127)))):(0,o.i7)().assertConditionTag(!1,"Cannot find comment post to cancel",593826126)}function X(e){var t=e.cardProps,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardMounted(n,t)}))}function K(e){var t=e.cardId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardEditorMounted(n,t)}))}function $(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostMounted(n,t)}))}function Z(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostEditorMounted(n,t)}))}function J(e){var t=e.trackback,n=e.threadId,r=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor;o.requestReplyCommentSession({renderContextType:r,telemetryVisitor:i,trackback:t},n)}function Q(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor;o.collapseCard({renderContextType:r,telemetryVisitor:i,trackback:t},n.getId())}function ee(e){var t=e.trackback,n=e.commentCardRef,o=e.dispatchProps,i=e.telemetryVisitor,a=e.componentTree,s=e.options,d=e.focusManager,c=e.isDraftThread,u={componentType:(0,w.AV)(c),id:n.getId(),renderContextType:a.componentTreeId.renderContextType};d.postOnComponentFocusedRequest(u,(function(){m.KX&&(0,r.fH)("Handling card focus with polite selection on ".concat(n.getId())),a.isFocusOnOrWithin(u)&&te({trackback:t,commentCardRef:n,dispatchProps:o,telemetryVisitor:i,componentTree:a,options:s})}))}function te(e){var t,n=e.trackback,o=e.commentCardRef,i=e.dispatchProps,a=e.telemetryVisitor,s=e.componentTree,d=e.options,c=!1,u=d.selectActionType;switch(u){case v.SelectActionType.ExpandCard:var l=d,m=l.selectRootPost&&(g.S()||!l.relativeDraftingState);c=l.shouldFocusAfter,t=m?{selectType:v.SelectActionType.SelectPost,selectedPost:o.getId()}:{selectType:v.SelectActionType.ExpandCard};break;case v.SelectActionType.SelectCard:case v.SelectActionType.Polite:t={selectType:u};break;default:(0,r.HB)(u)}var p=(0,T.E)(o.getId(),y.A.SharedComments,t);d.selectActionType===v.SelectActionType.ExpandCard&&i.discardDraftIfEmpty({renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:a,trackback:r.m2.reserveTag(571281760)},y.A.SharedComments,void 0).then((function(e){if(!g.S()&&e.draftDiscardBehavior===x.o.CannotAutoDiscard&&d.relativeDraftingState===E.V.InOtherCard){var t=(0,S.rB)(d.draftState);t&&C(1,t,a,r.m2.reserveTag(571281761),s.componentTreeId.renderContextType)}})).catch((0,f.L)(r.m2.reserveTag(571281762))),i.selectComment(s,{renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:a,trackback:n},p,c).catch((0,f.L)(r.m2.reserveTag(571340118)))}function ne(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor;e.shouldHighlightCard?o.highlightComment({renderContextType:r,telemetryVisitor:i,trackback:t},n.getId()):o.clearCommentHighlight({renderContextType:r,telemetryVisitor:i,trackback:t},n.getId())}function re(e){var t=e.trackback,n=e.focusManager,i=e.componentTree,a=e.cardId,s=e.isCardLie,d=e.newHeight,c=e.renderContextType,u=e.selectedComment,m=e.dispatchProps,p=e.telemetryVisitor;if(c===k.A.HalfPane){if(void 0===d)return(0,o.i7)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);s&&u&&u.selectedCardId===a&&m.requestDisplayConfiguration({renderContextType:c,telemetryVisitor:p,trackback:t},{displayMode:l.g1.Variable,desiredHeight:d}).then((function(){n.focusCommentPaneCommand(i)})).catch((0,f.L)(r.m2.reserveTag(593826130)))}}function oe(e){var t=e.trackback,n=e.id,r=e.draftState,o=e.renderContextType,i=e.dispatchProps,s=e.telemetryVisitor;if("android"===(0,L.u)()){var d=r.drafts[r.cardIdToDraftIdMap[n]];d&&d.isDraftEmpty&&d.commentDraft.sessionConfiguration.sessionType===a.XM&&i.discardDraftAsync({renderContextType:o,telemetryVisitor:s,trackback:t},y.A.SharedComments,!1)}}function ie(e){var t,n=e.trackback,s=e.showDiscardDialog,c=e.invokeModalDialog,u=e.componentTree,l=e.dispatchProps,m=e.closeOnDiscard,p=e.cardId,g=e.draftState,C=e.telemetryVisitor,h=e.localizationAPI,v=e.focusManager,T=e.lieIndex,I=g.cardIdToDraftIdMap[p];if(I){var S=void 0;s&&(S=(0,N.t)(g,u,c));var A=(null===(t=g.drafts[I])||void 0===t?void 0:t.commentDraft.sessionConfiguration.sessionType)===a.XM,_=function(e){var t=e.componentTree,n=e.focusManager,r=e.lieIndex,o=e.cardId,i=e.isReplyDraft,a=e.discardCallback;return function(e,s){return a?a((function(){return n.onUserAction(t,{userAction:R.a.CancelNewThreadDraft,threadIndex:r}),e?e():d.y.Unhandled}),s):e?(i?n.onUserAction(t,{userAction:R.a.CancelReplyDraft,cardId:o}):n.onUserAction(t,{userAction:R.a.CancelNewThreadDraft,threadIndex:r}),Promise.resolve(e())):Promise.resolve(d.y.Unhandled)}}({componentTree:u,focusManager:v,lieIndex:T,cardId:p,isReplyDraft:A,discardCallback:S});(0,i.gL)(h.getString(A?64:103)),l.discardDraftAsync({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:C,trackback:n},y.A.SharedComments,m,_).then((function(e){e===d.y.Handled&&(A?v.onUserAction(u,{userAction:R.a.CancelReplyDraft,cardId:p}):v.onUserAction(u,{userAction:R.a.CancelNewThreadDraft,threadIndex:T}))}),(0,f.L)(r.m2.reserveTag(592840735)))}else(0,o.i7)().assertConditionTag(!1,"Card draft to cancel not found",588853382)}function ae(e){var t=e.trackback,n=e.commentCardRef,i=e.draftState,a=e.areMentionsEnabled,s=e.session,d=e.componentTree,c=e.dispatchProps,u=e.telemetryVisitor,l=e.localizationAPI,m=e.commitSource;if((0,A.hT)(i))return Promise.resolve();var g=n.getId();return i.cardIdToDraftIdMap[g]?c.commitCommentAndFocus({trackback:t,telemetryVisitor:u,renderContextType:d.componentTreeId.renderContextType},n.getContentsAsync,s,a,d,g,m).then((function(e){U({result:e,localizationAPI:l})})).catch((0,f.L)(r.m2.reserveTag(593826134))):((0,o.i7)().assertConditionTag(!1,"Card draft to commit not found",588853383),Promise.reject(new p.cP("Card draft to commit not found",r.m2.reserveTag(587850433),-2130957492)))}function se(e){var t=e.trackback,n=e.id,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor,s=e.localizationAPI,d=e.isTask;(0,i.gL)(s.getString(125)),o.requestReopenThread({renderContextType:r,telemetryVisitor:a,trackback:t},n,d)}function de(e){var t=e.componentTree,n=e.focusManager,r=e.trackback,o=e.id,a=e.renderContextType,s=e.dispatchProps,d=e.telemetryVisitor,c=e.localizationAPI,u=e.isTask;(0,i.gL)(c.getString(124)),n.onUserAction(t,{userAction:R.a.ResolveThread,cardId:o}),s.requestResolveThread({renderContextType:a,telemetryVisitor:d,trackback:r},o,u)}function ce(e){var t=e.trackback,n=e.id,a=e.data,s=e.selectedComment,c=e.componentTree,u=e.invokeModalDialog,l=e.dispatchProps,m=e.telemetryVisitor,p=e.localizationAPI,g=e.focusManager,C=e.isTask,h=e.threadIndex;if(e.shouldCheckForLowFidelity){var v=B.eu(a,n);if(!v)return void(0,o.i7)().assertConditionTag(!1,"Comment not found",593605342);if(V({comment:v,threads:a,selectedComment:s,warningType:_.xQ.DeleteThread}))return void l.selectCommentCardAndShowLowFidelityWarning({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:m,trackback:r.m2.reserveTag(593605343)},v.commentId,_.xQ.DeleteThread)}c.componentTreeId.renderContextType===k.A.HalfPane&&u?u(b.A.DeleteThread,(function(){return function(e){var t=e.componentTree,n=e.selectedComment,i=e.telemetryVisitor;return n?(e.dispatchProps.requestDeleteThread({renderContextType:t.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.m2.reserveTag(592840775)},n.selectedCardId),d.y.Handled):((0,o.i7)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),d.y.Unhandled)}({dispatchProps:l,componentTree:c,selectedComment:s,telemetryVisitor:m})}),(function(){return d.y.Canceled})).then((function(e){e===d.y.Handled&&g.onUserAction(c,{userAction:R.a.DeleteThread,threadIndex:h})})).catch((0,f.L)(r.m2.reserveTag(595632546))):((0,i.gL)(p.getString(63)),g.onUserAction(c,{userAction:R.a.DeleteThread,threadIndex:h}),(0,O.qD)(c.componentTreeId.renderContextType)?setTimeout((function(){l.requestDeleteThread({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:m,trackback:t},n,C)}),100):l.requestDeleteThread({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:m,trackback:t},n,C))}function ue(e){de({componentTree:e.componentTree,focusManager:e.focusManager,trackback:e.trackback,id:e.id,renderContextType:e.renderContextType,dispatchProps:e.dispatchProps,telemetryVisitor:e.telemetryVisitor,localizationAPI:e.localizationAPI,isTask:!0})}function le(e){var t=e.failTag,n=e.successTag,r=e.person,i=e.dispatchProps,a=e.telemetryVisitor,s=e.renderContextType,d=e.trackback,c=(0,o.i7)().createActivityObject("CheckUserAccess",a,(0,o.Zx)()),l={UserId:(0,u.u9)(r),Provider:F.K,DisplayName:(0,u.QU)(r),Email:(0,u.u9)(r)};i.checkUserAccess(l).then((function(e){var t;c.addDataField("UserCanWrite",e.UserCanWrite,o.LG.SystemMetadata),c.addDataField("UserCanReview",null!==(t=null==e?void 0:e.UserCanReview)&&void 0!==t&&t,o.LG.SystemMetadata),c.successTag(n)}),(function(e){c.failTag(t,-2130957562)})),i.addToCurrentMentionees({telemetryVisitor:a,trackback:d,renderContextType:s},r)}function me(e){var t=e.trackback,n=e.contentId,r=e.isEmpty,o=e.renderContextType,i=e.draftIdMap,a=e.actionDispatchers,s=e.telemetryVisitor,d=i[n];d&&a.draftEmptinessChanged({renderContextType:o,telemetryVisitor:s,trackback:t},d,r)}function fe(e){var t=e.trackback,n=e.id,o=e.editor,i=e.renderContextType,a=e.draftIdMap,s=e.draftMap,d=e.actionDispatchers,c=e.telemetryVisitor,u=a[n];if(u){var l=s[u];(0,r.hv)(l,"Draft should be defined if draftId exists!",r.m2.reserveTag(587850434)),l.pendingState===A.W8.None&&d.saveDraft({renderContextType:i,telemetryVisitor:c,trackback:t},u,{editorContent:o.getContentsAsync(),editorCursorPosition:o.getCursorPositionAsync()})}}function pe(e){var t=e.trackback,n=e.emailsStillInDraft,r=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor;o.updateMentioneesStillInDraft({renderContextType:r,telemetryVisitor:i,trackback:t},n)}function ge(e){var t=e.trackback,n=e.renderContextType,r=e.dispatchProps,o=e.telemetryVisitor,i=e.selectedAssignee;r.updateSelectedTaskAssignee({renderContextType:n,telemetryVisitor:o,trackback:t},i)}function Ce(e){var t=e.selectedState,n=e.renderContextType,i=e.dispatchProps,a=e.telemetryVisitor;t&&(0,_.Uo)(t)?i.clearLowFidelityWarning({renderContextType:n,telemetryVisitor:a,trackback:r.m2.reserveTag(573612046)}):(0,o.i7)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658)}function he(e){var t=e.selectedState,n=e.onCardDelete,r=e.onPostDelete,i=e.onPostEdit;if(t)if(!(0,_.dF)(t.selectionDetails)||(0,_.x0)(t)){if((0,_.Z2)(t))return void n(a=t.selectedCardId);if((0,_.kg)(t))return void(0,o.i7)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662)}else{var a=t.selectionDetails.selectedPostId;if((0,_.Je)(t))return void r(a);if((0,_.kg)(t))return void i(a)}else(0,o.i7)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661)}function ve(e){var t=e.ownProps,n=e.dispatchProps,i=e.componentTree,a=e.draftState,s=e.invokeModalDialog;i.componentTreeId.renderContextType!==k.A.HalfPane&&(0,A.IE)(a)&&!g.W2()?n.discardDraftAsync({renderContextType:i.componentTreeId.renderContextType,telemetryVisitor:t.telemetryVisitor,trackback:r.m2.reserveTag(592840770)},y.A.SharedComments,!0,(0,N.t)(a,i,s,b.A.ClosePaneDraft)).then((function(e){e===d.y.Canceled?(0,M.r)():e===d.y.Unhandled&&(0,o.i7)().assertConditionTag(e!==d.y.Unhandled,"Unhandled request to discard on close pane",592840769)})).catch((0,f.L)(r.m2.reserveTag(592840771))):function(e){var t=e.dispatchProps,n=e.componentTree,i=e.telemetryVisitor,a=(0,o.i7)().createActivityObject("ClosePane",i,(0,o.Zx)());a.addDataField("PaneCloseResult",P.NoDialog,o.LG.SystemMetadata),a.successTag(592840773),t.requestClosePane({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.m2.reserveTag(592840774)})}({dispatchProps:n,componentTree:i,telemetryVisitor:t.telemetryVisitor})}function ye(e,t,n,r,o){n.collapseCard({renderContextType:o.componentTreeId.renderContextType,telemetryVisitor:r,trackback:e},B.Ee(t))}function Te(e,t,n,r){if(!(0,A.mw)(r)||g.S()||"win32"===(0,L.u)()){var o=B.Ee(e);n.focusCommentCardCommand(t,o)}}function Ie(e,t,n,r,o,i,a){o.requestUpdateCommentReactions({renderContextType:r,telemetryVisitor:i,trackback:e},t,a,n)}function Se(e,t,n,r,o){r.requestPresentLinkToComment({renderContextType:n,telemetryVisitor:o,trackback:e},t)}},46823:function(e,t,n){"use strict";n.d(t,{P:function(){return s}});var r=n(65203),o=n(81913),i=n(12862),a=n(9749);function s(e,t){var n=(0,o.rB)(e);if(!n)return(0,r.i7)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),(0,a.pZ)(t)?i.A.ClosePaneDraft:i.A.CancelNewDraft;switch(n.commentDraft.sessionConfiguration.sessionType){case"CREATE":return i.A.CancelNewDraft;case"EDIT":return i.A.CancelPostEdit;case"REPLY":return i.A.CancelReplyDraft;case"METADATA":return(0,r.i7)().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),i.A.CancelNewDraft}}},80611:function(e,t,n){"use strict";n.d(t,{Q:function(){return i}});var r=n(15964),o=n(81913);function i(e,t){var n=(0,o.rB)(e);return void 0!==n&&n.renderContextType!==t&&n.commentDraft.sessionConfiguration.sessionType===r.Jg}},89454:function(e,t,n){"use strict";n.d(t,{Vs:function(){return B},Yq:function(){return A},cF:function(){return R},FF:function(){return V},XL:function(){return k},rC:function(){return _},bc:function(){return y},aL:function(){return v},cD:function(){return O},cZ:function(){return L},FH:function(){return h},U7:function(){return I},LU:function(){return w},g2:function(){return D},m3:function(){return M},z9:function(){return F},A6:function(){return T},UU:function(){return E},rr:function(){return P},Z5:function(){return N},aM:function(){return b},pJ:function(){return x},Y7:function(){return C}});var r=n(33195),o=n(77042),i=n(94423),a=n(65203),s=n(38017),d=n(50577),c=n(75789),u=n(88652),l=n(94344),m=n(96138),f=n(47513),p=n(38575),g=n(38024);function C(e,t,n){var r=l.cb(),i=n&&r?t-1:t-2;if(i<1)throw new c.cP(u.DK,o.m2.reserveTag(589103692),-2130957559);return 1===i?r?e.getString(106):e.getString(9):r?e.formatString(107,String(i)):e.formatString(10,String(i))}function h(e,t){switch(t){case s.d.AtFinishNextCommentIsFirst:return e.getString(8);case s.d.AtStartNextCommentIsFirst:return e.getString(6);case s.d.MoreCommentsUpcoming:case s.d.DocumentHasComments:return e.getString(7);case s.d.OnlyCommentsInCurrent:case s.d.NoComments:case s.d.Unknown:return"";default:(0,o.HB)(t)}}function v(e,t,n,r){return n?t?e.getString(16):e.getString(17):l.dh()&&void 0!==r&&r!==g.V.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function y(e,t){switch(t){case m.u.ReturnToDraft:return e.getString(110);case m.u.GrantAccessFailedSilently:return e.getString(134);case m.u.GrantAccessCanceled:return e.getString(234);case m.u.CommitFailed:return e.getString(135);case m.u.None:return(0,a.i7)().assertConditionTag(!1,"Invalid DraftWarningType: ".concat(t),595686755),""}}function T(e,t){return void 0===t&&(t=!0),t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function I(e,t){return t?(0,f.kg)(t)?e.getString(35):(0,f.Je)(t)?e.getString(36):"":""}n(12862),n(44579);var S=(0,i.CT)((function(){try{(new Date).toLocaleDateString("i")}catch(e){return e instanceof Error&&"RangeError"===e.name}return!1}));function A(e,t){var n=!!t&&S();try{if(n){return e.toLocaleDateString(t,{hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0})}return(0,a.i7)().assertConditionTag(!1,"The locale and/or options arguments are not supported, doesToLocaleDateStringSupportsLocales: ".concat(S(),", locale Exists: ").concat(!!t),595882385),e.toLocaleDateString()}catch(n){return(0,a.i7)().assertConditionTag(!1,"LocaleDateString conversion failed: ".concat(n instanceof Error?n.name:"",", locale Exists: ").concat(!!t,", doesToLocaleDateStringSupportsLocales: ").concat(S(),", Date: ").concat(e.toString()),595953050),""}}function _(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function D(e){return e.getString(122)}function E(e,t){return 0===e.length?x(t):1===e.length?function(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,(0,d.TO)(e))}(e[0],t):(0,d.cc)(e)?t.getString(250):t.getString(251)}function P(e,t,n){if(0===e.length)return b(t,n);var r=e.map((function(e){return(0,d.TO)(e)})).join(", ");return t?n.formatString(130,r):n.formatString(129,r)}function x(e){return e.formatString(111,e.getString(133))}function b(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}function k(e,t,n,r){var o,i=t===p.A.Draft||t===p.A.DraftPreCommitPending;return null!==(o=R(e,n,r))&&void 0!==o?o:i?e.getString(173):e.getString(174)}function w(e,t,n){var r="";switch(n.length){case 0:r=e.getString(133);break;case 1:r=n[0];break;case 2:r=e.formatString(242,n[0],n[1]);break;case 3:r=e.formatString(243,n[0],n[1],n[2]);break;default:r=e.formatString(244,n[0],(n.length-1).toString())}var o=t?114:252;return e.formatString(o,r)}function R(e,t,n){var r=(0,d.QU)(n);if(r)return e.formatString(t?179:178,r)}function F(e,t){return e?t.getString(176):t.getString(126)}function N(e,t){return 0===e.length?t.getString(181):t.formatString(114,e.map((function(e){return(0,d.TO)(e)})).join(", "))}function M(e,t){switch(t){case r.eT.ActiveOnly:return e.getString(247);case r.eT.ResolvedOnly:return e.getString(246);case r.eT.All:return e.getString(245);default:(0,o.HB)(t)}}function L(e,t){switch(t){case void 0:return;case 1:return e.getString(256);default:return e.formatString(257,t.toString())}}function O(e,t){return 0===t?e.getString(254):e.formatString(267,t.toString())}function B(e){return e>0?"".concat(e):void 0}function V(e,t){return 0===t?e.getString(268):e.formatString(269,t.toString())}},75847:function(e,t,n){"use strict";function r(e){return"_".concat(e.renderContextType,"_").concat(e.id)}function o(e){return"cardEditor".concat(r(e))}function i(e){return"postEditor".concat(r(e))}function a(e){return"editorRoot_".concat(e)}function s(e){return"postRoot".concat(r(e))}function d(e,t){return t?"draftCardRoot".concat(r(e)):"cardRoot".concat(r(e))}function c(){return"GhostCard"}function u(e){return"replyBoxDescription".concat(r(e))}function l(e){return"editorBoxDescription".concat(r(e))}function m(e){return"sendReplyButton".concat(r(e))}function f(e){return"cancelReplyButton".concat(r(e))}function p(e){return"cardContextMenu".concat(r(e))}function g(e){return"postContextMenu".concat(r(e))}function C(e){return"renderableItemList".concat(r(e))}function h(e,t){return"actionBarButton_".concat(t).concat(r(e))}function v(e){return"editorFocusContainer_".concat(e)}function y(e){return"draftCancelButton".concat(r(e))}function T(e){return"innerReplyBoxContainer".concat(r(e))}function I(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function S(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function A(e){return"viewMoreReply".concat(r(e))}function _(e){return"postTimeStamp".concat(r(e))}function D(e,t){return"".concat(t.replace(/\s/g,"")).concat(r(e))}function E(e,t){return"".concat(t.replace(/\s/g,"")).concat(r(e))}function P(e){return"anchorHintText".concat(r(e))}function x(e){return"lowFidelityWarning".concat(r(e))}function b(){return"CommentsListScrollView"}function k(){return"CommentsList"}function w(){return"EmptyCreatedCommentLie"}function R(){return"NewCommentButton"}function F(e){return"taskAssignerCheckbox".concat(r(e))}function N(e){return"cardTaskFooterPickerButton".concat(r(e))}function M(e){return"taskAssignerLabel".concat(r(e))}function L(e){return"cardTaskTopperCheckbox".concat(r(e))}function O(e){return"cardTaskTopperDiv".concat(r(e))}function B(e){return"taskAssignerDiv".concat(r(e))}function V(){return"TaskChevronIcon"}function U(e){return"postWarning".concat(r(e))}function H(e){return"draftWarning".concat(r(e))}function G(e){return"postingTip".concat(r(e),";")}function z(e){return"truncationOverlay".concat(e)}function q(){return"next-thread-button"}function W(){return"previous-thread-button"}function Y(e){return"loadingPlaceholder".concat(r(e))}function j(e){return"DiscreteHostedCommentRoot".concat(r(e))}function X(e){return"AtMentionExtraInfoButton".concat(r(e))}function K(){return"ReopenThread"}function $(){return"suggestion-list"}function Z(){return"lppSuggestionListId"}function J(e){return"smartReplyHeader_".concat(e)}function Q(e){return"reactionButtonDescription_".concat(e)}function ee(e){return"reactionButtonUserList_".concat(e)}function te(e,t){return"".concat(e,"_").concat(t)}function ne(e){return"commentReactionButton".concat(r(e))}function re(){return"commentPaneFilterButtonId"}n.d(t,{$7:function(){return G},$X:function(){return j},AJ:function(){return X},Am:function(){return S},BN:function(){return M},CW:function(){return $},E4:function(){return I},EP:function(){return A},G5:function(){return g},Ht:function(){return z},Iv:function(){return re},Jd:function(){return h},Kg:function(){return F},LR:function(){return f},LX:function(){return o},Lh:function(){return C},Lt:function(){return u},M3:function(){return w},Nw:function(){return y},OD:function(){return p},PT:function(){return m},Pn:function(){return Y},Q0:function(){return te},Qw:function(){return L},SA:function(){return O},SS:function(){return a},Sg:function(){return V},TJ:function(){return c},W1:function(){return _},Wf:function(){return E},Wq:function(){return b},XG:function(){return N},Zf:function(){return K},_x:function(){return ee},a0:function(){return v},aN:function(){return ne},aU:function(){return J},bl:function(){return P},bt:function(){return i},cF:function(){return s},cW:function(){return U},fO:function(){return Q},gV:function(){return Z},h9:function(){return q},in:function(){return B},jG:function(){return W},jc:function(){return D},km:function(){return l},pI:function(){return k},qt:function(){return x},u4:function(){return d},vo:function(){return H},zC:function(){return T},zV:function(){return R}}),n(77042),n(65203),n(44579)},17864:function(e,t,n){"use strict";n.d(t,{T:function(){return s},t:function(){return d}});var r=n(81913),o=n(6759),i=n(44579),a=n(46823),s=function(e,t,n,o,a){return e&&t===i.A.HalfPane&&void 0===a&&(!o||o.selectedCardId===(0,r.tN)(n,!0,t))},d=function(e,t,n,i){if(n&&(0,r.uQ)(e)===o.o.CannotAutoDiscard){var s=null!=i?i:(0,a.P)(e,t.componentTreeId.renderContextType);return function(e,t){return n(s,e,t)}}}},78887:function(e,t,n){"use strict";n.d(t,{BX:function(){return y},Gd:function(){return v},Xf:function(){return T},pS:function(){return h}});var r,o=n(90853),i=n(77042),a=n(72429),s=n(65203),d=n(89378),c=n(76198),u=n(99381),l=n(94344),m=n(81913),f=n(20478),p=n(94828),g=n(38024),C=n(44579);function h(e,t,n){var r;if((0,p.x2)(t))return t.find((function(t){var r;return t===e||(null===(r=n[t])||void 0===r?void 0:r.alternateId)===e}));for(var o,i=new c.C(t,-1);!(o=i.next()).done;){var a=o.value.commentId,s=n[a];if((null==s?void 0:s.alternateId)===e||a===e)break}return null===(r=o.value)||void 0===r?void 0:r.commentId}function v(e,t,n){var r=(0,p.YO)(t,e);return r?(0,m.x0)(t,n,(0,u.a)(r)):[]}function y(e,t,n,d,c,f,p){var g,C;if(!l.rR()){if(c&&p===e)return{thread:[c.newComment_deprecated],isDraftThread:!0,draftThreadState:f};(0,s.i7)().assertConditionTag(!f||!f.isInCurrentContext||"CREATE"!==f.commentDraft.sessionConfiguration.sessionType,"Bad Store State, missing lie for new draft requested.",579372370)}var h=d||e,v=(0,m.x0)(t,n,h);v.length>0&&void 0===(0,u.j)(v[0])&&(null===(C=(g=(0,s.i7)()).logDiagnosticTrace)||void 0===C||C.call(g,(0,a.D)(r||(r=(0,o.__makeTemplateObject)(["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."],["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."]))),i.m2.reserveTag(540575834),s.AI.Info,s.b5.ProductServiceUsage,(0,s.t4)(s.ZK.ReviewedAsNotNecessary)),v=[]);var y=l.rR()&&p===h;return{thread:v,isDraftThread:y,draftThreadState:y?f:void 0}}function T(e,t,n,r,o){if(t.draftThreadState)return t.draftThreadState.renderContextType===C.A.None||t.draftThreadState.renderContextType===r?d.z6.Enabled_ForcePrimary:d.z6.Disabled;if(t.isDraftThread||t.thread.length>0)return o===g.V.InCard||o===g.V.InChildPost?d.z6.Enabled_ForcePrimary:d.z6.Enabled_Default;if((0,f.dl)(n))return d.z6.Disabled;var i=(0,m.rB)(n);return i&&i.threadId===e?d.z6.Disabled:d.z6.Invalid}},39760:function(e,t,n){"use strict";n.d(t,{E:function(){return i},r:function(){return o}});var r=n(75847);function o(){var e=document.getElementById(r.E4());e&&e.focus()}function i(e){if(e&&e.target){var t=e.target.closest(".ql-editor");null!==t&&"true"===t.contentEditable||e.preventDefault()}}},55925:function(e,t,n){"use strict";function r(){return"web"}n.d(t,{u:function(){return r}})},76404:function(e,t,n){"use strict";n.d(t,{O:function(){return a}});var r=n(77042),o=n(22245),i=n(44579);function a(e){switch(e){case o.A.HalfPane:return i.A.HalfPane;case o.A.FullPane:return i.A.FullPane;default:(0,r.HB)(e)}}},9749:function(e,t,n){"use strict";n.d(t,{pZ:function(){return o},qD:function(){return i}});var r=n(44579);function o(e){return e===r.A.FullPane||e===r.A.HalfPane}function i(e){return e===r.A.DiscreteIntegrated||e===r.A.DiscreteIsolated}},89805:function(e,t,n){"use strict";n.d(t,{As:function(){return R},Ee:function(){return x},OX:function(){return P},SS:function(){return _},X9:function(){return T},Yv:function(){return S},ae:function(){return k},eu:function(){return A},fp:function(){return E},j_:function(){return b},oO:function(){return D},oy:function(){return w},ze:function(){return I}});var r=n(90853),o=n(77042),i=n(65203),a=n(5402),s=n(99381),d=n(81199),c=n(50577),u=n(75789),l=n(88652),m=n(94344),f=n(81913),p=n(45680),g=n(94828),C=n(43357),h=n(89454);function v(e,t,n){for(var r=t;r<e.length;++r)if(e[r].commentId===n.commentId)return r;return-1}function y(e,t,n,r,o,a){for(var s=[],d=t,c=o;d<=n&&c<=a;){var u=e[d].date;(0,i.i7)().assertConditionTag(!!u,"commentDate should not be undefined",595719177),!u||u<=r.history[c].records[0].time?((0,i.i7)().assertConditionTag(e[d].parentId===r.commentId,"comments must belong to the same thread",595719173),s.push({commentModel:e[d]}),++d):((0,i.i7)().assertConditionTag(!r.history[c].commentId,"Unanchored history item should not have commentId",595719178),s.push({historyItem:r.history[c],parentThreadId:r.commentId}),++c)}for(;d<=n;++d)s.push({commentModel:e[d]});for(;c<=a;++c)(0,i.i7)().assertConditionTag(!r.history[c].commentId,"Unanchored history item should not have commentId",595719179),s.push({historyItem:r.history[c],parentThreadId:r.commentId});return s}function T(e,t){if(!m.$H()||!t||0===t.history.length)return e.map((function(e){return{commentModel:e}}));var n=!0;if(m.T$()||t.commentId===t.history[0].commentId||((0,i.i7)().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),n=!1),e[0].commentId!==t.commentId&&((0,i.i7)().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),n=!1),!n)return e.map((function(e){return{commentModel:e}}));var o=[];m.T$()||o.push({commentModel:e[0],historyItem:t.history[0]});for(var a=m.T$()?0:1,s=m.T$()?0:1,d=m.T$()?0:1;a<e.length&&d<t.history.length;){var c=v(e,a,t.history[d]);c>=0&&(o.push.apply(o,(0,r.__spreadArray)([],(0,r.__read)(y(e,a,c-1,t,s,d-1)),!1)),(0,i.i7)().assertConditionTag(0===c||e[c].parentId===t.commentId,"comments must belong to the same thread",595719175),o.push({commentModel:e[c],historyItem:t.history[d]}),a=c+1,s=d+1),++d}return o.push.apply(o,(0,r.__spreadArray)([],(0,r.__read)(y(e,a,e.length-1,t,s,t.history.length-1)),!1)),o}function I(e,t,n,o){var a=[];if((0,g._A)(n))(0,g.x2)(e)?e.forEach((function(e){a.push.apply(a,(0,r.__spreadArray)([],(0,r.__read)(T((0,f.x0)(n,t,e),o[e])),!1))})):(0,i.i7)().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515151);else for(var d=0,c=1;c<=n.length;c++)(c===n.length||(0,s.j)(n[c]))&&(a.push.apply(a,(0,r.__spreadArray)([],(0,r.__read)(T(n.slice(d,c),o[n[d].commentId])),!1)),d=c);return a}function S(e,t,n,o,i,a){var d=[];if(0===e.length)return d;if((0,g._A)(n))e.forEach((function(e){d.push.apply(d,(0,r.__spreadArray)([],(0,r.__read)(T((0,f.x0)(n,t,e.contentId),o[e.contentId])),!1))}));else for(var c=0,u=0,l=function(e,t,n,r){return e<t.length&&!!(0,s.j)(t[e])&&-1===n&&t[e].commentId===r};c<e.length&&!((null==i?void 0:i.newComment_deprecated)&&e[c].contentId===(0,f.tN)(a,!0)&&(d.push({commentModel:i.newComment_deprecated}),++c>=e.length));){for(var m=-1,p=0;p<=n.length;p++)if(l(p,n,m,e[c].contentId))m=p;else if(-1!==m&&(p===n.length||(0,s.j)(n[p]))){if(d.push.apply(d,(0,r.__spreadArray)([],(0,r.__read)(T(n.slice(m,p),o[n[m].commentId])),!1)),++c>=e.length)break;l(p,n,m=-1,e[c].contentId)&&(m=p)}u===c&&c++,u=c}return d}function A(e,t){var n=e.find((function(e){return(0,C.d)(e)&&e.commentModel.commentId===t}));if((0,C.d)(n))return n.commentModel}function _(e){var t=e[0];if((0,C.d)(t))return t.commentModel;throw new u.cP(l.Yn,o.m2.reserveTag(589103627),2130957505)}function D(e){return(0,C.d)(e)?e.commentModel.parentId:e.parentThreadId}function E(e,t){return"".concat(e,"__").concat(t)}function P(e){return(0,C.d)(e)?e.commentModel.commentId:E(e.historyItem.taskId,e.historyItem.records[0].recordId)}function x(e){return(0,C.d)(e)?(0,s.a)(e.commentModel):e.parentThreadId}function b(e,t){var n=[],r=e.records[0];switch(r.type){case d.w.Create:case d.w.UnassignAll:for(var o=[],a=1;a<e.records.length;a++)(u=e.records[a]).type===d.w.Assign&&o.push((0,c.TO)(u.assignee));n.push({icon:13,description:(0,h.LU)(t,!0,o)});break;case d.w.Assign:case d.w.Unassign:o=[];var s=[];for(a=0;a<e.records.length;a++){var u;if((u=e.records[a]).type!==d.w.Assign&&u.type!==d.w.Unassign)return(0,i.i7)().assertConditionTag(!1,"Unexpected HistoryRecordType.",528064847),[{icon:0,description:t.getString(119)}];u.type===d.w.Assign?o.push((0,c.TO)(u.assignee)):s.push((0,c.TO)(u.assignee))}o.length>0&&n.push({icon:13,description:(0,h.LU)(t,!0,o)}),s.length>0&&n.push({icon:13,description:(0,h.LU)(t,!1,s)});break;case d.w.Progress:return 100===r.completion?[{icon:15,description:t.getString(116)}]:[{icon:21,description:t.getString(117)}];case d.w.Schedule:return[{icon:17,description:t.getString(118)}];default:return(0,i.i7)().assertConditionTag(!1,"Unexpected HistoryRecordType",527759317),[{icon:0,description:t.getString(119)}]}return 0===n.length&&n.push({icon:0,description:t.getString(119)}),n}function k(e,t){return e.findIndex((function(e){return e.length>0&&x(e[0])===t}))}function w(e,t){return e.some((function(e){return(0,C.d)(e)&&!!(e.commentModel.commentFlags&a.PJ.LowFidelity)&&(void 0===t||t===(0,s.a)(e.commentModel))}))}function R(e,t,n,r,o){for(var a=[],s=!m.rR()&&!o&&void 0!==n,d=-1,c=-1,u=0;u<e.length;u+=1){var l=e[u],f=(0,C.d)(l)?l:void 0;if(f&&void 0!==t[f.commentModel.commentId])if(t[f.commentModel.commentId].pending===p.q.Delete&&r)for((0,C.d)(l)&&++c;!(u+1>=e.length||""===D(e[u+1]));)++u,(0,C.d)(e[u])&&++c;else{++c,a.push([f]),s&&c===(null==n?void 0:n.flatIndex)&&(d=a.length-1);for(var g=u+1;g<e.length;g+=1){if(l=e[g],(0,C.d)(l)){var h=D(l);if(h!==f.commentModel.commentId){(0,i.i7)().assertConditionTag(!h,"Orphaned reply",593085889);break}a[a.length-1].push(l),++c}else a[a.length-1].push(l);++u}}else for((0,i.i7)().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: ".concat(e.length," | cardViewStateLength: ").concat(Object.keys(t).length," | insertingThreadLie: ").concat(s),593085888),(0,C.d)(l)&&++c;!(u+1>=e.length||""===D(e[u+1]));)++u,(0,C.d)(e[u])&&++c}return s&&n&&(-1!==d?a.splice(d,0,[{commentModel:n.newComment_deprecated}]):((0,i.i7)().assertConditionTag(n.flatIndex>c,"Failed to find insertion point for lie in getAllRenderableItemThreads",529094429),n.flatIndex===c+1&&a.push([{commentModel:n.newComment_deprecated}]))),a}},65030:function(e,t,n){"use strict";n.d(t,{ap:function(){return s},ey:function(){return c},jB:function(){return d},uL:function(){return u}});var r=n(65203),o=n(10827),i=n(55309),a=n(95187);function s(e){return void 0!==e&&0!=(e.commentFlags&o.PJ.Resolved)}function d(e){return e!==a.A.Canvas}function c(e){return(0,i.shouldSelectActionExpandCard)(e)}function u(e,t){e.addDataField("IsCommentResolved",t,r.LG.SystemMetadata)}},3414:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var r=n(90853),o={WHITE:"#FFFFFF",BLACK:"#000000",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",Gray26:"#424242",Gray90:"#E5E5E5",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},i={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#B3B0AD",FOCUS_BOX:"#797775",DOT_BLUE:"#006BFF",REST_RESOLVED_BODY:o.GRAY_20,RESOLVED_CARD_TEXT:o.GRAY_130,ACTIVE_COMMENT_TEXT:o.GRAY_H2,SUGGESTED_PICKER_ITEM:"#DEECF9",SUGGESTED_PICKER_ITEM_HOVER:"#C7E0F4"},a=(0,r.__assign)((0,r.__assign)({},o),i)},61197:function(e,t,n){"use strict";n.d(t,{K1:function(){return v},Rl:function(){return u},TQ:function(){return p},WA:function(){return x},XD:function(){return g},Zt:function(){return A},_q:function(){return E},aQ:function(){return _},fC:function(){return f},gx:function(){return y},md:function(){return D},td:function(){return m},vC:function(){return P},wv:function(){return l},x9:function(){return S}});var r,o,i,a,s,d=n(35566),c=n(3414),u=1e3,l="2px",m="4px",f="@media screen and (-ms-high-contrast: active), (forced-colors: active)",p={content:'""',position:"absolute",left:-1,top:-1,bottom:-1,right:-1,border:0,outline:"none",zIndex:1},g={BUTTON_HOVER:"#F3F2F1",BUTTON_SELECT:"#E1DFDD",BUTTON_DOWN:"#D2D0CE",BUTTON_DISABLED:"#FAF9F8",HIGH_CONTRAST:{BUTTON_FOCUS:"highlight"}},C=((r={forcedColorAdjust:"auto",MsHighContrastAdjust:"auto"})[f]={color:"revert",stroke:"revert"},r);function h(e){return(0,d.Zq)(e,C)}var v={selectors:(o={},o[d.up]={backgroundColor:"Highlight",color:"HighlightText",borderColor:"WindowText",MsHighContrastAdjust:"none",selectors:{"svg > path":{fill:"HighlightText"}}},o)},y=(0,d.Zq)(v,{selectors:(i={},i[d.up]={outline:"2px",outlineOffset:"-2px"},i)}),T=(0,d.Zq)({selectors:(a={},a[d.up]={outline:"2px",outlineOffset:"-2px"},a)}),I=(0,d.Zq)(((s={})[f]={color:"ButtonText"},s)),S=function(e){void 0===e&&(e={});var t={rootHovered:h(y),rootFocused:h(v),rootDisabled:h(T),icon:h(I)};return(0,d.l8)(e,t)};function A(e){var t;return(0,d.l8)(e,{root:(t={},t[d.up]={color:"ButtonText"},t)})}var _={LEVEL1:"0px 1px 2px 0px rgba(0,0,0,0.10)",LEVEL2:"0px 2px 4px 0px rgba(0,0,0,0.10)",LEVEL3:"0px 4px 8px 0px rgba(0,0,0,0.10)",LEVEL4:"0px 8px 16px 0px rgba(0,0,0,0.10)",LEVEL5:"0px 16px 24px 0px rgba(0,0,0,0.10)"},D='"Segoe UI"',E='"Segoe UI Web"',P='"Segoe UI Semibold"';function x(e,t,n){var r,o;return!e||t?null!==(r=null==n?void 0:n.CardBackground)&&void 0!==r?r:c.x.WHITE:null!==(o=null==n?void 0:n.ResolvedCardBackground)&&void 0!==o?o:c.x.REST_RESOLVED_BODY}},9368:function(e,t,n){"use strict";n.d(t,{$C:function(){return m},HP:function(){return u},_u:function(){return l},im:function(){return d}});var r=n(13163),o=n(35566),i=n(93339),a=n(56704),s=n(61197),d={TASK_ASSIGNER_CHECKED_BOX:"#605E5C",TASK_BORDER_FOCUS:"#797775",TASK_BORDER:"#252423",TASK_CHECKBOX_COLOR:"#31752F",TASK_CHECKBOX_COLOR_COMPLETED_HOVER:"#255924",TASK_CHECKMARK_COLOR:"#31752F",TASK_DISABLED:"#A19F9D",TASK_TEXT:"#252423"},c="14px",u="10px",l=(0,r.J9)((function(e,t){var n,r,u,l=(0,o.Zq)(!t&&{color:d.TASK_TEXT,selectors:{":hover":{selectors:{".ms-Checkbox-text":(0,o.Zq)({color:d.TASK_TEXT,selectors:(n={},n[o.up]={color:"HighlightText"},n)},e&&{color:(0,a.uR)().primary})}}}}),m={alignItems:"center",border:"1px solid transparent",borderRadius:"3px",borderSpacing:"2px",height:"16px",overflow:"hidden",padding:"3px",selectors:(r={":hover":s.K1},r[o.up]={color:"ButtonText"},r)},f=(0,o.Zq)({borderRadius:s.wv,boxSizing:"content-box",height:c,textAlign:"center",width:c},t&&{borderColor:d.TASK_DISABLED}),p={selectors:(u={},u[".".concat(i.Y2," &:focus + .ms-Checkbox-label:before")]={outline:"none"},u[".".concat(i.Y2," &:focus + .ms-Checkbox-label")]={borderColor:d.TASK_BORDER_FOCUS},u[".".concat(i.Y2," &:focus + label")]=s.gx,u[".".concat(i.Y2," &:focus + label .ms-Checkbox-text")]=s.gx,u)};return(0,o.l8)({root:l,label:m,checkbox:f,input:p})})),m=(0,r.J9)((function(){return{CHECKMARK_ICON_TOPPER:{iconName:"TaskStatusCircleCheckmark",style:{height:"7px",width:"10px",transform:"translateY(-7.5px)"}},CHECKMARK_ICON_ASSIGNER:{iconName:"TaskStatusCircleCheckmark",style:{height:"10px",transform:"translateY(-1px)",width:"14px"}}}}))},68083:function(e,t,n){"use strict";n.d(t,{MD:function(){return s},hG:function(){return a},tM:function(){return d}});var r=n(90853),o=n(20903),i=n(50577),a=100;function s(e){return e===a}function d(e,t){var n=(0,r.__assign)({},t);(0,i.UO)(n,e);var a=[];Object.keys(n).forEach((function(e){var t=n[e].assignee;(0,o.b2)(t)||a.push(t)}));var s=t?e.filter((function(e){return void 0===t[(0,i.k4)(e)]})):(0,r.__spreadArray)([],(0,r.__read)(e),!1);if(0!==a.length||0!==s.length)return{assigneesToAdd:a,assigneesToRemove:s}}},43357:function(e,t,n){"use strict";function r(e){return!!e&&!!e.commentModel}function o(e){return!!e&&!!e.historyItem}n.d(t,{d:function(){return r},m:function(){return o}})},64019:function(e,t,n){"use strict";n.d(t,{Gz:function(){return i},ac:function(){return o},qi:function(){return d},sN:function(){return r},vk:function(){return s},yA:function(){return a}}),n(77042),n(75789);var r,o=function(){function e(){this.ops=[]}return e.prototype.insert=function(e,t,n){return this.ops.push({insert:e,attributes:t,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();function i(e,t,n){return{fullName:e,email:t,resolveState:n}}function a(e){return{atmention:{contentId:e.contentId,isCurrentUser:e.isCurrentUser,directoryId:e.directoryId}}}function s(e){return d(JSON.parse(e))}function d(e){return e.ops?e.ops.map((function(e){return e.insert})).join(""):""}!function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(r||(r={}))},85526:function(e,t,n){"use strict";n.d(t,{KX:function(){return o},Ue:function(){return i},Wl:function(){return r}});var r="sharedcommentsdemo"==={NODE_ENV:"production"}.TEST_PAGE,o=!1,i=void 0!=={NODE_ENV:"production"}.JEST_WORKER_ID?"JEST_TEST_ID":void 0},95886:function(e,t,n){"use strict";n.d(t,{Nh:function(){return c},dq:function(){return d},uo:function(){return s}});var r=n(77042),o=n(65203),i=n(55925),a=!1;function s(){var e=void 0;return a||(e=(0,o.i7)().createActivityObject("LPPLazyLoad",(0,o.t4)(o.ZK.GlobalAPI),(0,o.Zx)()),a=!0),u((function(){return Promise.all([n.e(2076),n.e(3243),n.e(1451)]).then(n.bind(n,43245))}),e).then((function(t){return e&&e.successTag(528282444),t}),(function(t){e&&e.failTag(528282445,-2130957488),a=!1}))}function d(e){var t,i=(0,o.i7)().createActivityObject("SharedCommentsUILazyLoad",(0,o.t4)(o.ZK.GlobalAPI),(0,o.Zx)());switch(i.addDataField("ContainerName",e,o.LG.SystemMetadata),e){case"ExtensionAwareCommentPaneContainer":t=u((function(){return Promise.all([n.e(2076),n.e(3243),n.e(7196)]).then(n.bind(n,26056))}),i);break;case"HostableCommentCardRendererContainer":t=u((function(){return Promise.all([n.e(2076),n.e(3243),n.e(7196)]).then(n.bind(n,65766))}),i);break;default:(0,r.HB)(e)}return t.then((function(e){return i.successTag(595731075),e}),(function(e){i.failTag(595734544,-2130957504)}))}function c(){var e=(0,o.i7)().createActivityObject("ImmerEs5PluginDelayLoad",(0,o.t4)(o.ZK.GlobalAPI),(0,o.Zx)());return"undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect?(e.successTag(526254848),Promise.resolve(void 0)):((0,o.i7)().assertConditionTag("web"===(0,i.u)(),"Native should not need to support the ES5 fallback and Immer reducers will fail",526254849),u((function(){return n.e(8997).then(n.bind(n,86663))}),e).then((function(t){return e&&e.successTag(526254850),t}),(function(t){e&&e.failTag(526254851,-2130957484)})))}function u(e,t,n){return void 0===n&&(n=3),new Promise((function(r,i){e().then((function(e){t&&t.addDataField("DelayLoadRetryCount",n,o.LG.SystemMetadata),r(e)}),(function(o){setTimeout((function(){1!==n?u(e,t,n-1).then(r,i):i(o)}),500)}))}))}},20061:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var r=n(65203),o=!1;function i(){var e;return o||(e=(0,r.i7)().createActivityObject("AtMentionLazyLoad",(0,r.t4)(r.ZK.GlobalAPI),(0,r.Zx)()),o=!0),Promise.all([n.e(2076),n.e(3243),n.e(1968)]).then(n.bind(n,25491)).then((function(t){return e&&e.successTag(507510881),t})).catch((function(t){e&&e.failTag(507510880,-2130957515),o=!1}))}},69084:function(e,t,n){"use strict";n.d(t,{L:function(){return a}});var r=n(77042),o=n(65203),i=n(75789),a=function(e){return function(t){(0,i.Ir)(t)?(0,o.i7)().assertConditionTag(!1,t.message,e):(0,o.i7)().assertConditionTag(!1,"Unknown error ".concat((0,r.M5)(t)),e)}}},75789:function(e,t,n){"use strict";n.d(t,{Ir:function(){return s},cP:function(){return a}});var r=n(90853),o=n(77042),i="CommentError",a=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.tag=n,o.errorCode=r,o.name=i,o}return(0,r.__extends)(t,e),t.prototype.stringify=function(){return(0,o.Mw)(this.tag,this.stack,"Error ".concat((e=this.errorCode)>4294967295||e<-4294967296?"dword_out_of_range(".concat(e,")"):"0x".concat((e<0?4294967295+e+1:e).toString(16))),this.innerException);var e},t}(o.mU);function s(e){return(0,o.Ar)(e,i)}},31236:function(e,t,n){"use strict";n.d(t,{E:function(){return i}});var r=n(75789),o=n(5627);function i(e,t){return(0,r.Ir)(e)?e.errorCode:(0,o.G)(e)?e.SDXHostAPIErrorCode:void 0===t?-2147467259:t}},88652:function(e,t,n){"use strict";n.d(t,{DK:function(){return i},Ft:function(){return p},Hf:function(){return c},IT:function(){return u},LR:function(){return o},MS:function(){return s},Mb:function(){return m},WR:function(){return l},Yn:function(){return g},bn:function(){return a},w3:function(){return d},wy:function(){return r},yC:function(){return f}});var r="Selected comment not found",o="Selected thread index out of bounds",i="Invalid number of posts for display more replies string",a="Unrecognized post display mode",s="Method not implemented",d="StringId is invalid",c="LocalizationModule NativeModule not valid",u="Store state unexpected",l="Editor reference is invalid",m="Invalid arguments",f="Comment ID value is invalid in the current operation",p="Attempting to perform an operation on an inactive draft",g="CommentModel not found in a thread of RenderableItems"},5627:function(e,t,n){"use strict";function r(e){return"object"==typeof e&&void 0!==e.message&&void 0!==e.SDXHostAPIErrorCode}n.d(t,{G:function(){return r}})},91294:function(e,t,n){"use strict";n.d(t,{i:function(){return s}});var r,o=n(77042),i=n(55777),a=n(75789);function s(){if(!r)try{r=(0,i.A7)()}catch(e){throw new a.cP("FeatureGateAPI not initialized",o.m2.reserveTag(589103629),-2130957531)}return r}},94344:function(e,t,n){"use strict";n.d(t,{b:function(){return b},$H:function(){return h},T$:function(){return y},Hp:function(){return I},i6:function(){return U},bq:function(){return P},yk:function(){return te},IU:function(){return ee},UJ:function(){return S},hd:function(){return M},kG:function(){return B},cb:function(){return c},wQ:function(){return H},K_:function(){return F},W2:function(){return g},cg:function(){return V},qh:function(){return A},h_:function(){return q},Ff:function(){return T},lg:function(){return N},m6:function(){return k},u_:function(){return m},aZ:function(){return w},No:function(){return L},$7:function(){return D},Rs:function(){return G},Fr:function(){return p},dh:function(){return u},pT:function(){return f},t8:function(){return l},GZ:function(){return E},dT:function(){return _},IF:function(){return v},$M:function(){return R},Om:function(){return W},jK:function(){return Z},y5:function(){return $},Ww:function(){return X},c5:function(){return z},HX:function(){return J},XW:function(){return K},cY:function(){return j},yp:function(){return C},Eu:function(){return Q},Vb:function(){return Y},rR:function(){return O},S:function(){return x}});var r=n(55777),o=n(55925),i=n(91294),a=n(65203),s=n(88836);function d(e,t){var n,r,c;void 0===t&&(t=new Set);var u=s.i[e].hardcodedPlatforms;if(u){var l=(0,o.u)();if(null===(n=u.enabled)||void 0===n?void 0:n.includes(l))return!0;if(null===(r=u.disabled)||void 0===r?void 0:r.includes(l))return!1}return!!(0,i.i)().isFeatureEnabled(e)&&(t.add(e),(null!==(c=s.i[e].dependencies)&&void 0!==c?c:[]).every((function(n){var r=t.has(n)||d(n,t);return(0,a.i7)().assertConditionTag(r,"Gate ".concat(e," enabled without dependency gate ").concat(n),544482649),r})))}function c(){return"android"!==(0,o.u)()}function u(){return"android"!==(0,o.u)()}function l(){return"win32"===(0,o.u)()}function m(){return d("LivePersonaPicker")}function f(){return d("PersonaFeature")}function p(){return d("NewCommentButton")}function g(){return d("DiscreteHostedComments")}function C(){return d("RenderDHCInPane")}function h(){return d("CommentTasks")}function v(){return d("TaskPaneWithNewInfrastructure")}function y(){return d("CommentTasksFromReply")}function T(){return d("HeadlessBoot")}function I(){return d("HyperlinksInComments")}function S(){return d("AtMentionFloodgateSurvey")}function A(){return d("ExtendedDrafting")}function _(){return d("RichTextFormattingInWeb")}function D(){return d("LogDraftCommentIdPair")}function E(){return d("RichContentEditIntegrationInWeb")}function P(){return d("SmartReplies")}function x(){return d("NewSelectionInteractions")}function b(){return d("CommentReactions")}function k(){return d("HyperlinksWithDisplayText")}function w(){return d("LinkToComment")}function R(){return d("TruncationUIWithReadMoreText")}function F(){return d("CtrlEnterTip")}function N(){return d("HighlightsAndFontColorInWebComments")}function M(){return d("AtMentionHintMessage")}function L(){return d("LivePersonaCardForWeb")}function O(){return d("MapBasedStore")}function B(){return d("CommentTasksMultiAssignCreation")}function V(){return d("DraftSessionRehydration")}function U(){return d("ListsInWebComments")}function H(){return d("ConsumerEmailLPPEnabled")}function G(){return!1}function z(){return(0,i.i)().isChangeGateEnabled("DelayLoadImmerES5",(0,r.LO)(6051195))}function q(){return(0,i.i)().isChangeGateEnabled("FontColorHighlightCacheFix",(0,r.LO)(8726484))}function W(){return(0,i.i)().isChangeGateEnabled("V9NewCommentButtonV2",(0,r.LO)(8158869))}function Y(){return(0,i.i)().isChangeGateEnabled("DraftWarningGrantAccessA11yFix",(0,r.LO)(8597870))}function j(){return(0,i.i)().isChangeGateEnabled("RemoveAppSettingsAssert",(0,r.LO)(8674451))}function X(){return(0,i.i)().isChangeGateEnabled("SelectedCommentIsRenderable",(0,r.LO)(8705077))}function K(){return(0,i.i)().isChangeGateEnabled("RegroupResolutionContentInFilterMenu",(0,r.LO)(8747116))}function $(){return(0,i.i)().isChangeGateEnabled("FilterCountAnnouncement",(0,r.LO)(8646901))}function Z(){return(0,i.i)().isChangeGateEnabled("WebHCHeaderMargin",(0,r.LO)(8773883))}function J(){return(0,i.i)().isChangeGateEnabled("FocusManagerFilterAware",(0,r.LO)(8819082))}function Q(){return(0,i.i)().isChangeGateEnabled("StripImageContentOnPaste",(0,r.LO)(8832065))}function ee(){return $()&&(0,i.i)().isChangeGateEnabled("FixContentFilterHooksState",(0,r.LO)(8900653))}function te(){return(0,i.i)().isChangeGateEnabled("EscCloseV9Menus",(0,r.LO)(8981228))}},88836:function(e,t,n){"use strict";n.d(t,{i:function(){return r}});var r={LivePersonaPicker:{webSettingName:"LivePersonaPicker",hardcodedPlatforms:{enabled:["win32","android"]}},PersonaFeature:{webSettingName:"PersonaColor"},NewCommentButton:{webSettingName:"NewCommentButton",hardcodedPlatforms:{enabled:["win32"]}},DiscreteHostedComments:{hardcodedPlatforms:{enabled:["web"],disabled:["android"]}},RenderDHCInPane:{},CommentTasks:{webSettingName:"CommentTasks",hardcodedPlatforms:{disabled:["android"]}},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure"},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply",dependencies:["CommentTasks"]},HeadlessBoot:{},HyperlinksInComments:{webSettingName:"HyperlinksInComments"},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText"},ContentNavigation:{webSettingName:"ContentNavigation"},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey"},ExtendedDrafting:{webSettingName:"ExtendedDrafting",hardcodedPlatforms:{disabled:["android"]}},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb"},SmartReplies:{webSettingName:"SmartReplies"},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair",hardcodedPlatforms:{enabled:["win32","android"]}},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration"},NewSelectionInteractions:{webSettingName:"NewSelectionInteractions"},CommentReactions:{webSettingName:"CommentReactions"},LinkToComment:{webSettingName:"LinkToComment"},TruncationUIWithReadMoreText:{webSettingName:"TruncationUIWithReadMoreText"},CtrlEnterTip:{webSettingName:"CtrlEnterTip",hardcodedPlatforms:{enabled:["win32"],disabled:["android"]}},FluentSVRefreshWin32:{},HighlightsAndFontColorInWebComments:{webSettingName:"HighlightsAndFontColorInWebComments",dependencies:["RichContentEditIntegrationInWeb"]},AtMentionHintMessage:{webSettingName:"AtMentionHintMessage"},LivePersonaCardForWeb:{webSettingName:"LivePersonaCardForWeb"},MapBasedStore:{webSettingName:"MapBasedStore"},ContentFiltering:{},CommentTasksMultiAssignCreation:{webSettingName:"CommentTasksMultiAssignCreation",dependencies:["CommentTasks","CommentTasksFromReply"]},DraftSessionRehydration:{webSettingName:"DraftSessionRehydration"},ConsumerEmailLPPEnabled:{webSettingName:"ConsumerEmailLPPEnabled"},ListsInWebComments:{webSettingName:"ListsInWebComments",dependencies:["RichContentEditIntegrationInWeb"]}}},91619:function(e,t,n){"use strict";n.d(t,{e1:function(){return s},xL:function(){return d}});var r=n(67937),o=n(35566),i=n(76149),a=n(94344);function s(e){var t=n(65755),o=n(83778),s=(0,r.jI)()?n(4532):n(73594),d=n(26800),c=n(55427),u=n(6442),l=n(23230),m=n(48621),f=n(22918),p=n(2802),g=n(33837),C=n(93625),h=n(14476),v={HintBarEllipses_16:i.createElement(t,null),CancelGlyph:i.createElement(o,null),NewComment:i.createElement(s,null),CancelGlyph_TaskPane:i.createElement(d,null),Send2_Fluent:i.createElement(c,null),Delete_Fluent:i.createElement(u,null),Edit_Fluent:i.createElement(l,null),Checkmark_Fluent:i.createElement(m,null),CommentReopen_Fluent:i.createElement(f,null),Error:i.createElement(p,null),ReopenThread:i.createElement(g,null),DeleteFilter:i.createElement(C,null),DeleteFilterDefault:i.createElement(h,null)};if(e||a.$H()){var y=n(97510),T=n(16384),I=n(79872),S=n(97357),A=n(33837),_=n(31391),D=n(42188);v.TaskAssign=i.createElement(y,null),v.TaskComplete=i.createElement(T,null),v.TaskDelete=i.createElement(I,null),v.TaskEdit=i.createElement(S,null),v.TaskReopen=i.createElement(A,null),v.TaskStatusCircleCheckmark=i.createElement(_,null),v.ChevronDown12=i.createElement(D,null)}if(e||a.b()){var E=n(9931),P=n(33925);v.CommentLikeEmpty=i.createElement(E,null),v.CommentLikeSolid=i.createElement(P,null)}if(e||a.aZ()){var x=n(29506);v.LinkToComment=i.createElement(x,null)}return{icons:v}}function d(e){(0,o.K1)(s(e))}},21861:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=n(24779).SharedCommentsVersion},51346:function(e,t,n){"use strict";n.d(t,{A:function(){return o},V:function(){return i}});var r=n(90853);function o(e,t){return(0,r.__assign)((0,r.__assign)({},e),{trackback:t})}function i(e,t,n){return{type:e,payload:t,actionDetail:n}}},95187:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o}}),function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"}(r||(r={}));const o=r},70055:function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("ADD_CONTENT_EXTENSION",{extension:t},e)}},82854:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(51346);function o(e,t,n){return(0,r.V)("BEGIN_DRAFTING_FAILURE",{beginDraftingParams:t,errorInfo:n},e)}},11163:function(e,t,n){"use strict";n.d(t,{y:function(){return o}});var r=n(51346);function o(e,t,n,o){return(0,r.V)("BEGIN_DRAFTING_SUCCESS",{draftDetails:t,draftRenderContextType:n,rehydratedDraftParams:o},e)}},84809:function(e,t,n){"use strict";n.d(t,{e:function(){return o}});var r=n(51346);function o(e){return(0,r.V)("BEGIN_PROCESSING_COMMIT",{},e)}},70648:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(51346);function o(e){return(0,r.V)("BEGIN_PROCESSING_DISCARD",{},e)}},16610:function(e,t,n){"use strict";n.d(t,{p:function(){return o}});var r=n(51346);function o(e){return(0,r.V)("BEGIN_VIEW_INIT",{},e)}},34554:function(e,t,n){"use strict";n.d(t,{D:function(){return o}});var r=n(51346);function o(e){return(0,r.V)("CANCEL_DISCARD",{},e)}},64160:function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var r=n(51346);function o(e,t,n){return(0,r.V)("CLEAR_COMMENT_HIGHLIGHT",{actionSource:t,commentId:n},e)}},13266:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var r=n(51346);function o(e){return(0,r.V)("CLEAR_COMMENT_SELECTION",{},e)}},17986:function(e,t,n){"use strict";n.d(t,{B:function(){return i},f:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("COMMIT_DRAFT",t,e)}function i(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}},8143:function(e,t,n){"use strict";n.d(t,{M:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("COMMIT_FAILURE",{commitText:t},e)}},69349:function(e,t,n){"use strict";n.d(t,{u:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("DISPLAY_DRAFT_WARNING",e,t)}},48581:function(e,t,n){"use strict";n.d(t,{M:function(){return s},j:function(){return d}});var r=n(77042),o=n(65203),i=n(44579),a=n(51346);function s(e){return(0,a.V)("",{},e)}var d=s({renderContextType:i.A.None,telemetryVisitor:(0,o.t4)(o.ZK.ReviewedAsNotNecessary),trackback:r.m2.reserveTag(595735680)})},67534:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var r=n(51346);function o(e){return(0,r.V)("END_VIEW_INIT",{},e)}},3133:function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var r=n(51346);function o(e,t,n){return(0,r.V)("HIGHLIGHT_COMMENT",{commentId:t,actionSource:n},e)}},55499:function(e,t,n){"use strict";n.d(t,{s:function(){return o}});var r=n(51346);function o(e,t,n){return(0,r.V)("LOAD_COMMENT",{commentData:t,tasks:n},e)}},79318:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("LOAD_PERSONA_ICON_PROPERTIES",{personaIconPropertiesMap:t},e)}},38761:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("VIRTUALIZE_COMMENTS",{threadInfo:t},e)}},34067:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("RELOAD_COMMENTS",t,e)}},41943:function(e,t,n){"use strict";n.d(t,{E:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("RESOLVE_ATMENTION_CAPABILITY",{capability:t},e)}},1534:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("SAVE_DRAFT",t,e)}},30387:function(e,t,n){"use strict";n.d(t,{G7:function(){return i},V9:function(){return r},un:function(){return a}});var r,o=n(51346);function i(e){switch(e){case r.SelectCard:case r.Polite:return!1;case r.ExpandCard:case r.SelectPost:return!0}}function a(e,t,n,r,i){return(0,o.V)("SELECT_COMMENT",{selectedCard:t,selectedPost:n,selectType:r,source:i},e)}!function(e){e[e.ExpandCard=0]="ExpandCard",e[e.SelectCard=1]="SelectCard",e[e.SelectPost=2]="SelectPost",e[e.Polite=3]="Polite"}(r||(r={}))},74444:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(51346);function o(e,t,n){return(0,r.V)("SESSION_REQUEST_STARTED",{params:t,captureSelectedThreadIdBeforeSession:n},e)}},97793:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(51346);function o(e,t,n){return(0,r.V)("SHOW_LOW_FIDELITY_WARNING",{commentId:t,lowFidelityWarningType:n},e)}},91256:function(e,t,n){"use strict";n.d(t,{T:function(){return w}});var r=n(77042),o=n(65203),i=n(71318),a=n(15964),s=n(73588),d=n(30564),c=n(6759),u=n(44579),l=n(76404),m=n(9749),f=n(20061),p=n(69084),g=n(75789),C=n(31236),h=n(88652),v=n(94344),y=n(81913),T=n(20478),I=n(85844),S=n(29273),A=n(51346),_=n(95187),D=n(82854),E=n(11163),P=n(48581),x=n(74444),b=n(67177),k=n(7692);function w(e,t,n,w,R,F){return function(N,M){var L=M(),O=(0,o.i7)().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,(0,o.Zx)()),B=s.ce[n.sessionType];return O.addDataField("SessionType",B,o.LG.SystemMetadata),O.addDataField("Trackback",e.trackback,o.LG.SystemMetadata),O.addDataField("RenderContextType",e.renderContextType,o.LG.SystemMetadata),O.addDataField("PaneVisibilityState",S.vL(L),o.LG.SystemMetadata),v.$H()||n.sessionType!==a.q3?(I.YE(L).atMention===i.z5.Enabled&&(0,f.B)().catch((0,p.L)(r.m2.reserveTag(591397600))),N((0,b.u)(e,_.A.SharedComments,s.UO(n))).catch((function(e){return(0,p.L)(r.m2.reserveTag(591397602))(e),{draftDiscardResult:i.y0.Unhandled,draftDiscardBehavior:c.o.CannotAutoDiscard}})).then((function(i){var a,c;O.addDataField("DraftDiscardBehavior",i.draftDiscardBehavior,o.LG.SystemMetadata);var f=M(),p=I.XU(f);return(0,T.mw)(p)||!v.rR()&&I.iM(f)&&s.pi(n)?(O.addDataField("SessionAlreadyRequested",!0,o.LG.SystemMetadata),O.addDataField("DraftRenderContextType",null!==(c=null===(a=(0,y.rB)(p))||void 0===a?void 0:a.renderContextType)&&void 0!==c?c:u.A.None,o.LG.SystemMetadata),O.successTag(591397633),Promise.resolve(N(P.j))):(O.addDataField("SessionAlreadyRequested",!1,o.LG.SystemMetadata),F||N((0,x.$)((0,A.A)(e,r.m2.reserveTag(591397634)),n,w)),t.beginDraftingAsync(n).then((function(t){if(void 0===t.sessionConfiguration)throw new g.cP(h.Mb,r.m2.reserveTag(589103630),-2130957532);s.pi(n)&&v.pT()&&N((0,k.X)((0,A.A)(e,r.m2.reserveTag(591397635)),[],[],R,t.author));var i,a,c,f=M(),p=(i=e.renderContextType,a=S.vL(f),c=S.zm(f).containerType,a!==d.Y.Closed&&i!==u.A.DiscreteIsolated?(0,l.O)(c):(0,m.pZ)(i)?a===d.Y.Closed?u.A.None:(0,l.O)(c):i);return O.addDataField("DraftRenderContextType",p,o.LG.SystemMetadata),(0,o.i7)().assertConditionTag(p===e.renderContextType||e.renderContextType===u.A.None,"Requested starting a draft in RenderContextType:".concat(e.renderContextType," but had to lock to RenderContextType:").concat(p," based on pane state"),554714642),O.successTag(591397640),N((0,E.y)((0,A.A)(e,r.m2.reserveTag(591397641)),t,p,F))})).catch((function(t){return(t.message||t).includes("LegacyConvertDialog")?O.successTag(591397643):O.failTag(591397642,(0,C.E)(t)),N((0,D.z)((0,A.A)(e,r.m2.reserveTag(591397644)),n,t))})))}))):(O.failTag(591397599,-2130957513),Promise.resolve(N(P.j)))}}},67177:function(e,t,n){"use strict";n.d(t,{u:function(){return p}});var r=n(77042),o=n(65203),i=n(15918),a=n(6759),s=n(81913),d=n(20478),c=n(96138),u=n(85844),l=n(51346),m=n(69349),f=n(89181);function p(e,t,n){return function(p,g){var C=g(),h=u.XU(C),v=(0,o.i7)().createActivityObject("DiscardDraftIfEmpty",e.telemetryVisitor,(0,o.Zx)()),y=(0,d.hT)(h);v.addDataField("Trackback",e.trackback,o.LG.SystemMetadata),v.addDataField("RenderContextType",e.renderContextType,o.LG.SystemMetadata),v.addDataField("CommitPendingAttemptedCancel",y,o.LG.SystemMetadata),v.addDataField("ActionSource",t,o.LG.SystemMetadata);var T=(0,s.uQ)(h);return v.addDataField("DraftDiscardBehavior",T,o.LG.SystemMetadata),T===a.o.CanAutoDiscard?p((0,f.y)(e,t,!1)).then((function(e){return v.successTag(539754957),{draftDiscardResult:e,draftDiscardBehavior:T}})):(void 0!==n&&T===a.o.CannotAutoDiscard&&(v.addDataField("DraftWarningReason",n,o.LG.SystemMetadata),p((0,m.u)({draftWarningType:c.u.ReturnToDraft,draftWarningReason:n},(0,l.A)(e,r.m2.reserveTag(591728722))))),v.successTag(539754958),Promise.resolve({draftDiscardResult:i.y.Canceled,draftDiscardBehavior:T}))}}},89181:function(e,t,n){"use strict";n.d(t,{y:function(){return p}});var r=n(77042),o=n(65203),i=n(55309),a=n(15964),s=n(15918),d=n(20478),c=n(47513),u=n(85844),l=n(51346),m=n(70648),f=n(34554);function p(e,t,n,p){return function(g,C){var h=C(),v=(0,o.i7)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,(0,o.Zx)()),y=u.XU(h),T=u.$6(h),I=(0,d.hT)(y);v.addDataField("Trackback",e.trackback,o.LG.SystemMetadata),v.addDataField("RenderContextType",e.renderContextType,o.LG.SystemMetadata),v.addDataField("CommitPendingAttemptedCancel",I,o.LG.SystemMetadata),v.addDataField("ActionSource",t,o.LG.SystemMetadata);var S=function(e,t,n){var s=u.CR(e),d=u.$6(e);if(!s)return d&&(0,c.dF)(d.selectionDetails)&&(0,c.Uo)(d)?{cancelAction:i.cancelCommentPostEdit((0,l.A)(n,r.m2.reserveTag(593278744)),d.selectionDetails.selectedPostId,t),sessionType:a.N_}:-2130957522;var m=s.commentDraft.sessionConfiguration.sessionType;switch(s.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:i.cancelCommentCreateThread((0,l.A)(n,r.m2.reserveTag(593278745)),t),sessionType:m};case"REPLY":return{cancelAction:i.cancelCommentReply((0,l.A)(n,r.m2.reserveTag(593278746)),s.commentDraft.sessionConfiguration.threadId,t),sessionType:m};case"EDIT":return{cancelAction:i.cancelCommentPostEdit((0,l.A)(n,r.m2.reserveTag(593278747)),s.commentDraft.sessionConfiguration.commentId,t),sessionType:m};default:return(0,o.i7)().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}(h,n,e);if("number"==typeof S)return v.failTag(r.m2.reserveTag(593278749),S),Promise.resolve(s.y.Handled);var A=S.sessionType,_=S.cancelAction;return v.addDataField("ActiveSessionType",A,o.LG.SystemMetadata),I||!(0,d.IE)(y)&&!(0,c.gh)(T)?(v.addDataField("DiscardUnnecessary",!0,o.LG.SystemMetadata),v.successTag(593278755),Promise.resolve(s.y.Unhandled)):(v.addDataField("DiscardUnnecessary",!1,o.LG.SystemMetadata),g((0,m.$)((0,l.A)(e,r.m2.reserveTag(593278750)))),p?p((function(){return g(_),v.addDataField("CancelledByUser",!1,o.LG.SystemMetadata),v.successTag(593278751),s.y.Handled}),(function(){return v.addDataField("CancelledByUser",!0,o.LG.SystemMetadata),v.successTag(593278752),g((0,f.D)((0,l.A)(e,r.m2.reserveTag(593278753)))),s.y.Canceled})):(g(_),v.successTag(593278754),Promise.resolve(s.y.Handled)))}}},7692:function(e,t,n){"use strict";n.d(t,{X:function(){return d}});var r=n(77042),o=n(69084),i=n(11544),a=n(85844),s=n(79318);function d(e,t,n,d,c){return function(u,l){var m=(0,i.Pj)(t,n,a.t_(l()),c);if(0===m.length)return Promise.resolve();if(d.getPersonaIconPropertiesArray)d.getPersonaIconPropertiesArray(m).then((function(t){u((0,s.P)(e,(0,i.SI)(t)))})).catch((0,o.L)(r.m2.reserveTag(595645964)));else{var f=(0,i.l9)(m);u((0,s.P)(e,(0,i.SI)(f)))}return Promise.resolve()}}},60344:function(e,t,n){"use strict";n.d(t,{u:function(){return u}});var r=n(77042),o=n(12595),i=n(56288),a=n(69084),s=n(75789),d=n(29273),c=n(51346);function u(e,t){return function(n,u){var l=d.zm(u());return(0,i.I)(l)&&(0,o.qO)(t)?l.setDisplayConfiguration(t).then((function(t){return n(function(e,t){return(0,c.V)("VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",{displayConfiguration:t},e)}(e,t)),Promise.resolve(t)})).catch((function(e){return function(e){return(0,a.L)(r.m2.reserveTag(578426816))(e),Promise.resolve(void 0)}(e)})):Promise.reject(new s.cP("Not half pane or half pane configuration",r.m2.reserveTag(577610273),-2130957557))}}},1855:function(e,t,n){"use strict";n.d(t,{E:function(){return p},S:function(){return f}});var r=n(90853),o=n(77042),i=n(65203),a=n(68631),s=n(58462),d=n(85526),c=n(47513),u=n(85844),l=n(51346),m=n(30387);function f(e,t,n,r){return function(f,p){f((0,l.V)("SELECT_COMMENT",n,t));var g=p(),C=(0,u.$6)(g);return r&&C&&C.selectedCardId===n.selectedCard&&(n.selectType!==m.V9.SelectPost||(0,c.dF)(C.selectionDetails)&&C.selectionDetails.selectedPostId===n.selectedPost)?e?new Promise((function(n){return setTimeout((function(){var r;if((0,c.dF)(C.selectionDetails))r={componentType:s.I5.Post,id:C.selectionDetails.selectedPostId,renderContextType:t.renderContextType};else{var l=(0,u.XU)(g).drafts[C.selectedCardId],m=!!l&&"CREATE"===l.commentDraft.sessionConfiguration.sessionType;r={componentType:(0,a.AV)(m),id:C.selectedCardId,renderContextType:t.renderContextType}}var f=e.getComponentById(r);f?(d.KX&&(0,o.fH)("Focusing comment ".concat(r.id," with render context type ").concat(r.renderContextType," after selection.")),f.focus()):(0,i.i7)().assertConditionTag(!1,"Couldn't find focus target after select: ".concat(JSON.stringify(r)),590104655),n()}))})):((0,i.i7)().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function p(e,t,n){return(0,r.__assign)({selectedCard:e,source:t},n)}},68583:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("TOP_VISIBLE_THREAD_CHANGED",{threadId:t},e)}},55721:function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("UPDATE_CONTEXT_DETAILS",{contextState:t},e)}},29908:function(e,t,n){"use strict";n.d(t,{r:function(){return o}});var r=n(51346);function o(e,t){return(0,r.V)("UPDATE_SUGGESTIONS_DETAILS",{details:t},e)}},55309:function(e,t,n){"use strict";n.r(t),n.d(t,{EMPTY_ACTION:function(){return x.j},SelectActionType:function(){return Q.V9},activeFilterUpdated:function(){return o},addContentExtension:function(){return i.c},addToCurrentMentionees:function(){return a},applyCommentChanges:function(){return s},beginDraftingFailure:function(){return d.z},beginDraftingSuccess:function(){return c.y},beginProcessingCommit:function(){return u.e},beginProcessingDiscard:function(){return l.$},beginViewInitialization:function(){return m.p},cancelCommentCreateThread:function(){return f},cancelCommentPostEdit:function(){return p},cancelCommentReply:function(){return g},cancelDiscard:function(){return C.D},chainActionDetails:function(){return r.A},clearCommentHighlight:function(){return h.F},clearCommentSelection:function(){return v.P},clearLowFidelityWarning:function(){return y},clearPostErrorUI:function(){return T},collapseCard:function(){return I},commentContextChanged:function(){return S},commitDraft:function(){return A.f},commitFailure:function(){return _.M},createAction:function(){return r.V},dispatchLoadThreads:function(){return D},displayDraftWarning:function(){return E.u},draftEmptinessChanged:function(){return P},emptyAction:function(){return x.M},endViewInitialization:function(){return b.t},getCommitDraftSessionType:function(){return A.B},highlightComment:function(){return k.c},loadComment:function(){return w.s},loadFilter:function(){return R},loadPersonaIconProperties:function(){return F.P},loadVirtualizedComments:function(){return N.K},moveFocusToCanvas:function(){return M},nextPopulatedContextDetailsUpdated:function(){return L},onInitialRender:function(){return O},populateSmartReply:function(){return B},queueLoadThreads:function(){return U},readyToRender:function(){return H},reloadComments:function(){return G._},removeContentExtensions:function(){return z},requestClosePane:function(){return q},requestDeletePost:function(){return W},requestDeleteThread:function(){return Y},requestModalConfirmation:function(){return j},requestPresentLinkToComment:function(){return V},requestReopenThread:function(){return X},requestShowPane:function(){return K},requestThreadResolve:function(){return $},resolveAtMentionCapability:function(){return Z.E},saveDraft:function(){return J.J},selectComment:function(){return Q.un},selectContent:function(){return ee},selectFirstThreadInNextCommentContext:function(){return te},selectLastThreadInPreviousCommentContext:function(){return ne},sessionRequestStartedAndLockSelection:function(){return re.$},setCollaborators:function(){return oe},setContentNavigationEnablement:function(){return ie},setFilteringCapabilities:function(){return ae},shouldSelectActionExpandCard:function(){return Q.G7},showLowFidelityWarning:function(){return se.G},showPostErrorUI:function(){return de},toggleTaskAssigner:function(){return ce},topVisibleThreadChanged:function(){return ue.K},updateCollaborators:function(){return le},updateContextState:function(){return me.i},updateDraftRenderContext:function(){return fe},updateDraftThread:function(){return pe},updateExtensionPriority:function(){return ge},updateFilterRange:function(){return Ce},updateMentioneesStillInDraft:function(){return he},updateModelCapabilities:function(){return ve},updateSelectedTaskAssignee:function(){return ye},updateSelectedTaskAssignees:function(){return Te},updateSuggestionsDetails:function(){return Ie.r},viewContainerChanged:function(){return Se},viewContainerFoldableLayoutStateChanged:function(){return Ae},viewContainerVisibilityChanged:function(){return _e}});var r=n(51346);function o(e,t){return(0,r.V)("ACTIVE_FILTER_UPDATED",t,e)}var i=n(70055);function a(e,t){return(0,r.V)("ADD_TO_CURRENT_MENTIONEES",{mentionee:t},e)}function s(e,t){return(0,r.V)("APPLY_COMMENT_CHANGES",{changes:t},e)}var d=n(82854),c=n(11163),u=n(84809),l=n(70648),m=n(16610);function f(e,t){return(0,r.V)("CANCEL_COMMENT_CREATE_THREAD",{closeOnDiscard:t},e)}function p(e,t,n){return(0,r.V)("CANCEL_COMMENT_POST_EDIT",{commentId:t,closeOnDiscard:n},e)}function g(e,t,n){return(0,r.V)("CANCEL_COMMENT_REPLY",{commentId:t,closeOnDiscard:n},e)}var C=n(34554),h=n(64160),v=n(13266);function y(e){return(0,r.V)("CLEAR_LOW_FIDELITY_WARNING",void 0,e)}function T(e,t){return(0,r.V)("CLEAR_POST_ERROR_STATE",{commentId:t},e)}function I(e,t){return(0,r.V)("COLLAPSE_CARD",{cardId:t},e)}function S(e,t){return(0,r.V)("COMMENT_CONTEXT_CHANGED",t,e)}var A=n(17986),_=n(8143);function D(e,t){return(0,r.V)("DISPATCH_LOAD_THREADS",t,e)}var E=n(69349);function P(e,t,n){return(0,r.V)("DRAFT_EMPTINESS_CHANGED",{isEmpty:t,draftId:n},e)}var x=n(48581),b=n(67534),k=n(3133),w=n(55499);function R(e,t){return(0,r.V)("LOAD_FILTER",t,e)}var F=n(79318),N=n(38761);function M(e,t){return(0,r.V)("MOVE_FOCUS_TO_CANVAS",{resource:t},e)}function L(e,t){return(0,r.V)("NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",{nextPopulatedContextDetails:t},e)}function O(e,t){return(0,r.V)("ON_INITIAL_RENDER",t,e)}function B(e,t){return(0,r.V)("POPULATE_SMART_REPLY",t,e)}function V(e,t){return(0,r.V)("PRESENT_LINK_TO_COMMENT",{commentId:t},e)}function U(e,t){return(0,r.V)("QUEUE_LOAD_THREADS",t,e)}function H(e){return(0,r.V)("READY_TO_RENDER",{},e)}var G=n(34067);function z(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return(0,r.V)("REMOVE_CONTENT_EXTENSION",{renderModes:t},e)}function q(e){return(0,r.V)("REQUEST_CLOSE_PANE",{},e)}function W(e,t){return(0,r.V)("REQUEST_DELETE_POST",{commentId:t},e)}function Y(e,t,n){return(0,r.V)("REQUEST_DELETE_THREAD",{commentId:t,isTask:n},e)}function j(e,t,n,o){return(0,r.V)("REQUEST_MODAL_CONFIRMATION",{onConfirm:t,onCancel:n,displayStrings:o},e)}function X(e,t,n){return(0,r.V)("REQUEST_REOPEN_THREAD",{commentId:t,isTask:n},e)}function K(e){return(0,r.V)("REQUEST_SHOW_PANE",{},e)}function $(e,t,n){return(0,r.V)("REQUEST_THREAD_RESOLVE",{commentId:t,isTask:n},e)}var Z=n(41943),J=n(1534),Q=n(30387);function ee(e,t,n,o,i,a,s){return(0,r.V)("SELECT_CONTENT",{selectDirection:t,from:a,reason:s,iterableContentTypes:n,restrictToCurrentContext:o,preventLooping:i},e)}function te(e){return(0,r.V)("SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",{},e)}function ne(e){return(0,r.V)("SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",{},e)}var re=n(74444);function oe(e,t){return(0,r.V)("SET_COLLABORATORS",t,e)}function ie(e,t){return(0,r.V)("SET_CONTENT_NAVIGATION_ENABLEMENT",{isEnabled:t},e)}function ae(e,t){return(0,r.V)("SET_FILTERING_CAPABILITIES",t,e)}var se=n(97793);function de(e,t){return(0,r.V)("SHOW_POST_ERROR_STATE",{commentId:t},e)}function ce(e){return(0,r.V)("TOGGLE_TASK_ASSIGNER_TYPE",{},e)}var ue=n(68583);function le(e,t){return(0,r.V)("UPDATE_COLLABORATORS",t,e)}var me=n(55721);function fe(e,t,n){return(0,r.V)("UPDATE_DRAFT_RENDER_CONTEXT",{isClaimingLock:t,draftId:n},e)}function pe(e,t){return(0,r.V)("UPDATE_DRAFT_THREAD",t,e)}function ge(e,t){return(0,r.V)("UPDATE_EXTENSION_PRIORITY",{updates:t},e)}function Ce(e,t){return(0,r.V)("UPDATE_FILTER_RANGE",t,e)}function he(e,t){return(0,r.V)("UPDATE_MENTIONEES_STILL_IN_DRAFT",{emailsStillInDraft:t},e)}function ve(e,t,n){return(0,r.V)("UPDATE_MODEL_STATE",{modelCapabilityFlags:t,richTextCapabilityFlags:n},e)}function ye(e,t){return(0,r.V)("UPDATE_SELECTED_TASK_ASSIGNEE",{selectedAssignee:t},e)}function Te(e,t){return(0,r.V)("UPDATE_SELECTED_TASK_ASSIGNEES",{selectedAssignee:t},e)}var Ie=n(29908);function Se(e,t){return(0,r.V)("VIEW_CONTAINER_CHANGED",{viewContainer:t},e)}function Ae(e,t){return(0,r.V)("VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",{foldableLayoutState:t},e)}function _e(e,t){return(0,r.V)("VIEW_CONTAINER_VISIBILITY_CHANGED",{visibilityState:t},e)}},59824:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o}}),function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"}(r||(r={}));const o=r},54948:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return o}}),function(e){e[e.KeyboardShortcut=1]="KeyboardShortcut",e[e.CommitButton=2]="CommitButton",e[e.Programmatic=3]="Programmatic"}(r||(r={}));const o=r},93894:function(e,t,n){"use strict";n.d(t,{K:function(){return a},_:function(){return s}});var r=n(65203),o=n(94344),i=n(20478);function a(e,t,n,o,a){if(-1!==n&&(0,i.Ze)(t)<(0,i.Ze)(e)){var s=(0,r.i7)().createActivityObject("SilentDraftDiscard",(0,r.t4)(r.ZK.GlobalAPI),(0,r.Zx)());s.addDataField("DiscardReason",null!=n?n:0,r.LG.SystemMetadata),s.addDataField("Source",o,r.LG.SystemMetadata),s.successTag(a)}}function s(e){if(o.$7()){var t=(0,r.i7)().createActivityObject("MarkCommentCreation",e,(0,r.Zx)());t.addDocumentMetadata(r.$j.Basic),t.successTag(591152859)}}},78062:function(e,t,n){"use strict";n.d(t,{HM:function(){return d},JI:function(){return s},SX:function(){return c},Yi:function(){return u},_T:function(){return l}});var r=n(33195),o=n(65203),i=n(91733),a=n(29881);function s(e){if(function(e){var t=a.a7(e);if(!t)return!1;var n=a.DX(e,t);return!!n&&n.canUpdateFilter}(e))return a.a7(e)}function d(e,t){return!a.L3(e)||void 0!==a.cw(e).find((function(e){return e.contentId===t}))}function c(e,t){var n;return!(t.supportsMentionToMeFilter&&e.mentionsToCurrentUser!==i.y.mentionsToCurrentUser||(null===(n=e.CommentThread)||void 0===n?void 0:n.resolutionStatus)!==i.y.CommentThread.resolutionStatus||t.supportsFilterByUser&&void 0!==e.userFilter&&0!==e.userFilter.length)}function u(e,t){t.addDataField("HasFiltereringCapabilities",!!e.filterState.filteringCapabilities,o.LG.SystemMetadata);var n=!1,r=a.a7(e);if(r){var i=e.filterState.filteredRanges[r],s=e.filterState.filteringCapabilities;i&&s&&(n=!c(i.filter,s))}t.addDataField("IsFilterApplied",n,o.LG.SystemMetadata)}var l=[r.eT.ActiveOnly,r.eT.ResolvedOnly]},11544:function(e,t,n){"use strict";n.d(t,{l9:function(){return c},SI:function(){return d},Pj:function(){return s},Le:function(){return u}});var r=n(90853);function o(e){return e.reduce((function(e,t){return Array.isArray(t)?e.push.apply(e,(0,r.__spreadArray)([],(0,r.__read)(o(t)),!1)):e.push(t),e}),[])}var i=n(50577),a=n(3414);function s(e,t,n,r){var a;return function(e,t){var n={};return e.filter((function(e){var r=(0,i.ut)(e);return!(!r||n[r]||u(t,e))&&(n[r]=!0)}))}(o([e.map((function(e){return e.author})),null!==(a=null==t?void 0:t.map((function(e){return e.history.map((function(e){return e.records[0].user}))})))&&void 0!==a?a:[],null!=r?r:[]]),n)}function d(e){return e.reduce((function(e,t){var n=function(e){if(e.authorID||e.authorName)return e.authorID||e.authorName}(t);return n?(e[n]=t,e):e}),{})}function c(e){var t=[];return e.forEach((function(e){t.push({authorName:e.DisplayName||"",authorID:e.UserId,authorColor:a.x.COMMENTS_PURPLE,authorImageURL:""})})),t}function u(e,t){var n=(0,i.ut)(t);if(n){var r=e[n];return void 0!==r?r:t.DisplayName&&e[t.DisplayName]?e[t.DisplayName]:void 0}}},45610:function(e,t,n){"use strict";function r(e,t,n){return!e||!!t&&!n&&0!==e.numberOfLoadedComments&&(void 0===e.selectedThreadIndex||e.selectedThreadIndex<e.numberOfLoadedThreads)}n.d(t,{B:function(){return r}})},81913:function(e,t,n){"use strict";n.d(t,{FO:function(){return te},jn:function(){return Ie},aw:function(){return Ue},wS:function(){return ze},vY:function(){return H},ah:function(){return X},FE:function(){return j},uv:function(){return Ge},iv:function(){return $},K1:function(){return K},t$:function(){return q},Jn:function(){return ae},NN:function(){return ie},uQ:function(){return De},Zn:function(){return Y},EO:function(){return Ce},Sv:function(){return he},uk:function(){return Ye},YN:function(){return We},uV:function(){return W},FQ:function(){return _e},cU:function(){return J},i8:function(){return ee},oL:function(){return Q},J8:function(){return z},x0:function(){return U},Nk:function(){return se},Uh:function(){return ve},qP:function(){return ce},DI:function(){return le},a9:function(){return ue},gJ:function(){return pe},tN:function(){return ye},CR:function(){return we},Zg:function(){return Fe},zh:function(){return Ne},rB:function(){return Me},Q0:function(){return G},Hh:function(){return Ae},WT:function(){return Z},f8:function(){return V},gl:function(){return L},uG:function(){return He},a3:function(){return re},nS:function(){return Ve},qb:function(){return Oe},Om:function(){return ne},mh:function(){return oe},wx:function(){return Pe},jr:function(){return Le},nc:function(){return B},Mu:function(){return O},MK:function(){return Be},G$:function(){return ge},Pi:function(){return ke},Sr:function(){return xe},at:function(){return be},mi:function(){return Te},ve:function(){return me}});var r=n(90853),o=n(77042);function i(e,t){var n=e.filter(t);return n.length===e.length?e:n}var a=n(65203),s=n(71318),d=n(64307),c=n(58486),u=n(76198),l=n(73588),m=n(99381),f=n(78143),p=n(30564),g=n(6759),C=n(44579),h=n(89454),v=n(75847),y=n(64019),T=(new y.ac).insert("").toJSON();(new y.ac).toJSON();var I=n(55925),S=n(9749),A=n(75789),_=n(88652),D=n(94344),E=n(30387),P=n(45680),x=n(20478),b=n(5873),k=n(12008),w=n(47513),R=n(94828),F=n(93894),N=n(45610),M=3;function L(e){return""===e||null===e?void 0:e}function O(e,t){if(!e[t])return e;var n=(0,r.__assign)({},e);return delete n[t],n}function B(e,t,n){var o=void 0!==n&&e[n]===t?n:-1;if(o<0&&(o=e.findIndex((function(e){return e===t}))),o<0)return e;var i=(0,r.__spreadArray)([],(0,r.__read)(e),!1);return i.splice(o,1),i}function V(e){return e.state===b.m.Placeholder||e.state===b.m.Loading}function U(e,t,n){var r,o;return(0,R._A)(e)?null!==(o=null===(r=t[n])||void 0===r?void 0:r.map((function(t){return e[t]})))&&void 0!==o?o:[]:e.filter((function(e){return(0,m.a)(e)===n}))}function H(e){return{commentId:e,commentBody:T,author:{UserId:"",Provider:"",DisplayName:""},parentId:"",commentFlags:0}}function G(e,t,n,r){if(n<0)return-1;for(var o=0,i=-1,a=0;a<e.length;a++)if(e[a]!==r){if(o===n)return a;if(o>n)return i===a-1?a-2:a-1;o+=t[e[a]].length}else i=a;return o===n?e.length:-1}function z(e,t,n){for(var r={},o=0;o<e.length;++o)r[e[o].commentId]=q(!D.rR()&&t.includes((0,m.a)(e[o]))?Y(e[o].date,e[o].displayDate,n.dataCulture):e[o].displayDate);return r}function q(e){return{displayDate:e,displayingErrorUI:!1,pending:k.U.None}}function W(e){return{displayDate:e}}function Y(e,t,n){return t||(!e||isNaN(e.getDate())?"":h.Yq(e,n))}function j(e,t,n,o){for(var i,s=void 0,d=!1,c=0;c<n.length;c++)if((0,m.a)(n[c])===e){d=!0,(0,a.i7)().assertConditionTag(!!t[n[c].commentId],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",540112392);var u=null!==(i=t[n[c].commentId])&&void 0!==i?i:q(void 0);u.displayDate||(s||(s=(0,r.__assign)({},t)),s[n[c].commentId]=(0,r.__assign)((0,r.__assign)({},u),{displayDate:Y(n[c].date,n[c].displayDate,o.dataCulture)}))}else if(d)break;return s}function X(e,t,n,o){var i=void 0;return e.forEach((function(e){var s;if(n[e]){(0,a.i7)().assertConditionTag(!!t[e],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",538035351);var d=null!==(s=t[e])&&void 0!==s?s:q(void 0);d.displayDate||(i||(i=(0,r.__assign)({},t)),i[e]=(0,r.__assign)((0,r.__assign)({},d),{displayDate:Y(n[e].date,n[e].displayDate,o.dataCulture)}))}})),i}function K(e,t){for(var n={},r=0;r<e.length;++r)""===e[r].parentId&&(n[e[r].commentId]=$(void 0,t));return n}function $(e,t){return J(e,t===b.m.Loading||t===b.m.Placeholder?{state:t,initialItemCount:1}:{state:null!=t?t:b.m.Loaded})}function Z(e){var t,n,o={};try{for(var i=(0,r.__values)(e),a=i.next();!a.done;a=i.next()){var s=a.value;o[s.threadId]=J(void 0,{state:b.m.Placeholder,initialItemCount:s.itemCount})}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}function J(e,t){return{loadState:null!=t?t:{state:b.m.Loaded},pending:P.q.None,alternateId:e}}function Q(e){var t={};return t[e]={pending:k.U.Post,displayDate:void 0,displayingErrorUI:!1},t}function ee(e){var t={};return t[e]={pending:P.q.Card,loadState:{state:b.m.Loaded},alternateId:e},t}function te(e,t,n){var r=re(e,t,n),o=Me(n);if(D.cg()){var i=null==o?void 0:o.commentDraft.sessionConfiguration;"EDIT"===(null==i?void 0:i.sessionType)&&o&&!r.some((function(e){return e===o.threadId}))&&r.push(o.threadId)}return!t||r.includes(t.selectedCardId)?r:o&&o.threadId===t.selectedCardId?[o.threadId]:o&&r.includes(o.threadId)?[t.selectedCardId,o.threadId]:[t.selectedCardId]}function ne(e,t,n,r){if(!t.includes(e))return t;var o=Me(n);return o&&o.threadId===e?t:r&&(0,w.dF)(r.selectionDetails)?((0,a.i7)().assertConditionTag(!1,"Trying to collapse a card while it has a selected post",570529298),t):o&&t.includes(o.threadId)?[o.threadId]:[]}function re(e,t,n){var r=Me(n);return i(e,(function(e){return e===(null==t?void 0:t.selectedCardId)||e===(null==r?void 0:r.threadId)}))}function oe(e,t,n){var r=Me(n);return i(e,(function(e){return t[e]||e===(null==r?void 0:r.threadId)}))}function ie(e){return{selectedCardId:e,selectionDetails:{lowFidelityWarningType:void 0}}}function ae(){return{lowFidelityWarningType:void 0}}function se(e,t){var n,r=e.draftState.postIdToDraftIdMap[t];if(!r)return e.selectedComment;var i=e.draftState.drafts[r];if(!i.isInCurrentContext)return(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)===i.threadId?void 0:e.selectedComment;var a=(0,R.YO)((0,R.OJ)(e),t);if(!a)throw new A.cP(_.wy,o.m2.reserveTag(589103587),-2130957563);return ie((0,m.a)(a))}function de(e,t){return{selectedCardId:e,selectionDetails:{selectedPostId:t,lowFidelityWarningType:void 0}}}function ce(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return ie(t.sessionConfiguration.draftId);case"EDIT":return function(e,t){var n=(0,R.YO)(e,t);if(n)return de((0,m.a)(n),t);throw new A.cP(_.yC,o.m2.reserveTag(589103616),-2130957556)}(e,t.sessionConfiguration.commentId);case"REPLY":return function(e,t){var n=(0,R.YO)(e,t);if(n&&""===n.parentId)return ie(t);throw new A.cP(_.yC,o.m2.reserveTag(589103617),-2130957556)}(e,t.sessionConfiguration.threadId);default:throw new A.cP(_.Mb,o.m2.reserveTag(589103618),-2130957532)}}function ue(e){switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":return ie(e.threadId);case"EDIT":return de(e.threadId,e.commentDraft.sessionConfiguration.commentId);default:throw new A.cP(_.Mb,o.m2.reserveTag(577610274),-2130957532)}}function le(e,t,n){return(null==t?void 0:t.selectedCardId)===e&&(0,w.dF)(t.selectionDetails)&&!(0,x.Dd)(n)?ie(e):t}function me(e,t){var n=t.payload;return{selectedCardId:n.selectedCard,selectionDetails:fe(e,n)}}function fe(e,t){return t.selectType===E.V9.SelectPost?e&&(0,w.dF)(e.selectionDetails)&&t.selectedPost===e.selectionDetails.selectedPostId?e.selectionDetails:{selectedPostId:t.selectedPost,lowFidelityWarningType:void 0}:{lowFidelityWarningType:e&&!(0,w.dF)(e.selectionDetails)&&t.selectedCard===e.selectedCardId?e.selectionDetails.lowFidelityWarningType:void 0}}function pe(e,t,n){var r,o=t.payload.params;return(0,l.vd)(o)?ie(n):(0,l.pS)(o)?{selectedCardId:n,selectionDetails:{lowFidelityWarningType:void 0,selectedPostId:o.commentId}}:ie(null!==(r=null==e?void 0:e.selectedCardId)&&void 0!==r?r:n)}function ge(e,t,n){if("CLEAR_COMMENT_SELECTION"===n.type)return!!t&&!(0,x.Dd)(e);if(!t)return!0;if((0,x.Dd)(e))return n.payload.selectedCard===t.selectedCardId&&!(0,w.dF)(t.selectionDetails)&&n.payload.selectType===E.V9.ExpandCard;if(n.payload.selectedCard===t.selectedCardId)switch(n.payload.selectType){case E.V9.SelectCard:return(0,w.dF)(t.selectionDetails);case E.V9.Polite:return!1;case E.V9.SelectPost:case E.V9.ExpandCard:return!0;default:(0,o.HB)(n.payload)}return!0}function Ce(e){var t={};return e.commentId&&(t[e.commentId]={pending:P.q.None,loadState:{state:b.m.Loaded},alternateId:e.commentId}),t}function he(e){var t={};return e.commentId&&(t[e.commentId]={pending:k.U.None,displayDate:void 0,displayingErrorUI:!1}),t}function ve(e,t){return e&&e.selectedCardId===t.payload.commentId?ie(t.payload.commentId):e}function ye(e,t,n){if(e.pendingDraft&&"CREATE"===e.pendingDraft.sessionType)return(0,v.M3)();if(e.committedLieId)return e.committedLieId;var r=Me(e);return!r||"CREATE"!==r.commentDraft.sessionConfiguration.sessionType||t&&!r.isInCurrentContext||n&&r.renderContextType!==n&&r.renderContextType!==C.A.None?void 0:r.commentDraft.sessionConfiguration.draftId}function Te(e,t,n,r){var o=B(e,n);if(o.length<e.length){var i=G(o,t,r.flatIndex);i>=0&&o.splice(i,0,n)}return o}function Ie(e,t,n,o){if(!ye(o,!0))return e;var i=ye(o);if(e&&i&&n[i]&&n[i].pending===P.q.None){var a=(0,r.__assign)({},e),s=t.length;if(a.flatIndex>=s)a.flatIndex=s;else if(a.flatIndex>=0&&t[a.flatIndex].parentId){var d=new u.C(t,a.flatIndex);d.next().done?a.flatIndex=s:a.flatIndex=d.currentIndex()}return a}}function Se(e,t,n){if(!t)return-1;var r=n?t.selectedCardId:(0,w.Gl)(t);return e.findIndex((function(e){return e.commentId===r}))}function Ae(e,t){return(0,R.x2)(e)?t?e.findIndex((function(e){return e===t.selectedCardId})):-1:Se(e,t,!0)}function _e(e,t,n){if((0,R._A)(e)){if(!n||!t[n.selectedCardId])return-1;var r=(0,w.Gl)(n);return t[n.selectedCardId].findIndex((function(e){return e===r}))}return Se(e,n,!1)}function De(e){if(!(0,x.QZ)(e))return g.o.NoDraft;if(!function(e){var t=Fe(e),n=t?e.drafts[e.cardIdToDraftIdMap[t]]:void 0;return!!(null==n?void 0:n.isDraftEmpty)}(e))return g.o.CannotAutoDiscard;var t=Me(e);return t&&(0,s.qH)(t.commentDraft.sessionConfiguration)?g.o.CannotAutoDiscard:g.o.CanAutoDiscard}function Ee(e,t){if(void 0===t)return(0,a.i7)().assertConditionTag(0===Object.keys(e).length,"Invalid number of drafts.",593762516),e;var n=t.sessionConfiguration.draftId;return(0,a.i7)().assertConditionTag(1===Object.keys(e).length,"Invalid number of drafts.",593762517),(0,a.i7)().assertConditionTag(!!e[n],"Draft is not in map",593762518),D.cg()&&n&&(0,f.v)().removeItem(n),O(e,n)}function Pe(e){return De(e)===g.o.CanAutoDiscard?(0,x.KM)():e}function xe(e,t,n,r,i,a){var s,d;if(e.pendingDraft)switch(e.pendingDraft.sessionType){case"REPLY":if(!t[s=e.pendingDraft.threadId])return e;break;case"EDIT":if(!r[d=e.pendingDraft.commentId])return e;break;default:return e}else{var c=Me(e);if(!c||!c.isInCurrentContext)return e;switch(c.commentDraft.sessionConfiguration.sessionType){case"REPLY":s=c.threadId;break;case"EDIT":d=c.commentDraft.sessionConfiguration.commentId;break;default:return e}}if(s&&!n[s]){var u=Oe(e,s);return(0,F.K)(e,u,3,a,o.m2.reserveTag(539297118)),u}return d&&!i[d]?(u=Be(e,d),(0,F.K)(e,u,2,a,o.m2.reserveTag(539297119)),u):e}function be(e,t){var n=(0,r.__assign)({},e.drafts),o=!1;return Object.keys(n).forEach((function(e){var i=t(e);i!==n[e].renderContextType&&(n[e]=(0,r.__assign)((0,r.__assign)({},n[e]),{renderContextType:i}),o=!0)})),o?(0,r.__assign)((0,r.__assign)({},e),{drafts:n}):e}function ke(e,t){if(t===p.Y.Closed){if((0,S.pZ)(e))return C.A.None}else if(e===C.A.DiscreteIntegrated)return C.A.FullPane;return e}function we(e){var t=Me(e);return t?t.commentDraft:void 0}function Re(e){var t=Object.keys(e);if(t.length>1)throw(0,a.i7)().assertConditionTag(!1,"Invalid number of drafts.",593762519),new A.cP("Only a single draft is supported at this time.",o.m2.reserveTag(589103619),-2130957551);if(0!==t.length)return t[0]}function Fe(e){return Re(e.cardIdToDraftIdMap)}function Ne(e){return Re(e.postIdToDraftIdMap)}function Me(e){var t=e.drafts,n=Re(t);return n?t[n]:void 0}function Le(e){var t,n,i=e.drafts,s=Object.keys(i).filter((function(e){var t;return null===(t=i[e])||void 0===t?void 0:t.isInCurrentContext})).map((function(e){return i[e]}));if(0===s.length)return e;var d=(0,r.__assign)({},e);try{for(var c=(0,r.__values)(s),u=c.next();!u.done;u=c.next()){var l=u.value;switch(l.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":case"METADATA":(0,a.i7)().assertConditionTag("METADATA"!==l.commentDraft.sessionConfiguration.sessionType,"Metadata session removed on context change, but metadata sessions should not be long lived.",545630307),d=Oe(d,l.threadId);break;case"EDIT":d=Be(d,l.commentDraft.sessionConfiguration.commentId);break;default:(0,o.HB)(l.commentDraft.sessionConfiguration)}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return d}function Oe(e,t){var n,o=e.pendingDraft&&(0,l.vd)(e.pendingDraft)&&e.pendingDraft.threadId===t,i=e.cardIdToDraftIdMap[t];return i?(0,r.__assign)((0,r.__assign)({},e),{drafts:Ee(e.drafts,null===(n=e.drafts[i])||void 0===n?void 0:n.commentDraft),cardIdToDraftIdMap:O(e.cardIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?(0,r.__assign)((0,r.__assign)({},e),{pendingDraft:void 0}):e}function Be(e,t){var n,o=e.pendingDraft&&(0,l.pS)(e.pendingDraft)&&e.pendingDraft.commentId===t,i=e.postIdToDraftIdMap[t];return i?(0,r.__assign)((0,r.__assign)({},e),{drafts:Ee(e.drafts,null===(n=e.drafts[i])||void 0===n?void 0:n.commentDraft),postIdToDraftIdMap:O(e.postIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?(0,r.__assign)((0,r.__assign)({},e),{pendingDraft:void 0}):e}function Ve(e,t,n){var o=Oe(e,t),i=Ne(o);if(i){var a=o.postIdToDraftIdMap[i],s=o.drafts[a];s&&s.threadId===t&&(o=Be(o,i))}if(o.pendingDraft&&(0,l.pS)(o.pendingDraft)){var d=o.pendingDraft.commentId,c=n.find((function(e){return e.commentId===d}));c&&(0,m.a)(c)===t&&(o=(0,r.__assign)((0,r.__assign)({},o),{pendingDraft:void 0}))}return o}function Ue(e){if("web"===(0,I.u)()||"win32"===(0,I.u)()){if(e.tasks===c.u.Unknown){if("win32"===(0,I.u)())return D.$H();(0,a.i7)().assertConditionTag(!1,"Tasks Model Capability state has not been sent by the app.",590144153)}return e.tasks===c.u.Enabled&&D.$H()}return D.$H()}function He(e,t,n,i){var s,d=e.pendingCommentLoad,c=void 0,u=e.expandedComments,l=function(e,t){var n=t?(0,R.E)(t)?{commentThreadIds:(0,r.__spreadArray)([],(0,r.__read)(t.commentThreadIds),!1),cardPostIds:(0,r.__assign)({},t.cardPostIds),postData:(0,r.__assign)({},t.postData)}:{commentData:(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(t.commentData),!1),(0,r.__read)(e),!1)}:D.rR()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:e};if(!(0,R.ZY)(n))return n;var o=void 0;return e.forEach((function(e){if((0,m.j)(e))n.commentThreadIds.push(e.commentId),n.cardPostIds[e.commentId]=[e.commentId],o=e.commentId;else if(o===e.parentId)n.cardPostIds[e.parentId].push(e.commentId);else{if(!n.cardPostIds[e.parentId])return void(0,a.i7)().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",528773920);n.cardPostIds[e.parentId]=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(n.cardPostIds[e.parentId]),!1),[e.commentId],!1),o=e.parentId}n.postData[e.commentId]=e})),n}(t,e);if(d){var f=d.numberOfLoadedComments+t.length,p=d.numberOfLoadedThreads+t.filter(m.j).length;f>=d.numberOfTotalComments?((0,a.i7)().assertConditionTag(f===d.numberOfTotalComments,"Loaded more comments than expected",525693528),d=void 0):d=(0,r.__assign)((0,r.__assign)({},d),{numberOfLoadedComments:f,numberOfLoadedThreads:p})}if(e.pendingCommentLoad){var g=e.pendingCommentLoad.selectedThreadIndex,C=void 0!==g&&(0,N.B)(d,n,i);if((0,R.ZY)(l)&&e.createdCommentLie){var h=ye(e.draftState,!0);if(h&&(!l.cardPostIds[h]||C)){var v=G(l.commentThreadIds,l.cardPostIds,e.createdCommentLie.flatIndex);l.cardPostIds[h]||(v<0&&!d&&((0,a.i7)().assertConditionTag(!1,"Draft thread index too large after loading all data, inserting at end",526262789),v=l.commentThreadIds.length),v>=0&&(l.commentThreadIds.splice(v,0,h),l.cardPostIds[h]=[h])),v>=0&&void 0!==g&&v<=g&&(g+=1)}}if(void 0!==g&&C){var y=(0,R.ZY)(l)?l.commentThreadIds:l.commentData.filter(m.j);if(!(g>=0&&g<y.length))throw(0,o.fH)("selectedThreadIndex out of bounds"),new A.cP(_.LR,o.m2.reserveTag(589103620),-2130957565);u=te(u,c=ie((0,R.x2)(y)?y[g]:y[g].commentId),e.draftState)}}if(e.selectedComment)if(D.S()){var T=Me(e.draftState);(null!==(s=null==T?void 0:T.threadId)&&void 0!==s?s:ye(e.draftState))===e.selectedComment.selectedCardId&&(c=e.selectedComment,u=e.expandedComments)}else(0,x.mw)(e.draftState)&&(c=e.selectedComment,u=e.expandedComments);return(0,r.__assign)((0,r.__assign)({},l),{pendingCommentLoad:d,selectedComment:c,expandedComments:u})}function Ge(e,t){var n=(0,R.YO)(e,t);return(null==n?void 0:n.author.DisplayName)&&(null==n?void 0:n.date)?{valid:!0,matchesCurrentUser:!!(null==n?void 0:n.author.IsCurrentUser),timeElapsed:(null==n?void 0:n.date)?Date.now()-n.date.getTime():0}:{valid:!1}}function ze(e,t,n){return(0,R.x2)(e)?n?(0,R._A)(t)?e.some((function(e){return!(t[e].commentFlags&d.P.Resolved)})):t.some((function(t){return""===t.parentId&&!(t.commentFlags&d.P.Resolved)&&e.find((function(e){return e===t.parentId}))})):e.length>0:(0,R._A)(t)?((0,o.hv)(!1,"ThreadData and CommentData must align if Map-Based",o.m2.reserveTag(526402327)),!1):n?t.filter((function(e){return""===e.parentId&&!(e.commentFlags&d.P.Resolved)})).length>0:t.length>0}var qe=0;function We(){return{atMention:s.z5.Unknown,newThread:!1,resolve:!1,richTextCapabilities:qe,tasks:c.u.Unknown,virtualized:!1,presentLinkToComment:!1,UIAAnnotationPattern:!1,ContentExtensionHostingDisabled:!1}}function Ye(e,t){var n,o=e.cardIdToDraftIdMap[t.commentId],i=o?e.drafts[o].commentDraft:void 0;if(void 0===i)return(0,a.i7)().assertConditionTag(0===Object.keys(e.drafts).length,"Could not find draft for adding smart replies",590202465),e;var s=t.smartReplies,d=i.sessionConfiguration.sessionType,c=s.length;return"REPLY"===d&&c<=M&&c>0?(0,r.__assign)((0,r.__assign)({},e),{drafts:(0,r.__assign)((0,r.__assign)({},e.drafts),(n={},n[o]=(0,r.__assign)((0,r.__assign)({},e.drafts[o]),{smartReplies:s}),n))}):e}},91733:function(e,t,n){"use strict";n.d(t,{y:function(){return o}});var r=n(33195),o={mentionsToCurrentUser:!1,CommentThread:{resolutionStatus:r.eT.All},TrackedChange:{stubField:""},contentOrder:r.OX.HostDefaultOrder,includeAllDocumentContexts:!1,userFilter:void 0}},45680:function(e,t,n){"use strict";var r;n.d(t,{q:function(){return r}}),function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"}(r||(r={}))},20478:function(e,t,n){"use strict";n.d(t,{CG:function(){return s},Dd:function(){return m},EF:function(){return a},IE:function(){return g},KM:function(){return c},QZ:function(){return u},W8:function(){return r},Ze:function(){return d},Zh:function(){return v},dl:function(){return f},hT:function(){return C},m6:function(){return h},mw:function(){return l}});var r,o=n(90853),i=n(94344);function a(e){return{isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,selectedTaskAssignees:e.selectedTaskAssignees,smartReplies:e.smartReplies}}function s(e){return Object.keys(e.drafts)}function d(e){var t=0;for(var n in e.drafts)e.drafts.hasOwnProperty(n)&&++t;return t}function c(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0,committedLieId:void 0}}function u(e){return d(e)>0}function l(e){return u(e)||f(e)}function m(e){return!i.S()&&l(e)}function f(e){return void 0!==e.pendingDraft}function p(e,t){var n,r;try{for(var i=(0,o.__values)(s(e)),a=i.next();!a.done;a=i.next()){var d=a.value;if(e.drafts[d].pendingState===t)return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1}function g(e){return p(e,r.None)}function C(e){return p(e,r.Commit)}function h(e){return p(e,r.Discard)}function v(e,t){return h(e)&&g(t)}!function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"}(r||(r={}))},14503:function(e,t,n){"use strict";var r;n.d(t,{m:function(){return r}}),function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"}(r||(r={}))},96138:function(e,t,n){"use strict";var r;n.d(t,{u:function(){return r}}),function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed",e[e.GrantAccessCanceled=4]="GrantAccessCanceled"}(r||(r={}))},5873:function(e,t,n){"use strict";var r;n.d(t,{m:function(){return r}}),function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.NeedsReload=3]="NeedsReload"}(r||(r={}))},12008:function(e,t,n){"use strict";var r;function o(e){return void 0!==e.pending||void 0!==e.displayingErrorUI}n.d(t,{U:function(){return r},_:function(){return o}}),function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"}(r||(r={}))},47513:function(e,t,n){"use strict";var r;function o(e){return e.selectionDetails.lowFidelityWarningType===r.Edit}function i(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteReply}function a(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteThread}function s(e){return i(e)||a(e)}function d(e){return!!e&&(o(e)||i(e))}function c(e){return!!e&&(s(e)||o(e))}function u(e){return void 0!==e.selectedPostId}function l(e){return u(e.selectionDetails)?e.selectionDetails.selectedPostId:e.selectedCardId}function m(e,t){return!!t&&u(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&c(t)}n.d(t,{EX:function(){return m},Gl:function(){return l},Je:function(){return i},Uo:function(){return c},Z2:function(){return s},dF:function(){return u},gh:function(){return d},kg:function(){return o},x0:function(){return a},xQ:function(){return r}}),function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"}(r||(r={}))},85844:function(e,t,n){"use strict";n.d(t,{$6:function(){return D},$q:function(){return C},CA:function(){return g},CR:function(){return _},Eq:function(){return N},F6:function(){return h},KU:function(){return E},ML:function(){return p},SL:function(){return I},Tw:function(){return P},UU:function(){return f},UX:function(){return M},W3:function(){return R},XU:function(){return A},Xg:function(){return y},YE:function(){return F},cC:function(){return S},dG:function(){return u},iM:function(){return w},p3:function(){return b},rL:function(){return l},sO:function(){return T},t3:function(){return x},t_:function(){return m},xN:function(){return k},ym:function(){return L}});var r=n(89378),o=n(18717),i=n(89805),a=n(81913),s=n(94828),d=n(29881),c=n(55684),u=function(e){return e.commentState.contextState.isReadOnly},l=function(e){return e.commentState.topVisibleThreadId},m=function(e){return e.commentState.personaIconPropertiesMap},f=function(e){return e.commentState.cardViewState},p=function(e){return e.commentState.highlightedCommentId},g=function(e){return(0,s.E)(e.commentState)?e.commentState.postData:e.commentState.commentData},C=function(e){return(0,s.E)(e.commentState)?e.commentState.commentThreadIds:e.commentState.commentData},h=function(e){var t=d.L3(e);if(t){if(d.a7(e)){var n=d.cw(e);return t.supportedContentTypes!==r.cM.CommentThread&&(n=n.filter((function(e){return e.contentType===r.cM.CommentThread}))),n.map((function(e){return e.contentId}))}return[]}return C(e)},v={},y=function(e){return(0,s.E)(e.commentState)?e.commentState.cardPostIds:v},T=function(e){return C(e).length>0},I=function(e){return h(e).length>0},S=function(e){return e.commentState.postViewState},A=function(e){return e.commentState.draftState},_=function(e){return(0,a.rB)(A(e))},D=function(e){return e.commentState.selectedComment},E=function(e){return e.commentState.expandedComments},P=function(e){return e.commentState.pendingCommentLoad},x=function(e){return e.commentState.selectedThreadIdBeforeCommentSession},b=function(e){return e.commentState.contextState},k=function(e,t,n){return(0,a.tN)(A(e),t,n)},w=function(e,t,n){return e.commentState.createdCommentLie&&k(e,t,n)?e.commentState.createdCommentLie:void 0},R=function(){return(0,o.Mz)([C,d.cw,y,g,w,A,c.x,d.L3],(function(e,t,n,r,o,a,s,d){return d?i.Yv(t,n,r,s,o,a):i.ze(e,n,r,s)}))},F=function(e){return e.commentState.modelCapabilities},N=function(e){return e.commentState.suggestionsDetails},M=function(e,t){return t?(0,s.YO)(g(e),t):void 0},L=function(){return(0,o.Mz)([d.cw,D,d.L3],(function(e,t,n){return n&&t?e.some((function(e){return e.contentType===r.cM.CommentThread&&t.selectedCardId===e.contentId}))?t:void 0:t}))}},36297:function(e,t,n){"use strict";n.d(t,{Jl:function(){return a},df:function(){return s},v5:function(){return i},yl:function(){return d}});var r=n(77042),o=n(89378),i=function(e){return e.contentExtensions.extensions},a=function(e,t){var n=i(e)[t];return void 0!==n&&n.priority!==o.OR.Disabled},s=function(e,t){if(!t)return!1;switch(t.renderMode){case o.G9.Integrated:case o.G9.TaskPaneItem:return void 0!==(n=i(e)[t.renderMode])&&n.priority!==o.OR.Disabled;case o.G9.Isolated:var n;return void 0!==(n=i(e)[t.renderMode])&&n.controller.provider.getExtension(t.threadId).priority!==o.OR.Disabled;default:(0,r.HB)(t)}},d=function(e){return e.contentExtensions.contentNavigationSupported}},29881:function(e,t,n){"use strict";n.d(t,{DX:function(){return i},KN:function(){return o},L3:function(){return c},U$:function(){return l},Wk:function(){return u},a7:function(){return r},cw:function(){return s},hI:function(){return d}});var r=function(e){return e.filterState.activeFilterId},o=function(e){var t,n=e.filterState.activeFilterId;if(n)return null===(t=e.filterState.filteredRanges[n])||void 0===t?void 0:t.filter},i=function(e,t){return e.filterState.filteredRanges[t]},a=[],s=function(e){var t,n,r=e.filterState.activeFilterId;return r&&null!==(n=null===(t=e.filterState.filteredRanges[r])||void 0===t?void 0:t.order)&&void 0!==n?n:a},d=function(e){return s(e).length},c=function(e){return e.filterState.filteringCapabilities},u=function(e){return e.filterState.ensureActiveFilter},l=function(e){return e.filterState.collaborators}},29273:function(e,t,n){"use strict";n.d(t,{AH:function(){return p},JS:function(){return c},Xy:function(){return u},vL:function(){return l},yg:function(){return m},zm:function(){return f}});var r=n(18717),o=n(30564),i=n(9749),a=n(81913),s=n(85844),d=n(29881),c=function(e){return e.paneState.visibilityState===o.Y.Visible},u=function(e){return e.paneState.visibilityState!==o.Y.Closed},l=function(e){return e.paneState.visibilityState},m=function(e){return e.paneState.componentTree},f=function(e){return e.paneState.viewContainer},p=function(e){return(0,r.Mz)([e,d.L3,s.XU],(function(e,t,n){var r;if(!t&&e&&(0,a.tN)(n)===e.selectedCardId){var o=null===(r=n.drafts[e.selectedCardId])||void 0===r?void 0:r.renderContextType;if(void 0!==o&&!(0,i.pZ)(o))return}return e}))}},55684:function(e,t,n){"use strict";n.d(t,{J:function(){return a},x:function(){return i}});var r=n(94344),o={},i=function(e){return(0,r.$H)()?e.commentState.tasks:o},a=function(e){return e.commentState.historyRecordViewState}},94828:function(e,t,n){"use strict";n.d(t,{E:function(){return s},OJ:function(){return d},YO:function(){return c},ZY:function(){return o},_A:function(){return i},x2:function(){return a}});var r=n(94344);function o(e){return r.rR()}function i(e){return r.rR()}function a(e){return r.rR()||0===e.length||"string"==typeof e[0]}function s(e){return r.rR()}function d(e){return s()?e.postData:e.commentData}function c(e,t){return i()?e[t]:e.find((function(e){return e.commentId===t}))}},24857:function(e,t,n){"use strict";var r;n.d(t,{A:function(){return r}}),function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"}(r||(r={}))},75802:function(e,t,n){"use strict";var r;n.d(t,{z:function(){return r}}),function(e){e.A="a",e.C="c",e.V="v",e.X="x",e.Alt="Alt",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.End="End",e.Enter="Enter",e.Escape="Escape",e.Home="Home",e.Meta="Meta",e.Shift="Shift",e.Space=" ",e.Tab="Tab",e.F6="F6",e.F12="F12"}(r||(r={}))},52505:function(e,t,n){"use strict";var r;n.d(t,{AM:function(){return r},Ad:function(){return i.A},zG:function(){return a.z},O5:function(){return o}}),function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(r||(r={}));var o,i=n(24857),a=n(75802);!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"}(o||(o={}))},53972:function(e,t,n){"use strict";n.d(t,{l:function(){return i},x:function(){return o}});var r=n(52505);function o(e,t){if(!t)return e;switch(e){case r.zG.ArrowLeft:return r.zG.ArrowRight;case r.zG.ArrowRight:return r.zG.ArrowLeft;default:return e}}function i(e){switch(e){case"Down":return r.zG.ArrowDown;case"Up":return r.zG.ArrowUp;case"Left":return r.zG.ArrowLeft;case"Right":return r.zG.ArrowRight;case"OS":return r.zG.Meta;case"Del":return r.zG.Delete;case"Spacebar":return" ";case"Esc":return r.zG.Escape;case"Ctrl":case"Ctl":return r.zG.Control;case"F6":return r.zG.F6;case"F12":return r.zG.F12;default:return e}}},90496:function(e,t,n){"use strict";n.d(t,{AM:function(){return s.AM},zG:function(){return s.zG},O5:function(){return s.O5},xU:function(){return d.x},l5:function(){return d.l}});var r,o,i=n(76149),a=i.createContext(void 0);(o=r||(r={}))[o.Forward=0]="Forward",o[o.Reverse=1]="Reverse";var s=n(52505),d=n(53972);s.zG.Tab,s.AM.AtTarget,s.zG.Tab,s.AM.AtTarget;var c=n(24857);function u(e){return e.isFocusOn?c.A.FocusOn:e.isFocusWithin?c.A.FocusWithin:c.A.Unfocused}var l=n(90853);n(60377),function(){function e(e,t,n,r,o){this.nodeId=e,this.nodeData=t,this.tabbable=n,this.onFocusStateChange=r,this.focusState=o,this.registrationRef=i.createRef(),this.innerComponentRef=i.createRef()}e.prototype.onEffect=function(e,t,n,r){this.nodeData=e,this.tabbable=t,this.onFocusStateChange=n;var o=this.focusState;this.focusState=r,u(o)!==u(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return(0,l.__generator)(this,(function(e){switch(e.label){case 0:return[4,this];case 1:return e.sent(),[2]}}))},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return u(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===c.A.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.focus()},e.prototype.blur=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.blur()}}();var m=function(){var e=this;this.root=null,this.getRoot=function(){return e.root},this.setRoot=function(t){e.root=t}},f=(function(){function e(e){var t=this;this.viewTreeMap=new Map,e&&e.viewTreeMap.forEach((function(e,n){return t.viewTreeMap.set(n,e)}))}e.prototype.updateIdForViewTree=function(e,t){var n=this.viewTreeMap.get(e);return!!n&&(this.viewTreeMap.set(t,n),this.viewTreeMap.delete(e),!0)},e.prototype.getOrCreateViewTreeById=function(e){var t=this.viewTreeMap.get(e);return t||(t=new m,this.viewTreeMap.set(e,t)),t},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(e){var t,n,r;try{for(var o=(0,l.__values)(this.viewTreeMap.values()),i=o.next();!i.done;i=o.next()){var a=null===(r=i.value.getRoot())||void 0===r?void 0:r.getDescendantById(e);if(a)return a}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}}(),Object.defineProperty(function(){var e=this;this.ref=i.createRef(),this.focus=function(){e.ref&&e.ref.current&&e.ref.current.focus()},this.blur=function(){e.ref&&e.ref.current&&e.ref.current.blur()},this.getFocusState=function(){return e.ref&&e.ref.current?e.ref.current.getFocusState():s.Ad.Unfocused},this.getNextTabTarget=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.getNextTabTarget(t,n)},this.isTabbable=function(){return!(!e.ref||!e.ref.current)&&e.ref.current.isTabbable()},this.getChildNodes=function(){return e.ref&&e.ref.current?e.ref.current.getChildNodes():[]},this.addChildNode=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.addChildNode(t,n)},this.getId=function(){return e.ref&&e.ref.current?e.ref.current.getId():""},this.getData=function(){if(e.ref&&e.ref.current)return e.ref.current.getData()},this.getDescendantById=function(t){if(e.ref&&e.ref.current)return e.ref.current.getDescendantById(t)},this.getIterator=function(){return e.ref&&e.ref.current?e.ref.current.getIterator():{next:function(){return{done:!0,value:e}}}}}.prototype,"disabled",{get:function(){return!(!this.ref.current||!this.ref.current.disabled)},enumerable:!1,configurable:!0}),function(e){function t(){var t=e.apply(this,(0,l.__spreadArray)([],(0,l.__read)(arguments),!1))||this;return t.registrationToken=void 0,t.onFocusStateChange=function(e){t.registrationToken&&t.registrationToken.onFocusStateChange(e)},t}return(0,l.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,(function(){return e.props.position})))},t.prototype.componentWillUnmount=function(){this.registrationToken&&(this.registrationToken.unregister(),this.registrationToken=void 0)},t.prototype.render=function(){return i.Children.only(this.props.children)},t}(i.PureComponent));!function(e){function t(){var t=e.apply(this,(0,l.__spreadArray)([],(0,l.__read)(arguments),!1))||this;return t.registrationHelperRef=i.createRef(),t.onFocusStateChange=function(e){t.registrationHelperRef.current&&t.registrationHelperRef.current.onFocusStateChange(e)},t}(0,l.__extends)(t,e),t.prototype.render=function(){var e=this;return i.createElement(a.Consumer,null,(function(t){return i.createElement(f,{parentNode:t,node:e.props.node,ref:e.registrationHelperRef,position:e.props.position},e.props.children)}))}}(i.PureComponent)},86392:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaFormattingType=void 0,(n=t.DeltaFormattingType||(t.DeltaFormattingType={}))[n.None=0]="None",n[n.Text=1]="Text",n[n.Image=2]="Image",n[n.Table=4]="Table",n[n.Weight=8]="Weight",n[n.Underline=16]="Underline",n[n.Strikethrough=32]="Strikethrough",n[n.Italic=64]="Italic",n[n.Mention=128]="Mention",n[n.Hyperlink=256]="Hyperlink",n[n.Color=512]="Color",n[n.Highlight=1024]="Highlight",n[n.FontSize=2048]="FontSize",n[n.FontFamily=4096]="FontFamily",n[n.AltText=8192]="AltText",n[n.Optional=16384]="Optional",n[n.Paragraph=32768]="Paragraph",n[n.Language=65536]="Language",n[n.SubsscriptAndSuperscript=131072]="SubsscriptAndSuperscript",n[n.BadMentionFormat=134217728]="BadMentionFormat",n[n.UnknownAttribute=268435456]="UnknownAttribute",n[n.Unsupported=536870912]="Unsupported",n[n.Unknown=1073741824]="Unknown",n[n.TextAndMentions=129]="TextAndMentions",n[n.TextAndParagraph=32769]="TextAndParagraph",n[n.AllFormatting=262143]="AllFormatting",n[n.InvalidFormatting=2013265920]="InvalidFormatting"},50202:function(e,t,n){n(67222),n(46595).Array.findIndex},52875:function(e,t,n){n(33479),n(46595).Array.find},59405:function(e,t,n){n(22384),n(46595).Array.includes},62629:function(e,t,n){n(7111),n(46595).Object.assign},54453:function(e,t,n){n(13188),n(46595).String.trimRight},31394:function(e){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},54253:function(e,t,n){var r=n(1665)("unscopables"),o=Array.prototype;null==o[r]&&n(95828)(o,r,{}),e.exports=function(e){o[r][e]=!0}},49887:function(e,t,n){var r=n(36538);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},17305:function(e,t,n){var r=n(50064),o=n(83558),i=n(36658);e.exports=function(e){return function(t,n,a){var s,d=r(t),c=o(d.length),u=i(a,c);if(e&&n!=n){for(;c>u;)if((s=d[u++])!=s)return!0}else for(;c>u;u++)if((e||u in d)&&d[u]===n)return e||u||0;return!e&&-1}}},52728:function(e,t,n){var r=n(607),o=n(4842),i=n(1453),a=n(83558),s=n(90405);e.exports=function(e,t){var n=1==e,d=2==e,c=3==e,u=4==e,l=6==e,m=5==e||l,f=t||s;return function(t,s,p){for(var g,C,h=i(t),v=o(h),y=r(s,p,3),T=a(v.length),I=0,S=n?f(t,T):d?f(t,0):void 0;T>I;I++)if((m||I in v)&&(C=y(g=v[I],I,h),e))if(n)S[I]=C;else if(C)switch(e){case 3:return!0;case 5:return g;case 6:return I;case 2:S.push(g)}else if(u)return!1;return l?-1:c||u?u:S}}},22449:function(e,t,n){var r=n(36538),o=n(46144),i=n(1665)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},90405:function(e,t,n){var r=n(22449);e.exports=function(e,t){return new(r(e))(t)}},56614:function(e){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},46595:function(e){var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},607:function(e,t,n){var r=n(31394);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},5079:function(e){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},67940:function(e,t,n){e.exports=!n(24279)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},65395:function(e,t,n){var r=n(36538),o=n(6227).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},15023:function(e){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},20670:function(e,t,n){var r=n(6227),o=n(46595),i=n(95828),a=n(87802),s=n(607),d="prototype",c=function(e,t,n){var u,l,m,f,p=e&c.F,g=e&c.G,C=e&c.S,h=e&c.P,v=e&c.B,y=g?r:C?r[t]||(r[t]={}):(r[t]||{})[d],T=g?o:o[t]||(o[t]={}),I=T[d]||(T[d]={});for(u in g&&(n=t),n)m=((l=!p&&y&&void 0!==y[u])?y:n)[u],f=v&&l?s(m,r):h&&"function"==typeof m?s(Function.call,m):m,y&&a(y,u,m,e&c.U),T[u]!=m&&i(T,u,f),h&&I[u]!=m&&(I[u]=m)};r.core=o,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},24279:function(e){e.exports=function(e){try{return!!e()}catch(e){return!0}}},82752:function(e,t,n){e.exports=n(16553)("native-function-to-string",Function.toString)},6227:function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},25598:function(e){var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},95828:function(e,t,n){var r=n(4884),o=n(73979);e.exports=n(67940)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},90005:function(e,t,n){e.exports=!n(67940)&&!n(24279)((function(){return 7!=Object.defineProperty(n(65395)("div"),"a",{get:function(){return 7}}).a}))},4842:function(e,t,n){var r=n(56614);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},46144:function(e,t,n){var r=n(56614);e.exports=Array.isArray||function(e){return"Array"==r(e)}},36538:function(e){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},61165:function(e){e.exports=!1},43677:function(e,t,n){"use strict";var r=n(67940),o=n(32200),i=n(84087),a=n(20908),s=n(1453),d=n(4842),c=Object.assign;e.exports=!c||n(24279)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=r}))?function(e,t){for(var n=s(e),c=arguments.length,u=1,l=i.f,m=a.f;c>u;)for(var f,p=d(arguments[u++]),g=l?o(p).concat(l(p)):o(p),C=g.length,h=0;C>h;)f=g[h++],r&&!m.call(p,f)||(n[f]=p[f]);return n}:c},4884:function(e,t,n){var r=n(49887),o=n(90005),i=n(42801),a=Object.defineProperty;t.f=n(67940)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},84087:function(e,t){t.f=Object.getOwnPropertySymbols},21740:function(e,t,n){var r=n(25598),o=n(50064),i=n(17305)(!1),a=n(4175)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),d=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;t.length>d;)r(s,n=t[d++])&&(~i(c,n)||c.push(n));return c}},32200:function(e,t,n){var r=n(21740),o=n(15023);e.exports=Object.keys||function(e){return r(e,o)}},20908:function(e,t){t.f={}.propertyIsEnumerable},73979:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},87802:function(e,t,n){var r=n(6227),o=n(95828),i=n(25598),a=n(49176)("src"),s=n(82752),d="toString",c=(""+s).split(d);n(46595).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var d="function"==typeof n;d&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(d&&(i(n,a)||o(n,a,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,d,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},4175:function(e,t,n){var r=n(16553)("keys"),o=n(49176);e.exports=function(e){return r[e]||(r[e]=o(e))}},16553:function(e,t,n){var r=n(46595),o=n(6227),i="__core-js_shared__",a=o[i]||(o[i]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(61165)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},44610:function(e,t,n){var r=n(20670),o=n(5079),i=n(24279),a=n(42228),s="["+a+"]",d=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),u=function(e,t,n){var o={},s=i((function(){return!!a[e]()||""!=""[e]()})),d=o[e]=s?t(l):a[e];n&&(o[n]=d),r(r.P+r.F*s,"String",o)},l=u.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(d,"")),2&t&&(e=e.replace(c,"")),e};e.exports=u},42228:function(e){e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},36658:function(e,t,n){var r=n(8126),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},8126:function(e){var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},50064:function(e,t,n){var r=n(4842),o=n(5079);e.exports=function(e){return r(o(e))}},83558:function(e,t,n){var r=n(8126),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},1453:function(e,t,n){var r=n(5079);e.exports=function(e){return Object(r(e))}},42801:function(e,t,n){var r=n(36538);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},49176:function(e){var t=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+n).toString(36))}},1665:function(e,t,n){var r=n(16553)("wks"),o=n(49176),i=n(6227).Symbol,a="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=r},67222:function(e,t,n){"use strict";var r=n(20670),o=n(52728)(6),i="findIndex",a=!0;i in[]&&Array(1)[i]((function(){a=!1})),r(r.P+r.F*a,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(54253)(i)},33479:function(e,t,n){"use strict";var r=n(20670),o=n(52728)(5),i="find",a=!0;i in[]&&Array(1)[i]((function(){a=!1})),r(r.P+r.F*a,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(54253)(i)},7111:function(e,t,n){var r=n(20670);r(r.S+r.F,"Object",{assign:n(43677)})},22384:function(e,t,n){"use strict";var r=n(20670),o=n(17305)(!0);r(r.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(54253)("includes")},13188:function(e,t,n){"use strict";n(44610)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},5369:function(e,t,n){"use strict";n.r(t),n.d(t,{RichContentEditAPIFactoryGlobal:function(){return m.xe},ScreenReaderNotifierManagerFactoryGlobal:function(){return j.aY},initializeRuntime:function(){return oe},instantiate:function(){return Ao},setDarkModeColorHandler:function(){return _o},setWebpackPublicPath:function(){return vo.q}}),n(59405),n(52875),n(54453);var r=n(10827),o=n(13502),i=n(77042),a=n(59502),s=n(55777),d=n(65203),c=n(67937),u=(n(50597),n(20797)),l=n(89378),m=(n(50202),n(62629),n(1828)),f=n(33055),p=n(56704),g=n(99553),C=n(65336),h=n(90853),v=n(94344),y=function(){function e(){this._listeners=[]}return e.prototype.add=function(e){this._listeners.push(e)},e.prototype.remove=function(e){var t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var e=this;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e._listeners.forEach((function(e){return e.apply(void 0,(0,h.__spreadArray)([],(0,h.__read)(t),!1))}))}},enumerable:!1,configurable:!0}),e}();const T=y;var I=function(){function e(){var e=this;this.changedEvent=new T,this.fireEvent=function(t){e.changedEvent.invoke(t)}}return e.prototype.registerForViewContainerEvents=function(e){this.changedEvent.add(e)},e.prototype.unregisterForViewContainerEvents=function(e){this.changedEvent.remove(e)},e}(),S=function(){function e(e,t,n){this.viewContainerBase=e,this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.identifier=e.identifier}return e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.moveFocusToCanvas_donotuse=function(){this.viewContainerBase.moveFocusToCanvas_donotuse&&this.viewContainerBase.moveFocusToCanvas_donotuse()},e}(),A=n(76149),_=n(38035),D=n(75847),E=n(69084),P="SharedCommentPane";function x(e,t){return"".concat(e,"-").concat(t)}var b,k=n(33195),w=n(57859),R=n(88899);!function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(b||(b={}));var F={sendCodeMarker:function(e){},onStartEvent:new R.EventImpl((function(){})),onStopEvent:new R.EventImpl((function(){}))};const N=function(e){this.onMockUIAction=new R.EventImpl((function(){}))};var M=n(70167),L=n(22245),O=n(52700),B=n(75789),V=function(e,t){var n=this;this.commentViewManager=e,this.correlationId=t,this.visit=function(e){e.attachContext(n.commentViewManager.apiContext),n.correlationId&&e.addDataField("InstanceCorrelationId",n.correlationId,d.LG.SystemMetadata)}};function U(e){return new V(H(e),e.correlationId)}var H=function(){throw new Error("ViewManagerFactory not set")};const G=new(function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(e){var t=this;return this.instanceMap.get(e)||{visit:function(n){var r=t.instanceMap.get(e);if(!r)return n.attachContext(e),void n.addDataField("MissingInstanceTelemetry",!0,d.LG.SystemMetadata);r.visit(n)}}},e.prototype.closeViewManager=function(e){var t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))},e.prototype.disposeViewManager=function(){var e=this;this.instanceMap.forEach((function(t,n){(0,w.Nz)(n),e.closeViewManager(n)}))},e.prototype.doesViewManagerExist=function(e){return this.instanceMap.has(e)},e.prototype.ensureViewManager=function(e){var t=e.apiContext,n=e.displayMode,r=e.contentNavigationAPIMockSettings,o=e.contentFilteredRangeHostAPIMockSettings;this.initialized||this.ensureInitialized();var i=this.instanceMap.get(t);return i?this.updateInstanceObject(i,n):(this.initializeContentNavigationAPI(t,r),this.initializeContentFilteredRangeAPI(t,o),i=U(e),this.instanceMap.set(t,i)),i.commentViewManager},e.prototype.getCorrelationId=function(e){var t=this.instanceMap.get(e);return t&&t.correlationId},e.prototype.getStore=function(e){var t=this.instanceMap.get(e);if(!t)throw new B.cP("Instance is not initialized",i.m2.reserveTag(589103622),-2130957512);return t.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(e){var t=this.tryGetViewManager(e);if(!t)throw new B.cP("Instance is not initialized",i.m2.reserveTag(589103623),-2130957512);return t},e.prototype.tryGetViewManager=function(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager},e.prototype.ensureInitialized=function(){var e=this;v.Ff()&&F.onStartEvent.subscribe((function(t){e.initializeContentNavigationAPI(t.context,void 0),e.initializeContentFilteredRangeAPI(t.context,void 0),e.initializeViewManager(t.context,t.correlationId,t.useMockMode)})),F.onStopEvent.subscribe((function(t){e.closeViewManager(t.context),(0,w.Nz)(t.context)})),this.initialized=!0},e.prototype.initializeViewManager=function(e,t,n){var r=this.instanceMap.get(e);if(r)r.correlationId=t;else{var o=void 0;n&&v.W2()&&((0,d.i7)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent})).successTag(592511450),o=new N(e)),this.instanceMap.set(e,U({apiContext:e,correlationId:t,initializationReason:O.A.PaneOpen,displayMode:L.A.FullPane,foldableLayoutState:M.b.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:o}))}},e.prototype.updateInstanceObject=function(e,t){var n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)},e.prototype.initializeContentNavigationAPI=function(e,t){if(!(0,w.cz)(e)){if(t)return void(t.useMock&&(0,w.AA)(t.mock,e));var n=new w.wI(e);n.isAPIEnabled()&&(0,w.AA)(n,e)}},e.prototype.initializeContentFilteredRangeAPI=function(e,t){if(!(0,k.Q8)(e)){if(t)return void(t.useMock&&(0,k.Gs)(e,t.mock));(0,k.Gs)(e,new k.IY(e))}},e}());var z=n(30564),q=n(38569),W=function(){function e(e,t,n){var r=this;this.viewContainerBase=e,this.context=t,this.viewContainerProvider=n,this.rootNode=null,this.lastRenderFailed=!1,this.processVisibilityEvent=function(e){switch(e.viewContainerVisibilityState){case z.Y.Visible:r.viewContainerBase.identifier?r.rootNode=document.getElementById(r.viewContainerBase.identifier):(0,d.i7)().assertConditionTag(!1,"View container base identifier expected",558401364),r.providerPromise.then((function(e){r.renderIntoView(e)})).catch((0,E.L)(i.m2.reserveTag(558401365)));break;case z.Y.Closed:r.viewContainerBase.identifier&&r.rootNode&&((0,_.unmountComponentAtNode)(r.rootNode),r.rootNode=null);break;case z.Y.Hidden:(0,d.i7)().assertConditionTag(!1,"ViewContainerVisibilityState.Hidden is not currently supported for web.",558401366);break;default:(0,i.HB)(e.viewContainerVisibilityState)}},this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.onViewEventReceived=this.onViewEventReceived.bind(this),this.onProviderStateChange=this.onProviderStateChange.bind(this);var o=x(P,t);this.viewContainerProvider&&(this.viewContainerProvider.registerForViewContainerEvents(this.onViewEventReceived),this.providerPromise=(0,u.l9)().getComponent(o),this.providerPromise.then((function(e){e.onStateChanged.subscribe(r.onProviderStateChange)})).catch((0,E.L)(i.m2.reserveTag(558401359))))}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.viewContainerBase.identifier},enumerable:!1,configurable:!0}),e.prototype.renderIntoView=function(e){this.renderPane(e)},e.prototype.renderPane=function(e){var t=this,n=e.component,r=(0,d.i7)().createActivityObject("RenderPaneIntoView",G.getTelemetryVisitor(this.context),(0,d.Zx)());if(!n)return this.lastRenderFailed&&r.failTag(558401360,-2130957502),void(this.lastRenderFailed=!0);(0,_.render)(A.createElement(n,{resource:{id:"CommentPane"}}),this.rootNode,(function(){var e=document.getElementById(D.E4());e&&e.focus(),t.lastRenderFailed=!1})),r.successTag(558401361)},e.prototype.onProviderStateChange=function(e){var t=this;this.rootNode&&(e===u.qN.Registered?this.providerPromise.then((function(e){t.renderIntoView(e)})).catch((function(e){(0,d.i7)().assertConditionTag(!1,"Unexpected promise rejection from component provider promise",558401362)})):e===u.qN.Unregistered&&(0,_.unmountComponentAtNode)(this.rootNode))},e.prototype.onViewEventReceived=function(e){var t;switch(e.eventType){case q.F.VisibilityChanged:this.processVisibilityEvent(e);break;case q.F.ViewContainerChanged:e.newViewContainer!==this&&(null===(t=this.viewContainerProvider)||void 0===t||t.unregisterForViewContainerEvents(this.onViewEventReceived));break;case q.F.FoldableLayoutStateChanged:case q.F.FocusTriggered:break;default:(0,i.HB)(e)}},e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.closeView=function(){this.viewContainerBase.closeView()},e.prototype.moveFocusToCanvas_donotuse=function(){},e}();const Y=function(e){function t(t,n){var r=e.call(this)||this;return r.viewContainerProvider=n,r.apiContext=t,n.registerForViewContainerEvents(r.fireEvent),r}return(0,h.__extends)(t,e),t.prototype.getViewContainer=function(){return this.currentContainer||(v.IF()?this.currentContainer=new S(this.viewContainerProvider.getViewContainer(),this.apiContext,this):this.currentContainer=new W(this.viewContainerProvider.getViewContainer(),this.apiContext,this)),this.currentContainer},t.prototype.changeViewContainerType=function(e){},t}(I);var j=n(58605),X=(0,n(13163).J9)((function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:0,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:0}}})),K=function(e){function t(t){var n=e.call(this,t)||this;return n.state={liveRegionUpdate:t.liveRegionUpdate,liveRegionCounter:0},n}return(0,h.__extends)(t,e),t.prototype.appendLiveRegionUpdate=function(e){var t=this,n=this.state.liveRegionCounter+1;this.setState({liveRegionUpdate:e,liveRegionCounter:n}),setTimeout((function(){t.state.liveRegionCounter===n&&t.setState({liveRegionUpdate:void 0,liveRegionCounter:0})}),1e3)},t.prototype.render=function(){var e=X();return A.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",style:e.offscreenLiveRegion},this.state.liveRegionUpdate)},t}(A.PureComponent),$=void 0;var Z=void 0;function J(e){Z=e}var Q=n(95886),ee=(n(91294),n(88836)),te=n(91619),ne={name:"OfficeSharedComments",version:n(21861).A};function re(){return G.getViewManager(o.T)}function oe(){re().beginInitialization()}var ie=n(50577),ae=n(88652),se=n(5402),de=n(33917),ce=function(){function e(e,t,n,r,o){var i=this;this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=r,this._insertIndex=o,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(e){e.draftId===i.sessionConfiguration.draftId&&(e.anchorHintText&&(i._anchorHintText=e.anchorHintText),void 0!==e.insertIndex&&(i._insertIndex=e.insertIndex))},this.handleCommentEvents=function(e,t){e===se.Oj.CommentContextChanged&&(0,de.Fz)(t)&&t.contextDrafts?t.contextDrafts.forEach((function(e){return i.updateDraft(e)})):e===se.Oj.UpdateDraftThread&&(0,de.ne)(t)&&i.updateDraft(t)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(e,t){this._propertiesToUpdate[e]=(0,h.__assign)({},t)},e.prototype.commit=function(e){if(!this.hostCommentAPI.commit)throw new B.cP(ae.MS,i.m2.reserveTag(589103689),-2130957526);if(!this._active)throw new B.cP(ae.Ft,i.m2.reserveTag(589103690),-2130957525);var t=v.$H()||v.b(),n=t&&this.sessionConfiguration.sessionType===se.q3;if(void 0===e&&!n||n&&void 0!==e)throw new B.cP(ae.Mb,i.m2.reserveTag(589103691),-2130957507);return t?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}(),ue=function(){function e(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),e.getCommentReactionData&&(this.getCommentReactionData=e.getCommentReactionData.bind(e)),v.aZ()&&(this.presentLinkToComment=e.presentLinkToComment.bind(e)),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e)),e.onClickableTextClicked&&(this.onClickableTextClicked=e.onClickableTextClicked.bind(e))}return e.prototype.beginDraftingAsync=function(e){var t=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new B.cP("Drafting APIs are undefined on Host Comment API",i.m2.reserveTag(589103700),-2130957527);var n=(0,a.g)(),r=(0,h.__assign)((0,h.__assign)({},e),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(r).then((function(e){return new ce(t.hostCommentAPI,(0,ie.vZ)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||r,e.insertIndex)}))},e}(),le=n(3414),me={themeId:1,palette:{ButtonBorder:le.x.GRAY_B,CardAccent:le.x.GRAY_B,CardBackground:le.x.WHITE,CardHoveredBackground:le.x.GRAY_20,CardDraftBoxBackgroundHovered:le.x.WHITE,CardDraftBoxBorderHovered:le.x.GRAY_160,CardDraftBoxBorder:le.x.GRAY_110,CardDraftBoxBackground_HalfPane:le.x.WHITE,CardDraftBoxBackground:le.x.GRAY_A,CardExpandButtonBorder:le.x.GRAY_B,CardHeroBarBackground_HalfPane:le.x.GRAY_A,CardHeroBarBackground:le.x.WHITE,CardReplyBackground_HalfPane:le.x.GRAY_A,CardReplyBackground:le.x.GRAY_A,CardReplyTopBorder:le.x.GRAY_B,CardSelectionColor:le.x.COMMENTS_PURPLE,CardShadowColor:le.x.BLACK,CardBorder:le.x.GRAY_B,CardBorderEmphasis:le.x.COMMENTS_PURPLE,CommandBarBorder:le.x.GRAY_B,CommandBarTopBorder:le.x.GRAY_B,IconButtonDisabledTint:le.x.GRAY_C,IconButtonFocusedTint:le.x.GRAY_I,NavigationBarBackground:le.x.WHITE,NavigationBarBorder:le.x.GRAY_B,PaneBackground_HalfPane:le.x.WHITE,PaneBackground:le.x.GRAY_A,UnreadDotColor:le.x.DOT_BLUE,UnreadDotBorderColor:le.x.WHITE,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:le.x.GRAY_150,CardPlaceholderColor:le.x.GRAY_130,ResolvedCardBackground:le.x.GRAY_20}},fe=function(){function e(){}return e.prototype.getTheme=function(){return(0,d.i7)().assertConditionTag(!1,"Should not be called",592986821),me},e.prototype.registerForThemeChange=function(e){},e.prototype.unregisterForThemeChange=function(e){},e}(),pe=n(72429),ge=n(90496),Ce=n(12595),he=n(85526),ve=n(55309),ye=n(95187),Te=n(78062),Ie=n(45610),Se=n(81913),Ae=n(45680),_e=n(20478),De=n(47513),Ee=n(85844),Pe=n(29881),xe=n(29273),be=n(94828),ke=n(5326),we=n(38024),Re=n(78984),Fe=n(44579),Ne=n(28760),Me=n(55925),Le=n(9749),Oe=n(6946),Be=n(88723),Ve=n(17310),Ue=n(68631),He=n(58462);function Ge(e,t){return!!((0,He.Xk)(t)?e.getComponentById(t):e.getComponent(t.componentType))}function ze(e,t,n){var r,o,i;if(void 0===n&&(n={priority:1}),(0,Le.pZ)(e.componentTreeId.renderContextType)){var a=null!==(i=null!==(o=null!==(r=function(e,t,n){if(v.Fr()&&e.componentTreeId.renderContextType===Fe.A.FullPane){var r=t.getState();if(Ee.YE(r).newThread){if(e.getComponent(He.I5.NewCommentButton))return(0,Be.F)(void 0,{componentType:He.I5.NewCommentButton},{priorityArgs:n});(0,d.i7)().assertConditionTag(!1,"cannot find new comment button, but its enabled",579086400)}}}(e,t,n))&&void 0!==r?r:function(e,t,n){if(v.HX()&&e.componentTreeId.renderContextType===Fe.A.FullPane){var r=t.getState();if(Pe.L3(r)){if(e.getComponent(He.I5.FilterButton))return(0,Be.F)(void 0,{componentType:He.I5.FilterButton},{priorityArgs:n});(0,d.i7)().assertConditionTag(!1,"cannot find filter button in full pane with filtering enabled",507339343)}}}(e,t,n))&&void 0!==o?o:function(e,t){if(n=e.componentTreeId.renderContextType,!("win32"===(0,Me.u)()||"web"===(0,Me.u)()&&v.IF())&&(0,Le.pZ)(n)){var n;if(e.getComponent(He.I5.ClosePaneButton))return(0,Be.F)(void 0,{componentType:He.I5.ClosePaneButton},{priorityArgs:t});(0,d.i7)().assertConditionTag(!1,"cannot find close button on platform where we should be able to find it",579086371)}}(e,n))&&void 0!==i?i:function(e){if("web"!==(0,Me.u)())return(0,Be.F)(void 0,{componentType:He.I5.CommentsList},{priorityArgs:e})}(n);if(a)return a;(0,d.i7)().assertConditionTag(!1,"Couldn't find a focus target",576337158)}else(0,d.i7)().assertConditionTag(!1,"Shouldn't be called with renderContextType: ".concat(e.componentTreeId.renderContextType),576337157)}var qe=function(e){function t(t){var n=e.call(this,t)||this,r=t.nativeEvent,o=r.altKey,i=r.shiftKey,a=r.ctrlKey,s=r.metaKey,d=r.key;return n.altKey=o,n.shiftKey=i,n.ctrlKey=a,n.metaKey=s,n.key=(0,ge.l5)(d),n}return(0,h.__extends)(t,e),t}(function(){function e(e){this._sourceEvent=e,this.eventPhase=e.eventPhase}return e.prototype.isEventTarget=function(e){return e===this._sourceEvent.target},e.prototype.stopPropagation=function(){this._sourceEvent.stopPropagation()},e.prototype.preventDefault=function(){this._sourceEvent.preventDefault()},e}());function We(e,t,n,r,o){var i=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.apply(void 0,(0,h.__spreadArray)([e],(0,h.__read)(t),!1))},a=function(r){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];var d=i.apply(void 0,(0,h.__spreadArray)([r],(0,h.__read)(a),!1));o(d,r,e(),t,n)};return a.processCommand=i,a}function Ye(e,t,n,r,o){var i=function(e,o){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];if(n(o)){var s=(0,ge.xU)((0,ge.l5)(e.key),t),d=r[ge.zG[s]];return d?d.handler.apply(d,(0,h.__spreadArray)([e,o],(0,h.__read)(i),!1)):void 0}},a=Object.keys(r).map((function(e){return{key:e,eventPhase:r[e].phase}})),s=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return{onKeyDown:function(n){return function(t,n){var r,a=(0,h.__read)(n),s=a[0],d=a.slice(1),c=s();o(i.apply(void 0,(0,h.__spreadArray)([(r=t,new qe(r)),c],(0,h.__read)(d),!1)),c,e(),(function(){}),(function(){}))}(n,t)},getKeyDownEvents:function(){return a}}};return s.processEvent=i,s}var je,Xe,Ke=n(15761),$e=n(95389),Ze=n(38017),Je=n(99381),Qe=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.model[this.pointer]){var t=(0,Je.a)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find((function(e){return e.commentId===t}))}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.model.length&&e&&e.commentFlags&se.PJ.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&se.PJ.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),et=n(76198),tt=n(89805),nt=n(64307),rt=n(43357),ot=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.items[this.pointer]){var t=tt.Ee(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(var n=this.pointer;n>=0;--n){var r=this.items[n];if((0,rt.d)(r)&&r.commentModel.commentId===t)return r.commentModel}for(n=this.pointer+1;n<this.items.length;++n)if(r=this.items[n],(0,rt.d)(r)&&r.commentModel.commentId===t)return r.commentModel}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.items.length&&e&&e.commentFlags&nt.P.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&nt.P.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),it=n(9685),at=function(){function e(e,t,n){this.commentStore=e,this.telemetryVisitor=t,this.useContentNavigationAPI=n}return e.prototype.selectThreadInCurrentContext=function(e,t,n,r,o){return(0,Oe.Y)(e,ve.selectComment(t,n,void 0,r?ve.SelectActionType.ExpandCard:ve.SelectActionType.SelectCard,o))},e.prototype.collapseThreadInCurrentContext=function(e,t,n){return(0,Oe.Y)(e,ve.collapseCard(t,n))},e.prototype.selectPost=function(e,t,n,r,o){return(0,Oe.Y)(e,ve.selectComment(t,n,r,ve.SelectActionType.SelectPost,o))},e.prototype.selectFirstThreadInCurrentContext=function(e,t,n,r,o){if(!v.rR()&&v.S()){var a=Ee.iM(this.commentStore.getState(),!0,r),s=(0,Se.tN)(Ee.XU(this.commentStore.getState()),!0,r);if(s&&a&&0===a.flatIndex)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.m2.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},s,!1,n)}var d=void 0,c=o?Ee.$q(this.commentStore.getState()):Ee.F6(this.commentStore.getState());if((0,be.x2)(c))d=o?new et.L(c,Ee.CA(this.commentStore.getState()),-1).next().value:c[0];else{var u=void 0;d=null==(u=o?new et.C(c,-1,o).next().value:c[0])?void 0:u.commentId}if(d)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.m2.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},d,t,n)},e.prototype.selectLastThreadInCurrentContext=function(e,t,n,r,o){var a=Ee.CA(this.commentStore.getState());if(!(0,be._A)(a)&&v.S()){var s=Ee.iM(this.commentStore.getState(),!0,r),c=(0,Se.tN)(Ee.XU(this.commentStore.getState()),!0,r);if(c&&s&&s.flatIndex===a.length)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.m2.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},c,!1,n)}var u=o?Ee.$q(this.commentStore.getState()):Ee.F6(this.commentStore.getState());if((0,Se.wS)(u,a,o)){var l=void 0;if((0,be.x2)(u))l=o?new et.L(u,a,u.length).previous().value:u[u.length-1];else{var m=new et.C(u,u.length,o).previous().value;l=null==m?void 0:m.commentId}if(l)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.m2.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},l,t,n);(0,d.i7)().assertConditionTag(!1,"Unable to find last thread",593278812)}},e.prototype.focusAndCollapseSelectedThread=function(e,t){var n=Ee.$6(this.commentStore.getState());if(n){if(v.S()&&(0,Se.tN)(Ee.XU(this.commentStore.getState()))===n.selectedCardId)return;var r=Ee.KU(this.commentStore.getState());if((0,Ne.$)(n.selectedCardId,r,t)===ke.A.Expanded)return(0,it.s)(e,(0,Be.F)(e,{componentType:He.I5.Card,id:n.selectedCardId,renderContextType:t}),this.collapseThreadInCurrentContext(e,{renderContextType:t,trackback:i.m2.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},n.selectedCardId))}},e.prototype.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated=function(e,t,n,r,o,a,s,d){var c,u=t.direction===w.w.Next?e.next():e.previous();return v.S()&&n&&r&&o.selectedCardId!==n&&(t.direction===w.w.Next?a<r.flatIndex&&(u.done||e.currentIndex()>=r.flatIndex):a>=r.flatIndex&&(u.done||e.currentIndex()<r.flatIndex))?this.selectThreadInCurrentContext(s,{renderContextType:d,trackback:i.m2.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},n,!1,t.source):(u.done||(c=u.value.commentId),c)},e.prototype.selectNextOrPreviousThread=function(e,t,n,r,o){var a=this.commentStore.getState(),s=Ee.$6(a);if(this.useContentNavigationAPI&&(!s||r===Fe.A.DiscreteIntegrated||r===Fe.A.None&&xe.vL(a)!==z.Y.Visible)){if(void 0!==n)return(0,Oe.Y)(e,ve.selectContent({renderContextType:r,trackback:i.m2.reserveTag(578352064),telemetryVisitor:this.telemetryVisitor},t.direction,t.iterableContentTypes,!!t.restrictToCurrentContext,!!t.restrictToCurrentContext,s?{contentId:s.selectedCardId,contentType:l.cM.CommentThread}:void 0,n));(0,d.i7)().assertConditionTag(!1,"contentNavigationReason undefined when expecting to use content navigation",560756106)}var c=o?Ee.$q(this.commentStore.getState()):Ee.F6(this.commentStore.getState()),u=Ee.p3(a).nextPopulatedContextDetails,m=t.direction===w.w.Next,f=Ee.iM(a,!0,r);if(void 0!==s&&(o||(0,Te.HM)(this.commentStore.getState(),s.selectedCardId))){var p,g=(0,Se.tN)(Ee.XU(a),!0,r);p=!(0,be.x2)(c)&&v.S()&&f&&s.selectedCardId===g?f.flatIndex+(m?-1:0):this.getSelectedThreadIndex(c);var C=void 0;if((0,be.x2)(c))if(o){var h=new et.L(c,Ee.CA(a),p);C=m?h.next().value:h.previous().value}else C=c[p+(m?1:-1)];else{h=new et.C(c,p,o);var y=this.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated(h,t,g,f,s,p,e,r);if(y&&"string"!=typeof y)return y;C=y}if(C)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.m2.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},C,t.expandCard,t.source);if(!t.restrictToCurrentContext)return this.selectAcrossContexts(e,t,r,u,o)}else{if((0,Se.wS)(o?Ee.$q(this.commentStore.getState()):Ee.F6(this.commentStore.getState()),Ee.CA(a),o)||!v.rR()&&v.S()&&f)return this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,r,o);if(!t.restrictToCurrentContext&&u!==Ze.d.NoComments)return this.selectAcrossContexts(e,t,r,u,o)}},e.prototype.selectAcrossContexts=function(e,t,n,r,o){return this.useContentNavigationAPI&&!xe.Xy(this.commentStore.getState())&&(0,d.i7)().assertConditionTag(!1,"This method should not be used for DHC iteration across contexts when the content navigation API is being used.",560551957),t.direction===w.w.Next?r===Ze.d.OnlyCommentsInCurrent?this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,n,o):(0,Oe.Y)(e,ve.selectFirstThreadInNextCommentContext({renderContextType:n,trackback:i.m2.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):r===Ze.d.OnlyCommentsInCurrent?this.selectLastThreadInCurrentContext(e,t.expandCard,t.source,n,o):(0,Oe.Y)(e,ve.selectLastThreadInPreviousCommentContext({renderContextType:n,trackback:i.m2.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor}))},e.prototype.selectNextPostWithinCard=function(e,t,n){var r=Ee.$6(this.commentStore.getState());if(void 0!==r){if(!v.$H()){var o=Ee.CA(this.commentStore.getState()),a=this.getSelectedIndex(),s=void 0,c=void 0;if((0,be._A)(o)){var u=Ee.Xg(this.commentStore.getState())[r.selectedCardId];u&&a<u.length-1&&(s=r.selectedCardId,c=u[a+1])}else{var l=new Qe(o,a).next(),m=o[a];!l.done&&l.value.parentId&&l.value.parentId===(0,Je.a)(m)&&(s=l.value.parentId,c=l.value.commentId)}return s&&c?this.selectPost(e,{renderContextType:t,trackback:i.m2.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},s,c,ye.A.SharedComments):void 0}if(n){var f=this.getSelectedIndexFromRenderableItems(n);if(!(f<0)){var p=new ot(n,f).next(),g=n[f],C=tt.Ee(g);return p.done||tt.Ee(p.value)!==C?void 0:this.selectPost(e,{renderContextType:t,trackback:i.m2.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},tt.Ee(p.value),tt.OX(p.value),ye.A.SharedComments)}(0,d.i7)().assertConditionTag(!1,"Selection not found in renderableItems",571777352)}else(0,d.i7)().assertConditionTag(!1,"renderableItems must not be undefined",593278855)}else(0,d.i7)().assertConditionTag(!1,"Expected selectedComment",593278853)},e.prototype.selectPreviousPostWithinCard=function(e,t,n){var r=Ee.$6(this.commentStore.getState());if(void 0!==r){if(!v.$H()){var o=Ee.CA(this.commentStore.getState()),a=this.getSelectedIndex(),s=void 0,c=void 0;if((0,be._A)(o)){var u=Ee.Xg(this.commentStore.getState())[r.selectedCardId];u&&a>0&&(s=r.selectedCardId,c=u[a-1])}else{var l=o[a];l.parentId&&((f=new Qe(o,a).previous()).done||(0,Je.a)(f.value)!==l.parentId||(s=(0,Je.a)(f.value),c=f.value.commentId))}return s&&c?this.selectPost(e,{renderContextType:t,trackback:i.m2.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},s,c,ye.A.SharedComments):void 0}if(n){var m=this.getSelectedIndexFromRenderableItems(n);if(m<0)(0,d.i7)().assertConditionTag(!1,"Selection not found in renderableItems",571777353);else{var f,p=n[m],g=tt.oO(p);if(g&&!(f=new ot(n,m).previous()).done&&tt.Ee(f.value)===g)return this.selectPost(e,{renderContextType:t,trackback:i.m2.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},tt.Ee(f.value),tt.OX(f.value),ye.A.SharedComments)}}else(0,d.i7)().assertConditionTag(!1,"renderableItems must not be undefined",593278859)}else(0,d.i7)().assertConditionTag(!1,"Expected selectedComment",593278857)},e.prototype.selectRootPostOfSelectedThread=function(e,t){var n=Ee.$6(this.commentStore.getState());if(n&&!(0,De.dF)(n.selectionDetails))return this.selectPost(e,{renderContextType:t,trackback:i.m2.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},n.selectedCardId,n.selectedCardId,ye.A.SharedComments)},e.prototype.focusAndSelectSiblingThread=function(e,t){if(!(t<0)){var n=Ee.F6(this.commentStore.getState()),r=(0,be.x2)(n)?n:n.filter((function(e){return!e.parentId}));if(0!==r.length&&(0!==t||1!==r.length)){var o;t>r.length?((0,d.i7)().assertConditionTag(!1,"Passed in threadIndex too large.",526660886),o=r.length-1):o=t>=1?t-1:t+1;var a=(0,be.x2)(r)?r[o]:r[o].commentId;return(0,it.s)(void 0,(0,Be.F)(void 0,{componentType:He.I5.Card,id:a,renderContextType:e}),(0,Oe.Y)(void 0,ve.selectComment({renderContextType:e,trackback:i.m2.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},a,void 0,ve.SelectActionType.SelectCard,ye.A.SharedComments)))}}},e.prototype.getSelectedIndex=function(){var e=this.commentStore.getState();return(0,Se.FQ)(Ee.CA(e),Ee.Xg(e),Ee.$6(e))},e.prototype.getSelectedThreadIndex=function(e){return(0,Se.Hh)(e,Ee.$6(this.commentStore.getState()))},e.prototype.getSelectedIndexFromRenderableItems=function(e){var t=Ee.$6(this.commentStore.getState());if(!t)return-1;var n=(0,De.Gl)(t);return e.findIndex((function(e){return tt.OX(e)===n}))},e}(),st=function(){function e(e,t){var n=this;this.isRTL=e,this.telemetryVisitor=t,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecutor=(0,Ve.l)(Ve.c,[Ke.X.FocusComponent]),this.pendingOnComponentFocusedRequest=void 0,this.clearPendingOnComponentFocusedRequest=function(e){var t=e?(0,Ue.XX)(e):"";!n.pendingOnComponentFocusedRequest||""!==t&&t===(0,Ue.XX)(n.pendingOnComponentFocusedRequest.targetedComponent)||(he.KX&&(0,i.fH)("Pending component focused request cleared."),clearTimeout(n.pendingOnComponentFocusedRequest.token),n.pendingOnComponentFocusedRequest=void 0)},this.commandOnWillFocusCallback=function(e){n.clearPendingOnComponentFocusedRequest(e)},this.commandExecuteCallback=function(e,t){e&&(0,Be.z)(e)&&(t===Re.H.ShouldRetry?n.focusToRetry={command:e,timestamp:Date.now()}:t===Re.H.Handled&&(n.focusToRetry=void 0))},this.commentContentsKeyDown=Ye((function(){return n.commentStore}),this.isRTL,(function(e){var t=Ee.XU(n.commentStore.getState());if(v.S()){var r=(0,Se.Zg)(t);if(r&&e.isFocusOnOrWithin({componentType:He.I5.CardEditor,id:r,renderContextType:t.drafts[t.cardIdToDraftIdMap[r]].renderContextType}))return!1;var o=(0,Se.zh)(t);if(o&&e.isFocusOnOrWithin({componentType:He.I5.PostEditor,id:o,renderContextType:t.drafts[t.postIdToDraftIdMap[o]].renderContextType}))return!1}else if((0,_e.QZ)(t))return!1;return!e.isFocusOn({componentType:He.I5.GhostCard})}),{ArrowDown:{handler:function(e,t,r){var o=n.onDownKey(e,t,r?r():void 0);return o&&(o.stopPropagation=!0,o.preventDefault=!0),o},phase:ge.AM.Bubbling},ArrowUp:{handler:function(e,t,r){var o=n.onUpKey(e,t,r?r():void 0);return o&&(o.stopPropagation=!0,o.preventDefault=!0),o},phase:ge.AM.Bubbling},ArrowRight:{handler:function(e,t){if(t.componentTreeId.renderContextType!==Fe.A.HalfPane){var r=n.onRightKey(e,t);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:ge.AM.Bubbling},ArrowLeft:{handler:function(e,t){if(t.componentTreeId.renderContextType!==Fe.A.HalfPane){var r=n.onLeftKey(e,t.componentTreeId.renderContextType);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:ge.AM.Bubbling},Home:{handler:function(e,t){if(t.componentTreeId.renderContextType===Fe.A.FullPane){var r=n.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,ye.A.SharedComments,t.componentTreeId.renderContextType,!1);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:ge.AM.Capturing},End:{handler:function(e,t){if(t.componentTreeId.renderContextType===Fe.A.FullPane){var r=n.selectionCommandFactory.selectLastThreadInCurrentContext(e,!0,ye.A.SharedComments,t.componentTreeId.renderContextType,!1);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r}},phase:ge.AM.Capturing},F12:{handler:function(e,t){var r=e.altKey?n.handleMoveFocusEvent(e,t):void 0;return r&&(r.stopPropagation=!0),r},phase:ge.AM.None},Escape:{handler:function(e,t){var r="win32"===(0,Me.u)()?n.handleMoveFocusEvent(e,t):void 0;return r&&(r.stopPropagation=!0),r},phase:ge.AM.None}},this.commandExecutor),this.focusCommentCardCommand=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r=Ee.XU(n.commentStore.getState()),o=(0,Se.rB)(r),i=void 0;return(i=n.checkForRetryOfEditorFocus(e,r))||!v.S()&&(null==o?void 0:o.threadId)===t&&(i=n.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,r))?i:(0,Be.F)(void 0,{componentType:(0,Ue.EY)(t,r),id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:1},preventScroll:e.componentTreeId.renderContextType===Fe.A.DiscreteIntegrated})}),this.commandExecutor),this.focusCommentPostCommand=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r=Ee.XU(n.commentStore.getState());if(!v.S()&&r.postIdToDraftIdMap[t]){var o=n.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,r);if(o)return o}return(0,Be.F)(void 0,{componentType:He.I5.Post,id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:1}})}),this.commandExecutor),this.focusCommentPaneCommand=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e){if((0,Le.pZ)(e.componentTreeId.renderContextType)){var t=Ee.XU(n.commentStore.getState()),r=void 0;if(r=n.checkForRetryOfEditorFocus(e,t))return r;if(!e.isFocusWithinPane()||e.isFocusOn({componentType:He.I5.PaneRoot})){if(!v.S()&&(r=n.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t)))return r;var o=v.HX()?xe.AH(Ee.ym())(n.commentStore.getState()):Ee.$6(n.commentStore.getState());if(r=n.checkForCommentSelectionFocus(e.componentTreeId.renderContextType,o,t))return r;if(!v.Fr()&&!e.getComponent(He.I5.ClosePaneButton)){var i=Ee.F6(n.commentStore.getState());return i.length>0?n.focusCommentCardCommand.processCommand(e,(0,be.x2)(i)?i[0]:i[0].commentId):void(0,d.i7)().assertConditionTag("win32"===(0,Me.u)(),"Shouldn't be reached on current config",575239243)}return ze(e,n.commentStore)}}else(0,d.i7)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242)}),this.commandExecutor),this.commentCardMounted=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r,o=Ee.XU(n.commentStore.getState()),i={componentType:(0,Ue.EY)(t.id,o),id:t.id,renderContextType:e.componentTreeId.renderContextType};if(r=n.handleFocusRetry(e,i,o,1))return r;if(t.selected&&!e.isFocusWithin(i)){var a=(0,Le.pZ)(e.componentTreeId.renderContextType);if((!a||e.isFocusWithinPane())&&(a||e.isFocusWithinAny(He.I5.Card)||e.isFocusWithinAny(He.I5.DraftCard)))return n.focusCommentCardCommand.processCommand(e,t.id)}}),this.commandExecutor),this.commentCardEditorMounted=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:He.I5.CardEditor,id:t,renderContextType:e.componentTreeId.renderContextType},Ee.XU(n.commentStore.getState()),1)}),this.commandExecutor),this.commentPostMounted=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:He.I5.Post,id:t,renderContextType:e.componentTreeId.renderContextType},Ee.XU(n.commentStore.getState()),1)}),this.commandExecutor),this.commentPostEditorMounted=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return n.handleFocusRetry(e,{componentType:He.I5.PostEditor,id:t,renderContextType:e.componentTreeId.renderContextType},Ee.XU(n.commentStore.getState()),1)}),this.commandExecutor),this.commentPanePropsUpdated=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,r){var o=void 0;if(o=n.checkForRetryCommandOnPropsUpdated(e,r.draftState,!1))return o;var i=t.draftState,a=r.draftState,s=t.selectedComment,d=r.selectedComment;return(o=n.checkForDiscard(e,i,a,s,d))||(o=n.checkForHalfPaneFullTransition(e,t,r))?o:e.isFocusWithinPane()?(o=n.checkForLowFidelityWarning(e,s,d))||(o=n.checkForSelectionChange(e,a,s,d))||(o=n.checkForCardPendingChange(e,t.cardViewStates,r.cardViewStates,a))||(o=n.checkForReplyFinished(e,d,t.draftState,r.draftState,d&&r.cardViewStates[d.selectedCardId]))?o:n.checkForLowFidelityWarning(e,s,d):void 0}),this.commandExecutor),this.discreteCommentCardRootRefMounted=function(e){},this.discreteCommentCardPropsUpdated=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,r){var o=void 0;return(o=n.checkForRetryCommandOnDiscreteCardPropsUpdated(e,r))||(o=n.checkForDiscard(e,t.draftState,r.draftState,t.selectedState,r.selectedState))?o:e.isFocusWithinAny(He.I5.Card)||e.isFocusWithinAny(He.I5.DraftCard)?n.shouldFocusFromCardPendingStateChange(t.cardState,r.cardState)?(0,Be.F)(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:(0,Ue.AV)(r.isDraftThread),id:r.threadId}):(o=n.checkForLowFidelityWarning(e,t.selectedState,r.selectedState))||(o=n.checkForSelectionChange(e,r.draftState,t.selectedState,r.selectedState))||(o=n.checkForReplyFinished(e,r.selectedState,t.draftState,r.draftState,r.cardState))?o:n.checkForLowFidelityWarning(e,t.selectedState,r.selectedState):void 0}),this.commandExecutor),this.paneContainerKeyDown=Ye((function(){return n.commentStore}),this.isRTL,(function(e){return!!(0,Le.pZ)(e.componentTreeId.renderContextType)||((0,d.i7)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1)}),{Escape:{handler:function(e,t){return(0,Oe.Y)(e,ve.requestClosePane({renderContextType:t.componentTreeId.renderContextType,trackback:i.m2.reserveTag(575239245),telemetryVisitor:n.telemetryVisitor}))},phase:ge.AM.Capturing},Tab:{handler:function(e,t){return n.paneContainerTabHandling(e,t)},phase:ge.AM.None}},this.commandExecutor),this.commentEditorKeyDown=Ye((function(){return n.commentStore}),this.isRTL,(function(){return!0}),{F12:{handler:function(e,t){var r=e.altKey?n.handleMoveFocusEvent(e,t):void 0;return r&&(r.stopPropagation=!0),r},phase:ge.AM.None}},this.commandExecutor),this.onUserAction=We((function(){return n.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var r;switch(t.userAction){case $e.a.RequestNewCommentFromHost:if(!(0,Le.pZ)(e.componentTreeId.renderContextType))return;return ze(e,n.commentStore);case $e.a.CancelReplyDraft:return(0,Be.F)(void 0,{componentType:He.I5.Card,id:t.cardId,renderContextType:e.componentTreeId.renderContextType});case $e.a.DeleteThread:case $e.a.CancelNewThreadDraft:if(!(0,Le.pZ)(e.componentTreeId.renderContextType))return;if(e.componentTreeId.renderContextType===Fe.A.HalfPane&&t.userAction===$e.a.CancelNewThreadDraft)return;return null!==(r=ze(e,n.commentStore,{priority:3,phase:0}))&&void 0!==r?r:n.selectionCommandFactory.focusAndSelectSiblingThread(e.componentTreeId.renderContextType,t.threadIndex);case $e.a.ResolveThread:if("android"!==(0,Me.u)())return;return(0,Be.F)(void 0,{componentType:He.I5.ReopenThreadButton,id:t.cardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:3}});default:(0,i.HB)(t)}}),this.commandExecutor)}return e.prototype.postOnComponentFocusedRequest=function(e,t){this.clearPendingOnComponentFocusedRequest();var n=setTimeout(t,500);this.pendingOnComponentFocusedRequest={callback:t,token:n,targetedComponent:e},he.KX&&(0,i.fH)("Pending component focused request added for ".concat((0,Ue.XX)(e),"."))},e.prototype.initialize=function(e,t,n){if(this._commentStore)throw new B.cP("FocusManager already initialized",i.m2.reserveTag(575239239),-2130957489);this._commentStore=e,this.selectionCommandFactory=null!=n?n:new at(e,this.telemetryVisitor,t)},Object.defineProperty(e.prototype,"commentStore",{get:function(){if(!this._commentStore)throw new B.cP("FocusManager not initialized",i.m2.reserveTag(575239240),-2130957490);return this._commentStore},enumerable:!1,configurable:!0}),e.prototype.setDeferredActiveEditorFocusCommand=function(e){this.draftToFocus={draftId:e,timestamp:Date.now(),isPendingSetFocus:!0}},e.prototype.handleFocusRetry=function(e,t,n,r){var o;if(o=this.checkForRetryOfEditorFocus(e,n))return o;if(this.focusToRetry&&t){var i=this.focusToRetry.command.component,a=Date.now()-this.focusToRetry.timestamp;if(a>15e3)return(0,d.i7)().assertConditionTag(!1,"Took too long to mount component type ".concat(i.componentType," for focus retry: ").concat(a," ms"),575239241),void(this.focusToRetry=void 0);if(this.shouldRetryFocusForPhase(this.focusToRetry,r)&&(0,He.pL)(i,t)){var s=this.focusToRetry.command;return this.focusToRetry=void 0,s}}},e.prototype.shouldArrowNavigatePosts=function(e,t,n){return(0,Ne.$)(e.selectedCardId,t,n.componentTreeId.renderContextType)!==ke.A.Collapsed&&e.selectedCardId!==(0,Se.tN)(Ee.XU(this.commentStore.getState()))&&n.isFocusWithinAny(He.I5.Post)},e.prototype.onDownKey=function(e,t,n){var r=v.W2()&&!xe.Xy(this.commentStore.getState()),o=Ee.$6(this.commentStore.getState()),i=Ee.KU(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,i,t)){if(t.componentTreeId.renderContextType===Fe.A.DiscreteIsolated)return;var a={direction:w.w.Next,source:ye.A.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,a,w.G6.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectNextPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==Fe.A.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,ye.A.SharedComments,t.componentTreeId.renderContextType,r);(0,d.i7)().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249)},e.prototype.onUpKey=function(e,t,n){var r=v.W2()&&!xe.Xy(this.commentStore.getState()),o=Ee.$6(this.commentStore.getState()),i=Ee.KU(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,i,t)){if(t.componentTreeId.renderContextType===Fe.A.DiscreteIsolated)return;var a={direction:w.w.Previous,source:ye.A.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,a,w.G6.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==Fe.A.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,ye.A.SharedComments,t.componentTreeId.renderContextType,r);(0,d.i7)().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250)},e.prototype.onRightKey=function(e,t){var n=Ee.$6(this.commentStore.getState());if(!v.S()||!n||n.selectedCardId!==(0,Se.tN)(Ee.XU(this.commentStore.getState()))){var r=this.selectionCommandFactory.selectRootPostOfSelectedThread(e,t.componentTreeId.renderContextType);return r||(n&&(0,De.dF)(n.selectionDetails)&&t.isFocusOn({componentType:He.I5.Card,id:n.selectedCardId,renderContextType:t.componentTreeId.renderContextType})&&(r=this.focusCommentPostCommand.processCommand(t,n.selectionDetails.selectedPostId)),r||void 0)}},e.prototype.onLeftKey=function(e,t){return this.selectionCommandFactory.focusAndCollapseSelectedThread(e,t)},e.prototype.onTabKeyInPane=function(e,t){var n=Ee.$6(this.commentStore.getState());return void 0!==n&&(0,Te.HM)(this.commentStore.getState(),n.selectedCardId)||!Ee.SL(this.commentStore.getState())?v.S()?void 0:this.checkForActiveEditorFocus(e,t,Ee.XU(this.commentStore.getState())):this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,ye.A.SharedComments,t,!1)},e.prototype.isDraftInOtherContext=function(){var e=Ee.CR(this.commentStore.getState());return!!e&&!e.isInCurrentContext},e.prototype.logEditorRetryError=function(e,t,n,r){var o,i,a;null===(i=(o=(0,d.i7)()).logDiagnosticTrace)||void 0===i||i.call(o,(0,pe.D)(je||(je=(0,h.__makeTemplateObject)(["CommentsEditorFocusRetry"],["CommentsEditorFocusRetry"]))),r,d.AI.Info,d.b5.ProductServiceUsage,this.telemetryVisitor,(0,d.jR)("RenderContextType",t.componentTreeId.renderContextType,d.LG.SystemMetadata),(0,d.jR)("IsDraftInCurrentContext",!!e&&e.isInCurrentContext,d.LG.SystemMetadata),(0,d.jR)("DraftRenderContextType",null!==(a=null==e?void 0:e.renderContextType)&&void 0!==a?a:Fe.A.None,d.LG.SystemMetadata),(0,d.jR)("ComponentType",null!=n?n:0,d.LG.SystemMetadata))},e.prototype.checkForRetryOfEditorFocus=function(e,t){var n=this;if(void 0!==this.draftToFocus){if(!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:Ke.X.PreserveFocus,priorityArgs:{priority:1}};var r=t.drafts[this.draftToFocus.draftId],o=Date.now()-this.draftToFocus.timestamp;if(o>15e3)return(0,d.i7)().assertConditionTag(!1,"Took too long to focus draft editor: ".concat(o," ms, expected draft still exists: ").concat(!!r),575239251),this.draftToFocus=void 0,void this.logEditorRetryError(r,e,void 0,i.m2.reserveTag(556607431));if(r&&r.renderContextType===e.componentTreeId.renderContextType){var a=this.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t,{priority:2,phase:0});if(a&&Ge(e,a.component))return this.draftToFocus=(0,h.__assign)((0,h.__assign)({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout((function(){return n.draftToFocus=void 0})),this.clearPendingOnComponentFocusedRequest(),a;this.logEditorRetryError(r,e,null==a?void 0:a.component.componentType,i.m2.reserveTag(556794947))}else this.logEditorRetryError(r,e,void 0,i.m2.reserveTag(556794945))}},e.prototype.checkForActiveEditorFocus=function(e,t,n,r){if(void 0===r&&(r={priority:1}),!this.isDraftInOtherContext()){var o=(0,Se.zh)(n);if(o)return(0,Be.F)(e,{componentType:He.I5.PostEditor,id:o,renderContextType:t},{priorityArgs:r});var i=(0,Se.Zg)(n);return i?(0,Be.F)(e,{componentType:He.I5.CardEditor,id:i,renderContextType:t},{priorityArgs:r}):void 0}},e.prototype.handleMoveFocusEvent=function(e,t){var n=Ee.$6(this.commentStore.getState()),r=n?{contentId:null==n?void 0:n.selectedCardId,contentType:l.cM.CommentThread}:void 0;return(0,Oe.Y)(e,ve.moveFocusToCanvas({renderContextType:t.componentTreeId.renderContextType,trackback:i.m2.reserveTag(575239252),telemetryVisitor:this.telemetryVisitor},r))},e.prototype.checkForCommentSelectionFocus=function(e,t,n){if(v.S()||!this.isDraftInOtherContext())return t&&t.selectedCardId?(0,Be.F)(void 0,{componentType:(0,Ue.EY)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e},{priorityArgs:{priority:2,phase:1}}):void 0},e.prototype.checkForDiscard=function(e,t,n,r,o){if("web"!==(0,Me.u)()&&r&&o){var i=r.selectionDetails,a=o.selectionDetails;if((0,_e.m6)(t)&&!(0,_e.QZ)(n))return this.focusCommentCardCommand.processCommand(e,o.selectedCardId);if((0,De.dF)(i)===(0,De.dF)(a)&&r.selectedCardId===o.selectedCardId&&(0,_e.Zh)(t,n)){if(!(0,De.dF)(i)||!(0,De.dF)(a))return(0,Be.F)(void 0,{componentType:He.I5.CardEditor,id:o.selectedCardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}});if(i.selectedPostId===a.selectedPostId)return(0,Be.F)(void 0,{componentType:He.I5.PostEditor,id:a.selectedPostId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}})}}},e.prototype.paneContainerTabHandling=function(e,t){if("win32"!==(0,Me.u)()){var n=this.commentStore.getState(),r=Ee.YE(n).virtualized;if(!(0,Ie.B)(Ee.Tw(n),r,!!Pe.L3(n)))return(m=(0,Be.F)(e,{componentType:He.I5.ClosePaneButton})).stopPropagation=!0,m.preventDefault=!0,m;var o,i=t.getComponent(He.I5.ClosePaneButton),a=t.getComponent(He.I5.NewCommentButton),s=v.HX()?t.getComponent(He.I5.FilterButton):void 0,d=Ee.YE(n).newThread,c=v.HX()?Pe.L3(n):void 0;if(o=v.HX()&&c&&s?s:d&&a?a:i,v.cb()){var u=Ee.$6(n),l=Ee.XU(n),m=void 0;return u&&(0,Te.HM)(n,u.selectedCardId)?v.S()||t.isFocusWithin({componentType:(0,Ue.EY)(u.selectedCardId,l),id:u.selectedCardId,renderContextType:t.componentTreeId.renderContextType})||(m=this.checkForActiveEditorFocus(e,t.componentTreeId.renderContextType,l)):o&&e.isEventTarget(o)&&!e.shiftKey&&(m=this.onTabKeyInPane(e,t.componentTreeId.renderContextType)),m&&(m.stopPropagation=!0,m.preventDefault=!0),m}if(i&&e.isEventTarget(i)&&e.shiftKey)return(m=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(m.preventDefault=!0,m.stopPropagation=!0),m;if(o&&e.isEventTarget(o)&&!e.shiftKey)return(m=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(m.preventDefault=!0,m.stopPropagation=!0),m}},e.prototype.checkForSelectionChange=function(e,t,n,r){if(r&&(!n||(0,De.Gl)(n)!==(0,De.Gl)(r)||(0,De.dF)(n.selectionDetails)!==(0,De.dF)(r.selectionDetails))&&(this.clearPendingOnComponentFocusedRequest(),(v.S()||!(0,_e.mw)(t))&&!e.isFocusOn({componentType:He.I5.NextCommentButton})&&!e.isFocusOn({componentType:He.I5.PreviousCommentButton}))){if(!(0,De.dF)(r.selectionDetails)){if(e.isFocusOnOrWithin({componentType:r.selectedCardId!==(null==n?void 0:n.selectedCardId)?(0,Ue.EY)(r.selectedCardId,t):He.I5.CardEditor,id:r.selectedCardId,renderContextType:e.componentTreeId.renderContextType},!0))return;return this.focusCommentCardCommand.processCommand(e,r.selectedCardId)}if(!e.isFocusOnOrWithin({componentType:He.I5.Post,id:r.selectionDetails.selectedPostId,renderContextType:e.componentTreeId.renderContextType}))return this.focusCommentPostCommand.processCommand(e,r.selectionDetails.selectedPostId)}},e.prototype.checkForReplyFinished=function(e,t,n,r,o){var i=(0,Se.Zg)(n),a=(0,Se.Zg)(r);if(o&&o.pending!==Ae.q.Editor)return i&&!a&&(null==t?void 0:t.selectedCardId)===i&&e.isFocusWithin({componentType:He.I5.Card,id:i,renderContextType:e.componentTreeId.renderContextType})?this.focusCommentCardCommand.processCommand(e,i):void 0},e.prototype.checkForHalfPaneFullTransition=function(e,t,n){if(e.componentTreeId.renderContextType===Fe.A.HalfPane&&(0,Ce.qO)(n.displayConfigurationState)&&n.displayConfigurationState.displayMode===Ce.g1.Normal&&(!(0,Ce.qO)(t.displayConfigurationState)||t.displayConfigurationState.displayMode===Ce.g1.Variable))return(0,Be.F)(void 0,{componentType:He.I5.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(e,t){return!!e&&e.pending!==t.pending&&t.pending!==Ae.q.Editor},e.prototype.checkForCardPendingChange=function(e,t,n,r){var o=this,i=Object.entries(n).find((function(e){var n=t[e[0]];return o.shouldFocusFromCardPendingStateChange(n,e[1])}));if(i)return(0,Be.F)(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:(0,Ue.EY)(i[0],r),id:i[0]})},e.prototype.checkForRetryCommandOnPropsUpdated=function(e,t,n){var r=!n&&this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&Ge(e,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(e,r,t,2)},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(e,t){var n=this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&(!(0,He.Xk)(this.focusToRetry.command.component)||!(0,He.nM)(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===t.threadId),r=this.draftToFocus&&(t.cardRelativeDraftingState===we.V.InCard||t.cardRelativeDraftingState===we.V.InChildPost);if(n||r)return this.checkForRetryCommandOnPropsUpdated(e,t.draftState,!n)},e.prototype.checkForLowFidelityWarning=function(e,t,n){if(n&&(v.cb()?(0,De.Uo)(n):(0,De.gh)(n))){var r=t?(0,De.Gl)(t):void 0,o=(0,De.Gl)(n);if(o!==r||n.selectionDetails.lowFidelityWarningType!==(null==t?void 0:t.selectionDetails.lowFidelityWarningType))return(0,Be.F)(void 0,{componentType:He.I5.Post,renderContextType:e.componentTreeId.renderContextType,id:o})}},e.prototype.shouldRetryFocusForPhase=function(e,t){return 1!==e.command.priorityArgs.priority&&0!=(e.command.priorityArgs.phase&t)},e}(),dt=n(78630),ct=n(24557),ut=function(){return function(e){return function(t){return(0,_.unstable_batchedUpdates)((function(){return e(t)}))}}},lt=function(){return function(e){return function(t){var n="string"==typeof t.type?t.type:t.name||"Unknown Action",r=(0,i.V6)(i.tj.Redux,n),o=e(t);return null==r||r.end(),o}}},mt=n(48581),ft=n(75044),pt=n(71318),gt=n(57518),Ct=n(58486),ht=n(73588),vt=n(32601);!function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.UIAAnnotationPattern=256]="UIAAnnotationPattern",e[e.ContentExtensionHostingDisabled=512]="ContentExtensionHostingDisabled"}(Xe||(Xe={}));var yt=n(76404),Tt=n(93172);function It(e,t){for(var n=null==t?void 0:t(),r=[],o=0,i=void 0;o<e.length;){if(e[o].type===Tt.ej.Thread){var a=e[o].id;i=a,r.push(St(a,void 0,n))}else r.push(St(e[o].id,i,n));o++}return r}function St(e,t,n){var r=void 0;return n&&(r=(0,be.YO)((0,be.OJ)(n),e)),r||(0,h.__assign)((0,h.__assign)({},(0,Se.vY)(e)),{parentId:null!=t?t:""})}var At,_t=n(64019),Dt=n(5873),Et=n(12008),Pt=n(93894);function xt(e,t){var n=(0,ft.c2)(e);if(n)return n;(0,d.i7)().assertConditionTag(!1,"immerDraft does not have original state",t)}function bt(e,t,n){var r=!1;if((0,Je.j)(t)){var o=void 0===n;if(n){var i=function(e,t,n){if(n.insertFlatIndex<0)return{insertThreadIndex:-1};for(var r=!!(null==n?void 0:n.draftIdToSkip)||void 0,o=0,i=0;i<e.length;i++){if(o===n.insertFlatIndex)return{insertThreadIndex:i,beforeDraft:r};if(e[i]!==n.draftIdToSkip){if(o+=t[e[i]].length,n.insertFlatIndex<=o)return{insertThreadIndex:i+1,beforeDraft:r}}else r=!1}return o===n.insertFlatIndex?{insertThreadIndex:e.length,beforeDraft:r}:{insertThreadIndex:-1}}(e.commentThreadIds,e.cardPostIds,n);r=!!i.beforeDraft,i.insertThreadIndex>=0?e.commentThreadIds.splice(i.insertThreadIndex,0,t.commentId):((0,d.i7)().assertConditionTag(!1,"Invalid thread insert flat index.",512508103),o=!0)}o&&e.commentThreadIds.push(t.commentId),e.cardPostIds[t.commentId]=[t.commentId]}else{if(!e.cardPostIds[t.parentId])return void(0,d.i7)().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",526242826);if(n){var a=function(e,t,n,r){for(var o=!!r||void 0,i=0,a=0;a<t.length;a++){if(t[a]===e)return{flatIndex:i,beforeDraft:o};t[a]!==r?i+=n[t[a]].length:o=!1}return{flatIndex:-1}}(t.parentId,e.commentThreadIds,e.cardPostIds,n.draftIdToSkip);r=!!a.beforeDraft;var s=n.insertFlatIndex-a.flatIndex;(0,d.i7)().assertConditionTag(s>=1&&s<=e.cardPostIds[t.parentId].length,"Invalid insert post index.",520646683),s=Math.max(Math.min(s,e.cardPostIds[t.parentId].length),1),e.cardPostIds[t.parentId].splice(s,0,t.commentId)}else e.cardPostIds[t.parentId].push(t.commentId)}e.postData[t.commentId]=t,(null==n?void 0:n.draftIdToSkip)&&e.createdCommentLie&&r&&e.createdCommentLie.flatIndex++}function kt(e,t){var n=xt(e,i.m2.reserveTag(524031042));if(n){var r,o;if(e.draftState.pendingDraft)switch(e.draftState.pendingDraft.sessionType){case"REPLY":if(r=e.draftState.pendingDraft.threadId,!n.cardViewState[r])return;break;case"EDIT":if(o=e.draftState.pendingDraft.commentId,!n.postViewState[o])return;break;default:return}else{var a=Se.rB(e.draftState);if(!a||!a.isInCurrentContext)return;switch(a.commentDraft.sessionConfiguration.sessionType){case"REPLY":r=a.threadId;break;case"EDIT":o=a.commentDraft.sessionConfiguration.commentId;break;default:return}}r&&!e.cardViewState[r]?(Rt(e.draftState,r),(0,Pt.K)(n.draftState,e.draftState,3,t,i.m2.reserveTag(526242828))):o&&!e.postViewState[o]&&(Ft(e.draftState,o),(0,Pt.K)(n.draftState,e.draftState,2,t,i.m2.reserveTag(526242829)))}}function wt(e,t,n,r){var o,a,s=xt(e,i.m2.reserveTag(524031047));if(s&&function(e,t){return!(!(e&&e.commentFlags&nt.P.Resolved&&t)||t.commentFlags&nt.P.Resolved)}(t,n)&&(e.selectedComment&&e.selectedComment.selectedCardId===t.commentId&&((0,De.dF)(e.selectedComment.selectionDetails)||void 0!==e.selectedComment.selectionDetails.lowFidelityWarningType)&&(e.selectedComment.selectionDetails=Se.Jn()),t.commentId===(null===(o=Se.rB(e.draftState))||void 0===o?void 0:o.threadId)&&(function(e,t,n){Rt(e,n);var r=Se.zh(e);if(r){var o=e.postIdToDraftIdMap[r],i=e.drafts[o];i&&i.threadId===n&&Ft(e,r)}if(e.pendingDraft&&(0,ht.pS)(e.pendingDraft)){var a=t[e.pendingDraft.commentId];a&&(0,Je.a)(a)===n&&(e.pendingDraft=void 0)}}(e.draftState,e.postData,t.commentId),(0,Pt.K)(s.draftState,e.draftState,1,r,i.m2.reserveTag(526242836))),(null===(a=s.cardViewState[t.commentId])||void 0===a?void 0:a.loadState.state)===Dt.m.Loaded)){var d=Se.Om(t.commentId,e.expandedComments,e.draftState,e.selectedComment);d!==e.expandedComments&&(e.expandedComments=d)}}function Rt(e,t){e.pendingDraft&&(0,ht.vd)(e.pendingDraft)&&e.pendingDraft.threadId===t&&(e.pendingDraft=void 0);var n=e.cardIdToDraftIdMap[t];n&&(Nt(e,n),delete e.cardIdToDraftIdMap[t])}function Ft(e,t){e.pendingDraft&&(0,ht.pS)(e.pendingDraft)&&e.pendingDraft.commentId===t&&(e.pendingDraft=void 0);var n=e.postIdToDraftIdMap[t];n&&(Nt(e,n),delete e.postIdToDraftIdMap[t])}function Nt(e,t){e.drafts[t]?((0,d.i7)().assertConditionTag(1===Object.keys(e.drafts).length,"Invalid number of drafts",526131555),delete e.drafts[t]):(0,d.i7)().assertConditionTag(0===Object.keys(e.drafts).length,"Invalid draftId",526131554)}function Mt(e,t,n){var r,o,a=n,s=t.model.parentId;if(s&&(e.cardViewState[s]?e.cardViewState[s].pending=Ae.q.None:null===(o=null===(r=(0,d.i7)())||void 0===r?void 0:r.logDiagnosticTrace)||void 0===o||o.call(r,(0,pe.D)(At||(At=(0,h.__makeTemplateObject)(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),i.m2.reserveTag(520646684),d.AI.Warning,d.b5.ProductServiceUsage,(0,d.t4)(d.ZK.ReviewedAsNotNecessary))),t.tempId){if(delete e.cardViewState[t.tempId],delete e.postViewState[t.tempId],e.draftState.committedLieId===t.tempId){var c=e.commentThreadIds.findIndex((function(e){return t.tempId===e}));c<0?(0,d.i7)().assertConditionTag(!1,"ThreadId to delete not found",520646688):(e.commentThreadIds.splice(c,1),delete e.cardPostIds[t.tempId]),delete e.postData[t.tempId],e.createdCommentLie=void 0,e.draftState.committedLieId=void 0,a=void 0}e.selectedComment&&e.selectedComment.selectedCardId===t.tempId&&(e.selectedComment=Se.NN((0,Je.a)(t.model)),t.model.parentId?e.expandedComments.findIndex((function(e){return t.tempId===e}))>=0&&(e.expandedComments=Se.Om(t.tempId,e.expandedComments,e.draftState,e.selectedComment)):e.expandedComments=Se.FO(e.expandedComments,e.selectedComment,e.draftState))}(0,d.i7)().assertConditionTag(!e.postViewState[t.model.commentId],"Received insert for existing comment",522856031),s||(e.cardViewState[t.model.commentId]=Se.iv(t.tempId||void 0)),e.postViewState[t.model.commentId]=Se.t$(t.model.displayDate),bt(e,t.model,{insertFlatIndex:t.index,draftIdToSkip:a})}function Lt(e,t){var n=xt(e,i.m2.reserveTag(522856032));if(n){var r=e.postData[t.model.commentId],o=n.modelCapabilities.virtualized;if(r){e.postData[t.model.commentId]=t.model;var a=(0,Je.a)(t.model),s=e.cardViewState[a];s?(e.cardViewState[a].pending=Ae.q.None,s.loadState.state!==Dt.m.Loading&&o||(e.cardViewState[a].loadState={state:Dt.m.Loaded})):((0,d.i7)().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",522856033),e.cardViewState[a]=Se.iv(void 0,o?Dt.m.Placeholder:void 0)),e.postViewState[t.model.commentId]?r.displayDate===t.model.displayDate&&r.date===t.model.date||(e.postViewState[t.model.commentId].displayDate=Se.Zn(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture),e.postViewState[t.model.commentId].pending=Et.U.None):e.postViewState[t.model.commentId]=Se.t$(Se.Zn(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture)),wt(e,e.postData[t.model.commentId],r,2)}else(0,d.i7)().assertConditionTag(!1,"change commentId not found in postData",522856034),(0,i.fH)("change commentId not found in postData ".concat(t.model.commentId))}}function Ot(e,t,n){var r,o,i,a=e.postData[t.model.commentId];if(a){var s=-1,c=0;if((0,Je.j)(a))(s=e.commentThreadIds.findIndex((function(e){return a.commentId===e})))<0?(0,d.i7)().assertConditionTag(!1,"ThreadId to delete not found",520646687):e.commentThreadIds.splice(s,1),c=null!==(o=null===(r=e.cardPostIds[a.commentId])||void 0===r?void 0:r.length)&&void 0!==o?o:0,e.cardPostIds[a.commentId].forEach((function(t){delete e.postData[t]})),delete e.cardPostIds[a.commentId];else{if((0,d.i7)().assertConditionTag(void 0!==e.cardPostIds[a.parentId],"Orphaned reply delete received",520646686),s=e.commentThreadIds.findIndex((function(e){return a.parentId===e})),e.cardPostIds[a.parentId]){var u=e.cardPostIds[a.parentId].findIndex((function(e){return a.commentId===e}));u<0?(0,d.i7)().assertConditionTag(!1,"PostID to delete not found",520646685):(c=1,e.cardPostIds[a.parentId].splice(u,1))}delete e.postData[t.model.commentId]}n&&void 0!==(null===(i=e.createdCommentLie)||void 0===i?void 0:i.flatIndex)&&s>=0&&s<e.commentThreadIds.findIndex((function(e){return e===n}))&&(e.createdCommentLie.flatIndex-=c)}if(e.highlightedCommentId===t.model.commentId&&(e.highlightedCommentId=void 0),e.topVisibleThreadId===t.model.commentId&&(e.topVisibleThreadId=void 0),delete e.cardViewState[t.model.commentId],delete e.postViewState[t.model.commentId],t.model.commentId===e.selectedThreadIdBeforeCommentSession&&a){var l=e.commentThreadIds.length;l?t.index>=e.commentThreadIds.length?e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[l-1]:e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[t.index]:e.selectedThreadIdBeforeCommentSession=void 0}}function Bt(e,t,n,r){var o,i,a,s,d;if(v.$H()&&n.tasks){var c=!1,u={},l={},m=new Set,f=Object.keys(e);n.comments.forEach((function(e){""===e.parentId&&m.add(e.commentId)}));try{for(var p=(0,h.__values)(f),g=p.next();!g.done;g=p.next()){var C=g.value;if(!m.has(C)){c=!0;break}}}catch(e){o={error:e}}finally{try{g&&!g.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}f.length!==(null===(d=n.tasks)||void 0===d?void 0:d.length)&&(c=!0);try{for(var y=(0,h.__values)(n.tasks),T=y.next();!T.done;T=y.next()){var I=T.value;c=Ut(t,l,I,r)||c,u[I.commentId]=Gt(I)}}catch(e){a={error:e}}finally{try{T&&!T.done&&(s=y.return)&&s.call(y)}finally{if(a)throw a.error}}if(c)return{updatedTasks:u,updatedHistoryRecordViewState:l}}}function Vt(e,t,n,r){if(v.$H()){var o=(0,h.__assign)({},e),i=(0,h.__assign)({},t),a=!1;if(n.changes.forEach((function(n){if(n.type!==pt.Ey.Unknown){var s=n.model.commentId;switch(n.type){case pt.Ey.Delete:delete o[s],void 0!==e[s]&&Object.keys(e).includes(s)&&(Ht(i,e[s],void 0),a=!0);break;case pt.Ey.Load:case pt.Ey.Insert:case pt.Ey.Modify:(0,d.i7)().assertConditionTag(n.type===pt.Ey.Modify||!o[s],"Task should not already be populated on initial load",554836097);var c=n.task;if(c)a=Ut(t,i,c,r)||a||!o[s]||!function(e,t){if(e.completion!==t.completion||e.title!==t.title||e.isLossy!==t.isLossy||e.priority!==t.priority||e.schedule.dueDate!==t.schedule.dueDate||e.schedule.startDate!==t.schedule.startDate||e.assignees.length!==t.assignees.length)return!1;for(var n=0;n<e.assignees.length;n++)if(!(0,ie.ZO)(e.assignees[n],t.assignees[n]))return!1;return!0}(o[s].currentState,c.currentState),o[s]=Gt(c);else if(""===n.model.parentId&&o[s]){var u=o[s];Ht(i,u,void 0),delete o[s],a=!0}}}else(0,d.i7)().assertConditionTag(!1,"Unknown change type",554836096)})),a)return{updatedTasks:o,updatedHistoryRecordViewState:i}}}function Ut(e,t,n,r){var o,i,a,s;if(0===n.history.length)return!0;var d=!1,c=e&&Object.keys(e).length>0,u=c?new Set:void 0;try{for(var l=(0,h.__values)(n.history),m=l.next();!m.done;m=l.next()){var f=m.value;try{for(var p=(a=void 0,(0,h.__values)(f.records)),g=p.next();!g.done;g=p.next()){var C=g.value;null==u||u.add(C.recordId);var v=tt.fp(n.id,C.recordId);e[v]?t[v]=e[v]:(d=!0,t[v]=(0,Se.uV)((0,Se.Zn)(C.time,C.displayTime,r.dataCulture)))}}catch(e){a={error:e}}finally{try{g&&!g.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}}}catch(e){o={error:e}}finally{try{m&&!m.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}if(c){var y=Ht(t,n,u);d=d||y}return d}function Ht(e,t,n){var r,o,i,a,s=!1;try{for(var d=(0,h.__values)(t.history),c=d.next();!c.done;c=d.next()){var u=c.value;try{for(var l=(i=void 0,(0,h.__values)(u.records)),m=l.next();!m.done;m=l.next()){var f=m.value;n&&n.has(f.recordId)||(delete e[tt.fp(t.id,f.recordId)],s=!0)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}return s}function Gt(e){var t,n,r,o,i=(0,h.__assign)({},e),a=[];try{for(var s=(0,h.__values)(e.history),d=s.next();!d.done;d=s.next()){var c=d.value,u=(0,h.__assign)({},c);u.taskId||(u.taskId=e.id);var l=[];try{for(var m=(r=void 0,(0,h.__values)(c.records)),f=m.next();!f.done;f=m.next()){var p=f.value;l.push((0,h.__assign)({},p))}}catch(e){r={error:e}}finally{try{f&&!f.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}u.records=l,a.push(u)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return i.history=a,i}function zt(e){if(e){var t={};if(void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length)return t}}var qt=n(17886),Wt=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e[n]);return t};function Yt(e){return Kt((0,He.Xk)(e)?(0,Ue.$R)(e):(0,Ue.ny)(e.componentType))}function jt(e){var t=document.activeElement;return!!e&&t===e}function Xt(e,t,n){var r=document.activeElement,o=t!==He.I5.CardEditor&&t!==He.I5.PostEditor&&!n;return!!e&&(r&&e.contains(r)||o&&function(e){return e===document.body||null===e||0===Object.keys(e).length}(r))}function Kt(e){var t=document.getElementById(e);return null!=t?t:void 0}const $t=function(){function e(e,t,n){this.componentTreeId={renderContextType:e,contextIdentifier:t}}return e.prototype.getComponent=function(e){return Kt((0,Ue.ny)(e))},e.prototype.getComponentById=function(e){return Kt((0,Ue.$R)(e))},e.prototype.isEventTarget=function(e,t){return e===t},e.prototype.isFocusOn=function(e){return jt(Yt(e))},e.prototype.isFocusWithin=function(e){return Xt(Yt(e),e.componentType)},e.prototype.isFocusOnOrWithin=function(e,t){var n=Yt(e);return jt(n)||Xt(n,e.componentType,t)},e.prototype.isFocusWithinAny=function(e){var t=void 0;switch(e){case He.I5.Card:t=Wt(document.querySelectorAll("[id*='".concat(D.u4({id:"",renderContextType:this.componentTreeId.renderContextType},!1),"']")));break;case He.I5.DraftCard:t=Wt(document.querySelectorAll("[id*='".concat(D.u4({id:"",renderContextType:this.componentTreeId.renderContextType},!0),"']")));break;case He.I5.PostEditor:t=Wt(document.querySelectorAll("[id*='".concat(D.a0(D.bt({id:"",renderContextType:this.componentTreeId.renderContextType})),"']")));break;case He.I5.CardEditor:t=Wt(document.querySelectorAll("[id*='".concat(D.a0(D.LX({id:"",renderContextType:this.componentTreeId.renderContextType})),"']")));break;case He.I5.Post:t=Wt(document.querySelectorAll("[id*='".concat(D.cF({id:"",renderContextType:this.componentTreeId.renderContextType}),"']")))}if(t)for(var n=0;n<t.length;++n)if(Xt(t[n],e))return!0;return!1},e.prototype.isFocusWithinPane=function(){return Xt(document.getElementById(D.E4()),He.I5.PaneRoot)},e.prototype.getCurrentlyFocused=function(){return this.isFocusWithinPane()?[document.activeElement]:[]},e}();function Zt(e,t){switch(void 0===e&&(e={extensions:{},contentNavigationSupported:!1}),void 0===t&&(t=ve.EMPTY_ACTION),t.type){case"ADD_CONTENT_EXTENSION":return function(e,t){var n;(0,d.i7)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var r=t.payload.extension;return(0,h.__assign)((0,h.__assign)({},e),{extensions:(0,h.__assign)((0,h.__assign)({},e.extensions),(n={},n[t.payload.extension.provider.scope.renderMode]={controller:r,priority:r.priority},n))})}(e,t);case"REMOVE_CONTENT_EXTENSION":return function(e,t){var n,r,o=(0,h.__assign)({},e.extensions);try{for(var i=(0,h.__values)(t.payload.renderModes),a=i.next();!a.done;a=i.next())delete o[a.value]}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return(0,h.__assign)((0,h.__assign)({},e),{extensions:o})}(e,t);case"UPDATE_EXTENSION_PRIORITY":return function(e,t){var n=(0,h.__assign)({},e.extensions);for(var r in t.payload.updates)n[r]&&(n[r]=(0,h.__assign)((0,h.__assign)({},n[r]),{priority:t.payload.updates[r]}));return(0,h.__assign)((0,h.__assign)({},e),{extensions:n})}(e,t);case"SET_CONTENT_NAVIGATION_ENABLEMENT":return function(e,t){return(0,h.__assign)((0,h.__assign)({},e),{contentNavigationSupported:t.payload.isEnabled})}(e,t);default:return e}}function Jt(e,t){return void 0===e&&(e={filteredRanges:{},filteringCapabilities:void 0,ensureActiveFilter:!1,collaborators:void 0}),void 0===t&&(t=ve.EMPTY_ACTION),(0,ft.Ay)(e,(function(n){switch(t.type){case"ACTIVE_FILTER_UPDATED":return void function(e,t){t.payload.newActiveFilterId!==e.activeFilterId&&(e.activeFilterId=t.payload.newActiveFilterId,e.activeFilterId&&(e.ensureActiveFilter=!0))}(n,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return void function(e,t){e.activeFilterId||t.payload.visibilityState===z.Y.Closed||(e.ensureActiveFilter=!0)}(n,t);case"LOAD_FILTER":return void function(e,t){!function(e,t,n){if(void 0!==e.filteredRanges[t.id])return(0,d.i7)().assertConditionTag(!1,"Should not load a filter with the same id as a previously loaded filter",528527825),!1;n&&(e.activeFilterId=t.id,e.ensureActiveFilter=!1),e.filteredRanges[t.id]={filter:t.getFilter(),order:t.getOrder(),canUpdateFilter:t.canBeUpdated()}}(e,t.payload.filteredRange,t.payload.shouldSetActive)}(n,t);case"SET_FILTERING_CAPABILITIES":return void function(e,t){e.filteringCapabilities=t.payload.capabilities}(n,t);case"UPDATE_FILTER_RANGE":return void function(e,t){if((0,d.i7)().assertConditionTag(t.payload.filterId.length>0,"FilterId must not be empty string",529138905),0!==t.payload.changes.length&&t.payload.filterId){var n=e.filteredRanges[t.payload.filterId];n?t.payload.changes.forEach((function(r){switch(r.type){case"FilterUpdate":(0,d.i7)().assertConditionTag(n.canUpdateFilter,"Should not get into FilterUpdate if canUpdateFilter is false",528749965),n.filter=r.updatedFilter;break;case"Insert":if(r.index<0||r.index>n.order.length){(0,d.i7)().assertConditionTag(!1,"Insert index out of bounds?",529138908);break}n.order=(0,h.__spreadArray)((0,h.__spreadArray)((0,h.__spreadArray)([],(0,h.__read)(n.order.slice(0,r.index)),!1),[r.content],!1),(0,h.__read)(n.order.slice(r.index)),!1);break;case"Reload":n.order=r.fullContent;break;case"Remove":if(r.index<0||r.index>=n.order.length){(0,d.i7)().assertConditionTag(!1,"Processing Remove with index out of bounds?",529138911);break}n.order.splice(r.index,1);break;case"Teardown":t.payload.filterId===e.activeFilterId&&((0,d.i7)().assertConditionTag(r.teardownReason!==k.jL.Unknown,"Active filter was removed for unknown reason. Requesting a new filter to be set as active.",507794051),e.activeFilterId=void 0,e.ensureActiveFilter=r.teardownReason!==k.jL.RuntimeTeardown),delete e.filteredRanges[t.payload.filterId]}})):(0,d.i7)().assertConditionTag(!1,"Processing update for a filter that is not found?",529138910)}}(n,t);case"SET_COLLABORATORS":return void function(e,t){e.collaborators=t.payload.collaborators}(n,t);case"UPDATE_COLLABORATORS":return void function(e,t){var n,r;switch(t.payload.change.type){case"UserAdded":null===(n=e.collaborators)||void 0===n||n.push(t.payload.change.user);break;case"UserRemoved":e.collaborators=null===(r=e.collaborators)||void 0===r?void 0:r.filter((function(e){return e.UserId!==t.payload.change.user.UserId}))}}(n,t);default:return e}}))}function Qt(e){return(0,h.__assign)((0,h.__assign)({},v.rR()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:[]}),{cardViewState:{},postViewState:{},selectedComment:void 0,expandedComments:[],pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:Ze.d.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:(0,_e.KM)(),modelCapabilities:(0,Se.YN)(),localizationDetails:e,suggestionsDetails:void 0,tasks:{},historyRecordViewState:{}})}var en,tn={isRightToLeft:!1,dataCulture:"",uiCulture:""};function nn(e,t){void 0===e&&(e=Qt(tn)),void 0===t&&(t=mt.j);var n=function(e,t){switch(t.type){case"HIGHLIGHT_COMMENT":return function(e,t){var n=Se.gl(t.payload.commentId);return n===e.highlightedCommentId?e:(0,h.__assign)((0,h.__assign)({},e),{highlightedCommentId:n})}(e,t);case"APPLY_COMMENT_CHANGES":return(0,be.E)(e)?(0,ft.Ay)((function(e){!function(e,t){var n,r;if(t.payload.changes.length){var o,a=Se.tN(e.draftState,!0);try{for(var s=(0,h.__values)(t.payload.changes),d=s.next();!d.done;d=s.next())switch((o=d.value).type===gt.Ay.Load&&(o=void 0!==e.postViewState[o.model.commentId]?(0,h.__assign)((0,h.__assign)({},o),{type:gt.Ay.Modify}):(0,h.__assign)((0,h.__assign)({},o),{type:gt.Ay.Insert})),o.type){case gt.Ay.Insert:Mt(e,o,a),void 0===e.createdCommentLie&&(a=void 0);break;case gt.Ay.Modify:Lt(e,o);break;case gt.Ay.Delete:Ot(e,o,a)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}kt(e,2),e.selectedComment&&!(0,_e.Dd)(e.draftState)&&(e.cardViewState[e.selectedComment.selectedCardId]?(0,De.dF)(e.selectedComment.selectionDetails)&&!e.postViewState[e.selectedComment.selectionDetails.selectedPostId]&&(e.selectedComment=Se.NN(e.selectedComment.selectedCardId)):e.selectedComment=void 0),e.expandedComments=Se.mh(e.expandedComments,e.cardViewState,e.draftState);var c=xt(e,i.m2.reserveTag(520646682));if(c){var u=Vt(c.tasks,c.historyRecordViewState,t.payload,c.localizationDetails);(null==u?void 0:u.updatedTasks)&&(e.tasks=u.updatedTasks),(null==u?void 0:u.updatedHistoryRecordViewState)&&(e.historyRecordViewState=u.updatedHistoryRecordViewState)}}}(e,t)}))(e):function(e,t){var n,r,o,a,s,c,u;if(!t.payload.changes.length)return e;var l,m={commentData:(0,h.__spreadArray)([],(0,h.__read)(e.commentData),!1),cardViewState:(0,h.__assign)({},e.cardViewState),postViewState:(0,h.__assign)({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,expandedComments:e.expandedComments,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState},f=e.createdCommentLie,p=!!Se.tN(e.draftState,!0),g=null==f?void 0:f.flatIndex,C=e.modelCapabilities.virtualized;try{for(var v=(0,h.__values)(t.payload.changes),y=v.next();!y.done;y=v.next())if((l=y.value).type===gt.Ay.Load&&(l=void 0!==m.postViewState[l.model.commentId]?(0,h.__assign)((0,h.__assign)({},l),{type:gt.Ay.Modify}):(0,h.__assign)((0,h.__assign)({},l),{type:gt.Ay.Insert})),l.type===gt.Ay.Insert){var T;if((I=l.model.parentId)&&(m.cardViewState[I]?m.cardViewState[I]=(0,h.__assign)((0,h.__assign)({},m.cardViewState[I]),{pending:Ae.q.None}):null===(s=null===(a=(0,d.i7)())||void 0===a?void 0:a.logDiagnosticTrace)||void 0===s||s.call(a,(0,pe.D)(en||(en=(0,h.__makeTemplateObject)(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),i.m2.reserveTag(526960065),d.AI.Warning,d.b5.ProductServiceUsage,(0,d.t4)(d.ZK.ReviewedAsNotNecessary))),m.commentData.splice(l.index,0,l.model),l.tempId)I||((T={})[l.model.commentId]=Se.iv(l.tempId),m.cardViewState=(0,h.__assign)((0,h.__assign)({},Se.Mu(m.cardViewState,l.tempId)),T)),m.postViewState=(0,h.__assign)((0,h.__assign)({},Se.Mu(m.postViewState,l.tempId)),Se.J8([l.model],m.expandedComments,e.localizationDetails)),m.draftState.committedLieId===l.tempId&&(m.draftState=(0,h.__assign)((0,h.__assign)({},m.draftState),{committedLieId:void 0}),g=void 0),m.selectedComment&&m.selectedComment.selectedCardId===l.tempId&&(m.selectedComment=Se.NN((0,Je.a)(l.model)),l.model.parentId||(m.expandedComments=Se.FO(m.expandedComments,m.selectedComment,m.draftState)));else(0,d.i7)().assertConditionTag(!m.postViewState[l.model.commentId],"Received insert for existing comment",594122589),I||((T={})[l.model.commentId]=Se.iv(void 0),m.cardViewState=(0,h.__assign)((0,h.__assign)({},m.cardViewState),T)),m.postViewState=(0,h.__assign)((0,h.__assign)({},m.postViewState),Se.J8([l.model],m.expandedComments,e.localizationDetails));p&&void 0!==g&&l.index<=g&&g++}else if(l.type===gt.Ay.Modify)if((D=m.commentData[l.index]).commentId===l.model.commentId){m.commentData[l.index]=l.model;var I=(0,Je.a)(l.model),S=m.cardViewState[I];S?m.cardViewState[I]=(0,h.__assign)((0,h.__assign)({},S),{pending:Ae.q.None,loadState:S.loadState.state!==Dt.m.Loading&&C?S.loadState:{state:Dt.m.Loaded}}):((0,d.i7)().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",527962186),m.cardViewState[I]=Se.iv(void 0,C?Dt.m.Placeholder:void 0));var A=D.displayDate===l.model.displayDate&&D.date===l.model.date?m.postViewState[l.model.commentId].displayDate:Se.Zn(l.model.date,l.model.displayDate,e.localizationDetails.dataCulture);if(m.postViewState=(0,h.__assign)((0,h.__assign)({},m.postViewState),((o={})[l.model.commentId]=(0,h.__assign)((0,h.__assign)({},m.postViewState[l.model.commentId]),{pending:Et.U.None,displayDate:A}),o)),l.model.commentFlags&nt.P.Resolved&&!(D.commentFlags&nt.P.Resolved)){var _=m.draftState;m.selectedComment&&m.selectedComment.selectedCardId===l.model.commentId&&(m.selectedComment=Se.NN(m.selectedComment.selectedCardId)),m.draftState=Se.nS(m.draftState,l.model.commentId,m.commentData),(0,Pt.K)(_,m.draftState,1,2,i.m2.reserveTag(539297114)),(null==S?void 0:S.loadState.state)===Dt.m.Loaded&&(m.expandedComments=Se.Om(l.model.commentId,m.expandedComments,m.draftState,m.selectedComment))}}else(0,d.i7)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),(0,i.fH)("changeIndex did not match comment for ".concat(l.model.commentId));else if(l.type===gt.Ay.Delete){var D;if((D=m.commentData[l.index]).commentId===l.model.commentId&&m.commentData.splice(l.index,1),m.highlightedCommentId===l.model.commentId&&(m.highlightedCommentId=void 0),m.topVisibleThreadId===l.model.commentId&&(m.topVisibleThreadId=void 0),m.cardViewState=Se.Mu(m.cardViewState,l.model.commentId),m.postViewState=Se.Mu(m.postViewState,l.model.commentId),l.model.commentId===m.selectedThreadIdBeforeCommentSession){var E=l.index;m.commentData.length?(E>=m.commentData.length&&(E=m.commentData.length-1),m.selectedThreadIdBeforeCommentSession=(0,Je.a)(m.commentData[E])):m.selectedThreadIdBeforeCommentSession=void 0}p&&void 0!==g&&l.index<g&&g--}}catch(e){n={error:e}}finally{try{y&&!y.done&&(r=v.return)&&r.call(v)}finally{if(n)throw n.error}}p&&(void 0===g?f=void 0:f&&g!==f.flatIndex&&(f=(0,h.__assign)((0,h.__assign)({},f),{flatIndex:g}))),m.draftState=Se.Sr(m.draftState,e.cardViewState,m.cardViewState,e.postViewState,m.postViewState,2),m.selectedComment&&!(0,_e.Dd)(m.draftState)&&(m.cardViewState[m.selectedComment.selectedCardId]?(0,De.dF)(m.selectedComment.selectionDetails)&&!m.postViewState[m.selectedComment.selectionDetails.selectedPostId]&&(m.selectedComment=Se.NN(m.selectedComment.selectedCardId)):m.selectedComment=void 0);var P=Vt(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return(0,h.__assign)((0,h.__assign)({},e),{createdCommentLie:f,draftState:m.draftState,selectedComment:m.selectedComment,expandedComments:Se.mh(m.expandedComments,m.cardViewState,m.draftState),commentData:m.commentData,cardViewState:m.cardViewState,postViewState:m.postViewState,highlightedCommentId:m.highlightedCommentId,topVisibleThreadId:m.topVisibleThreadId,selectedThreadIdBeforeCommentSession:m.selectedThreadIdBeforeCommentSession,tasks:null!==(c=null==P?void 0:P.updatedTasks)&&void 0!==c?c:e.tasks,historyRecordViewState:null!==(u=null==P?void 0:P.updatedHistoryRecordViewState)&&void 0!==u?u:e.historyRecordViewState})}(e,t);case"LOAD_COMMENT":return function(e,t){var n,r,o,i=e.modelCapabilities.virtualized,a=Se.uG(e,t.payload.commentData,i,!!t.payload.filteringEnabled);o=Se.K1(t.payload.commentData,i?Dt.m.Placeholder:Dt.m.Loaded);var s=function(e,t){var n,r;if(e&&v.$H()){var o={},i={};try{for(var a=(0,h.__values)(e),s=a.next();!s.done;s=a.next()){var d=s.value;Ut({},i,d,t),o[d.commentId]=Gt(d)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return{updatedTasks:o,updatedHistoryRecordViewState:i}}}(t.payload.tasks,e.localizationDetails);return(0,h.__assign)((0,h.__assign)((0,h.__assign)({},e),a),{cardViewState:(0,h.__assign)((0,h.__assign)({},e.cardViewState),o),postViewState:(0,h.__assign)((0,h.__assign)({},e.postViewState),Se.J8(t.payload.commentData,a.expandedComments,e.localizationDetails)),tasks:null!==(n=null==s?void 0:s.updatedTasks)&&void 0!==n?n:e.tasks,historyRecordViewState:null!==(r=null==s?void 0:s.updatedHistoryRecordViewState)&&void 0!==r?r:e.historyRecordViewState})}(e,t);case"VIRTUALIZE_COMMENTS":return function(e,t){if(!e.modelCapabilities.virtualized)throw new B.cP("virtualizeCommentsReducer requires virtualization",i.m2.reserveTag(589103643),-2130957500);var n=t.payload.threadInfo.map((function(e){return e.threadId})).map((function(e){return St(e,void 0,void 0)})),r=Se.uG(e,n,!0,!!t.payload.filteringEnabled);return(0,h.__assign)((0,h.__assign)((0,h.__assign)({},e),r),{cardViewState:(0,h.__assign)((0,h.__assign)({},e.cardViewState),Se.WT(t.payload.threadInfo)),postViewState:(0,h.__assign)((0,h.__assign)({},e.postViewState),Se.J8(n,r.expandedComments,e.localizationDetails))})}(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return function(e,t){var n;if(!(0,_e.QZ)(e.draftState))return e;var r,o=Se.tN(e.draftState);if(!o)return e;var i=!1;(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)!==o?r=e.selectedComment:e.selectedThreadIdBeforeCommentSession&&(r={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}},i=!0);var a=Se.qb(e.draftState,o);return(0,h.__assign)((0,h.__assign)((0,h.__assign)({},e),(0,be.E)(e)?{commentThreadIds:Se.nc(e.commentThreadIds,o),cardPostIds:Se.Mu(e.cardPostIds,o),postData:Se.Mu(e.postData,o)}:{}),{createdCommentLie:void 0,selectedComment:r,expandedComments:r&&i?Se.FO(e.expandedComments,r,a):Se.a3(e.expandedComments,r,a),cardViewState:Se.Mu(e.cardViewState,o),postViewState:Se.Mu(e.postViewState,o),selectedThreadIdBeforeCommentSession:void 0,draftState:a})}(e);case"CANCEL_COMMENT_POST_EDIT":return function(e,t){var n=Se.Nk(e,t.payload.commentId),r=Se.MK(e.draftState,t.payload.commentId);return(0,h.__assign)((0,h.__assign)({},e),{selectedComment:n,expandedComments:Se.a3(e.expandedComments,n,r),selectedThreadIdBeforeCommentSession:void 0,draftState:r})}(e,t);case"CANCEL_COMMENT_REPLY":return function(e,t){var n=Se.qb(e.draftState,t.payload.commentId);return(0,h.__assign)((0,h.__assign)({},e),{expandedComments:Se.a3(e.expandedComments,e.selectedComment,n),selectedThreadIdBeforeCommentSession:void 0,draftState:n})}(e,t);case"COLLAPSE_CARD":return function(e,t){var n=Se.rB(e.draftState);if((null==n?void 0:n.threadId)===t.payload.cardId)return e;var r=Se.DI(t.payload.cardId,e.selectedComment,e.draftState);return(0,h.__assign)((0,h.__assign)({},e),{selectedComment:r,expandedComments:Se.Om(t.payload.cardId,e.expandedComments,e.draftState,r)})}(e,t);case"SELECT_COMMENT":return function(e,t){var n=e.selectedComment;if(!Se.G$(e.draftState,n,t))return e;if(!t.payload.selectedCard)throw new B.cP(ae.yC,i.m2.reserveTag(589103644),-2130957536);var r=Se.ve(e.selectedComment,t),o=(0,ve.shouldSelectActionExpandCard)(t.payload.selectType)?Se.FO(e.expandedComments,r,e.draftState):Se.a3(e.expandedComments,r,e.draftState);return(0,h.__assign)((0,h.__assign)({},e),{selectedComment:r,expandedComments:o})}(e,t);case"REQUEST_THREAD_RESOLVE":return function(e,t){var n;return(0,h.__assign)((0,h.__assign)({},e),{cardViewState:(0,h.__assign)((0,h.__assign)({},e.cardViewState),(n={},n[t.payload.commentId]=(0,h.__assign)((0,h.__assign)({},e.cardViewState[t.payload.commentId]),{pending:Ae.q.Card,loadState:{state:Dt.m.Loaded}}),n)),selectedComment:Se.Uh(e.selectedComment,t)})}(e,t);case"RELOAD_COMMENTS":return(0,be.E)(e)?(0,ft.Ay)((function(e){!function(e,t){var n=xt(e,i.m2.reserveTag(524031011));if(n){var r=!1,o=!1,a=!1,s=!1,c=n.selectedComment&&(0,De.dF)(n.selectedComment.selectionDetails),u=!1;e.commentThreadIds=[],e.cardPostIds={},e.postData={},e.cardViewState={},e.postViewState={},t.payload.comments.forEach((function(t){if(t.commentId===n.highlightedCommentId&&(r=!0),t.commentId===n.topVisibleThreadId&&(o=!0),n.selectedComment&&(t.commentId===n.selectedComment.selectedCardId&&(a=!0),n.selectedComment.selectedCardId===(0,Je.a)(t)&&(0,De.dF)(n.selectedComment.selectionDetails)&&n.selectedComment.selectionDetails.selectedPostId===t.commentId&&(s=!0)),t.commentId in n.postData)(0,Je.j)(t)&&function(e,t){var n=xt(e,i.m2.reserveTag(523604707));if(n){var r=n.cardViewState[t];(0,d.i7)().assertConditionTag(!r||r.pending!==Ae.q.Delete,"Card pending delete remained after a reload.",523604736);var o=n.modelCapabilities.virtualized?Dt.m.NeedsReload:Dt.m.Loaded;if(r){var a=r.pending!==Ae.q.None,s=(a||n.modelCapabilities.virtualized)&&r.loadState.state!==Dt.m.Placeholder&&r.loadState.state!==o;e.cardViewState[t]=a||s?(0,h.__assign)((0,h.__assign)({},r),{pending:Ae.q.None}):r,s&&(e.cardViewState[t].loadState=(0,h.__assign)((0,h.__assign)({},e.cardViewState[t].loadState),{state:o}))}else(0,d.i7)().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default",523604737),e.cardViewState[t]=Se.iv(void 0,o)}}(e,t.commentId),function(e,t){var n=xt(e,i.m2.reserveTag(523604738));if(n){var r=n.postViewState[t];(0,d.i7)().assertConditionTag(!r||r.pending!==Et.U.Delete,"Post pending delete remained after a reload.",523604739),r?e.postViewState[t]=r.pending!==Et.U.None?(0,h.__assign)((0,h.__assign)({},r),{pending:Et.U.None}):r:((0,d.i7)().assertConditionTag(!1,"Post state missing for existing post on reload. Creating default",523604740),e.postViewState[t]=Se.t$(void 0))}}(e,t.commentId),wt(e,t,n.postData[t.commentId],1),n.selectedThreadIdBeforeCommentSession&&n.selectedThreadIdBeforeCommentSession===t.commentId&&(u=!0);else{if((0,Je.j)(t)){var c=t.commentId,l=n.modelCapabilities.virtualized?{state:Dt.m.Placeholder,initialItemCount:1}:{state:Dt.m.Loaded};e.cardViewState[t.commentId]=Se.cU(c,l)}e.postViewState[t.commentId]=Se.t$(t.displayDate)}bt(e,t)})),r||(e.highlightedCommentId=void 0),o||(e.topVisibleThreadId=void 0),!u&&n.selectedThreadIdBeforeCommentSession&&function(e){var t=xt(e,i.m2.reserveTag(523604741));if(null==t?void 0:t.selectedThreadIdBeforeCommentSession){var n=t.commentThreadIds.indexOf(t.selectedThreadIdBeforeCommentSession);n<0&&((0,d.i7)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in original commentThreadIds. Falling back to first comment",523604742),n=0);var r=e.commentThreadIds.length-1;e.commentThreadIds.length?(n>=e.commentThreadIds.length&&(n=r),e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[n]):e.selectedThreadIdBeforeCommentSession=void 0}}(e),function(e){var t=xt(e,i.m2.reserveTag(523604706));if(t&&e.createdCommentLie){var n=Se.tN(e.draftState,!0);if(n&&t.createdCommentLie&&t.cardViewState[n]&&t.cardViewState[n].pending===Ae.q.None){var r=Object.keys(e.postData).length;e.createdCommentLie&&e.createdCommentLie.flatIndex>r&&(e.createdCommentLie.flatIndex=r);var o=Se.Q0(e.commentThreadIds,e.cardPostIds,e.createdCommentLie.flatIndex);o>=0?(e.commentThreadIds.splice(o,0,n),e.cardPostIds[n]=[n],e.postData[n]=t.postData[n],e.cardViewState[n]=t.cardViewState[n],e.postViewState[n]=t.postViewState[n]):(0,d.i7)().assertConditionTag(!1,"getThreadIndexFromFlatIndex unexpected failure to get threadIndex",523100547)}else e.createdCommentLie=void 0}}(e),e.draftState.committedLieId=void 0;var l=Se.tN(e.draftState);l&&e.selectedComment&&l===e.selectedComment.selectedCardId&&(a=!0),kt(e,1),(0,_e.Dd)(e.draftState)||(a?c&&!s&&e.selectedComment&&!n.modelCapabilities.virtualized&&(e.selectedComment.selectionDetails=Se.Jn()):e.selectedComment=void 0),e.pendingCommentLoad=void 0;var m=Bt(n.tasks,n.historyRecordViewState,t.payload,n.localizationDetails);(null==m?void 0:m.updatedTasks)&&(e.tasks=m.updatedTasks),(null==m?void 0:m.updatedHistoryRecordViewState)&&(e.historyRecordViewState=m.updatedHistoryRecordViewState);var f=Se.mh(e.expandedComments,e.cardViewState,e.draftState);f!==e.expandedComments&&(e.expandedComments=f)}}(e,t)}))(e):function(e,t){var n,r,o,a,s={},c={},u=e.selectedComment,l=e.expandedComments,m=u&&(0,De.dF)(u.selectionDetails),f=!1,p=!1,g=!1,C=e.selectedThreadIdBeforeCommentSession,v=e.draftState,y=e.modelCapabilities.virtualized,T=null===(n=Se.rB(v))||void 0===n?void 0:n.threadId,I={};e.commentData.forEach((function(e){I[e.commentId]=e}));var S=!1,A=!1;t.payload.comments.forEach((function(n){if(n.commentId===e.highlightedCommentId&&(S=!0),n.commentId===e.topVisibleThreadId&&(A=!0),u&&(n.commentId===u.selectedCardId&&(p=!0),u.selectedCardId===(0,Je.a)(n)&&(0,De.dF)(u.selectionDetails)&&u.selectionDetails.selectedPostId===n.commentId&&(f=!0)),n.commentId in I){if(""===n.parentId){e.cardViewState[n.commentId]&&(0,d.i7)().assertConditionTag(e.cardViewState[n.commentId].pending!==Ae.q.Delete,"Card pending delete remained after a reload.",593762527);var r=e.cardViewState[n.commentId];if(r)if(r.pending!==Ae.q.None||y){var o=r.loadState;c[n.commentId]=(0,h.__assign)((0,h.__assign)({},r),{pending:Ae.q.None,loadState:o.state===Dt.m.Placeholder?o:{state:y?Dt.m.NeedsReload:Dt.m.Loaded}})}else c[n.commentId]=r;else(0,d.i7)().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default.",527958879),c[n.commentId]=Se.iv(void 0,y?Dt.m.NeedsReload:Dt.m.Loaded)}if((0,d.i7)().assertConditionTag(!e.postViewState[n.commentId]||e.postViewState[n.commentId].pending!==Et.U.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[n.commentId]?e.postViewState[n.commentId].pending!==Et.U.None?s[n.commentId]=(0,h.__assign)((0,h.__assign)({},e.postViewState[n.commentId]),{pending:Et.U.None}):s[n.commentId]=e.postViewState[n.commentId]:s[n.commentId]=Se.t$(void 0),n.commentFlags&nt.P.Resolved&&(!I[n.commentId]||!(I[n.commentId].commentFlags&nt.P.Resolved))){if(u&&u.selectedCardId===n.commentId&&(u=Se.NN(u.selectedCardId)),n.commentId===T){var a=v;v=Se.nS(v,n.commentId,t.payload.comments),(0,Pt.K)(a,v,1,1,i.m2.reserveTag(539297115))}l=Se.Om(n.commentId,l,v,u)}C&&C===n.commentId&&(g=!0)}else{if(""===n.parentId){var m=n.commentId,_=y?{state:Dt.m.Placeholder,initialItemCount:1}:{state:Dt.m.Loaded};c[n.commentId]=Se.cU(m,_)}s[n.commentId]=Se.t$(l.includes((0,Je.a)(n))?Se.Zn(n.date,n.displayDate,e.localizationDetails.dataCulture):n.displayDate)}})),a=Se.jn(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState),v=(0,h.__assign)((0,h.__assign)({},v),{committedLieId:void 0});var _=Se.tN(v);if(_&&(u&&_===u.selectedCardId&&(p=!0),c[_]=e.cardViewState[_],s[_]=e.postViewState[_]),v=Se.Sr(v,e.cardViewState,c,e.postViewState,s,1),(0,_e.Dd)(v)||(p?m&&!f&&u&&!y&&(u={selectedCardId:u.selectedCardId,selectionDetails:{lowFidelityWarningType:void 0}}):u=void 0),!g&&C){var D=e.commentData.findIndex((function(e){return e.commentId===C}));if(D<0&&((0,d.i7)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),D=0),t.payload.comments.length){D>=t.payload.comments.length&&(D=t.payload.comments.length-1);var E=t.payload.comments[D];C=(0,Je.a)(E)}else C=void 0}var P=Bt(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return(0,h.__assign)((0,h.__assign)({},e),{draftState:v,commentData:(0,h.__spreadArray)([],(0,h.__read)(t.payload.comments),!1),cardViewState:c,postViewState:s,selectedComment:u,expandedComments:Se.mh(l,c,v),pendingCommentLoad:void 0,highlightedCommentId:S?e.highlightedCommentId:void 0,topVisibleThreadId:A?e.topVisibleThreadId:void 0,createdCommentLie:a,selectedThreadIdBeforeCommentSession:C,tasks:null!==(r=null==P?void 0:P.updatedTasks)&&void 0!==r?r:e.tasks,historyRecordViewState:null!==(o=null==P?void 0:P.updatedHistoryRecordViewState)&&void 0!==o?o:e.historyRecordViewState})}(e,t);case"REQUEST_REOPEN_THREAD":return function(e,t){var n,r=(0,h.__assign)((0,h.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=(0,h.__assign)((0,h.__assign)({},e.cardViewState[t.payload.commentId]),{pending:Ae.q.Card}),n));return(0,h.__assign)((0,h.__assign)({},e),{cardViewState:r})}(e,t);case"REQUEST_DELETE_POST":return function(e,t){var n,r=(0,h.__assign)((0,h.__assign)({},e.postViewState),((n={})[t.payload.commentId]=(0,h.__assign)((0,h.__assign)({},e.postViewState[t.payload.commentId]),{pending:Et.U.Delete}),n));return(0,h.__assign)((0,h.__assign)({},e),{postViewState:r})}(e,t);case"REQUEST_DELETE_THREAD":return function(e,t){var n,r=(0,h.__assign)((0,h.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=(0,h.__assign)((0,h.__assign)({},e.cardViewState[t.payload.commentId]),{pending:Ae.q.Delete}),n));return(0,h.__assign)((0,h.__assign)({},e),{cardViewState:r})}(e,t);case"DISPATCH_LOAD_THREADS":return function(e,t){var n=(0,h.__assign)({},e.cardViewState);return t.payload.threadIds.forEach((function(e){if(n[e]){var t=n[e].loadState;n[e]=(0,h.__assign)((0,h.__assign)({},n[e]),{loadState:{state:Dt.m.Loading,initialItemCount:Se.f8(t)?t.initialItemCount:1}})}else(0,d.i7)().assertConditionTag(!1,"Loading an unexpected thread?",528021317)})),(0,h.__assign)((0,h.__assign)({},e),{cardViewState:n})}(e,t);case"BEGIN_DRAFTING_SUCCESS":return function(e,t){var n,r,o,a,s,c,u,l,m,f,p;if(Se.CR(e.draftState))throw new B.cP("Draft already active!",i.m2.reserveTag(589103640),-2130957551);var g=e.selectedThreadIdBeforeCommentSession,C=t.payload.draftDetails,v=null===(m=null===(l=t.payload.rehydratedDraftParams)||void 0===l?void 0:l.inCurrentContext)||void 0===m||m,y=null===(p=null===(f=t.payload.rehydratedDraftParams)||void 0===f?void 0:f.isDraftEmpty)||void 0===p||p;switch(C.sessionConfiguration.sessionType){case"CREATE":var T=C.sessionConfiguration.draftId,I=(0,h.__assign)((0,h.__assign)({},Se.vY(T)),{author:C.author,anchorHintText:C.anchorHintText}),S=v?Se.qP((0,be.OJ)(e),C):e.selectedComment,A=(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:(0,h.__assign)((0,h.__assign)({},e.draftState.drafts),(n={},n[T]={commentDraft:C,isDraftEmpty:y,isInCurrentContext:v,pendingState:_e.W8.None,renderContextType:t.payload.draftRenderContextType,threadId:T},n)),cardIdToDraftIdMap:(0,h.__assign)((0,h.__assign)({},e.draftState.cardIdToDraftIdMap),(r={},r[T]=T,r)),pendingDraft:void 0}),_={};if((0,be.E)(e)){var D=Se.Q0(e.commentThreadIds,e.cardPostIds,C.insertIndex),E=e.commentThreadIds,P=e.cardPostIds;D>=0&&(E=(0,h.__spreadArray)((0,h.__spreadArray)((0,h.__spreadArray)([],(0,h.__read)(E.slice(0,D)),!1),[T],!1),(0,h.__read)(E.slice(D)),!1),P=(0,h.__assign)((0,h.__assign)({},e.cardPostIds),((o={})[T]=[T],o))),_={commentThreadIds:E,cardPostIds:P,postData:(0,h.__assign)((0,h.__assign)({},e.postData),(a={},a[T]=I,a))}}return(0,h.__assign)((0,h.__assign)((0,h.__assign)({},e),_),{createdCommentLie:{flatIndex:C.insertIndex,newComment_deprecated:I},cardViewState:(0,h.__assign)((0,h.__assign)({},e.cardViewState),Se.EO(I)),postViewState:(0,h.__assign)((0,h.__assign)({},e.postViewState),Se.Sv(I)),selectedComment:S,expandedComments:Se.FO(e.expandedComments,S,A),selectedThreadIdBeforeCommentSession:g,draftState:A});case"EDIT":case"REPLY":if(!(0,vt.kW)(C.sessionConfiguration)&&!(0,vt.w1)(C.sessionConfiguration))throw(0,d.i7)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new B.cP(ae.Mb,i.m2.reserveTag(589103642),-2130957532);var x,b=(0,vt.w1)(C.sessionConfiguration)&&(!e.selectedComment||C.sessionConfiguration.threadId!==e.selectedComment.selectedCardId),k=ht.pS(C.sessionConfiguration)&&(!e.selectedComment||!(0,De.dF)(e.selectedComment.selectionDetails)||C.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId);x=v?!e.selectedComment||b||k?Se.qP((0,be.OJ)(e),C):(0,h.__assign)((0,h.__assign)({},e.selectedComment),{selectionDetails:(0,h.__assign)((0,h.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedComment;var w=e.draftState.cardIdToDraftIdMap,R=e.draftState.postIdToDraftIdMap,F="",N=!1,M=!1;if(ht.vd(C.sessionConfiguration))w=(0,h.__assign)((0,h.__assign)({},w),((s={})[C.sessionConfiguration.threadId]=C.sessionConfiguration.draftId,s)),F=C.sessionConfiguration.threadId,M=y;else if(ht.pS(C.sessionConfiguration)){var L=C.sessionConfiguration.commentId;if(R=(0,h.__assign)((0,h.__assign)({},R),((c={})[L]=C.sessionConfiguration.draftId,c)),N=!0,(0,be.E)(e)){var O=e.postData[L],V=(0,_t.vk)(O.commentBody);M=0===V.length||"web"===(0,Me.u)()&&"\n"===V,F=(0,Je.a)(O)}else e.commentData.some((function(e){if(e.commentId===L){var t=(0,_t.vk)(e.commentBody);return M=0===t.length||"web"===(0,Me.u)()&&"\n"===t,F=(0,Je.a)(e),!0}return!1}));!F&&C.sessionConfiguration.rootCommentId&&(F=C.sessionConfiguration.rootCommentId)}else(0,i.HB)(C.sessionConfiguration);var U=(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:(0,h.__assign)((0,h.__assign)({},e.draftState.drafts),(u={},u[C.sessionConfiguration.draftId]={commentDraft:C,isDraftEmpty:M,isInCurrentContext:v,pendingState:_e.W8.None,renderContextType:t.payload.draftRenderContextType,threadId:F},u)),cardIdToDraftIdMap:w,postIdToDraftIdMap:R,pendingDraft:void 0});return(0,h.__assign)((0,h.__assign)({},e),{selectedComment:x,expandedComments:N?Se.FO(e.expandedComments,x,U):Se.a3(e.expandedComments,x,U),selectedThreadIdBeforeCommentSession:g,draftState:U,createdCommentLie:void 0});default:return e}}(e,t);case"BEGIN_DRAFTING_FAILURE":return function(e,t){if(void 0===e.selectedComment)return(0,d.i7)().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=(0,h.__assign)((0,h.__assign)({},e.selectedComment),{selectionDetails:(0,h.__assign)((0,h.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}});var r=(0,h.__assign)((0,h.__assign)({},e.draftState),{pendingDraft:void 0});return(0,h.__assign)((0,h.__assign)({},e),{selectedComment:n,expandedComments:Se.a3(e.expandedComments,n,r),selectedThreadIdBeforeCommentSession:void 0,createdCommentLie:void 0,draftState:r})}(e,t);case"SESSION_REQUEST_STARTED":return function(e,t){var n;if(e.createdCommentLie)return(0,d.i7)().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(ht.vd(t.payload.params))n=t.payload.params.threadId;else if(ht.pS(t.payload.params)){var r=t.payload.params.commentId,o=(0,be.YO)((0,be.OJ)(e),r);if(!o)return(0,d.i7)().assertConditionTag(!1,"Could not lock selection on missing comment",593764357),e;n=(0,Je.a)(o)}else n=(0,D.M3)();var i=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(i=e.selectedComment.selectedCardId);var a=(0,h.__assign)((0,h.__assign)({},e.draftState),{pendingDraft:t.payload.params,committedLieId:void 0}),s=Se.gJ(e.selectedComment,t,n),c=(0,De.dF)(s.selectionDetails)?Se.FO(e.expandedComments,s,a):e.expandedComments;return(0,h.__assign)((0,h.__assign)({},e),{selectedThreadIdBeforeCommentSession:i,selectedComment:s,expandedComments:c,draftState:a})}(e,t);case"COMMENT_CONTEXT_CHANGED":return function(e,t){var n,r,o,a=(0,_e.KM)(),s={},c={},u=void 0,l=void 0,m=void 0,f=void 0,p=Se.tN(e.draftState),g=!!e.createdCommentLie;o=t.payload.contextDetails?(0,h.__assign)((0,h.__assign)({},zt(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:Ze.d.Unknown,isReadOnly:v.Fr()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var C,y=t.payload.contextDrafts;if(y){var T=Se.wx(e.draftState);if((0,_e.Ze)(T)>0){var I={},S=void 0,A=void 0,_=!v.S();if((0,_e.CG)(T).forEach((function(n){var r,o,i=y.find((function(e){return e.draftId===n}));I[n]=(0,h.__assign)((0,h.__assign)({},T.drafts[n]),{isInCurrentContext:!!i}),p===n&&(g=!!i,i&&(S=i.insertIndex,A=i.anchorHintText,(null===(r=t.payload.contextDetails)||void 0===r?void 0:r.selectedCommentId)===p&&(u=Se.NN(p)))),_||u||!i||I[n].threadId!==(null===(o=e.selectedComment)||void 0===o?void 0:o.selectedCardId)||(_=!0)})),a=(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:I}),l=e.createdCommentLie,m=p?(0,be.E)(e)?e.postData[p]:null==l?void 0:l.newComment_deprecated:void 0,_&&(u=e.selectedComment),l&&p&&g){(0,d.i7)().assertConditionTag(void 0!==S,"Index unknown for lie in latest context",587309136);var D=null!=S?S:0;D!==l.flatIndex&&(l=(0,h.__assign)((0,h.__assign)({},l),{flatIndex:D})),m&&void 0!==A&&A!==l.newComment_deprecated.anchorHintText&&(m=(0,h.__assign)((0,h.__assign)({},m),{anchorHintText:A}),l=(0,h.__assign)((0,h.__assign)({},l),{newComment_deprecated:m})),s=Se.i8(p),c=Se.oL(p),l.flatIndex>-1&&(s[p].pending=Ae.q.None,c[p].pending=Et.U.None)}}else f=null!=f?f:-1}else f=null!=f?f:4;if(o.isReadOnly&&(g&&(l=void 0),a=Se.jr(a),f=null!=f?f:5),(0,Pt.K)(e.draftState,a,f,4,i.m2.reserveTag(539297116)),(0,be.E)(e)){var E=[],P={},x={};l&&p&&m&&((n={})[p]=m,x=n,g&&!l.flatIndex&&(E=[p],(r={})[p]=[p],P=r)),C={commentThreadIds:E,cardPostIds:P,postData:x}}else C={commentData:[]};return(0,h.__assign)((0,h.__assign)((0,h.__assign)({},e),C),{cardViewState:s,postViewState:c,selectedComment:u,expandedComments:Se.a3(e.expandedComments,u,a),pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfLoadedComments:0,numberOfLoadedThreads:0,numberOfTotalComments:t.payload.numberOfComments,numberOfTotalThreads:t.payload.numberOfThreads,selectedThreadIndex:void 0!==t.payload.selectedThreadIndex&&t.payload.selectedThreadIndex<t.payload.numberOfThreads?t.payload.selectedThreadIndex:void 0},contextState:o,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?Se.gl(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:l,selectedThreadIdBeforeCommentSession:void 0,draftState:a,tasks:{},historyRecordViewState:{}})}(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return function(e,t){return(0,h.__assign)((0,h.__assign)({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}(e,t);case"SHOW_LOW_FIDELITY_WARNING":return function(e,t){var n,r=t.payload,o=r.commentId,i=r.lowFidelityWarningType,a=(0,be.YO)((0,be.OJ)(e),o);if(!a)return(0,d.i7)().assertConditionTag(!1,"Comment not found",593762530),e;if((0,_e.mw)(e.draftState))return(0,d.i7)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;var s=e.expandedComments;return i===De.xQ.DeleteThread?n={selectedCardId:o,selectionDetails:{lowFidelityWarningType:i}}:(n={selectedCardId:(0,Je.a)(a),selectionDetails:{selectedPostId:o,lowFidelityWarningType:i}},s=Se.FO(s,n,e.draftState)),(0,h.__assign)((0,h.__assign)({},e),{selectedComment:n,expandedComments:s})}(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return function(e,t){var n=e.selectedComment;return n&&void 0!==n.selectionDetails.lowFidelityWarningType?(0,h.__assign)((0,h.__assign)({},e),{selectedComment:(0,h.__assign)((0,h.__assign)({},n),{selectionDetails:{lowFidelityWarningType:void 0}})}):e}(e);case"CLEAR_COMMENT_SELECTION":return function(e,t){return Se.G$(e.draftState,e.selectedComment,t)?(0,h.__assign)((0,h.__assign)({},e),{selectedComment:void 0}):e}(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return function(e,t){return void 0!==t.payload.commentId&&t.payload.commentId!==e.highlightedCommentId?e:(0,h.__assign)((0,h.__assign)({},e),{highlightedCommentId:void 0})}(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return function(e,t){return(0,h.__assign)((0,h.__assign)({},e),{topVisibleThreadId:t.payload.threadId})}(e,t);case"UPDATE_CONTEXT_DETAILS":return function(e,t){var n=!1,r=(0,h.__assign)({},e.contextState),o=e.createdCommentLie,a=e.draftState,s=void 0;return void 0!==t.payload.contextState.commentThreadCounts&&(n=!0,r.commentThreadCounts=t.payload.contextState.commentThreadCounts),void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n=!0,r.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails),void 0!==t.payload.contextState.isReadOnly&&(n=!0,r.isReadOnly=t.payload.contextState.isReadOnly,r.isReadOnly&&(a=Se.jr(e.draftState),s=null!=s?s:5,Se.tN(e.draftState,!0)&&(o=void 0))),n?((0,Pt.K)(e.draftState,a,s,5,i.m2.reserveTag(539297117)),(0,h.__assign)((0,h.__assign)({},e),{draftState:a,contextState:r,createdCommentLie:o})):e}(e,t);case"BEGIN_PROCESSING_COMMIT":return function(e,t){var n;if(!(0,_e.IE)(e.draftState))return(0,d.i7)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var r=e.draftState,o=Se.rB(e.draftState);return o&&(r=(0,h.__assign)((0,h.__assign)({},r),{drafts:(0,h.__assign)((0,h.__assign)({},r.drafts),(n={},n[o.commentDraft.sessionConfiguration.draftId]=(0,h.__assign)((0,h.__assign)({},o),{pendingState:_e.W8.Commit}),n))})),(0,h.__assign)((0,h.__assign)({},e),{draftState:r})}(e);case"COMMIT_FAILURE":return function(e,t){var n;if(!(0,_e.hT)(e.draftState))return(0,d.i7)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var r=e.draftState,o=Se.rB(e.draftState);return o&&(r=(0,h.__assign)((0,h.__assign)({},r),{drafts:(0,h.__assign)((0,h.__assign)({},r.drafts),(n={},n[o.commentDraft.sessionConfiguration.draftId]=(0,h.__assign)((0,h.__assign)({},o),{pendingState:_e.W8.None,savedDraftContent:void 0!==t.payload.commitText?{editorContent:Promise.resolve(t.payload.commitText),editorCursorPosition:Promise.resolve(void 0)}:o.savedDraftContent}),n))})),(0,h.__assign)((0,h.__assign)({},e),{draftState:r})}(e,t);case"BEGIN_PROCESSING_DISCARD":return function(e){var t;if(!(0,_e.IE)(e.draftState)&&!(0,De.gh)(e.selectedComment))return(0,d.i7)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var n=e.draftState,r=Se.rB(e.draftState);return r&&(n=(0,h.__assign)((0,h.__assign)({},n),{drafts:(0,h.__assign)((0,h.__assign)({},n.drafts),(t={},t[r.commentDraft.sessionConfiguration.draftId]=(0,h.__assign)((0,h.__assign)({},r),{pendingState:_e.W8.Discard}),t))})),(0,h.__assign)((0,h.__assign)({},e),{draftState:n})}(e);case"CANCEL_DISCARD":return function(e){var t;if(!(0,_e.m6)(e.draftState))return(0,d.i7)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var n=e.draftState,r=Se.rB(e.draftState);return r&&(n=(0,h.__assign)((0,h.__assign)({},n),{drafts:(0,h.__assign)((0,h.__assign)({},n.drafts),(t={},t[r.commentDraft.sessionConfiguration.draftId]=(0,h.__assign)((0,h.__assign)({},r),{pendingState:_e.W8.None}),t))})),(0,h.__assign)((0,h.__assign)({},e),{draftState:n})}(e);case"LOAD_PERSONA_ICON_PROPERTIES":return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;var n=(0,h.__assign)((0,h.__assign)({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return(0,h.__assign)((0,h.__assign)({},e),{personaIconPropertiesMap:n})}(e,t);case"COMMIT_DRAFT":return function(e,t){var n=Se.CR(e.draftState);if(void 0===n)return(0,d.i7)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){var n;if(!e.createdCommentLie)return e;var r=Se.tN(e.draftState);if(!r)return e;var o=t.temporaryCommentId;if(!o)throw(0,d.i7)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new B.cP(ae.Mb,i.m2.reserveTag(589103637),-2130957545);var a=(0,be.E)(e)?e.postData[r]:e.createdCommentLie.newComment_deprecated;if((0,be.E)(e)&&!a)return(0,d.i7)().assertConditionTag(!1,"Did not find model for draft thread on commit",527251200),e;var s=(0,h.__assign)((0,h.__assign)({},a),{commentId:o,commentBody:t.commentBody}),c=(0,h.__assign)((0,h.__assign)({},e.cardViewState),Se.i8(o)),u=(0,h.__assign)((0,h.__assign)({},e.postViewState),Se.oL(o)),l=e.selectedComment&&{selectedCardId:o,selectionDetails:{lowFidelityWarningType:void 0}},m=Se.qb(e.draftState,r);return(0,h.__assign)((0,h.__assign)((0,h.__assign)((0,h.__assign)({},e),{selectedComment:l,expandedComments:Se.FO(e.expandedComments,l,m)}),(0,be.E)(e)?{postData:(0,h.__assign)((0,h.__assign)({},e.postData),(n={},n[r]=s,n))}:{createdCommentLie:(0,h.__assign)((0,h.__assign)({},e.createdCommentLie),{newComment_deprecated:s})}),{cardViewState:c,postViewState:u,selectedThreadIdBeforeCommentSession:void 0,draftState:(0,h.__assign)((0,h.__assign)({},m),{committedLieId:o})})}(e,t.payload.data);case"REPLY":return function(e,t){var n;if(!t.parentId)throw new B.cP(ae.yC,i.m2.reserveTag(589103638),-2130957536);var r=(0,h.__assign)((0,h.__assign)({},e.cardViewState),((n={})[t.parentId]=(0,h.__assign)((0,h.__assign)({},e.cardViewState[t.parentId]),{pending:Ae.q.Editor,loadState:{state:Dt.m.Loaded}}),n)),o=Se.NN(t.parentId),a=Se.qb(e.draftState,t.parentId);return(0,h.__assign)((0,h.__assign)({},e),{cardViewState:r,selectedComment:o,expandedComments:Se.a3(e.expandedComments,o,a),selectedThreadIdBeforeCommentSession:void 0,draftState:a})}(e,t.payload.data);case"EDIT":return function(e,t){var n,r=Se.Nk(e,t.commentId),o=(0,h.__assign)((0,h.__assign)({},e.postViewState[t.commentId]),{pending:Et.U.Post}),i=Se.MK(e.draftState,t.commentId);return(0,h.__assign)((0,h.__assign)({},e),{postViewState:(0,h.__assign)((0,h.__assign)({},e.postViewState),(n={},n[t.commentId]=o,n)),selectedComment:r,expandedComments:Se.a3(e.expandedComments,r,i),selectedThreadIdBeforeCommentSession:void 0,draftState:i})}(e,t.payload.data);default:throw new B.cP("Unexpected session type for commit",i.m2.reserveTag(589103639),-2130957532)}}(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return function(e,t){return(0,h.__assign)((0,h.__assign)({},e),{modelCapabilities:(0,h.__assign)((0,h.__assign)({},e.modelCapabilities),{atMention:t.payload.capability})})}(e,t);case"SAVE_DRAFT":return function(e,t){var n,r=e.draftState.drafts;if(void 0===r[t.payload.draftId])return(0,d.i7)().assertConditionTag(!(0,_e.QZ)(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;var o=(0,h.__assign)((0,h.__assign)({},r),((n={})[t.payload.draftId]=(0,h.__assign)((0,h.__assign)({},r[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),n));return(0,h.__assign)((0,h.__assign)({},e),{draftState:(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:o})})}(e,t);case"DRAFT_EMPTINESS_CHANGED":return function(e,t){var n,r=e.draftState.drafts;if(void 0===r[t.payload.draftId])return(0,d.i7)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var o=(0,h.__assign)((0,h.__assign)({},r),((n={})[t.payload.draftId]=(0,h.__assign)((0,h.__assign)({},r[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),n));return(0,h.__assign)((0,h.__assign)({},e),{draftState:(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:o})})}(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return function(e,t){var n=Se.at(e.draftState,(function(n){var r=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?r.renderContextType:t.payload.isClaimingLock&&r.renderContextType===Fe.A.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||r.renderContextType!==t.actionDetail.renderContextType?r.renderContextType:Fe.A.None}));return(0,h.__assign)((0,h.__assign)({},e),{draftState:n})}(e,t);case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=Se.at(e.draftState,(function(n){var r=e.draftState.drafts[n];return(0,Le.pZ)(r.renderContextType)?(0,yt.O)(t.payload.viewContainer.containerType):r.renderContextType}));return(0,h.__assign)((0,h.__assign)({},e),{draftState:n})}(e,t);case"DISPLAY_DRAFT_WARNING":return function(e,t){var n,r,o=Se.CR(e.draftState);if(void 0===o)return(0,d.i7)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var i=o.sessionConfiguration.draftId,a=e.draftState.drafts;if(!a[i])return(0,d.i7)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var s=a[i].draftWarningState,c=(0,h.__assign)((0,h.__assign)({},a[i]),{draftWarningState:{warningCounter:s?s.warningCounter+1:0,type:t.payload.draftWarningType}}),u=(0,h.__assign)((0,h.__assign)({},a),((n={})[i]=c,n)),l=v.S()&&((0,vt.kW)(c.commentDraft.sessionConfiguration)||(null===(r=e.selectedComment)||void 0===r?void 0:r.selectedCardId)!==c.threadId)?Se.a9(c):e.selectedComment,m=(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:u});return(0,h.__assign)((0,h.__assign)({},e),{draftState:m,selectedComment:l,expandedComments:Se.a3(e.expandedComments,l,m)})}(e,t);case"UPDATE_MODEL_STATE":return function(e,t){var n={atMention:t.payload.modelCapabilityFlags&Xe.AtMentionKnown?t.payload.modelCapabilityFlags&Xe.AtMentionEnabled?pt.z5.Enabled:pt.z5.Disabled:pt.z5.Unknown,newThread:!!(t.payload.modelCapabilityFlags&Xe.NewThread),resolve:!!(t.payload.modelCapabilityFlags&Xe.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&Xe.Virtualized),tasks:t.payload.modelCapabilityFlags&Xe.TasksKnown?t.payload.modelCapabilityFlags&Xe.TasksEnabled?Ct.u.Enabled:Ct.u.Disabled:Ct.u.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&Xe.PresentLinkToComment),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&Xe.UIAAnnotationPattern),ContentExtensionHostingDisabled:!!(t.payload.modelCapabilityFlags&Xe.ContentExtensionHostingDisabled)};return(0,h.__assign)((0,h.__assign)({},e),{modelCapabilities:n})}(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return function(e,t){var n,r=Se.CR(e.draftState);if(void 0===r)return(0,d.i7)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var o=r.sessionConfiguration;if((0,vt.kW)(o))return e;var i=e.draftState.drafts[o.draftId];if(!i)return(0,d.i7)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var a=i.currentMentionees,s={};for(var c in a)s[c]={mentionee:(0,h.__assign)({},a[c].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(c)};var u=i.selectedTaskAssignee;if(u){var l=(0,ie.u9)(u);s[l]&&s[l].stillInDraft||(u=void 0)}var m=(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:(0,h.__assign)((0,h.__assign)({},e.draftState.drafts),(n={},n[o.draftId]=(0,h.__assign)((0,h.__assign)({},e.draftState.drafts[o.draftId]),{currentMentionees:s,selectedTaskAssignee:u}),n))});return(0,h.__assign)((0,h.__assign)({},e),{draftState:m})}(e,t);case"ADD_TO_CURRENT_MENTIONEES":return function(e,t){var n,r,o=Se.CR(e.draftState);if(void 0===o)return(0,d.i7)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var i=o.sessionConfiguration;if((0,vt.kW)(i))return e;var a=e.draftState.drafts[i.draftId];if(!a)return(0,d.i7)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var s=a.currentMentionees,c=(0,ie.u9)(t.payload.mentionee);if(s&&s[c])return e;var u={};for(var l in s)u[l]={mentionee:(0,h.__assign)({},s[l].mentionee),stillInDraft:s[l].stillInDraft};u[c]={mentionee:(0,h.__assign)({},t.payload.mentionee),stillInDraft:!0};var m=void 0;e.draftState.drafts[i.draftId].selectedTaskAssignees&&(m=(0,h.__assign)({},e.draftState.drafts[i.draftId].selectedTaskAssignees),(0,ie.Kc)(m,((n={})[c]={mentionee:(0,h.__assign)({},t.payload.mentionee),stillInDraft:!0},n)));var f=(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:(0,h.__assign)((0,h.__assign)({},e.draftState.drafts),(r={},r[i.draftId]=(0,h.__assign)((0,h.__assign)({},e.draftState.drafts[i.draftId]),{currentMentionees:u,selectedTaskAssignees:m}),r))});return(0,h.__assign)((0,h.__assign)({},e),{draftState:f})}(e,t);case"TOGGLE_TASK_ASSIGNER_TYPE":return function(e){var t;if(!v.kG())return(0,d.i7)().assertConditionTag(!1,"toggleTaskAssigner should not be called unless CommentTasksWithMultiAssign is enabled.",529143576),e;var n=Se.rB(e.draftState);if(void 0===n)return(0,d.i7)().assertConditionTag(!1,"No draft available while initializing selected task assignees.",529143577),e;var r=n.commentDraft,o={};if(void 0===n.selectedTaskAssignees){if((0,vt.w1)(r.sessionConfiguration)){var i=e.tasks[r.sessionConfiguration.threadId];(0,d.i7)().assertConditionTag(!!i,"Task not found.",529143616),(0,ie.VS)(o,i.currentState.assignees)}void 0!==n.currentMentionees&&(0,ie.Kc)(o,n.currentMentionees)}else o=void 0;var a=r.sessionConfiguration.draftId,s=(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:(0,h.__assign)((0,h.__assign)({},e.draftState.drafts),(t={},t[a]=(0,h.__assign)((0,h.__assign)({},e.draftState.drafts[a]),{selectedTaskAssignees:o}),t))});return(0,h.__assign)((0,h.__assign)({},e),{draftState:s})}(e);case"UPDATE_SELECTED_TASK_ASSIGNEE":return function(e,t){var n;if(v.kG())return(0,d.i7)().assertConditionTag(!1,"Should not update selectedTaskAssignee if CommentTasksWithMultiAssign is on.",529096909),e;var r=Se.CR(e.draftState);if(void 0===r)return(0,d.i7)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var o=r.sessionConfiguration;if((0,vt.kW)(o))return e;var i=o.draftId,a=e.draftState.drafts;if(!a[i])return(0,d.i7)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var s=(0,h.__assign)((0,h.__assign)({},a),((n={})[i]=(0,h.__assign)((0,h.__assign)({},a[i]),{selectedTaskAssignee:t.payload.selectedAssignee}),n));return(0,h.__assign)((0,h.__assign)({},e),{draftState:(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:s})})}(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEES":return function(e,t){var n,r;if(!v.kG())return(0,d.i7)().assertConditionTag(!1,"Should not update selectedTaskAssignees if CommentTasksWithMultiAssign is off.",529096910),e;var o=Se.CR(e.draftState);if(void 0===o)return(0,d.i7)().assertConditionTag(!1,"Expected active draft to be present",529143574),e;var i=o.sessionConfiguration;if((0,vt.kW)(i))return e;var a=i.draftId,s=e.draftState.drafts;if(!s[a])return(0,d.i7)().assertConditionTag(!1,"Expected draft to be present on update selected task assignees",529143575),e;var c=null!==(r=s[a].selectedTaskAssignees)&&void 0!==r?r:{},u=(0,h.__assign)({},c);(0,ie.RF)(u,t.payload.selectedAssignee);var l=(0,h.__assign)((0,h.__assign)({},s),((n={})[a]=(0,h.__assign)((0,h.__assign)({},s[a]),{selectedTaskAssignees:u}),n));return(0,h.__assign)((0,h.__assign)({},e),{draftState:(0,h.__assign)((0,h.__assign)({},e.draftState),{drafts:l})})}(e,t);case"POPULATE_SMART_REPLY":return function(e,t){return(0,h.__assign)((0,h.__assign)({},e),{draftState:Se.uk(e.draftState,t.payload)})}(e,t);case"SHOW_POST_ERROR_STATE":return function(e,t){var n=(0,h.__assign)((0,h.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),r=(0,h.__assign)({},e.postViewState);return r[t.payload.commentId]=n,(0,h.__assign)((0,h.__assign)({},e),{postViewState:r})}(e,t);case"CLEAR_POST_ERROR_STATE":return function(e,t){var n=(0,h.__assign)((0,h.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),r=(0,h.__assign)({},e.postViewState);return r[t.payload.commentId]=n,(0,h.__assign)((0,h.__assign)({},e),{postViewState:r})}(e,t);case"UPDATE_DRAFT_THREAD":return function(e,t){var n;if(!e.createdCommentLie)return e;if(Se.tN(e.draftState)!==t.payload.draftId)return(0,d.i7)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;var r=(0,be.E)(e)?e.postData[t.payload.draftId]:e.createdCommentLie.newComment_deprecated;if((0,be.E)(e)&&!r)return(0,d.i7)().assertConditionTag(!1,"Did not find model for draft thread on update",527251201),e;var o=e.createdCommentLie,i={};if(void 0!==t.payload.insertIndex&&t.payload.insertIndex!==o.flatIndex&&(o=(0,h.__assign)((0,h.__assign)({},o),{flatIndex:t.payload.insertIndex}),(0,be.E)(e))){var a=Se.mi(e.commentThreadIds,e.cardPostIds,t.payload.draftId,o);i=(0,h.__assign)((0,h.__assign)({},i),{commentThreadIds:a})}if(void 0!==t.payload.anchorHintText&&t.payload.anchorHintText!==r.anchorHintText){var s=(0,h.__assign)((0,h.__assign)({},r),{anchorHintText:t.payload.anchorHintText});if((0,be.E)(e)){var c=(0,h.__assign)((0,h.__assign)({},e.postData),((n={})[t.payload.draftId]=s,n));i=(0,h.__assign)((0,h.__assign)({},i),{postData:c})}else o=(0,h.__assign)((0,h.__assign)({},o),{newComment_deprecated:s})}return(0,h.__assign)((0,h.__assign)((0,h.__assign)({},e),i),{createdCommentLie:o})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){var n=e.draftState,r=e.selectedComment,o=e.expandedComments;if(t.payload.visibilityState!==z.Y.Visible&&!v.W2()&&(n=Se.wx(n),e.selectedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0)){var i=Se.Zg(e.draftState);i&&(r=Se.NN(i),o=Se.a3(e.expandedComments,r,n))}return n=Se.at(n,(function(n){var r=e.draftState.drafts[n];return Se.Pi(r.renderContextType,t.payload.visibilityState)})),(0,h.__assign)((0,h.__assign)({},e),{selectedComment:r,expandedComments:o,draftState:n})}(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return function(e,t){return(0,h.__assign)((0,h.__assign)({},e),{suggestionsDetails:t.payload.details})}(e,t);default:return e}}(e,t);return function(e,t){var n,r,o=t,i="android"===(0,Me.u)(),a=null===(n=o.selectedComment)||void 0===n?void 0:n.selectedCardId,s=Se.tN(o.draftState);if((0,be.E)(o)){var d=i&&a&&!o.expandedComments.includes(a)?(0,h.__spreadArray)((0,h.__spreadArray)([],(0,h.__read)(o.expandedComments),!1),[a],!1):o.expandedComments,c=o.cardPostIds,u=o.postData,l=void 0;d.forEach((function(e){e!==s&&c[e]&&(l=Se.ah(c[e],null!=l?l:o.postViewState,u,o.localizationDetails))})),l&&(o=(0,h.__assign)((0,h.__assign)({},o),{postViewState:l}))}else{a&&a!==s&&(i?a!==(null===(r=e.selectedComment)||void 0===r?void 0:r.selectedCardId):o.expandedComments.includes(a)&&!e.expandedComments.includes(a))&&(m=Se.FE(a,o.postViewState,o.commentData,o.localizationDetails))&&(o=(0,h.__assign)((0,h.__assign)({},o),{postViewState:m}));var m,f=Se.tN(e.draftState);f&&f!==s&&(i||o.expandedComments.includes(f))&&(m=Se.FE(f,o.postViewState,o.commentData,o.localizationDetails))&&(o=(0,h.__assign)((0,h.__assign)({},o),{postViewState:m}))}return o}(e,n)}function rn(){(0,d.i7)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function on(e,t){switch(void 0===e&&(e={viewContainer:{closeView:rn,openView:rn,containerType:L.A.FullPane,moveFocusToCanvas_donotuse:rn},componentTree:new $t(Fe.A.FullPane,o.T),visibilityState:z.Y.Closed,initializationStatus:qt.A.NotInitialized,viewContainerDisplayConfiguration:void 0}),void 0===t&&(t=ve.EMPTY_ACTION),t.type){case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return(0,h.__assign)((0,h.__assign)({},e),{viewContainer:t.payload.viewContainer,componentTree:n?new $t((0,yt.O)(t.payload.viewContainer.containerType),e.componentTree.componentTreeId.contextIdentifier,e.componentTree):e.componentTree})}(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return function(e,t){return t.payload.displayConfiguration===e.viewContainerDisplayConfiguration?e:(0,h.__assign)((0,h.__assign)({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){return(0,h.__assign)((0,h.__assign)({},e),{initializationStatus:t.payload.visibilityState!==z.Y.Closed||v.Ff()?e.initializationStatus:qt.A.NotInitialized,visibilityState:t.payload.visibilityState})}(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return function(e,t){var n=(0,h.__assign)((0,h.__assign)({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return(0,h.__assign)((0,h.__assign)({},e),{viewContainer:n})}(e,t);case"BEGIN_VIEW_INIT":return function(e){return(0,h.__assign)((0,h.__assign)({},e),{initializationStatus:qt.A.Initializing})}(e);case"END_VIEW_INIT":return function(e){return(0,h.__assign)((0,h.__assign)({},e),{initializationStatus:qt.A.Initialized})}(e);default:return e}}var an=void 0,sn=!1;function dn(e,t){void 0===t&&(t=mt.j),an||(an=(0,dt.HY)({paneState:on,contentExtensions:Zt,commentState:nn,filterState:Jt}));var n=an(e,t);return sn&&(0,i.fH)("Comments Store: ACTION: ",t," STATE: ",n),n}var cn=n(15964),un=function(){return{threadIdRequests:new Map,sequenceId:0}};function ln(e){return e&&(e.loadState.state===Dt.m.Placeholder||e.loadState.state===Dt.m.NeedsReload)}var mn=n(36297),fn=n(55684),pn=function(e,t){return function(n){var r=function(e,t,n){return void 0===n&&(n=20),r=function(e){return function(t,n){var r,o,i=Ee.UU(e.getState());try{for(var a=(0,h.__values)(n),s=a.next();!s.done;s=a.next()){var d=s.value;ln(i[d])&&t.threadIdRequests.set(d,t.sequenceId++)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return t}}(e),o=function(e,t,n){return function(r){for(var o=Array.from(r.threadIdRequests.entries()).sort((function(e,t){var n=(0,h.__read)(e,2),r=(n[0],n[1]),o=(0,h.__read)(t,2);return o[0],r-o[1]})),a=[],s=Ee.UU(e.getState()),d=o.pop();d&&a.length<n;d=o.pop()){var c=(0,h.__read)(d,1)[0];r.threadIdRequests.delete(c),ln(s[c])&&a.push(c)}if(a.length&&e.dispatch((0,ve.dispatchLoadThreads)({renderContextType:Fe.A.None,telemetryVisitor:t,trackback:i.m2.reserveTag(594888212)},{threadIds:a})),r.threadIdRequests.size>0)return r}}(e,t,n),d=(a=un)(),c=function(){var e=o(d);e?(d=e,s=setTimeout(c,500)):(d=a(),s=void 0)},(u=function(e){d=r(d,e),s||(s=setTimeout(c,0)),s||(s=setTimeout(c,500))}).reset=function(){void 0!==s&&(clearTimeout(s),d=a(),s=void 0)},u;var r,o,a,s,d,c,u}(n,t);return function(t){return function(o){var a=n.getState();switch(o.type){case"COMMENT_CONTEXT_CHANGED":case"RELOAD_COMMENTS":r.reset();break;case"COMMIT_DRAFT":var s=fn.x(a),c=Ee.CR(a);if(void 0!==c){var u=c.commentDraft;if(o.payload.metadataUpdates&&o.payload.metadataUpdates.Task){var l=void 0;u.sessionConfiguration.sessionType!==cn.Jg&&u.sessionConfiguration.sessionType!==cn.N_&&(l=s[u.sessionConfiguration.threadId]&&s[u.sessionConfiguration.threadId].id),o.payload.metadataUpdates.Task.taskId=l,u.updateProperties("Task",o.payload.metadataUpdates.Task)}o.payload.data.temporaryCommentId=u.commit(o.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":return Ee.YE(a).virtualized?void r(o.payload.threadIds):void(0,d.i7)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case"DISPATCH_LOAD_THREADS":if(!Ee.YE(a).virtualized)return;e.loadThreads(o.payload.threadIds);break;case"HIGHLIGHT_COMMENT":o.payload.actionSource===ye.A.SharedComments&&e.highlightComment(o.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":var m=Ee.XU(a);if((0,_e.mw)(m))return;e.deleteComment(o.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":v.$H()?e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then((function(e){var t=fn.x(a)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()})).catch((0,E.L)(i.m2.reserveTag(593768922))):e.setThreadResolvedState(o.payload.commentId,!0);break;case"REQUEST_REOPEN_THREAD":v.$H()?e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then((function(e){var t=fn.x(a)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()})).catch((0,E.L)(i.m2.reserveTag(593768924))):e.setThreadResolvedState(o.payload.commentId,!1);break;case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":e.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":e.selectLastThreadInPreviousCommentContext();break;case"PRESENT_LINK_TO_COMMENT":e.presentLinkToComment(o.payload.commentId)}var f=t(o),p=n.getState(),g=Ee.$6(a),C=Ee.$6(p),h=void 0;switch("LOAD_COMMENT"===o.type||"VIRTUALIZE_COMMENTS"===o.type||"SELECT_COMMENT"===o.type&&o.payload.source!==ye.A.SharedComments||!C||C.selectedCardId===(null==g?void 0:g.selectedCardId)||C.selectedCardId===(0,D.M3)()||(h=C.selectedCardId),o.type){case"CLEAR_COMMENT_HIGHLIGHT":o.payload.actionSource===ye.A.SharedComments&&void 0!==a.commentState.highlightedCommentId&&void 0===p.commentState.highlightedCommentId&&e.highlightComment("");break;case"DISPLAY_DRAFT_WARNING":if(v.dh()&&!mn.yl(n.getState())){var y=Ee.CR(p);y&&(h=y.threadId)}}return h&&e.selectComment(h),f}}}};function gn(e,t,n){var r=e.getState(),o=mn.v5(r)[l.G9.Isolated];return!!o&&(n(t),o.controller.triggerUpdate(),!0)}function Cn(e,t,n,r){return"CREATE"===r&&gn(e,t,n)}function hn(e,t){return 0===Ee.p3(t).lastContextChangeIncrement?l.OR.Disabled:e===l.G9.TaskPane||e===l.G9.TaskPaneItem?xe.Xy(t)?l.OR.Primary:l.OR.Disabled:Ee.Tw(t)?l.OR.Disabled:hn(l.G9.TaskPane,t)!==l.OR.Primary?l.OR.Primary:e===l.G9.Integrated?l.OR.Disabled:l.OR.Secondary}function vn(e,t){var n=mn.v5(e)[t];n&&(n.controller.priority=n.priority)}var yn=function(e){return function(t){return function(n){return function(r){var o,a,s;switch(r.type){case"ADD_CONTENT_EXTENSION":r.payload.extension.priority=hn(r.payload.extension.provider.scope.renderMode,t.getState());break;case"REMOVE_CONTENT_EXTENSION":try{for(var d=(0,h.__values)(r.payload.renderModes),c=d.next();!c.done;c=d.next()){var u=c.value,m=mn.v5(t.getState())[u];m&&m.controller.unregisterExtension()}}catch(e){o={error:e}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}break;case"UPDATE_EXTENSION_PRIORITY":n(r),vn(t.getState(),l.G9.TaskPane),vn(t.getState(),l.G9.TaskPaneItem),vn(t.getState(),l.G9.Integrated),vn(t.getState(),l.G9.Isolated);break;case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(gn(t,r,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":return n(r),void t.dispatch((0,ve.updateExtensionPriority)({renderContextType:Fe.A.None,telemetryVisitor:e,trackback:i.m2.reserveTag(594834319)},(s={},s[l.G9.TaskPane]=hn(l.G9.TaskPane,t.getState()),s[l.G9.TaskPaneItem]=hn(l.G9.TaskPaneItem,t.getState()),s[l.G9.Integrated]=hn(l.G9.Integrated,t.getState()),s[l.G9.Isolated]=hn(l.G9.Isolated,t.getState()),s)));case"BEGIN_DRAFTING_SUCCESS":if(Cn(t,r,n,r.payload.draftDetails.sessionConfiguration.sessionType))return;break;case"BEGIN_DRAFTING_FAILURE":if(Cn(t,r,n,r.payload.beginDraftingParams.sessionType))return;break;case"UPDATE_DRAFT_RENDER_CONTEXT":if(r.payload.isClaimingLock||r.actionDetail.renderContextType===Fe.A.DiscreteIsolated)break;var f=Ee.CR(t.getState());if(f&&Cn(t,r,n,f.commentDraft.sessionConfiguration.sessionType))return}return n(r)}}}},Tn=function(e){return function(t){return function(n){return function(r){var o;if(!e||!mn.yl(t.getState()))return n(r);var i=t.getState(),a=n(r),s=t.getState();switch(r.type){case"DISPLAY_DRAFT_WARNING":var d=Ee.$6(i),c=Ee.$6(s),u=!c||c.selectedCardId===(null==d?void 0:d.selectedCardId);if(v.dh()&&u){var m=Ee.CR(s);m&&e.bringContentIntoView({contentIdentifier:{contentId:m.threadId,contentType:l.cM.CommentThread}})}break;case"SELECT_COMMENT":var f=Ee.$6(s);r.payload.source===ye.A.SharedComments&&r.payload.selectType!==ve.SelectActionType.Polite&&(0,Le.pZ)(r.actionDetail.renderContextType)&&f&&e.bringContentIntoView({contentIdentifier:{contentId:f.selectedCardId,contentType:l.cM.CommentThread}});break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(xe.Xy(s))break;var p=Ee.CR(s),g=p&&p.isInCurrentContext&&(null===(o=Ee.$6(s))||void 0===o?void 0:o.selectedCardId)===p.threadId?p.threadId:void 0;g&&e.bringContentIntoView({contentIdentifier:{contentId:g,contentType:l.cM.CommentThread}});break;case"SELECT_CONTENT":e.selectNextOrPreviousContent(r.payload);break;case"MOVE_FOCUS_TO_CANVAS":e.moveFocus({region:w.SM.Canvas,resource:r.payload.resource})}return a}}}},In=n(78143),Sn=function(e){return function(t){return function(n){return function(r){var o=t.getState().commentState.draftState.drafts;n(r);var i=t.getState().commentState.draftState.drafts;if(Object.keys(o).forEach((function(t){if(void 0===i[t]){var n=(0,d.i7)().createActivityObject("EndDraftingCalledOnAction",e,(0,d.Zx)());n.addDataField("ActionName",r.type,d.LG.SystemMetadata),n.successTag(539313865),o[t].commentDraft.endDrafting()}})),(0,v.cg)()&&"SAVE_DRAFT"===r.type){var a=i[r.payload.draftId];a&&(0,In.v)().storeEditorContentFromDraftSave(r.payload,a.commentDraft.sessionConfiguration)}}}}},An=n(31236),_n=n(5627),Dn=n(17986),En=(0,d.Zx)();function Pn(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:"ApplyCommentChangesAction",activityConfig:(0,d.Ko)({aggregationMode:d.Ro.OnSuccess})};case"BEGIN_PROCESSING_COMMIT":return{name:"BeginProcessingCommitAction",activityConfig:En};case"CANCEL_COMMENT_CREATE_THREAD":return{name:"CancelCommentCreateThreadAction",activityConfig:En};case"CANCEL_COMMENT_POST_EDIT":return{name:"CancelCommentPostEditAction",activityConfig:En};case"CANCEL_COMMENT_REPLY":return{name:"CancelCommentReplyAction",activityConfig:En};case"COLLAPSE_CARD":return{name:"CollapseCardAction",activityConfig:En};case"COMMIT_DRAFT":return{name:"CommitDraftAction",activityConfig:En};case"DISPLAY_DRAFT_WARNING":return{name:"DisplayDraftWarningAction",activityConfig:En};case"RELOAD_COMMENTS":return{name:"ReloadCommentsAction",activityConfig:(0,d.Ko)({aggregationMode:d.Ro.OnSuccess})};case"REQUEST_DELETE_POST":return{name:"DeletePostAction",activityConfig:En};case"REQUEST_DELETE_THREAD":return{name:"DeleteThreadAction",activityConfig:En,logDocumentMetadata:d.$j.Basic};case"DISPATCH_LOAD_THREADS":return{name:"LoadThreadsAction",activityConfig:(0,d.Ko)({aggregationMode:d.Ro.OnSuccess})};case"REQUEST_REOPEN_THREAD":return{name:"ReopenThreadAction",activityConfig:En};case"REQUEST_THREAD_RESOLVE":return{name:"ResolveThreadAction",activityConfig:En,logDocumentMetadata:d.$j.Basic};case"SELECT_COMMENT":return{name:"SelectCommentAction",activityConfig:En};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:"SelectFirstThreadInNextCommentContextAction",activityConfig:En};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:"SelectLastThreadInPreviousCommentContextAction",activityConfig:En};case"SESSION_REQUEST_STARTED":return{name:"SessionRequestStartedAndLockSelectionAction",activityConfig:En};case"SHOW_LOW_FIDELITY_WARNING":return{name:"ShowLowFidelityWarningAction",activityConfig:En};case"CLEAR_LOW_FIDELITY_WARNING":return{name:"ClearLowFidelityWarningAction",activityConfig:En};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:"UpdateDraftRenderContext",activityConfig:En};case"PRESENT_LINK_TO_COMMENT":return{name:"PresentLinkToCommentAction",activityConfig:En};default:return}}var xn,bn=function(){return function(e){return function(t){try{return e(t)}catch(e){if(void 0===Pn(t)){var n=(0,d.i7)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,(0,d.Zx)());n.addDataField("OperationType",t.type,d.LG.SystemMetadata),n.addDataField("Trackback",t.actionDetail.trackback,d.LG.SystemMetadata),n.failTag(593278723,(0,An.E)(e))}!function(e){if((0,_n.G)(e))throw e;if(!(0,B.Ir)(e))throw(0,d.i7)().assertConditionTag(!1,"Unknown error encountered, rethrowing: ".concat((0,i.M5)(e)),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:(0,d.i7)().assertConditionTag(!1,"Unexpected error: Name: ".concat(e.name," errorCode: ").concat(e.errorCode," Tag: ").concat(e.tag," internalDetails: ").concat((0,i.M5)(e)),e.tag)}}(e)}}}},kn=n(91733);!function(e){e[e.None=1]="None",e[e.Error=2]="Error",e[e.RequestDefaultFilter_unused=3]="RequestDefaultFilter_unused",e[e.LoadDefaultFilter_unused=4]="LoadDefaultFilter_unused",e[e.LoadFilter=5]="LoadFilter",e[e.UpdateFilter=6]="UpdateFilter",e[e.LoadActiveFilter=7]="LoadActiveFilter"}(xn||(xn={}));var wn,Rn=function(e,t,n){if(e!==xn.None){var r=(0,d.i7)().createActivityObject("FilterPerfScenario",t,(0,d.Zx)());return r.addDataField("FilterScenario",e,d.LG.SystemMetadata),(0,Te.Yi)(n,r),r}},Fn=function(e){switch(e){case"LOAD_FILTER":return xn.LoadFilter;case"UPDATE_FILTER_RANGE":return xn.UpdateFilter;default:return xn.None}},Nn=!1,Mn=function(e,t){return function(n){var r=new Map;return function(o){return function(a){if(!Pe.L3(n.getState()))return o(a);var s,c=Rn(Fn(a.type),t,n.getState()),u=Pe.a7(n.getState());switch(a.type){case"LOAD_FILTER":s=Pe.DX(n.getState(),a.payload.filteredRange.id);break;case"UPDATE_FILTER_RANGE":s=Pe.DX(n.getState(),a.payload.filterId);break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":a.payload.filteringEnabled=!0}var l=o(a),m=function(e,r,o){var a=e;if(!a){(0,d.i7)().assertConditionTag(!1,"Activity should not be undefined",r);var s=Fn(o);a=Rn(s!==xn.None?s:xn.Error,t,n.getState())}return(0,i.hv)(a,"Perf activity not defined in error fallback case.",i.m2.reserveTag(520168332)),a};switch(a.type){case"LOAD_FILTER":!function(e,t,n,r,o,a,s,c){void 0===s&&Pe.DX(n.getState(),r.payload.filteredRange.id)&&(o.set(r.payload.filteredRange.id,{filter:r.payload.filteredRange,changeToken:r.payload.filteredRange.onRangeUpdated.subscribe((function(e){!function(e,t,n,r,o,a){o.get(n)?t(ve.updateFilterRange({renderContextType:r,telemetryVisitor:e,trackback:i.m2.reserveTag(528779331)},{filterId:n,changes:a.changes})):(0,d.i7)().assertConditionTag(!1,"How did we receive an update, when we aren't tracking a filter? Did you forget to teardown an old filter?",528779330)}(t,n.dispatch,r.payload.filteredRange.id,r.actionDetail.renderContextType,o,e)}))}),r.payload.shouldSetActive&&Pe.a7(n.getState())===r.payload.filteredRange.id&&(Pe.a7(n.getState())!==c&&e.setActiveFilteredRange(r.payload.filteredRange.id),c&&c!==Pe.a7(n.getState())&&n.dispatch(ve.updateFilterRange({renderContextType:r.actionDetail.renderContextType,telemetryVisitor:t,trackback:i.m2.reserveTag(528779332)},{filterId:c,changes:[{type:"Teardown",teardownReason:k.jL.RangeObsolete}]})))),a.successTag(i.m2.reserveTag(520198023))}(e,t,n,a,r,m(c,i.m2.reserveTag(520198025),a.type),s,u);break;case"UPDATE_FILTER_RANGE":!function(e,t,n,r,o,i,a,s){Pe.a7(n.getState())!==s&&e.setActiveFilteredRange(Pe.a7(n.getState()));var c=Pe.DX(n.getState(),r.payload.filterId);if(a&&c&&a.filter!==c.filter){var u=o.get(r.payload.filterId);u&&u.filter.canBeUpdated()?u.filter.updateFilter(c.filter)?i.successTag(520198022):((0,d.i7)().assertConditionTag(!1,"The filter should have been able to update",528527826),Ln(e,t,i,n,c.filter,!1,s===r.payload.filterId)):Ln(e,t,i,n,c.filter,!1,s===r.payload.filterId)}if(!Pe.DX(n.getState(),r.payload.filterId)){(0,d.i7)().assertConditionTag(r.payload.changes.findIndex((function(e){return"Teardown"===e.type}))>=0,"Range should not be removed unless there was a Teardown",528749966);var l=o.get(r.payload.filterId);l&&(l.filter.teardown(),l.changeToken.unsubscribe(),o.delete(r.payload.filterId))}i.isEnded()||i.successTag(520198021)}(e,t,n,a,r,m(c,i.m2.reserveTag(520198024),a.type),s,u)}return Pe.Wk(n.getState())&&On(e,t,n,a.type,m),l}}}},Ln=function(e,t,n,r,o,a,s){e.createFilteredRange({contentTypes:[l.cM.CommentThread],filters:o,supportsFilterUpdates:a}).then((function(e){r.dispatch(ve.loadFilter({renderContextType:Fe.A.None,telemetryVisitor:t,trackback:i.m2.reserveTag(528532107)},{filteredRange:e,shouldSetActive:s})),n.successTag(520198020)})).catch((function(e){n.failTag(i.m2.reserveTag(507597955),-2147467259),(0,E.L)(i.m2.reserveTag(507597956))(e)}))},On=function(e,t,n,r,o){if(!Nn){Nn=!0;var a=o(Rn(xn.LoadActiveFilter,t,n.getState()),i.m2.reserveTag(507794050),r);Bn(e,t,n,a).catch((function(e){(0,d.i7)().assertConditionTag(!1,"Failed to load active filter. Error: ".concat((0,i.M5)(e)),507794049),a.failTag(i.m2.reserveTag(507794048),-2147467259)})).finally((function(){Nn=!1}))}},Bn=function(e,t,n,r){return(0,h.__awaiter)(void 0,void 0,void 0,(function(){var o,a,s,d,c,u;return(0,h.__generator)(this,(function(l){switch(l.label){case 0:return null===(c=Pe.a7(n.getState()))||void 0===c?[3,1]:(a=c,[3,3]);case 1:return[4,e.getActiveFilteredRangeId()];case 2:a=l.sent(),l.label=3;case 3:return(o=a)?[4,e.getFilteredRange(o)]:[3,5];case 4:if(s=l.sent())return n.dispatch(ve.loadFilter({renderContextType:Fe.A.None,telemetryVisitor:t,trackback:i.m2.reserveTag(507794018)},{filteredRange:s,shouldSetActive:!0})),r.successTag(507597954),[2];l.label=5;case 5:return d=kn.y,!!(null===(u=Pe.L3(n.getState()))||void 0===u?void 0:u.supportsFilterByUser)&&(d=(0,h.__assign)((0,h.__assign)({},kn.y),{userFilter:[]})),Ln(e,t,r,n,d,!0,!0),[2]}}))}))},Vn=n(96138),Un=function(e){return function(t){return function(n){return function(r){var o,i,a=t.getState(),s=n(r),d=t.getState();switch(r.type){case"BEGIN_DRAFTING_SUCCESS":var c=Ee.XU(d),u=r.payload.draftDetails.sessionConfiguration.draftId;(l=c.drafts[u])&&e.setDeferredActiveEditorFocusCommand(u);break;case"DISPLAY_DRAFT_WARNING":if(r.payload.draftWarningType===Vn.u.CommitFailed)break;var l;c=Ee.XU(d),(l=(0,Se.CR)(c))&&e.setDeferredActiveEditorFocusCommand(l.sessionConfiguration.draftId)}return(null===(o=Ee.$6(d))||void 0===o?void 0:o.selectedCardId)===(null===(i=Ee.$6(a))||void 0===i?void 0:i.selectedCardId)&&Ee.XU(d)===Ee.XU(a)||e.clearPendingOnComponentFocusedRequest(),s}}}},Hn=n(89454),Gn=function(e){return function(t){return function(n){return function(r){switch(r.type){case"DISPLAY_DRAFT_WARNING":if(!v.dh())break;var o=Hn.bc(e,r.payload.draftWarningType),i=v.Vb()&&"win32"===(0,Me.u)()&&(r.payload.draftWarningType===Vn.u.GrantAccessFailedSilently||r.payload.draftWarningType===Vn.u.GrantAccessCanceled)&&(0,xe.vL)(t.getState())===z.Y.Visible;(0,j.gL)(r.payload.draftWarningType===Vn.u.ReturnToDraft?e.formatString(230,o):o,i?{nativeId:(0,Ue.ny)(He.I5.PaneRoot)}:void 0)}return n(r)}}}},zn=n(10717),qn=n(65030);function Wn(e){e.timerHandle&&clearTimeout(e.timerHandle)}!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(wn||(wn={}));var Yn=function(){function e(e){var t=this;this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=function(e,n,r){var o=t.performanceActivities[e];o&&(o.activity.failTag(n,null!=r?r:-2130957541),Wn(o),delete t.performanceActivities[e])},this.timeoutTracker=function(e,n,r){var o=t.performanceActivities[e];o&&(Wn(o),o.activity.addDataField("Timeout",!0,d.LG.SystemMetadata),n.failOnTimeout?o.activity.failTag(r,-2130957491):o.activity.successTag(r),delete t.performanceActivities[e])}}return e.prototype.beginTracking=function(e,t,n,r,o){var a=this;void 0===o&&(o={timeout:5e3,failOnTimeout:!0});var s=r||(0,d.i7)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,(0,d.Zx)());s.addDataField("OperationType",n,d.LG.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&((0,d.i7)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,i.m2.reserveTag(595907678)));var c={activity:s,expectedChangeType:t};c.timerHandle=setTimeout((function(){return a.timeoutTracker(e,o,i.m2.reserveTag(575484417))}),o.timeout),this.performanceActivities[e]=c},e.prototype.updateTrackerId=function(e,t){if(e!==t){this.performanceActivities.hasOwnProperty(t)&&((0,d.i7)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,i.m2.reserveTag(595132705)));var n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}},e.prototype.failAllTrackers=function(e,t){var n=this;Object.keys(this.performanceActivities).forEach((function(r){var o=n.performanceActivities[r];Wn(o),o.activity.failTag(e,null!=t?t:-2130957541)})),this.performanceActivities={}},e.prototype.endTracker=function(e,t,n){var r=this.performanceActivities[e];r&&(Wn(r),r.activity.addDataField("ExpectedChangeArrived",r.expectedChangeType===t?wn.Yes:wn.No,d.LG.SystemMetadata),r.activity.successTag(n),delete this.performanceActivities[e])},e.prototype.endAllTrackers=function(e){for(var t in this.performanceActivities){var n=this.performanceActivities[t];Wn(n),n.activity.addDataField("ExpectedChangeArrived",wn.Unknown,d.LG.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}},e.prototype.getTracker=function(e,t){var n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n},e}(),jn=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(e){var t=(0,De.Gl)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",d.LG.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=(0,d.i7)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,(0,d.Zx)()),this.selectedCommentId=t)},e.prototype.endTrackingIfWarningDismissed=function(e,t){var n=(0,De.Gl)(t);!this.activity||n===this.selectedCommentId&&(0,De.Uo)(t)||(this.activity.addDataField("OperationType",e.type,d.LG.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function Xn(e,t){t?e.addDataField("AffectingTaskMetadata",!0,d.LG.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,d.LG.SystemMetadata)}function Kn(e,t,n,r){var o=(0,be.YO)(t,r);if(o){var i,a=(0,pt.a9)(o);(i=(0,be._A)(t)?n[a].some((function(e){return 0!=(t[e].commentFlags&pt.PJ.IsNew)})):t.some((function(e){return(e.commentId===a||e.parentId===a)&&0!=(e.commentFlags&pt.PJ.IsNew)})))&&e.addDataField("HasNewComment",i,d.LG.SystemMetadata)}}var $n=function(e){var t=new Yn(e),n=new jn(e),r="LoadCommentTracker",o=(0,zn.O)((function(e){(0,d.i7)().createActivityObject("PostButtonTeachingCallout",e.actionDetail.telemetryVisitor,(0,d.Zx)()).successTag(573687565)}));return function(e){return function(a){return function(s){var c,u,l=function(){var t,n,r,o,i,c,u=Pn(s);if(!u)return(0,d.i7)().assertConditionTag(!1,"Event name not defined for action type: ".concat(s.type),595616738),a(s);var l=(0,d.i7)().createActivityObject(u.name,s.actionDetail.telemetryVisitor,u.activityConfig);l.addDataField("Trackback",s.actionDetail.trackback,d.LG.SystemMetadata),l.addDataField("RenderContextType",s.actionDetail.renderContextType,d.LG.SystemMetadata),u.logDocumentMetadata&&l.addDocumentMetadata(u.logDocumentMetadata);var m=function(e,t,n){var r=(0,Se.uv)(e,n);r.valid&&(l.addDataField("MatchesCommentAuthor",r.matchesCurrentUser,d.LG.SystemMetadata),l.addDataField("ThreadCreationDeltaMs",r.timeElapsed,d.LG.SystemMetadata)),Kn(l,e,t,n)},f=e.getState(),p=fn.x(f);switch((0,Te.Yi)(f,l),s.type){case"COMMIT_DRAFT":var g=function(e){if("COMMIT_DRAFT"===e.type)return{name:"CommitDraft".concat((0,Dn.B)(e.payload),"Action"),activityConfig:En}}(s);if(!g)return(0,d.i7)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),a(s);var C=(0,d.i7)().createActivityObject(g.name,s.actionDetail.telemetryVisitor,(0,d.Zx)());C.addDataField("RenderContextType",s.actionDetail.renderContextType,d.LG.SystemMetadata),C.successTag(595903074);var h=ht.ce[s.payload.sessionType];l.addDataField("SessionType",h,d.LG.SystemMetadata),"REPLY"===s.payload.sessionType&&Kn(l,Ee.CA(f),Ee.Xg(f),s.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":l.addDataField("DraftWarningType",s.payload.draftWarningType,d.LG.SystemMetadata),l.addDataField("DraftWarningReason",s.payload.draftWarningReason,d.LG.SystemMetadata);var v=(0,Se.rB)(f.commentState.draftState);v&&l.addDataField("IsDraftInCurrentContext",v.isInCurrentContext,d.LG.SystemMetadata);break;case"UPDATE_DRAFT_RENDER_CONTEXT":l.addDataField("IsClaimingDraftLock",s.payload.isClaimingLock,d.LG.SystemMetadata),l.addDataField("IsUpdatingAllDraftLocks",!s.payload.draftId,d.LG.SystemMetadata);break;case"SELECT_COMMENT":l.addDataField("SelectType",ve.SelectActionType[s.payload.selectType],d.LG.SystemMetadata),l.addDataField("ActionSource",ye.A[s.payload.source],d.LG.SystemMetadata);var y=Ee.$6(f),T=!(!y||y.selectedCardId!==s.payload.selectedCard);l.addDataField("IsCurrentCard",T,d.LG.SystemMetadata),T||Kn(l,Ee.CA(f),Ee.Xg(f),s.payload.selectedCard),(0,qn.jB)(s.payload.source)&&(0,qn.ey)(s.payload.selectType)&&(0,qn.uL)(l,(0,qn.ap)(Ee.UX(f,s.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":Xn(l,s.payload.isTask),m(Ee.CA(f),Ee.Xg(f),s.payload.commentId);var I=void 0;if(s.payload.isTask){I="REQUEST_THREAD_RESOLVE"===s.type?"ResolveThreadWithTask":"ReopenThreadWithTask",l.addDataField(I,!0,d.LG.SystemMetadata,d.th.Critical);var S=null===(r=null===(n=null===(t=p[s.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===r?void 0:r.time;l.addDataField("TaskCreationTimeDeltaMs",S?Date.now()-S.getTime():0,d.LG.SystemMetadata,d.th.Critical)}(0,qn.uL)(l,(0,qn.ap)(Ee.UX(f,s.payload.commentId)));break;case"REQUEST_DELETE_THREAD":Xn(l,s.payload.isTask),s.payload.isTask&&(l.addDataField("DeleteThreadWithTask",!0,d.LG.SystemMetadata,d.th.Critical),S=null===(c=null===(i=null===(o=p[s.payload.commentId])||void 0===o?void 0:o.history[0])||void 0===i?void 0:i.records[0])||void 0===c?void 0:c.time,l.addDataField("TaskCreationTimeDeltaMs",S?Date.now()-S.getTime():0,d.LG.SystemMetadata,d.th.Critical)),(0,qn.uL)(l,(0,qn.ap)(Ee.UX(f,s.payload.commentId))),m(Ee.CA(f),Ee.Xg(f),s.payload.commentId);break;case"REQUEST_DELETE_POST":m(Ee.CA(f),Ee.Xg(f),s.payload.commentId)}try{var A=e.getState(),_=a(s),D=e.getState(),E=Ee.XU(A),P=Ee.XU(D);if("UPDATE_DRAFT_RENDER_CONTEXT"===s.type){var x=s.payload.draftId?E.drafts[s.payload.draftId]:(0,Se.rB)(E),b=s.payload.draftId?P.drafts[s.payload.draftId]:(0,Se.rB)(P),k=void 0!==x&&void 0!==b&&x.renderContextType!==b.renderContextType;l.addDataField("DidDraftLockUpdate",k,d.LG.SystemMetadata)}return l.successTag(595616739),_}catch(e){throw l.failTag(595616768,(0,An.E)(e,-2130957541)),e}};switch(s.type){case"BEGIN_PROCESSING_COMMIT":var m=(0,d.i7)().createActivityObject(t.trackerActivityName,s.actionDetail.telemetryVisitor,(0,d.Zx)());try{l()}catch(e){throw m.failTag(595687567,(0,An.E)(e,-2130957541)),e}if(!(p=Ee.CR(e.getState()))){m.failTag(595687569,-2130957541);break}var f=p.commentDraft.sessionConfiguration;t.beginTracking(f.draftId,ht.og[f.sessionType],f.sessionType,m);break;case"COMMIT_FAILURE":var p=Ee.CR(e.getState());(0,d.i7)().assertConditionTag(!!p,"Draft should exist when failing a commit.",595132701),p&&t.failTracker(p.commentDraft.sessionConfiguration.draftId,i.m2.reserveTag(595132702)),a(s);break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":t.beginTracking(s.payload.commentId,gt.Ey.Modify,s.type);try{l()}catch(e){throw t.failTracker(s.payload.commentId,i.m2.reserveTag(595907670),(0,An.E)(e,-2130957541)),e}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":t.beginTracking(s.payload.commentId,gt.Ey.Delete,s.type);try{l()}catch(e){throw t.failTracker(s.payload.commentId,i.m2.reserveTag(595907671),(0,An.E)(e,-2130957541)),e}break;case"COMMENT_CONTEXT_CHANGED":try{a(s)}catch(e){throw t.failAllTrackers(i.m2.reserveTag(595731294),(0,An.E)(e,-2130957541)),e}break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":("LOAD_COMMENT"===s.type?s.payload.commentData:s.payload.threadInfo).length>0&&!t.getTracker(r,gt.Ey.Load)&&(m=(0,d.i7)().createActivityObject(t.trackerActivityName,s.actionDetail.telemetryVisitor,(0,d.Zx)()),t.beginTracking(r,gt.Ey.Load,s.type,m,{timeout:1e6,failOnTimeout:!1})),a(s);break;case"RELOAD_COMMENTS":try{l()}catch(e){throw t.failAllTrackers(i.m2.reserveTag(595907672),(0,An.E)(e,-2130957541)),e}t.endAllTrackers(i.m2.reserveTag(595907673));break;case"ON_INITIAL_RENDER":var g=t.getTracker(r,gt.Ey.Load);g&&(g.activity.addDataField("RenderContextType",s.payload.renderContextType,d.LG.SystemMetadata),t.endTracker(r,gt.Ey.Load,i.m2.reserveTag(595646476))),a(s);break;case"APPLY_COMMENT_CHANGES":try{l()}catch(e){throw t.failAllTrackers(i.m2.reserveTag(595907674),(0,An.E)(e,-2130957541)),e}try{for(var C=(0,h.__values)(s.payload.changes),v=C.next();!v.done;v=C.next()){var y=v.value;if(y.type===gt.Ey.Load||y.type===gt.Ey.Unknown)break;if(y.type!==gt.Ey.Delete&&y.type!==gt.Ey.Modify){if(y.type===gt.Ey.Insert){void 0!==y.tempId&&""===y.model.parentId&&(0,Pt._)(s.actionDetail.telemetryVisitor);var T=y.tempId||y.model.parentId;void 0!==T&&t.endTracker(T,y.type,i.m2.reserveTag(595857620))}}else t.endTracker(y.model.commentId,y.type,i.m2.reserveTag(595907675))}}catch(e){c={error:e}}finally{try{v&&!v.done&&(u=C.return)&&u.call(C)}finally{if(c)throw c.error}}break;case"COMMIT_DRAFT":if(p=Ee.CR(e.getState()),l(),s.payload.data.temporaryCommentId&&p){var I=void 0;switch((f=p.commentDraft.sessionConfiguration).sessionType){case"CREATE":!function(e){(0,Pt._)(e)}(s.actionDetail.telemetryVisitor),I=s.payload.data.temporaryCommentId;break;case"REPLY":I=s.payload.data.temporaryCommentId;break;case"EDIT":I=f.commentId;break;case"METADATA":I=f.threadId;break;default:(0,i.HB)(f)}I&&t.updateTrackerId(f.draftId,I)}break;case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":l();break;case"SHOW_LOW_FIDELITY_WARNING":l();var S=Ee.$6(e.getState());S&&n.beginTracking(S);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":var A="";switch(s.payload.visibilityState){case z.Y.Closed:A="ViewContainerClosed";break;case z.Y.Hidden:A="ViewContainerHidden";break;case z.Y.Visible:A="ViewContainerVisible";break;default:(0,i.HB)(s.payload.visibilityState)}var _=(0,d.i7)().createActivityObject(A,s.actionDetail.telemetryVisitor,(0,d.Ko)({aggregationMode:d.Ro.Always}));a(s),_.successTag(592241220);break;case"DRAFT_EMPTINESS_CHANGED":var D=Ee.XU(e.getState()).drafts[s.payload.draftId].commentDraft.sessionConfiguration.sessionType;D!==pt.Jg&&D!==pt.XM||o(s),a(s);break;default:a(s)}var E=Ee.$6(e.getState());E&&n.endTrackingIfWarningDismissed(s,E)}}}},Zn=n(15311),Jn=n(56288),Qn=n(60344),er=function(e,t){return function(e){return function(n){return function(r){switch(r.type){case"REQUEST_SHOW_PANE":(i=xe.zm(e.getState())).openView();break;case"REQUEST_CLOSE_PANE":(i=xe.zm(e.getState())).closeView();break;case"MOVE_FOCUS_TO_CANVAS":mn.yl(e.getState())||(i=xe.zm(e.getState())).moveFocusToCanvas_donotuse();break;case"REQUEST_MODAL_CONFIRMATION":(i=xe.zm(e.getState())).invokeModalConfirmationDialog?i.invokeModalConfirmationDialog(r.payload.onConfirm,r.payload.onCancel,r.payload.displayStrings):((0,d.i7)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),i.closeView());break;case"READY_TO_RENDER":(i=xe.zm(e.getState())).onReadyToRender&&i.onReadyToRender();break;case"RESOLVE_ATMENTION_CAPABILITY":if(v.u_()){var o=r.payload.capability===Zn.z.Enabled;t.initializeController(o)}break;case"BEGIN_DRAFTING_SUCCESS":var i=xe.zm(e.getState());(0,Jn.I)(i)&&"CREATE"===r.payload.draftDetails.sessionConfiguration.sessionType&&nr(e.dispatch,r.actionDetail,{displayMode:Ce.g1.Variable,desiredHeight:0}),tr(e.getState(),i);break;case"DISPLAY_DRAFT_WARNING":tr(e.getState());break;case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":if(r.payload.closeOnDiscard)return i=xe.zm(e.getState()),n(r),void i.closeView()}var a=e.getState(),s=n(r),c=e.getState();return function(e,t,n,r){var o=xe.zm(r);if((0,Jn.I)(o)){var i=Ee.XU(r),a=Ee.XU(n),s=(0,_e.QZ)(i),d=(0,_e.QZ)(a),c=!!(0,Se.tN)(i),u=!!(0,Se.tN)(a);if(s!==d||!(0,Jn.I)(xe.zm(n))||!c&&u){if(!s)return c?void nr(e,t,{displayMode:Ce.g1.Variable,desiredHeight:0}):void nr(e,t,{displayMode:Ce.g1.Normal});var l=Ee.$6(r);if(l&&l.selectedCardId===(0,Se.tN)(i))return;nr(e,t,{displayMode:Ce.g1.FullScreen})}}}(e.dispatch,r.actionDetail,a,c),s}}}};function tr(e,t){(function(e){var t=xe.vL(e);return v.Ff()&&(v.W2()?t===z.Y.Hidden:t!==z.Y.Visible)})(e)&&(t||xe.zm(e)).openView()}function nr(e,t,n){e((0,Qn.u)(t,n)).catch((0,E.L)(i.m2.reserveTag(578426776)))}var rr=n(20903),or=n(63243),ir=n(54724),ar=n(29698),sr=n(15918),dr=n(59575),cr=n(35175),ur=function(){function e(e,t,n){this.commentStore=e,this.commandFactory=new at(this.commentStore,t,n)}return e.prototype.selectNextOrPreviousThread=function(e,t,n){var r=v.W2()&&!xe.Xy(this.commentStore.getState()),o=xe.yg(this.commentStore.getState());return cr.g(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,n,r),o,this.commentStore,(function(){}))===Re.H.Handled},e.prototype.selectAcrossContexts=function(e,t){var n=xe.yg(this.commentStore.getState()),r=Ee.p3(this.commentStore.getState()),o=v.W2()&&!xe.Xy(this.commentStore.getState());cr.g(this.commandFactory.selectAcrossContexts(void 0,{direction:e,source:ye.A.SharedComments,expandCard:!0,iterableContentTypes:void 0},t,r.nextPopulatedContextDetails,o),n,this.commentStore,(function(){}))},e}(),lr=n(51852),mr=n(78887),fr={PostHeight:69,ExpandButtonHeight:26,ReplyDraftHeight:44,TaskTopper:29};function pr(e,t){var n=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return(0,h.__extends)(r,n),r.prototype.render=function(){var n=(0,h.__assign)((0,h.__assign)({},t),this.props);return A.createElement(e,n)},r}(A.PureComponent);return n}var gr=n(40402);function Cr(e,t){return function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return(0,h.__extends)(r,n),r.prototype.render=function(){return A.createElement(gr.Provider,{store:t},A.createElement(e,(0,h.__assign)({},this.props)))},r}(A.PureComponent)}var hr,vr=function(){function e(e){var t=this;this.internalHandler=e,this.eventQueue=[],this._isProcessingEvents=!1,this.handler=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isProcessingEvents?t.internalHandler.apply(t,(0,h.__spreadArray)([],(0,h.__read)(e),!1)):t.eventQueue.push(e)}}return Object.defineProperty(e.prototype,"isProcessingEvents",{get:function(){return this._isProcessingEvents},enumerable:!1,configurable:!0}),e.prototype.pauseProcessing=function(){this._isProcessingEvents=!1},e.prototype.startProcessing=function(){var e,t;if(!this._isProcessingEvents){this._isProcessingEvents=!0;try{for(var n=(0,h.__values)(this.eventQueue),r=n.next();!r.done;r=n.next()){var o=r.value;this.handler.apply(this,(0,h.__spreadArray)([],(0,h.__read)(o),!1))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.eventQueue=[]}},e}(),yr=n(18717);!function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(hr||(hr={}));var Tr,Ir=n(63108),Sr=n(12862),Ar=n(41566),_r=n(80611),Dr=n(17864),Er=(i.m2.reserveTag(595723983),i.m2.reserveTag(595723984),i.m2.reserveTag(574456150)),Pr=i.m2.reserveTag(574456151),xr=i.m2.reserveTag(574456152),br=i.m2.reserveTag(574456153),kr=n(54948),wr=function(){function e(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}(),Rr=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(e){this.mockContents=e},e.prototype.getId=function(){return this.mockId},e}();!function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}(Tr||(Tr={}));var Fr=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getId=function(){return this.mockId},e}(),Nr=function(){function e(e,t){var n=this;this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=Tr.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=function(e){return xe.Xy(e)?xe.yg(e):n.viewManager.getComponentTreeForRenderMode(l.G9.Integrated)},this.makeGetRenderableItemThreads=function(e){return(0,yr.Mz)([Ee.XU,Ee.iM,Ee.UU,e,n.getActiveComponentTree],(function(e,t,n,r,o){return tt.As(r,n,t,o.componentTreeId.renderContextType!==Fe.A.HalfPane,(0,_r.Q)(e,o.componentTreeId.renderContextType))}))},this.getCompleteHostableCommentCardRendererOwnProps=function(e){return(0,h.__assign)((0,h.__assign)({},n.viewManager.getHostableCommentCardRendererProps(l.G9.Integrated)),{resource:{id:e},componentInstanceId:(0,a.g)()})},this.getCompletePaneOwnProps=function(){return(0,h.__assign)((0,h.__assign)({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(e){var t=n.commentStore.getState(),r=n.commentStore.dispatch;return xe.Xy(t)?(0,Ir.DI)(r,n.getCompletePaneOwnProps()):(0,Ir.XR)(r,n.getCompleteHostableCommentCardRendererOwnProps(e))},this.getNewThreadDraftId=function(){return(0,Se.tN)(Ee.XU(n.commentStore.getState()),!0)},this.getParentId=function(e){var t=n.commentStore.getState(),o=Ee.CA(t),i=(0,be.YO)(o,e);return i?(0,r.a9)(i):void 0},this.invokeModalDialog=function(e,t,r){var o=n.commentStore.getState(),a={renderContextType:n.getActiveComponentTree(o).componentTreeId.renderContextType,trackback:i.m2.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},s=n.commentStore.dispatch,d=n.getCompletePaneOwnProps(),c=(0,Ir.DI)(s,d),u=Ee.$6(o);switch(e){case Sr.A.CancelNewDraft:case Sr.A.CancelReplyDraft:case Sr.A.CancelPostEdit:return c.discardDraftAsync(a,ye.A.SharedComments,!1);case Sr.A.DeleteThread:return u&&c.requestDeleteThread(a,u.selectedCardId),Promise.resolve(sr.y.Handled);case Sr.A.ClosePaneDraft:return Ar.jj({ownProps:d,dispatchProps:c,componentTree:n.getActiveComponentTree(o),draftState:Ee.XU(o),invokeModalDialog:n.invokeModalDialog}),Promise.resolve(sr.y.Handled);default:(0,i.HB)(e)}},this.updateEventProcessingState=function(e){var t=Ee.Tw(n.previousStoreState),r=Ee.Tw(e);!t&&r&&n.pauseProcessing(),t&&!r&&n.beginProcessing()},this.handleStoreUpdate=function(){var e=n.commentStore.getState(),t=Ee.XU(e),r=Ee.XU(n.previousStoreState);!(0,_e.mw)(t)&&n.pendingActionReason===Tr.NeedNotDrafting&&n.pendingAction&&((0,d.i7)().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent})).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Tr.None);var o=(0,_e.IE)(t),i=(0,_e.IE)(r);o&&!i&&n.pendingActionReason===Tr.NeedDrafting&&n.pendingAction&&((0,d.i7)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent})).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Tr.None),n.updateEventProcessingState(e),n.previousStoreState=e},this.onDrafting=function(e){var t=(0,d.i7)().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent}));(0,_e.IE)(Ee.XU(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!1,d.LG.SystemMetadata),e(),t.successTag(592269460)):(t.addDataField("ActionDeferred",!0,d.LG.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Tr.NeedDrafting,t.successTag(592269461))},this.onNotDrafting=function(e){var t=(0,d.i7)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent}));(0,_e.mw)(Ee.XU(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!0,d.LG.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Tr.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,d.LG.SystemMetadata),e(),t.successTag(592269463))},this.runAction=function(e,t){switch(e){case Tr.NeedDrafting:return n.onDrafting(t);case Tr.NeedNotDrafting:return n.onNotDrafting(t);case Tr.None:return t()}},this.onMockUIAction=new vr((function(e){var t=(0,d.i7)().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent}));t.addDataField("MockUIActionType",e.actionType,d.LG.SystemMetadata);try{switch(e.actionType){case hr.CreateThread:!function(e){return e.actionType===hr.CreateThread&&void 0!==e.content}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464):n.runAction(Tr.NeedDrafting,(function(){return n.onCreateOrReply(new wr(n.getNewThreadDraftId(),e.content))}));break;case hr.CancelCreateThread:!function(e){return e.actionType===hr.CancelCreateThread}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465):n.runAction(Tr.NeedDrafting,(function(){return n.onCancelCreateThread(new wr(n.getNewThreadDraftId()))}));break;case hr.StartReplySession:!function(e){return e.actionType===hr.StartReplySession&&void 0!==e.threadId}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466):n.runAction(Tr.NeedNotDrafting,(function(){return n.onStartReplySession(new wr(e.threadId))}));break;case hr.CancelReplySession:!function(e){return e.actionType===hr.CancelReplySession&&void 0!==e.threadId}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467):n.runAction(Tr.NeedDrafting,(function(){return n.onCancelReplySession(new wr(e.threadId))}));break;case hr.PostReply:!function(e){return e.actionType===hr.PostReply&&void 0!==e.threadId&&void 0!==e.content}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468):n.runAction(Tr.NeedDrafting,(function(){return n.onCreateOrReply(new wr(e.threadId,e.content))}));break;case hr.DeleteComment:!function(e){return e.actionType===hr.DeleteComment&&void 0!==e.commentId}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469):n.runAction(Tr.NeedNotDrafting,(function(){return n.onDeleteComment(e.commentId)}));break;case hr.DeleteThread:!function(e){return e.actionType===hr.DeleteThread&&void 0!==e.threadId}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470):n.runAction(Tr.NeedNotDrafting,(function(){return n.onDeleteThread(e.threadId)}));break;case hr.ResolveThread:!function(e){return e.actionType===hr.ResolveThread&&void 0!==e.threadId}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471):n.runAction(Tr.NeedNotDrafting,(function(){return n.onResolveThread(e.threadId)}));break;case hr.ReopenThread:!function(e){return e.actionType===hr.ReopenThread&&void 0!==e.threadId}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472):n.runAction(Tr.NeedNotDrafting,(function(){return n.onReopenThread(e.threadId)}));break;case hr.StartEditSession:!function(e){return e.actionType===hr.StartEditSession&&void 0!==e.commentId}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473):n.runAction(Tr.NeedNotDrafting,(function(){return n.onStartEditSession(e.commentId)}));break;case hr.CancelEditSession:!function(e){return e.actionType===hr.CancelEditSession&&void 0!==e.commentId}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474):n.runAction(Tr.NeedDrafting,(function(){return n.onCancelEditSession(new Rr(e.commentId))}));break;case hr.PostEdit:if(function(e){return e.actionType===hr.PostEdit&&void 0!==e.commentId&&void 0!==e.content}(e)){var r=new Rr(e.commentId);r.setContents(e.content),n.runAction(Tr.NeedDrafting,(function(){return n.onPostEdit(r)}))}else(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case hr.SelectComment:!function(e){return e.actionType===hr.SelectComment&&void 0!==e.commentId}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504):n.runAction(Tr.NeedNotDrafting,(function(){return n.onSelectComment(new Fr(e.commentId))}));break;case hr.ClosePane:n.onClosePane();break;case hr.ClickGhostCard:!function(e){return e.actionType===hr.ClickGhostCard}(e)?(0,d.i7)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505):n.runAction(Tr.NeedNotDrafting,(function(){return n.onGhostCommentClicked()}));break;default:(0,i.HB)(e.actionType)}}catch(e){return void t.failTag(592269507,(0,An.E)(e))}t.successTag(592269508)})),this.onStartEditSession=function(e){var t=n.commentStore.getState();Ar.ki({trackback:i.m2.reserveTag(592269509),id:e,data:n.getFilteredRenderableItems(t),selectedComment:Ee.$6(t),renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(e,t){var r=n.commentStore.getState();Ar.q$({componentTree:n.getActiveComponentTree(r),focusManager:n.viewManager.getFocusManager(),trackback:i.m2.reserveTag(592269510),id:e,renderContextType:n.getActiveComponentTree(r).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:t})},this.onClosePane=function(){var e=n.commentStore.getState();if(xe.JS(e)){var t=n.commentStore.dispatch;(0,Ir.DI)(t,n.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:Fe.A.None,trackback:i.m2.reserveTag(592269511)})}else(0,d.i7)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(e){var t=e.getId(),o=n.commentStore.getState(),a=Ee.XU(o),s=(0,Se.rB)(a),d=s&&"CREATE"===s.commentDraft.sessionConfiguration.sessionType?{type:"CREATE"}:{type:"REPLY",parentId:t};Ar.x1({trackback:i.m2.reserveTag(592269513),commentCardRef:e,draftState:a,areMentionsEnabled:Ee.YE(o).atMention===r.z5.Enabled,session:d,componentTree:n.getActiveComponentTree(o),dispatchProps:n.getDispatchProps(t),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:kr.A.Programmatic}).catch((0,E.L)(i.m2.reserveTag(592269514)))},this.onCancelCreateThread=function(e){var t=e.getId(),r=n.getDispatchProps(t),o=n.commentStore.getState(),a=Ee.$6(o),s=Ee.XU(o),d=xe.JS(o),c=n.getActiveComponentTree(o).componentTreeId.renderContextType,u=Ee.t3(o),l=(null==a?void 0:a.selectedCardId)===e.getId()&&(0,Dr.T)(d,c,s,a,u),m=tt.ae(n.getRenderableItemThreads(o),t);Ar.Vw({trackback:i.m2.reserveTag(592269516),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(o),dispatchProps:r,closeOnDiscard:l,cardId:t,draftState:s,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:m})},this.onGhostCommentClicked=function(){var e=n.commentStore.getState();xe.JS(e)||(0,d.i7)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(w.w.Next,n.getActiveComponentTree(e).componentTreeId.renderContextType)},this.onPostEdit=function(e){var t=n.commentStore.getState(),o=n.getParentId(e.getId());o&&Ar.Z$({trackback:i.m2.reserveTag(592269518),id:e.getId(),data:n.getFilteredRenderableItems(t),draftState:Ee.XU(t),contentPromise:e.getContentsAsync(),atMentionsEnabled:Ee.YE(t).atMention===r.z5.Enabled,componentTree:n.getActiveComponentTree(t),actionDispatchers:n.getDispatchProps(o),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:kr.A.Programmatic}).catch((0,E.L)(i.m2.reserveTag(592269519)))},this.onCancelEditSession=function(e){var t=n.commentStore.getState(),r=Ee.XU(t),o=Ee.$6(t),a=xe.JS(t),s=Ee.t3(t),d=(0,Dr.T)(a,n.getActiveComponentTree(t).componentTreeId.renderContextType,r,o,s),c=n.getFilteredRenderableItems(t),u=n.getParentId(e.getId());if(u){var l=n.getDispatchProps(u);Ar.Ed({trackback:i.m2.reserveTag(592269521),commentId:e.getId(),setContents:e.setContents.bind(e),data:c,draftState:r,shouldClosePaneAfterDiscardDraft:d,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,dispatchProps:l,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onCancelReplySession=function(e){var t=n.commentStore.getState(),r=Ee.$6(t),o=Ee.XU(t),a=e.getId(),s=n.getDispatchProps(a),d=xe.JS(t),c=n.getActiveComponentTree(t).componentTreeId.renderContextType,u=Ee.t3(n.commentStore.getState()),l=(null==r?void 0:r.selectedCardId)===e.getId()&&(0,Dr.T)(d,c,o,r,u);Ar.Vw({trackback:i.m2.reserveTag(592269522),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(t),dispatchProps:s,closeOnDiscard:l,cardId:e.getId(),draftState:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:-1})},this.onDeleteThread=function(e){var t=n.commentStore.getState(),r=Ee.$6(t),o=n.getDispatchProps(e);Ar.$x({trackback:i.m2.reserveTag(592269523),id:e,data:n.getFilteredRenderableItems(t),selectedComment:r,componentTree:n.getActiveComponentTree(t),invokeModalDialog:n.invokeModalDialog,dispatchProps:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isTask:!!fn.x(t)[e],threadIndex:tt.ae(n.getRenderableItemThreads(t),e),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(e){var t=n.commentStore.getState(),r=Ee.$6(t),o=n.getParentId(e);if(o){var a=n.getDispatchProps(o);Ar.DN({trackback:i.m2.reserveTag(592269524),id:e,data:n.getFilteredRenderableItems(t),selectedComment:r,renderContextType:n.getActiveComponentTree(t).componentTreeId.renderContextType,actionDispatchers:a,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onSelectComment=function(e){var t,r=n.commentStore.getState(),o=Ee.iM(r,!0),a=n.getNewThreadDraftId(),s=n.getFilteredRenderableItems(r),c=e.getId(),u=v.rR()||c!==a?s.find((function(e){return tt.OX(e)===c})):o&&{commentModel:o.newComment_deprecated};if(u&&(0,rt.d)(u)){var l=u,m=n.getDispatchProps(null!==(t=l.commentModel.parentId)&&void 0!==t?t:l.commentModel.commentId),f=Ee.$6(r),p=Ee.XU(r),g=n.getActiveComponentTree(r),C=(0,Ne.$)(tt.Ee(u),Ee.KU(r),g.componentTreeId.renderContextType);Ar.tt({trackback:i.m2.reserveTag(592269526),renderableItem:u,selectedComment:f,cardCollapsedState:C,dispatchProps:m,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:g,draftState_deprecated:p}).catch((0,E.L)(i.m2.reserveTag(590123734)))}else(0,d.i7)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525)},this.onStartReplySession=function(e){Ar.Xp({trackback:i.m2.reserveTag(592269527),threadId:e.getId(),renderContextType:n.getActiveComponentTree(n.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getFilteredRenderableItems=Ee.W3(),this.getRenderableItemThreads=this.makeGetRenderableItemThreads(this.getFilteredRenderableItems)}return e.prototype.initialize=function(){var e=(0,d.i7)().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent}));this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),e.successTag(xr)},e.prototype.teardown=function(){var e,t=(0,d.i7)().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent}));null===(e=this.registrationToken)||void 0===e||e.unsubscribe(),this.unsubscribeStoreListener(),t.successTag(br)},e.prototype.beginProcessing=function(){var e=this,t=(0,d.i7)().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent}));this.startProcessingActionsPending=setTimeout((function(){e.onMockUIAction.startProcessing(),e.startProcessingActionsPending=void 0,t.successTag(Er)}),100)},e.prototype.pauseProcessing=function(){var e=(0,d.i7)().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),(0,d.Ko)({diagnosticLevel:d.lT.FullEvent}));this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),e.successTag(Pr)},e.prototype.onReopenThread=function(e,t){Ar.n6({trackback:i.m2.reserveTag(592269528),id:e,renderContextType:this.getActiveComponentTree(this.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},e}(),Mr=n(29908),Lr=n(70055);function Or(e,t,n,r){return function(o){return(0,l.Ld)().registerExtension(t,n,r).then((function(t){return o((0,Lr.c)(e,t)),t}))}}var Br=n(41943),Vr=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);var r=this.hostableComponentRegistry.get(e);n?r.set(t,n):r.delete(t)},e.prototype.getComponent=function(e,t){var n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)},e}(),Ur=function(e){function t(t){var n=e.call(this,t)||this;return t.initializeImmediately&&n.beginInitialization(),n}return(0,h.__extends)(t,e),t}(function(){function e(e){var t=e.apiContext,n=e.viewProvider,r=e.commentAPI,o=e.peopleAPI,s=e.localizationAPI,c=e.themeAPI,u=e.focusManager,m=e.lppManager,f=e.initializationReason,p=e.commentStore,g=e.viewStrategyFactory,C=e.mockUIDriver,h=e.contentFilteredRangeAPI,v=e.contentNavigationAPI,y=this;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(e){y.commentStore.dispatch(ve.onInitialRender({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595646478),telemetryVisitor:y.telemetryVisitor},{commentId:e.commentId,renderContextType:e.renderContextType})),(0,Le.pZ)(e.renderContextType)&&y.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=(0,zn.O)((function(){F.sendCodeMarker({context:y.apiContext,type:b.DataReceived,assertTag:i.m2.reserveTag(595731293)})})),this.getComponentTree=function(e){switch(e){case Fe.A.None:(0,i.hv)(!1,"Unexpected render context type:".concat(e),i.m2.reserveTag(589088338));case Fe.A.FullPane:case Fe.A.HalfPane:return y.getComponentTreeForRenderMode(l.G9.TaskPaneItem);case Fe.A.DiscreteIntegrated:return y.getComponentTreeForRenderMode(l.G9.Integrated);case Fe.A.DiscreteIsolated:return y.getComponentTreeForRenderMode(l.G9.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:y.commentAPI,localizationAPI:y.localizationAPI,peopleAPI:y.peopleAPI,focusManager:y.focusManager,telemetryVisitor:y.telemetryVisitor,onInitialRender:y.onInitialRender,correlationId:y.correlationId,lppManager:y.lppManager}},this.setComponentRef=function(e,t,n){y.viewManagerRefRegistry.registerComponent(e,t,n)},this.onSuggestionsDetailsChange=function(e){y.commentStore.dispatch(ve.updateSuggestionsDetails({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(592492758),telemetryVisitor:y.telemetryVisitor},e))},this.internalInterruptableCommandHandler=function(e){return y.activeViewStrategy.handleCommentInterruptableCommand(e,y.commentStore.dispatch,y.commentStore.getState)},this.createOrUpdateFilter=function(e){var t=y.contentFilteredRangeAPI;if(t&&(0,Pe.L3)(y.commentStore.getState())){if(!Pe.Wk(y.commentStore.getState())){var n=(0,Te.JI)(y.commentStore.getState());n?y.updateFilter(n,e):((0,d.i7)().assertConditionTag(!1,"In the UI layer, we should already have an active filter to update",507794013),y.createFilter(t,e))}}else(0,d.i7)().assertConditionTag(!1,"Should not request new filter with gate off",528779338)},this.updateFilter=function(e,t){y.commentStore.dispatch(ve.updateFilterRange({renderContextType:Fe.A.FullPane,telemetryVisitor:y.telemetryVisitor,trackback:i.m2.reserveTag(528779344)},{filterId:e,changes:[{type:"FilterUpdate",updatedFilter:t}]}))},this.createFilter=function(e,t){e.createFilteredRange({contentTypes:[l.cM.CommentThread],filters:t,supportsFilterUpdates:!0}).then((function(e){y.commentStore.dispatch(ve.loadFilter({renderContextType:Fe.A.FullPane,telemetryVisitor:y.telemetryVisitor,trackback:i.m2.reserveTag(528779340)},{filteredRange:e,shouldSetActive:!0}))})).catch((0,E.L)(i.m2.reserveTag(528779341)))},this.apiContext=t,this.viewProvider=n,this.commentAPI=r,this.peopleAPI=o,this.localizationAPI=s,this.themeAPI=c,this.focusManager=u,this.contentFilteredRangeAPI=h,this.contentNavigationAPI=v,this.lastInitializationReason=f,this.viewStrategyFactory=g,this.mockUIDriver=C,this.telemetryVisitor=G.getTelemetryVisitor(this.apiContext),this.correlationId=G.getCorrelationId(this.apiContext)||(0,a.g)(),this.lppManager=m,this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new ur(p,this.telemetryVisitor,!!this.contentNavigationAPI);var T=p.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(T.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=p,this.discreteIntegratedComponentTree=new $t(Fe.A.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new $t(Fe.A.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new Vr,this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new Nr(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){var e,t;(0,this.commentStore.dispatch)((e={renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},t=this.commentAPI,function(n){var r=(0,d.i7)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,(0,d.Zx)());return t.checkAtMentionCapability().then((function(t){r.addDataField("AtMentionsEnabled",t,d.LG.SystemMetadata),r.successTag(595903522),n((0,Br.E)(e,t?pt.z5.Enabled:pt.z5.Disabled))}),(function(t){r.failTag(595903523,(0,An.E)(t,-2130957528)),n((0,Br.E)(e,pt.z5.Disabled))}))})).catch((0,E.L)(i.m2.reserveTag(595152915)))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var e,t,n,r,o=this;this.initialized||(this.contentNavigationAPI&&(this.commentStore.dispatch(ve.setContentNavigationEnablement({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(526405722),telemetryVisitor:this.telemetryVisitor},!0)),null===(e=this.contentFilteredRangeAPI)||void 0===e||e.getCapabilities().then((function(e){var t;o.commentStore.dispatch(ve.setFilteringCapabilities({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(537421135),telemetryVisitor:o.telemetryVisitor},{capabilities:e})),(null==e?void 0:e.supportsFilterByUser)&&(o.userFilterManager=null===(t=o.contentFilteredRangeAPI)||void 0===t?void 0:t.getUserFilterManager(),o.userFilterManager&&(o.userFilterManager.getFilterUsers().then((function(e){o.commentStore.dispatch(ve.setCollaborators({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(507347608),telemetryVisitor:o.telemetryVisitor},{collaborators:e}))})).catch((0,E.L)(i.m2.reserveTag(507347607))),o.userFilterManager.onUserFilterManagerEvent.subscribe((function(e){o.commentStore.dispatch(ve.updateCollaborators({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(507347606),telemetryVisitor:o.telemetryVisitor},{change:e.payload}))}))))})).catch((0,E.L)(i.m2.reserveTag(528779335))),null===(t=this.contentFilteredRangeAPI)||void 0===t||t.onActiveFilterUpdated.subscribe((function(e){o.commentStore.dispatch(ve.activeFilterUpdated({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(507536257),telemetryVisitor:o.telemetryVisitor},{newActiveFilterId:e.newActiveFilterId}))}))),this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),v.W2()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),this.peopleAPI.capabilities&rr.ak.GetSuggestionsDetails&&(this.commentStore.dispatch((n={renderContextType:Fe.A.None,trackback:i.m2.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},r=this.peopleAPI,function(e){if(!(r.capabilities&rr.ak.GetSuggestionsDetails))return Promise.resolve();var t=(0,d.i7)().createActivityObject("RefreshSuggestionsDetails",n.telemetryVisitor,(0,d.Ko)({aggregationMode:d.Ro.OnSuccess}));return r.getSuggestionsDetails?r.getSuggestionsDetails().then((function(r){t.successTag(592492760),e((0,Mr.r)(n,r))}),(function(e){t.failTag(592492761,-2130957495)})):(t.failTag(592492759,-2130957494),Promise.resolve())})).catch((0,E.L)(i.m2.reserveTag(592492754))),(0,d.i7)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(e){!this.initialLoadComplete&&e&&void 0===Ee.Tw(e)&&Ee.sO(e)&&this.onFirstLoadComplete()},e.prototype.observeStore=function(e){var t,n=this;return e.subscribe((function(){var r=e.getState(),o=Ee.Tw(r);o!==t&&(t=o,n.onChange(r))}))},e.prototype.onFirstLoadComplete=function(){var e=this;(0,d.i7)().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach((function(t){e.onCommentUIAction(t)})),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()},e.prototype.registerActions=function(){this.commentAPI.registerForAction(ar.U.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(ar.U.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(ar.U.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(ar.U.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(ar.U.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(ar.U.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(e){switch(e){case l.G9.Integrated:return this.discreteIntegratedComponentTree;case l.G9.Isolated:return this.discreteIsolatedComponentTree;case l.G9.TaskPane:case l.G9.TaskPaneItem:return xe.yg(this.getCommentStore().getState())}},e.prototype.getPaneOwnProps=function(){return(0,h.__assign)((0,h.__assign)({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId,createOrUpdateFilter:this.createOrUpdateFilter})},e.prototype.getHostableCommentCardRendererProps=function(e){var t=this;return(0,h.__assign)((0,h.__assign)({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:function(n,r){t.setComponentRef(e,n,r)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.registerCommentCardHostableComponent=function(e,t,n){var r=this,o=Cr(pr(n.HostableCommentCardRendererContainer,(0,h.__assign)({},this.getHostableCommentCardRendererProps(e))),this.commentStore),i=x(t,this.apiContext),a=(0,u.l9)().registerComponent(i,o);return a.onComponentCommand.subscribe((function(t){r.processHostableComponentCommand(t,e)})),{componentController:a,contextAwareName:i}},e.prototype.initializeContentExtensions=function(){var e=this;(0,Q.dq)("ExtensionAwareCommentPaneContainer").then((function(t){var n;if(void 0!==t){var r=Cr(pr(t.ExtensionAwareCommentPane,(0,h.__assign)((0,h.__assign)({},e.getPaneOwnProps()),{extensionRenderMode:l.G9.Integrated,themeAPI:e.themeAPI})),e.commentStore),o=x(P,e.apiContext);e.commentPaneComponentController=(0,u.l9)().registerComponent(o,r),v.IF()&&e.commentStore.dispatch(Or({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(573384478),telemetryVisitor:e.telemetryVisitor},l.cM.CommentThread,o,{renderMode:l.G9.TaskPane,priority:l.OR.Disabled,instanceId:e.apiContext,componentDimensions:void 0})).catch((0,E.L)(i.m2.reserveTag(573384479)))}(0,Q.dq)("HostableCommentCardRendererContainer").then((function(t){if(void 0!==(n=t)){var r=e.registerCommentCardHostableComponent(l.G9.Integrated,"DiscreteIntegratedCommentCard",n),o=r.componentController,a=r.contextAwareName;e.discreteIntegratedComponentController=o;var s=e.registerCommentCardHostableComponent(l.G9.Isolated,"DiscreteIsolatedCommentCard",n),d=s.componentController,c=s.contextAwareName;e.discreteIsolatedComponentController=d;var u=e.registerCommentCardHostableComponent(l.G9.TaskPaneItem,"TaskPaneItemCommentCard",n),m=u.componentController,f=u.contextAwareName;e.commentPaneItemComponentController=m,e.commentStore.dispatch(Or({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(574428426),telemetryVisitor:e.telemetryVisitor},l.cM.CommentThread,a,{renderMode:l.G9.Integrated,priority:l.OR.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch((0,E.L)(i.m2.reserveTag(595645980))),e.commentStore.dispatch(Or({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595616916),telemetryVisitor:e.telemetryVisitor},l.cM.CommentThread,c,{renderMode:l.G9.Isolated,priority:l.OR.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize(),isContentAvailable:function(t){var n=e.commentStore.getState(),r=(0,mr.pS)(t,Ee.$q(n),Ee.UU(n)),o=Ee.XU(n);return(0,mr.Xf)(t,(0,mr.BX)(t,Ee.CA(n),Ee.Xg(n),r,Ee.iM(n,!0),o.drafts[t],(0,Se.tN)(o)),o,Fe.A.DiscreteIsolated,(0,lr.D)(t,Fe.A.DiscreteIsolated,o))}})).catch((0,E.L)(i.m2.reserveTag(595645982))),e.commentStore.dispatch(Or({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(546174344),telemetryVisitor:e.telemetryVisitor},l.cM.CommentThread,f,{renderMode:l.G9.TaskPaneItem,priority:l.OR.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch((0,E.L)(i.m2.reserveTag(546174345)))}})).catch((0,E.L)(i.m2.reserveTag(595645984)))})).catch((0,E.L)(i.m2.reserveTag(595645986)))},e.prototype.getAverageCardSize=function(){return{width:259,height:(e={itemCount:3,readOnly:!1,isTask:!1},t=e.itemCount,n=e.readOnly,r=e.isTask,o=fr.PostHeight,t>1&&(o+=fr.PostHeight+0),t>2&&(o+=fr.ExpandButtonHeight+0),n||(o+=fr.ReplyDraftHeight+0),r&&(o+=fr.TaskTopper),o)};var e,t,n,r,o},e.prototype.processHostableComponentCommand=function(e,t){var n=this;switch(e.command){case"Focus":return void setTimeout((function(){var r;return null===(r=n.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===r?void 0:r.focus()}));case"UpdateComponentDataProps":break;default:return void(0,d.i7)().assertConditionTag(!1,"Unexpected command type",593786644)}},e.prototype.teardownContentExtensions=function(){var e,t,n,r,o=[l.G9.Integrated,l.G9.Isolated,l.G9.TaskPaneItem];v.IF()&&o.push(l.G9.TaskPane),this.commentStore.dispatch(ve.removeContentExtensions.apply(ve,(0,h.__spreadArray)([{renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor}],(0,h.__read)(o),!1))),null===(e=this.commentPaneComponentController)||void 0===e||e.unregister(),null===(t=this.commentPaneItemComponentController)||void 0===t||t.unregister(),null===(n=this.discreteIntegratedComponentController)||void 0===n||n.unregister(),null===(r=this.discreteIsolatedComponentController)||void 0===r||r.unregister()},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(ar.U.AddComment),this.commentAPI.unregisterForAction(ar.U.NextThread),this.commentAPI.unregisterForAction(ar.U.PreviousThread),this.commentAPI.unregisterForAction(ar.U.DeleteThread),this.commentAPI.unregisterForAction(ar.U.BackKeyPressed),this.commentAPI.unregisterForAction(ar.U.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&rr.ak.GetSuggestionsDetails&&((0,d.i7)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),v.W2()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(e){this.commentUIActionListeners.push(e)},e.prototype.unregisterComponentUIActionListener=function(e){var t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)},e.prototype.registerInterruptableCommandListener=function(e){this.commentInterruptableCommandListeners.push(e)},e.prototype.unregisterComponentInterruptableCommandListener=function(e){var t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)},e.prototype.onCommentUIAction=function(e){var t,n;if(v.W2()&&e.actionBehavior===or.N.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;try{for(var r=(0,h.__values)(this.commentUIActionListeners),o=r.next();!o.done;o=r.next()){var i=(0,o.value)(e);if(i!==dr.KD.NotHandled)return i===dr.KD.Success}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===dr.KD.Success},e.prototype.onCommentEventReceived=function(e,t){var n=(0,i.V6)(i.tj.Comments,ir.O[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null==n||n.end(),v.W2()&&!this.initialLoadComplete&&e===ir.O.CommentContextChanged&&Tt.Fz(t)&&0===t.numberOfComments&&this.onFirstLoadComplete()},e.prototype.onCommentInterruptableCommandReceived=function(e){var t=Promise.resolve(sr.y.Unhandled);return this.commentInterruptableCommandListeners.reduce((function(t,n){return t.then((function(t){return t!==sr.y.Unhandled?Promise.resolve(t):n(e)}))}),t)},e.prototype.onViewContainerEvent=function(e){var t=this,n=this.commentStore.dispatch;switch(e.eventType){case q.F.VisibilityChanged:return void n(ve.viewContainerVisibilityChanged({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case q.F.ViewContainerChanged:return n(ve.viewContainerChanged({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor));case q.F.FocusTriggered:return void(v.IF()?setTimeout((function(){t.focusManager.focusCommentPaneCommand(xe.yg(t.commentStore.getState()))})):this.focusManager.focusCommentPaneCommand(xe.yg(this.commentStore.getState())));case q.F.FoldableLayoutStateChanged:n(ve.viewContainerFoldableLayoutStateChanged({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}},e}()),Hr=function(){function e(e,t,n){}return e.prototype.getAccountID=function(){return""},e.prototype.getLPPController=function(){},e.prototype.ensureLPPController=function(){throw new Error("ensureLPPController not supported in Web")},e.prototype.initializeController=function(e){},e.prototype.isInitialized=function(){return!1},e.prototype.isOnline=function(){return!1},e.prototype.refreshLPPController=function(){},e}(),Gr=n(91953),zr=n(6759),qr=n(91256),Wr=n(67177),Yr=n(89181),jr=n(1534),Xr=n(1855),Kr=n(14503);function $r(e){return function(e){var t=v.W2()&&!xe.JS(e);return Ee.p3(e).nextPopulatedContextDetails!==Ze.d.NoComments||(0,Se.wS)(t?Ee.$q(e):Ee.F6(e),Ee.CA(e),t)}(e)&&Zr(Ee.XU(e))}function Zr(e){return v.dh()||!(0,_e.mw)(e)}var Jr=function(){function e(e,t,n,r,o){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=r,this.telemetryVisitor=o}return e.prototype.processCommentEvent=function(e,t,n,r){var o=this,a=r();switch(e){case ir.O.CommentContextChanged:if(!Tt.Fz(t))return void(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",595912090);t.rehydrationDrafts&&t.rehydrationDrafts.forEach((function(e){var r,a,s,c,u;n((r={renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595912089),telemetryVisitor:o.telemetryVisitor},a=e.draftId,s=t.contextDrafts,c=o.commentAPI,u=o.peopleAPI,function(e,t){var n=(0,In.v)().getItem(a);if(!n)return(0,d.i7)().assertConditionTag(!1,"no saved sessionStorage data for provided draft id",523510273),Promise.resolve(e(mt.j));var o,i=JSON.parse(n);if(void 0===(o=i).draftContent||void 0===o.draftContent.content||void 0===o.draftingParams||void 0===o.draftingParams.sessionType||void 0===o.draftingParams.draftId)return(0,d.i7)().assertConditionTag(!1,"sessionStorage information is the wrong format",523510274),Promise.resolve(e(mt.j));(0,In.v)().removeItem(a);var l={inCurrentContext:!!(null==s?void 0:s.some((function(e){return e.draftId===i.draftingParams.draftId}))),isDraftEmpty:""===i.draftContent.content};return e((0,qr.T)(r,c,i.draftingParams,!1,u,l)).then((function(){var n=Ee.CR(t());if(!n)return(0,d.i7)().assertConditionTag(!1,"no active draft to save to session",520136543),e(mt.j);var o={draftId:n.commentDraft.sessionConfiguration.draftId,draftContent:{editorContent:Promise.resolve(i.draftContent.content),editorCursorPosition:Promise.resolve(i.draftContent.cursorPosition)}};return e((0,jr.J)(r,o))}))})).catch((0,E.L)(i.m2.reserveTag(523362973)))})),n(ve.commentContextChanged({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(512361622),telemetryVisitor:this.telemetryVisitor},t));break;case ir.O.CommentsChanged:if(!Tt.tA(t))return void(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case ir.O.LoadComments:if(!Tt.B5(t))return void(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case ir.O.CommentSelected:if(!Tt.$G(t))return void(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId){var s=void 0;if(void 0!==Ee.UU(a)[t.commentId])s=(0,Xr.E)(t.commentId,ye.A.Canvas,{selectType:t.selectionReason&&"ContentNavigation"===t.selectionReason.type&&t.selectionReason.contentNavigationReason===w.G6.Keyboarding?ve.SelectActionType.SelectCard:ve.SelectActionType.ExpandCard});else{var c=(0,be.YO)(Ee.CA(a),t.commentId);if(void 0===c)return;s=(0,Xr.E)(c.parentId,ye.A.Canvas,{selectType:ve.SelectActionType.SelectPost,selectedPost:t.commentId})}n((0,Xr.S)(void 0,{renderContextType:Fe.A.None,trackback:i.m2.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},s,!1)).catch((0,E.L)(i.m2.reserveTag(579744150)))}else n(ve.clearCommentSelection({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));break;case ir.O.CommentContextReload:if(!Tt.iR(t))return void(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case ir.O.CommentHighlighted:if(!Tt.TI(t))return void(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(ve.highlightComment({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},t.commentId,ye.A.Canvas)):n(ve.clearCommentHighlight({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},ye.A.Canvas,void 0));break;case ir.O.NextPopulatedContextDetailsUpdated:if(!Tt.yx(t)||!t.contextDetails.nextPopulatedContextDetails)return void(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(ve.nextPopulatedContextDetailsUpdated({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case ir.O.ModelCapabilitiesChanged:Tt.yt(t)?n(ve.updateModelCapabilities({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags,t.richTextCapabilityFlags)):(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case ir.O.CommentError:if(!Tt.Yy(t))return void(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case ir.O.ReturnToDraftRequested:Tt.Rt(t)&&n(ve.displayDraftWarning({draftWarningType:Vn.u.ReturnToDraft,draftWarningReason:Kr.m.HostRequest},{renderContextType:Fe.A.None,trackback:i.m2.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break;case ir.O.UpdateDraftThread:Tt.ne(t)?n(ve.updateDraftThread({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},t)):(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;case ir.O.SmartReplyPopulated:if(!Tt.Uz(t))return void(0,d.i7)().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);n(ve.populateSmartReply({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},t));break;default:return void(0,d.i7)().assertConditionTag(!1,"Deprecated event detected.",595912132)}},e.prototype.processCommentUIAction=function(e,t,n,r){var o,a=this,s=n();switch(e.actionType){case ar.U.ShowHideCommentPane:return dr.fO(e.actionBehavior)?xe.JS(s)?dr.KD.Success:dr.KD.Fail:(dr.C$(e.actionBehavior)&&(xe.JS(s)?t(ve.requestClosePane({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):t(ve.requestShowPane({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),dr.KD.Success);case ar.U.AddComment:if(dr.Gp(e.actionBehavior)){if(o=Ee.XU(s),!v.dh()&&((0,_e.mw)(o)||o.committedLieId))return dr.KD.Fail}else if(dr.C$(e.actionBehavior)){var c={renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return t((0,qr.T)(c,this.commentAPI,{sessionType:"CREATE"},!(!r||!r.retainSelectionOnAddComment),this.peopleAPI)).catch((0,E.L)(i.m2.reserveTag(592314376))),dr.KD.Success}return dr.KD.Success;case ar.U.NextThread:if((0,d.i7)().assertConditionTag(!dr.fO(e.actionBehavior),"This action type does not support toggled status",595899713),dr.C$(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return a.selectionManager.selectNextOrPreviousThread({direction:w.w.Next,source:ye.A.SharedComments,expandCard:!0,iterableContentTypes:[l.cM.CommentThread]},w.G6.HostAction,Fe.A.None)}),t,v.S()?void 0:Kr.m.NextThread,i.m2.reserveTag(591729749));else if(dr.Gp(e.actionBehavior))return $r(s)?dr.KD.Success:dr.KD.Fail;return dr.KD.Success;case ar.U.PreviousThread:if((0,d.i7)().assertConditionTag(!dr.fO(e.actionBehavior),"This action type does not support toggled status",595899714),dr.C$(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return a.selectionManager.selectNextOrPreviousThread({direction:w.w.Previous,source:ye.A.SharedComments,expandCard:!0,iterableContentTypes:[l.cM.CommentThread]},w.G6.HostAction,Fe.A.None)}),t,v.S()?void 0:Kr.m.PreviousThread,i.m2.reserveTag(591729750));else if(dr.Gp(e.actionBehavior))return $r(s)?dr.KD.Success:dr.KD.Fail;return dr.KD.Success;case ar.U.DeleteThread:if((0,d.i7)().assertConditionTag(!dr.fO(e.actionBehavior),"This action type does not support toggled status",595899715),dr.Gp(e.actionBehavior)){if(!function(e){return!!e.selectedComment&&Zr(e.draftState)}(s.commentState))return dr.KD.Fail}else dr.C$(e.actionBehavior)&&this.handleActionOrReturnToDraft((function(){var e=Ee.$6(s);e&&t(ve.requestDeleteThread({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(591738706),telemetryVisitor:a.telemetryVisitor},e.selectedCardId))}),t,Kr.m.DeleteThread,i.m2.reserveTag(591729751));return dr.KD.Success}return dr.KD.NotHandled},e.prototype.beginDraftingHelper=function(e,t,n,o){return e((0,qr.T)({renderContextType:Fe.A.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,t,!1,this.peopleAPI)).catch((0,E.L)(o)).then((function(){return r.y0.Handled}))},e.prototype.handleCommentInterruptableCommand=function(e,t,n){switch(e.type){case"CreateComment":return this.beginDraftingHelper(t,{sessionType:"CREATE"},i.m2.reserveTag(574371082),i.m2.reserveTag(574371083));case"EditComment":var o,a=n(),s=Ee.$6(a);o=(0,tt.X9)((0,mr.Gd)(e.commentId,Ee.CA(a),Ee.Xg(a)),void 0);var c=(0,tt.eu)(o,e.commentId);return c?(0,Ar.SH)({comment:c,threads:o,selectedComment:s,warningType:De.xQ.Edit})?(t(ve.showLowFidelityWarning({renderContextType:Fe.A.None,telemetryVisitor:this.telemetryVisitor,trackback:i.m2.reserveTag(593000206)},e.commentId,De.xQ.Edit)),Promise.resolve(r.y0.Handled)):this.beginDraftingHelper(t,{sessionType:"EDIT",commentId:e.commentId},i.m2.reserveTag(593000207),i.m2.reserveTag(593000208)):((0,d.i7)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(r.y0.Handled));case"ReplyComment":return this.beginDraftingHelper(t,{sessionType:"REPLY",threadId:e.threadId},i.m2.reserveTag(593000209),i.m2.reserveTag(593000210));case"DiscardDraft":var u=n();if(e.mode===Gr.J.TryAutoDiscard)return t((0,Wr.u)({renderContextType:Fe.A.None,telemetryVisitor:this.telemetryVisitor,trackback:i.m2.reserveTag(575411521)},ye.A.Canvas)).then((function(e){return e.draftDiscardResult}));if(s=Ee.$6(u),e.mode===Gr.J.Dialog&&(0,Se.uQ)(Ee.XU(u))===zr.o.CannotAutoDiscard)return xe.Xy(u)?Promise.resolve(r.y0.Unhandled):Promise.resolve(r.y0.Canceled);var l=(0,Dr.T)(xe.vL(u)===z.Y.Visible,(0,yt.O)(xe.zm(u).containerType),Ee.XU(u),s,Ee.t3(u));return t((0,Yr.y)({renderContextType:Fe.A.None,telemetryVisitor:this.telemetryVisitor,trackback:i.m2.reserveTag(575411522)},ye.A.Canvas,l,void 0));default:return Promise.resolve(r.y0.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(e,t,n,o){t((0,Wr.u)({renderContextType:Fe.A.None,trackback:o,telemetryVisitor:this.telemetryVisitor},ye.A.SharedComments,n)).then((function(t){void 0!==n&&t.draftDiscardBehavior!==zr.o.NoDraft&&t.draftDiscardResult!==r.y0.Handled||e()})).catch((0,E.L)(i.m2.reserveTag(591738704)))},e}(),Qr=n(64160),eo=n(13266),to=n(3133),no=n(30387),ro=n(68583),oo=n(55721);function io(e,t,n,r){return function(o,a){var s=a();r&&o(r);var d=r?r.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&o((0,ro.K)({renderContextType:e,telemetryVisitor:d,trackback:i.m2.reserveTag(595953696)},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId){var c=Ee.$6(s);if(n.selectedCommentId)if(c&&c.selectedCardId===n.selectedCommentId)if((0,De.dF)(c.selectionDetails)){var u=c.selectionDetails.selectedPostId,l=a();(0,be.YO)(Ee.CA(l),u)?o((0,no.un)({renderContextType:e,telemetryVisitor:d,trackback:i.m2.reserveTag(595953698)},n.selectedCommentId,u,no.V9.SelectPost,ye.A.Canvas)):o((0,no.un)({renderContextType:e,telemetryVisitor:d,trackback:i.m2.reserveTag(595953699)},n.selectedCommentId,void 0,no.V9.ExpandCard,ye.A.Canvas))}else o((0,no.un)({renderContextType:e,telemetryVisitor:d,trackback:i.m2.reserveTag(595953697)},n.selectedCommentId,void 0,no.V9.SelectCard,ye.A.Canvas));else o((0,no.un)({renderContextType:e,telemetryVisitor:d,trackback:i.m2.reserveTag(595953728)},n.selectedCommentId,void 0,no.V9.ExpandCard,ye.A.Canvas));else if(c){var m=Ee.XU(s),f=m.cardIdToDraftIdMap[c.selectedCardId];f&&"CREATE"===m.drafts[f].commentDraft.sessionConfiguration.sessionType||o((0,eo.P)({renderContextType:e,telemetryVisitor:d,trackback:i.m2.reserveTag(595953729)}))}}void 0!==n.highlightedCommentId&&(n.highlightedCommentId?o((0,to.c)({renderContextType:e,telemetryVisitor:d,trackback:i.m2.reserveTag(595953730)},n.highlightedCommentId,ye.A.Canvas)):o((0,Qr.F)({renderContextType:e,telemetryVisitor:d,trackback:i.m2.reserveTag(578586722)},ye.A.Canvas,void 0)));var p=zt(n);p&&o((0,oo.i)({renderContextType:e,telemetryVisitor:d,trackback:i.m2.reserveTag(595953732)},p))}}}var ao=n(51346),so=n(7692),co=n(55499),uo=n(38761);function lo(e,t,n){return function(r){Tt.k4(t)?r((0,uo.K)((0,ao.A)(e,i.m2.reserveTag(595137280)),t.threads)):(v.pT()&&r((0,so.X)((0,ao.A)(e,i.m2.reserveTag(595137282)),t.comments,t.tasks,n)),r((0,co.s)((0,ao.A)(e,i.m2.reserveTag(595137283)),t.comments,t.tasks)))}}var mo=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,r){switch(e){case ir.O.CommentsChanged:Tt.tA(t)&&n(io(Fe.A.None,this.telemetryVisitor,t.contextDetails,(0,ve.applyCommentChanges)({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},t.changes)));break;case ir.O.LoadComments:Tt.B5(t)&&n(lo({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case ir.O.CommentContextReload:Tt.iR(t)&&n((o={renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},a=t,s=this.peopleAPI,c=this.telemetryVisitor,function(e,t){var n=[];(0,Tt.F0)(a)?((0,d.i7)().assertConditionTag(!t||Ee.YE(t()).virtualized,"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),n=It(a.commentIds,(function(){return t().commentState}))):n=a.comments;var r=(0,Tt.F0)(a)?[]:a.tasks;e(io(o.renderContextType,c,a.contextDetails,(0,ve.reloadComments)((0,ao.A)(o,i.m2.reserveTag(595953694)),{comments:n,tasks:r}))),v.pT()&&e((0,so.X)((0,ao.A)(o,i.m2.reserveTag(595932895)),n,r,s)).catch((0,E.L)(i.m2.reserveTag(595645974)))}))}var o,a,s,c;this.commonViewStrategy.processCommentEvent(e,t,n,r)},e.prototype.processCommentUIAction=function(e,t,n){if(e.actionType===r.Ue.AddComment&&e.actionBehavior!==r.Ng.CheckEnabled){var o=n();xe.JS(o)&&this.focusManager.onUserAction(o.paneState.componentTree,{userAction:$e.a.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(e,t,n)},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}(),fo=n(34067),po=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,r){switch(e){case ir.O.CommentsChanged:Tt.tA(t)&&n((o=t,a=this.telemetryVisitor,function(e,t){var n,r,s,c,u,l=t(),m=!1,f=o.contextDetails;if(""===(null==f?void 0:f.selectedCommentId)&&(f=(0,h.__assign)((0,h.__assign)({},f),{selectedCommentId:void 0})),e(io(Fe.A.None,a,f,(0,ve.applyCommentChanges)({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595953743),telemetryVisitor:a},o.changes))),!o.contextDetails||!o.contextDetails.selectedCommentId){var p=Ee.$6(l),g=p?p.selectedCardId:void 0,C=t(),v=Ee.$6(C);(0,d.i7)().assertConditionTag(!(0,Pe.L3)(l),"applyCommentChangesAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402329);var y=Ee.$q(l),T=Ee.$q(C);if(g){var I=g&&o.changes.some((function(e){return e.type===gt.Ey.Delete&&e.model.commentId===g}));if(I){var S=void 0;if((0,be.x2)(y)){var A=Ee.Xg(l),_=[],D=0;S=-1;for(var E=0;E<y.length;E++)_.push(D),D+=A[y[E]].length,y[E]===g&&(S=E);try{for(var P=(0,h.__values)(o.changes),x=P.next();!x.done;x=P.next())switch((F=x.value).type){case gt.Ey.Insert:var b=void 0;for(b=_.length-1;b>=0&&F.index<=_[b];b--)_[b]+=1;(0,Je.j)(F.model)&&(b<S&&++S,_.splice(b+1,0,F.index));break;case gt.Ey.Delete:var k=void 0;for(k=_.length-1;k>=0;k--){if(!(F.index<_[k])){F.index===_[k]&&(k<S&&--S,_.splice(k,1));break}_[k]-=1}break;case gt.Ey.Modify:case gt.Ey.Unknown:case gt.Ey.Load:break;default:(0,i.HB)(F)}}catch(e){n={error:e}}finally{try{x&&!x.done&&(r=P.return)&&r.call(P)}finally{if(n)throw n.error}}}else{S=y.findIndex((function(e){return e.commentId===g}));try{for(var w=(0,h.__values)(o.changes),R=w.next();!R.done;R=w.next()){var F;switch((F=R.value).type){case gt.Ey.Insert:F.index<=S&&++S;break;case gt.Ey.Delete:F.index<S&&--S;break;case gt.Ey.Modify:case gt.Ey.Unknown:case gt.Ey.Load:break;default:(0,i.HB)(F)}}}catch(e){s={error:e}}finally{try{R&&!R.done&&(c=w.return)&&c.call(w)}finally{if(s)throw s.error}}}if(v)throw new B.cP(ae.IT,i.m2.reserveTag(589103626),-2130957551);if(T.length){var N=S;N===T.length&&(N-=1);var M=(0,be.x2)(T)?T[N]:(0,Je.a)(T[N]);e((0,ve.selectComment)({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595953744),telemetryVisitor:a},M,void 0,no.V9.ExpandCard,ye.A.SharedComments)),m=!0}}}else!y.length&&T.length&&(e((0,ve.selectComment)({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595947723),telemetryVisitor:a},(0,be.x2)(T)?T[0]:T[0].commentId,void 0,no.V9.ExpandCard,ye.A.SharedComments)),m=!0);(0,d.i7)().assertConditionTag(m||0===T.length||""!==(null===(u=o.contextDetails)||void 0===u?void 0:u.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}));break;case ir.O.LoadComments:Tt.B5(t)&&(r().paneState.initializationStatus!==qt.A.Initialized&&this.lastInitializationReason===O.A.NewThread||!xe.JS(r())?n(lo({renderContextType:Fe.A.None,trackback:i.m2.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)):n(function(e,t,n,r){return function(o,a){o(lo({renderContextType:e,trackback:i.m2.reserveTag(595899530),telemetryVisitor:r},t,n));var s=a();(0,d.i7)().assertConditionTag(void 0===(0,Pe.L3)(s),"Half pane specific logic should not run with filtering enabled.",523866629);var c=Ee.YE(s).virtualized,u=Ee.$6(s),l=Ee.F6(s);!(0,Ie.B)(Ee.Tw(s),c,!!(0,Pe.L3)(a()))||!l.length||u&&(0,Te.HM)(s,u.selectedCardId)||o((0,ve.selectComment)({renderContextType:e,trackback:i.m2.reserveTag(595953680),telemetryVisitor:r},(0,be.x2)(l)?l[0]:l[0].commentId,void 0,no.V9.ExpandCard,ye.A.SharedComments))}}(Fe.A.HalfPane,t,this.peopleAPI,this.telemetryVisitor)));break;case ir.O.CommentContextReload:Tt.iR(t)&&n(function(e,t,n,r){return function(o,a){var s,c,u=a(),l=!1,m=[];(0,Tt.F0)(t)?((0,d.i7)().assertConditionTag(Ee.YE(u).virtualized,"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),m=It(t.commentIds)):m=t.comments;var f=t.contextDetails;""===(null==f?void 0:f.selectedCommentId)&&(f=(0,h.__assign)((0,h.__assign)({},f),{selectedCommentId:void 0}));var p=(0,Tt.F0)(t)?[]:t.tasks;o(io(e,r,f,(0,fo._)({renderContextType:e,telemetryVisitor:r,trackback:i.m2.reserveTag(595953677)},{comments:m,tasks:p}))),v.pT()&&o((0,so.X)({renderContextType:e,telemetryVisitor:r,trackback:i.m2.reserveTag(595162892)},m,p,n)).catch((0,E.L)(i.m2.reserveTag(595645962))),(0,d.i7)().assertConditionTag(!(0,Pe.L3)(u),"reloadCommentsAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402328);var g=null===(s=Ee.$6(u))||void 0===s?void 0:s.selectedCardId,C=Ee.$q(u),y=a(),T=Ee.$q(y);if(g){if(!Ee.$6(y)){var I=(0,be.x2)(C)?C.findIndex((function(e){return e===g})):C.findIndex((function(e){return e.commentId===g}));if(I<0)return;if(T.length){var S=I;S===T.length&&(S-=1);var A=(0,be.x2)(T)?T[S]:(0,Je.a)(T[S]);o((0,ve.selectComment)({renderContextType:e,telemetryVisitor:r,trackback:i.m2.reserveTag(595953678)},A,void 0,no.V9.ExpandCard,ye.A.SharedComments)),l=!0}}}else!C.length&&T.length&&(o((0,ve.selectComment)({renderContextType:e,telemetryVisitor:r,trackback:i.m2.reserveTag(595947722)},(0,be.x2)(T)?T[0]:T[0].commentId,void 0,no.V9.ExpandCard,ye.A.SharedComments)),l=!0);(0,d.i7)().assertConditionTag(l||0===T.length||""!==(null===(c=t.contextDetails)||void 0===c?void 0:c.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}(Fe.A.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}var o,a;this.commonViewStrategy.processCommentEvent(e,t,n,r)},e.prototype.processCommentUIAction=function(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}(),go=function(){function e(){}return e.prototype.createViewStrategy=function(e,t,n,r,o,i,a,s){var d=new Jr(t,n,r,o,s);switch(e.containerType){case L.P.HalfPane:return new po(d,n,a,s);case L.P.FullPane:return new mo(d,n,i,s)}},e}();function Co(e){if(void 0===e.hostCommentAPI)throw new B.cP("'hostCommentAPI' was not supplied",i.m2.reserveTag(589103634),-2130957511);if(void 0===e.peopleAPI)throw new B.cP("'peopleAPI' was not supplied",i.m2.reserveTag(589103635),-2130957511);if(void 0===e.viewContainerProvider)throw new B.cP("'viewContainerProvider' was not supplied",i.m2.reserveTag(589103636),-2130957511);var t=(0,w.cz)(e.apiContext)?(0,w._1)(e.apiContext):void 0,n=(0,k.Q8)(e.apiContext)?(0,k.E$)(e.apiContext):void 0,r=(0,f.Kp)(),o=e.themeAPI||new fe,a=new ue(e.hostCommentAPI),s=G.getTelemetryVisitor(e.apiContext),d=new st(r.getLocaleInfo().isRightToLeft,s),c=new Hr(e.peopleAPI,s,e.correlationId||"");v.u_()&&c.initializeController(!1);var u,l,m,p,g=function(e,t,n,r,o,i,a,s,d){var c=d?[Mn(d,r)]:[],u=(0,dt.Zz)(dt.Tw.apply(void 0,(0,h.__spreadArray)([lt,ut,ct.A,bn,$n(r),pn(e,r),Sn(r),Un(a),er(t,s),Gn(i),yn(r),Tn(o)],(0,h.__read)(c),!1))),l=(0,dt.y$)(dn,n,u);return a.initialize(l,!!o),l}(a,e.viewContainerProvider,(u=e.viewContainerProvider.getViewContainer(),l=e.paneVisible,m=r.getLocaleInfo(),p=e.apiContext,function(e,t,n,r){return{paneState:{viewContainer:e,componentTree:new $t((0,yt.O)(e.containerType),r),visibilityState:t?z.Y.Visible:z.Y.Closed,initializationStatus:qt.A.NotInitialized,viewContainerDisplayConfiguration:void 0},contentExtensions:{extensions:{},contentNavigationSupported:!1},commentState:Qt(n),filterState:{filteredRanges:{},filteringCapabilities:void 0,ensureActiveFilter:!1,collaborators:void 0}}}(u,l,m,p)),G.getTelemetryVisitor(e.apiContext),t,r,d,c,n);return new Ur({apiContext:e.apiContext,viewProvider:e.viewContainerProvider,commentAPI:a,peopleAPI:e.peopleAPI,localizationAPI:r,themeAPI:o,focusManager:d,lppManager:c,initializationReason:e.initializationReason,commentStore:g,viewStrategyFactory:new go,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver,contentNavigationAPI:t,contentFilteredRangeAPI:n})}function ho(e,t,n,r,u,m,h,y,T){try{try{if(re())return void(0,d.i7)().assertConditionTag(!1,"View manager singleton cannot be instantiated more than once!",595891844)}catch(e){if(!(0,B.Ir)(e))throw e}H=Co;var I=[];(0,s.Mh)()?I.push([!h,"App settings should not be passed in when feature gate API is already initialized. Please inspect feature gate initialization on host.",i.m2.reserveTag(527754333)]):(I.push([!!h,"Must initialize feature gate API but no appSettings passed to instantiate.",i.m2.reserveTag(527754332)]),(0,s.EV)({appSettings:null!=h?h:{},mapping:ee.i})),(0,d.i7)().hasBeenInitialized()?(0,d.i7)().assertConditionTag(!t,"Telemetry details should not be passed in if telemetry API is already initialized. Please inspect telemetry API initialization on host.",527754334):(0,d.Uy)(ne,t),I.forEach((function(e){(0,d.i7)().assertConditionTag(e[0],e[1],e[2])})),v.cY()||(0,d.i7)().assertConditionTag(!!h,"appSettings should not be undefined",595616278);var S=function(){var t=(0,f.gM)(u);(0,c.DU)(t.getLocaleInfo().isRightToLeft),(0,te.xL)();var i,s=(i=o.T,new Y(i,r));G.ensureViewManager({apiContext:o.T,displayMode:C.Pk.FullPane,foldableLayoutState:C.bb.Indeterminate,initializationReason:m||O.A.PaneOpen,correlationId:(0,a.g)(),viewContainerProvider:s,peopleAPI:n,hostCommentAPI:e,paneVisible:!1,initializeImmediately:!1}),(0,p.Eo)(y),T&&g.JD.setThemeAPI(T),$=document.createElement("div"),document.body.appendChild($),_.render(A.createElement(K,{ref:J}),$),(0,j.QF)({announceToScreenReader:function(e){Z&&null!=e&&Z.appendLiveRegionUpdate(e)}}),(0,l.Ld)().onExtensionFirstRequested.subscribe((function(e){e.contentType===l.cM.CommentThread&&e.instanceId===l.wn&&oe()}))};v.c5()?(0,Q.Nh)().then((function(){S()})).catch((function(e){return(0,E.L)(i.m2.reserveTag(526254819))(e)})):S()}catch(e){throw(0,E.L)(i.m2.reserveTag(594367139))(e),e}}Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return-1!==this.indexOf(e,void 0===t?0:t)}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(Element.prototype.matches.call(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var vo=n(19691),yo=n(31447),To=n(14878);class Io{getThemeMode(){return To.o3.getInstance().getThemeMode()}registerOnThemeChanged(e){To.o3.getInstance().registerOnThemeChanged(e)}convertColorForTheme(e,t){if(!this.getDarkModeColor)return e;if(t===To.bx.Dark){const t=this.getDarkModeColor(e);return this.darkToLightColorMap.set(t,e),t}var n;return null!==(n=this.darkToLightColorMap.get(e))&&void 0!==n?n:e}constructor(e){this.getDarkModeColor=e,this.darkToLightColorMap=new Map}}let So;function Ao(...e){ho(...e,yo.a,new Io(So))}function _o(e){So=e}},44923:function(e,t,n){"use strict";n.d(t,{G7:function(){return c},J9:function(){return d},Kf:function(){return p},SH:function(){return m},ZI:function(){return f},Zb:function(){return s},Zp:function(){return l},gI:function(){return u}});var r=n(38757);let o,i,a;function s(e){o=e;try{i=JSON.parse(l("DisabledChangeGates","{}"))}catch(e){i={}}}function d(e){a=e}function c(e,t=!1){return(a?a(e):!!o&&!!o[e]&&"true"===o[e].toLowerCase())||(0,r.iP)(e,t)}function u(e,t){return(0,r.Z8)(e,t)}function l(e,t){return o&&o[e]?o[e]:t}function m(e){const t=l(e,"[]");return JSON.parse(t)}function f(e,t){const n=l(e,"");return!(i&&t in i||n.split(",").some((e=>e===t)))}function p(e,t,n){const r=l(e,"");return!(i&&t in i||r.split(n).some((e=>e.trim()===t)))}},38757:function(e,t,n){"use strict";let r;n.d(t,{Z8:function(){return i},be:function(){return s},iP:function(){return a},jE:function(){return o}});const o=e=>{r=e},i=(e,t)=>r?r.getIntFeatureGate(e,t):t,a=(e,t=!1)=>r?r.getBooleanFeatureGate(e,t):t,s=(e,t)=>r?r.getStringFeatureGate(e,t):t},83778:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:0}),r.createElement("path",{className:"OfficeIconColors_m22",fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:1})])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},6442:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M9.75,2.25H9v8.63a1,1,0,0,1-.09.43,1.1,1.1,0,0,1-.6.6,1,1,0,0,1-.43.09h-6a1,1,0,0,1-.44-.09,1.1,1.1,0,0,1-.6-.6,1,1,0,0,1-.09-.43V2.25H0V1.5H3V.75A.68.68,0,0,1,3.06.46.78.78,0,0,1,3.22.22.78.78,0,0,1,3.46.06.68.68,0,0,1,3.75,0H6a.68.68,0,0,1,.29.06.78.78,0,0,1,.24.16.78.78,0,0,1,.16.24.68.68,0,0,1,.06.29V1.5h3Zm-1.5,0H1.5v8.63a.38.38,0,0,0,.11.26.39.39,0,0,0,.27.11h6a.38.38,0,0,0,.37-.37Zm-4.5,7.5H3v-6h.75Zm0-8.25H6V.75H3.75Zm1.5,8.25H4.5v-6h.75Zm1.5,0H6v-6h.75Z"})))])}o.defaultProps={viewBox:"0 0 9.75 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},2802:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("path",{className:"cls-1",d:"M7.5 0C8.19271 0 8.85677 0.0885417 9.49219 0.265625C10.1328 0.442708 10.7318 0.695312 11.2891 1.02344C11.8464 1.34635 12.3516 1.73698 12.8047 2.19531C13.263 2.64844 13.6536 3.15365 13.9766 3.71094C14.3047 4.26823 14.5573 4.86719 14.7344 5.50781C14.9115 6.14323 15 6.80729 15 7.5C15 8.19271 14.9115 8.85938 14.7344 9.5C14.5573 10.1354 14.3047 10.7318 13.9766 11.2891C13.6536 11.8464 13.263 12.3542 12.8047 12.8125C12.3516 13.2656 11.8464 13.6562 11.2891 13.9844C10.7318 14.3073 10.1328 14.5573 9.49219 14.7344C8.85677 14.9115 8.19271 15 7.5 15C6.80729 15 6.14062 14.9115 5.5 14.7344C4.86458 14.5573 4.26823 14.3073 3.71094 13.9844C3.15365 13.6562 2.64583 13.2656 2.1875 12.8125C1.73438 12.3542 1.34375 11.8464 1.01562 11.2891C0.692708 10.7318 0.442708 10.1354 0.265625 9.5C0.0885417 8.85938 0 8.19271 0 7.5C0 6.80729 0.0885417 6.14323 0.265625 5.50781C0.442708 4.86719 0.692708 4.26823 1.01562 3.71094C1.34375 3.15365 1.73438 2.64844 2.1875 2.19531C2.64583 1.73698 3.15365 1.34635 3.71094 1.02344C4.26823 0.695312 4.86458 0.442708 5.5 0.265625C6.14062 0.0885417 6.80729 0 7.5 0ZM7.5 14C8.09375 14 8.66667 13.9219 9.21875 13.7656C9.77604 13.6094 10.2943 13.3906 10.7734 13.1094C11.2578 12.8281 11.6979 12.4896 12.0938 12.0938C12.4896 11.6979 12.8281 11.2604 13.1094 10.7812C13.3906 10.2969 13.6094 9.77865 13.7656 9.22656C13.9219 8.67448 14 8.09896 14 7.5C14 6.90625 13.9219 6.33333 13.7656 5.78125C13.6094 5.22396 13.3906 4.70573 13.1094 4.22656C12.8281 3.74219 12.4896 3.30208 12.0938 2.90625C11.6979 2.51042 11.2578 2.17188 10.7734 1.89062C10.2943 1.60938 9.77604 1.39062 9.21875 1.23438C8.66667 1.07812 8.09375 1 7.5 1C6.90104 1 6.32552 1.07812 5.77344 1.23438C5.22135 1.39062 4.70312 1.60938 4.21875 1.89062C3.73958 2.17188 3.30208 2.51042 2.90625 2.90625C2.51042 3.30208 2.17188 3.74219 1.89062 4.22656C1.60938 4.70573 1.39062 5.22396 1.23438 5.78125C1.07812 6.33333 1 6.90625 1 7.5C1 8.09375 1.07812 8.66927 1.23438 9.22656C1.39062 9.77865 1.60938 10.2969 1.89062 10.7812C2.17188 11.2604 2.51042 11.6979 2.90625 12.0938C3.30208 12.4896 3.73958 12.8281 4.21875 13.1094C4.70312 13.3906 5.22135 13.6094 5.77344 13.7656C6.32552 13.9219 6.90104 14 7.5 14ZM7 4H8V9H7V4ZM7 10H8V11H7V10Z",fill:"#252423",key:1})])}o.defaultProps={width:"15",height:"15",viewBox:"0 0 15 15",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},65755:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 192 768 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},73594:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 m 1024 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -768 h 128 v 640 h 256 v 331 l 331 -331 h 949 v -1024 h -768 v -128 z",key:0}),r.createElement("path",{className:"OfficeIconColors_mCommentMarginEntrypointCenter",d:"M 1856 192 v 1152 h -986 l -422 422 v -422 h -256 v -704 h 64 v 384 h 384 v -384 h 384 v -448 z",key:1}),r.createElement("path",{className:"OfficeIconColors_mCommentMarginEntrypointBorder",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -768 h 128 v 640 h 256 v 331 l 331 -331 h 949 v -1024 h -768 v -128 z",key:2}),r.createElement("path",{className:"OfficeIconColors_mCommentMarginEntrypointStamp",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 z",key:3})])}o.defaultProps={className:"CommentMarginEntrypoint",viewBox:"0,0,2048,2048",width:"16",height:"16"},e.exports=o,o.default=o},4532:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M512 512h384v-128h-384v-384h-128v384h-384v128h384v384h128v-384z m1408 896v-1280h-896v128h768v1024h-256v331l-331-331h-949v-640h-128v768h1024l512 512v-512h256z",key:0}),r.createElement("path",{className:"OfficeIconColors_mCommentMarginEntrypointCenter",d:"M1856 192v1152h-256v422l-422-422h-986v-704h64v384h384v-384h384v-448h832z",key:1}),r.createElement("path",{className:"OfficeIconColors_mCommentMarginEntrypointBorder",d:"M1920 128v1280h-256v512l-512-512h-1024v-768h128v640h949l331 331v-331h256v-1024h-768v-128h896z",key:2}),r.createElement("path",{className:"OfficeIconColors_mCommentMarginEntrypointStamp",d:"M896 512h-384v384h-128v-384h-384v-128h384v-384h128v384h384v128z",key:3})])}o.defaultProps={className:"CommentMarginEntrypoint",viewBox:"0,0,2048,2048"},e.exports=o,o.default=o},55427:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M0,7.93,1.32,4,0,0,11.9,4ZM2,3.59H8.41L1.18,1.18ZM1.18,6.75,8.41,4.34H2Z"}))}o.defaultProps={viewBox:"-0.25 0.5 11.9 7.93",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},26800:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),r.createElement("path",{type:"path",fill:"currentColor",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}o.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},48621:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M0,5,.53,4.5,3.64,7.61,11.25,0l.53.53L3.64,8.67Z"})))])}o.defaultProps={viewBox:"0 0 10 10",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},9931:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,r.createElement("path",{className:"LikeEmptyBorder",d:"M11.4234 18.7499C11.4403 18.7501 11.4571 18.7495 11.4736 18.748C11.5002 18.7493 11.527 18.75 11.554 18.75H14.804C15.7014 18.75 16.429 18.0224 16.429 17.125C16.429 16.75 16.302 16.4047 16.0886 16.1297C16.5973 15.7671 16.929 15.1723 16.929 14.5C16.929 13.9026 16.6671 13.3665 16.2519 13C16.6671 12.6335 16.929 12.0973 16.929 11.5C16.929 10.7728 16.5409 10.1363 15.9606 9.78621C16.2529 9.43849 16.429 8.9898 16.429 8.49998C16.429 7.39541 15.5335 6.49998 14.429 6.49998H12.0001V4C12.0001 3.19882 11.7501 2.25001 11.2501 1.75C10.7501 1.24999 10.5001 1 9.50008 1C8.60522 1 8.17718 1.37605 7.85847 1.65605C7.82102 1.68895 7.78509 1.72052 7.75008 1.75C7.41712 2.03039 7.00008 2.62501 7.00008 3.89069C7.00008 3.95877 6.99981 4.02992 6.99954 4.10097C6.999 4.24278 6.99847 4.38419 7.00008 4.50001C7.01466 5.54624 6.98083 5.99942 6.6321 6.89063C6.56179 7.07032 6.38704 7.39157 6.12313 7.60562C5.99099 7.7128 5.85122 7.81818 5.7009 7.93076L5.66168 7.96011C5.61703 7.99354 5.62436 7.99232 5.6322 7.99102C5.64837 7.98833 5.66669 7.98529 5.23489 8.28549C4.59381 8.73117 3.86967 9.55127 3.50006 10.5C3.13046 11.4487 2.90931 12.4721 3.00008 13.4488C3.09072 14.4243 3.23008 15.5104 4.00007 16.5C4.5996 17.2706 5.41413 17.75 6.00007 18C7.71545 18.732 8.59386 18.7357 10.5094 18.7438C10.7899 18.745 11.0926 18.7463 11.4234 18.7499ZM14.429 7.49998C15.429 7.49999 16.2519 8.56249 15.429 9.99999C15.429 9.99999 16.929 11.5 15.429 13C16.929 14.5 15.6087 16 15.6087 16C15.6087 16 16.429 17.75 14.804 17.75H11.929C11.4234 17.75 10.929 17.5 10.929 17C10.929 16.5 11.3352 16.1797 11.929 16.1797C11.9906 16.1797 12.0577 16.1805 12.1298 16.1814C12.7523 16.1893 13.7528 16.2018 14.929 15.7187C12.8587 15.7812 11.929 15.5 11.929 15.5C11.3118 15.5 10.929 15.0523 10.929 14.5C10.929 13.9477 11.429 13.5 11.929 13.5C14.429 13.5 14.929 13 14.929 13C14.929 13 10.929 13 10.929 11.5C10.929 10.9477 11.3767 10.5 11.929 10.5C14.429 10.5 14.929 9.99999 14.929 9.99999C14.929 9.99999 10.929 9.99999 10.929 8.49998C10.929 7.94769 11.3767 7.49998 11.929 7.49998H14.429ZM8.00008 4C8.00008 3.10931 8.50008 2.5 8.50008 2.5C8.50008 2.5 8.77431 2 9.50008 2C10.2259 2 10.5001 2.5 10.5001 2.5C10.5001 2.5 11.0001 3.11712 11.0001 4L11.0001 6.5C10.6667 6.66665 10.0001 7.29996 10.0001 8.49998C10.0001 8.83331 10.1001 9.59996 10.5001 9.99998C10.3334 10.1667 10.0001 10.7 10.0001 11.5C10.0095 12.0841 10.0925 12.6402 10.5001 13C10.0849 13.3665 9.92897 13.9026 9.92897 14.5C9.92897 15.0417 10.1503 15.6399 10.5001 16C10.1541 16.298 10.0001 16.5075 10.0001 17C10.0001 17.3583 10.0929 17.4954 10.171 17.6109C10.2018 17.6565 10.2304 17.6988 10.2501 17.75C8.5419 17.6578 7.26344 17.3894 6.54436 17.0854C5.68327 16.7214 5.2865 16.2328 4.84001 15.5882C4.43289 15.0003 4.17563 14.2043 4.09683 13.3563C4.01816 12.5097 4.12114 11.6498 4.39486 10.9472C4.74563 10.0468 5.27919 9.52447 5.85444 9.07045C5.98889 8.96433 6.12376 8.86336 6.26216 8.75976L6.30035 8.73117C6.45002 8.61907 6.60408 8.50311 6.75305 8.38228C7.05138 8.14032 7.31553 7.84 7.59001 7.51466C8.06065 6.9568 8.03278 5.84126 8.00795 4.84741C8.00501 4.72952 8.00211 4.61334 8.00008 4.50001C7.99811 4.38917 7.99873 4.28533 7.99939 4.17612C7.99973 4.11944 8.00008 4.06131 8.00008 4Z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0 0 20 20",fill:"none"},e.exports=o,o.default=o},33925:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"LikeSolidBorder",d:"M11.4736 18.748C11.4571 18.7495 11.4403 18.7501 11.4234 18.7499C8.83315 18.7212 7.96662 18.8391 6.00007 18C5.41413 17.75 4.5996 17.2706 4.00007 16.5C3.23008 15.5103 3.09072 14.4243 3.00008 13.4488C2.90931 12.4721 3.13046 11.4487 3.50006 10.5C3.86967 9.55127 4.59381 8.73117 5.23489 8.28549C5.87597 7.8398 5.52488 8.06251 5.66168 7.96011L5.70089 7.93076C5.85122 7.81818 5.99099 7.7128 6.12313 7.60562C6.38704 7.39157 6.56179 7.07032 6.6321 6.89063C6.98083 5.99942 7.01466 5.54624 7.00008 4.50001C6.99766 4.32615 7.00008 4.09465 7.00008 3.89069C7.00008 2.62501 7.41712 2.03039 7.75008 1.75C8.08304 1.46961 8.50008 1 9.50008 1C10.5001 1 10.7501 1.24999 11.2501 1.75C11.7501 2.25001 12.0001 3.19882 12.0001 4V6.49998H14.429C15.5335 6.49998 16.429 7.39541 16.429 8.49998C16.429 8.9898 16.2529 9.43849 15.9606 9.78621C16.5409 10.1363 16.929 10.7728 16.929 11.5C16.929 12.0973 16.6671 12.6335 16.2519 13C16.6671 13.3665 16.929 13.9026 16.929 14.5C16.929 15.1723 16.5973 15.7671 16.0886 16.1297C16.3019 16.4047 16.429 16.75 16.429 17.125C16.429 18.0224 15.7014 18.75 14.804 18.75H11.554C11.527 18.75 11.5002 18.7493 11.4736 18.748Z",key:0}),r.createElement("path",{className:"LikeSolidCenter",d:"M7.99996 4C7.99996 3.10931 8.49996 2.5 8.49996 2.5C8.49996 2.5 8.77419 2 9.49996 2C10.2257 2 10.5 2.5 10.5 2.5C10.5 2.5 11 3.11712 11 4L10.9999 6.5C10.6666 6.66665 9.99995 7.29996 9.99994 8.49998C9.99994 8.83331 10.0999 9.59996 10.4999 9.99998C10.3333 10.1667 9.99994 10.7 9.99994 11.5C10.0093 12.0841 10.0924 12.6402 10.4999 13C10.0847 13.3665 9.92885 13.9026 9.92885 14.5C9.92885 15.0417 10.1502 15.6399 10.4999 16C10.1539 16.298 9.99994 16.5075 9.99994 17C9.99994 17.3583 10.0927 17.4954 10.1708 17.6109C10.2017 17.6565 10.2303 17.6988 10.2499 17.75C8.54178 17.6578 7.26332 17.3894 6.54423 17.0854C5.68315 16.7214 5.28638 16.2328 4.83989 15.5882C4.43277 15.0003 4.17551 14.2043 4.09671 13.3563C4.01804 12.5097 4.12102 11.6498 4.39474 10.9472C4.74551 10.0468 5.27907 9.52447 5.85431 9.07045C5.98876 8.96433 6.12364 8.86336 6.26204 8.75976L6.30022 8.73117C6.4499 8.61907 6.60396 8.50311 6.75293 8.38228C7.05126 8.14032 7.31541 7.84 7.58989 7.51466C8.06053 6.9568 8.03266 5.84126 8.00783 4.84741C8.00489 4.72952 8.00198 4.61334 7.99996 4.50001C7.99798 4.38917 7.99861 4.28533 7.99927 4.17612C7.99961 4.11944 7.99996 4.06131 7.99996 4Z",key:1}),r.createElement("path",{className:"LikeSolidCenter",d:"M14.4288 7.5H11.9288C11.3766 7.5 10.9288 7.94772 10.9288 8.5C10.9288 10 14.9288 10 14.9288 10C14.9288 10 14.4288 10.5 11.9288 10.5C11.3766 10.5 10.9288 10.9477 10.9288 11.5C10.9288 13 14.9288 13 14.9288 13C14.9288 13 14.4288 13.5 11.9288 13.5C11.4288 13.5 10.9288 13.9477 10.9288 14.5C10.9288 15.0523 11.3116 15.5 11.9288 15.5C11.9288 15.5 12.8585 15.7813 14.9288 15.7188C13.7526 16.2018 12.7521 16.1893 12.1297 16.1815C12.0576 16.1805 11.9905 16.1797 11.9288 16.1797C11.3351 16.1797 10.9288 16.5 10.9288 17C10.9288 17.5 11.4233 17.75 11.9288 17.75H14.8038C16.4288 17.75 15.6085 16 15.6085 16C15.6085 16 16.9288 14.5 15.4288 13C16.9288 11.5 15.4288 10 15.4288 10C16.2517 8.56252 15.4288 7.50002 14.4288 7.5Z",key:2})])}o.defaultProps={width:"16",height:"16",viewBox:"0 0 20 20",fill:"none"},e.exports=o,o.default=o},22918:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 m 1547 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -73 -31 q -38 -14 -80 -22 l 75 -75 z",key:0}),r.createElement("path",{className:"reopenThreadIconShading",fillOpacity:"1.000",d:"M 1073 1344 h -203 l -422 422 v -422 h -256 v -561 l 384 385 l 195 -196 l -25 46 m 1110 -826 v 1152 h -723 l 105 -160 q 52 -79 79 -168 q 27 -90 27 -184 q 0 -115 -39 -220 q -40 -105 -109 -188 q -69 -84 -164 -141 q -95 -58 -206 -80 l 11 -11 z",key:1}),r.createElement("path",{className:"reopenThreadIconArrow",fillOpacity:"1.000",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -74 -31 q -38 -14 -79 -22 l 75 -75 z",key:2}),r.createElement("path",{className:"reopenThreadIconBubble",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 z",key:3})])}o.defaultProps={width:"14",height:"14",viewBox:"200,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},42188:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:0}),r.createElement("path",{fill:"currentColor",fillOpacity:"1.000",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:1})])}o.defaultProps={width:"12",height:"12",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},93625:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("path",{fill:"#F9F9F9",fillOpacity:"1.000",d:"M 800 1888 v -749 l -640 -655 v -324 h 1664 v 351 l -731 764 l 91 90 v 523 z",key:0}),r.createElement("path",{fill:"#3A3A38",fillOpacity:"1.000",d:"M 1856 128 v 369 l -582 596 l -45 -45 l 563 -577 v -279 h -1600 v 279 l 640 655 v 730 h 320 v -523 l 64 64 v 470 l -53 53 h -395 v -768 l -640 -655 v -369 z",key:1}),r.createElement("path",{fill:"#ED3D3B",fillOpacity:"1.000",d:"M 1677 1632 l 371 371 l -45 45 l -371 -371 l -371 371 l -45 -45 l 371 -371 l -371 -371 l 45 -45 l 371 371 l 371 -371 l 45 45 z",key:2})])}o.defaultProps={viewBox:"0,0,2048,2048",width:"100%",height:"100%"},e.exports=o,o.default=o},14476:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("path",{fill:"#FCFCFC",fillOpacity:"1.000",d:"M 800 1888 v -749 l -640 -655 v -324 h 1664 v 351 l -731 764 l 91 90 v 523 z",key:0}),r.createElement("path",{fill:"#919190",fillOpacity:"1.000",d:"M 1856 128 v 369 l -582 596 l -45 -45 l 563 -577 v -279 h -1600 v 279 l 640 655 v 730 h 320 v -523 l 64 64 v 470 l -53 53 h -395 v -768 l -640 -655 v -369 z",key:1}),r.createElement("path",{fill:"#FF9091",fillOpacity:"1.000",d:"M 1677 1632 l 371 371 l -45 45 l -371 -371 l -371 371 l -45 -45 l 371 -371 l -371 -371 l 45 -45 l 371 371 l 371 -371 l 45 45 z",key:2})])}o.defaultProps={viewBox:"0,0,2048,2048",width:"100%",height:"100%"},e.exports=o,o.default=o},23230:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M12,2a1.93,1.93,0,0,1-.15.75,1.87,1.87,0,0,1-.42.65L3.71,11.07,0,12,.93,8.29,8.64.57A1.87,1.87,0,0,1,9.29.15,1.93,1.93,0,0,1,10,0a1.79,1.79,0,0,1,.76.16,1.79,1.79,0,0,1,.62.42,1.79,1.79,0,0,1,.42.62A1.79,1.79,0,0,1,12,2ZM1,11,3,10.49A1.84,1.84,0,0,0,2.77,10a2.29,2.29,0,0,0-.32-.43A2.29,2.29,0,0,0,2,9.23,1.84,1.84,0,0,0,1.51,9Zm.88-2.6a2.64,2.64,0,0,1,1.72,1.72L10,3.75,8.25,2ZM10.5,3.22l.28-.28A2,2,0,0,0,11,2.67a1.34,1.34,0,0,0,.17-.31A1.14,1.14,0,0,0,11.25,2a1,1,0,0,0-.1-.47A1.2,1.2,0,0,0,10.5.85,1,1,0,0,0,10,.75a1.14,1.14,0,0,0-.39.06A1.34,1.34,0,0,0,9.33,1a2,2,0,0,0-.27.24l-.28.28Z"})))])}o.defaultProps={viewBox:"0 0 12 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},33837:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-1.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M7.4375,24.8349609 C7.875,24.8349609 8.29654745,24.8919265 8.70214844,25.0058594 C9.10774942,25.1197922 9.48827947,25.2815745 9.84375,25.4912109 C10.1992205,25.7008474 10.522785,25.9514959 10.8144531,26.2431641 C11.1061213,26.5348322 11.3567698,26.8583967 11.5664062,27.2138672 C11.7760427,27.5693377 11.937825,27.9498678 12.0517578,28.3554688 C12.1656907,28.7610697 12.2226562,29.1826172 12.2226562,29.6201172 C12.2226562,30.2444693 12.1030285,30.8471651 11.8637695,31.4282227 C11.6245105,32.0092802 11.2838564,32.5208311 10.8417969,32.9628906 L5.12011719,38.6777344 L4.50488281,38.0625 L10.2197266,32.3408203 C10.5797544,31.9807925 10.8577464,31.5649438 11.0537109,31.0932617 C11.2496755,30.6215797 11.3476562,30.1305364 11.3476562,29.6201172 C11.3476562,29.0869114 11.2439789,28.5833357 11.0366211,28.109375 C10.8292633,27.6354143 10.5478533,27.2207049 10.1923828,26.8652344 C9.83691229,26.5097638 9.42220289,26.2283539 8.94824219,26.0209961 C8.47428148,25.8136383 7.97070579,25.7099609 7.4375,25.7099609 C6.94531004,25.7099609 6.51123235,25.7840162 6.13525391,25.9321289 C5.75927546,26.0802416 5.41178545,26.2762032 5.09277344,26.5200195 C4.77376143,26.7638359 4.46728663,27.0406886 4.17333984,27.3505859 C3.87939306,27.6604833 3.57063964,27.9794905 3.24707031,28.3076172 L6.125,28.3076172 L6.125,29.1826172 L1.75,29.1826172 L1.75,24.8076172 L2.625,24.8076172 L2.625,27.6855469 C2.87565229,27.4303373 3.11604703,27.1831067 3.34619141,26.9438477 C3.57633579,26.7045886 3.80647671,26.479005 4.03662109,26.2670898 C4.26676547,26.0551747 4.50146365,25.8614918 4.74072266,25.6860352 C4.97998167,25.5105785 5.23518745,25.3601894 5.50634766,25.2348633 C5.77750787,25.1095371 6.07145024,25.0115563 6.38818359,24.940918 C6.70491695,24.8702796 7.05468559,24.8349609 7.4375,24.8349609 Z",id:"Reopen"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},31391:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,r.createElement("path",{d:"M1 4L3.5 6.5L9 1"}))}o.defaultProps={viewBox:"0 0 10 8",focusable:"false",fill:"none",fillOpacity:"0.0"},e.exports=o,o.default=o},97510:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(0.000000, 0.648438)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Reassign",points:"7.52636719 0 13.9589844 6.43261719 7.52636719 12.8652344 6.91113281 12.25 12.2910156 6.87011719 0 6.87011719 0 5.99511719 12.2910156 5.99511719 6.91113281 0.615234375"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 14 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},16384:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-32.000000, -2.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Resolve",points:"42.5673828 2.625 43.1826172 3.24023438 35.875 10.5546875 32.0673828 6.74023438 32.6826172 6.125 35.875 9.31054688"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 9",focusable:"false",version:"1.1"},e.exports=o,o.default=o},79872:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-62.000000, -26.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Cancel",points:"73.5888672 27.0839844 68.8720703 31.8076172 73.5888672 36.53125 72.9736328 37.1464844 68.25 32.4296875 63.5263672 37.1464844 62.9111328 36.53125 67.6279297 31.8076172 62.9111328 27.0839844 63.5263672 26.46875 68.25 31.1855469 72.9736328 26.46875"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 11",focusable:"false",version:"1.1"},e.exports=o,o.default=o},97357:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-30.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M44.625,27.0976562 C44.625,27.398439 44.5680344,27.6901028 44.4541016,27.9726562 C44.3401687,28.2552097 44.1738292,28.5058583 43.9550781,28.7246094 L34.9521484,37.7275391 L30.625,38.8076172 L31.7050781,34.4804688 L40.7080078,25.4775391 C40.9267589,25.258788 41.1774074,25.0924485 41.4599609,24.9785156 C41.7425144,24.8645828 42.0341782,24.8076172 42.3349609,24.8076172 C42.6494156,24.8076172 42.9456366,24.8680007 43.2236328,24.9887695 C43.501629,25.1095384 43.7443023,25.2735992 43.9516602,25.480957 C44.159018,25.6883148 44.3230788,25.9309882 44.4438477,26.2089844 C44.5646165,26.4869806 44.625,26.7832016 44.625,27.0976562 Z M32.8535156,34.5693359 C33.336591,34.7288419 33.7524397,34.9829084 34.1010742,35.331543 C34.4497088,35.6801775 34.7037752,36.0960262 34.8632812,36.5791016 L42.2529297,29.1826172 L40.25,27.1796875 L32.8535156,34.5693359 Z M31.828125,37.6044922 L34.0771484,37.0439453 C34.0315753,36.8343088 33.95752,36.6360686 33.8549805,36.4492188 C33.7524409,36.2623689 33.6282559,36.0960294 33.4824219,35.9501953 C33.3365878,35.8043612 33.1702483,35.6801763 32.9833984,35.5776367 C32.7965485,35.4750971 32.5983083,35.4010419 32.3886719,35.3554688 L31.828125,37.6044922 Z M42.875,28.5605469 C42.9889329,28.446614 43.0983068,28.3395187 43.203125,28.2392578 C43.3079432,28.1389969 43.4013668,28.0330409 43.4833984,27.9213867 C43.5654301,27.8097325 43.6303709,27.6889655 43.6782227,27.559082 C43.7260745,27.4291986 43.75,27.2776701 43.75,27.1044922 C43.75,26.9085277 43.7124027,26.7250985 43.637207,26.5541992 C43.5620113,26.3832999 43.4594733,26.2329108 43.3295898,26.1030273 C43.1997064,25.9731439 43.0493173,25.8706058 42.878418,25.7954102 C42.7075187,25.7202145 42.5240895,25.6826172 42.328125,25.6826172 C42.1549471,25.6826172 42.0034186,25.7065427 41.8735352,25.7543945 C41.7436517,25.8022463 41.6228847,25.8671871 41.5112305,25.9492188 C41.3995763,26.0312504 41.2936203,26.124674 41.1933594,26.2294922 C41.0930985,26.3343104 40.9860032,26.4436843 40.8720703,26.5576172 L42.875,28.5605469 Z",id:"Edit"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",x:"0",y:"0",viewBox:"0 0 15 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},29506:function(e,t,n){var r=n(76149);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M 2048 1216 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -512 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 64 v 128 h -64 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -64 v -128 h 64 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 m -640 -384 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -512 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 512 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 z"})))])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},75044:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function o(e){return!!e&&!!e[Y]}function i(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===j}(e)||Array.isArray(e)||!!e[W]||!!(null===(t=e.constructor)||void 0===t?void 0:t[W])||m(e)||f(e))}function a(e){return o(e)||r(23,e),e[Y].t}function s(e,t,n){void 0===n&&(n=!1),0===d(e)?(n?Object.keys:X)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function d(e){var t=e[Y];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:m(e)?2:f(e)?3:0}function c(e,t){return 2===d(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function u(e,t,n){var r=d(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function l(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function m(e){return H&&e instanceof Map}function f(e){return G&&e instanceof Set}function p(e){return e.o||e.t}function g(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=K(e);delete t[Y];for(var n=X(t),r=0;r<n.length;r++){var o=n[r],i=t[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function C(e,t){return void 0===t&&(t=!1),v(e)||o(e)||!i(e)||(d(e)>1&&(e.set=e.add=e.clear=e.delete=h),Object.freeze(e),t&&s(e,(function(e,t){return C(t,!0)}),!0)),e}function h(){r(2)}function v(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function y(e){var t=$[e];return t||r(18,e),t}function T(){return V}function I(e,t){t&&(y("Patches"),e.u=[],e.s=[],e.v=t)}function S(e){A(e),e.p.forEach(D),e.p=null}function A(e){e===V&&(V=e.l)}function _(e){return V={p:[],l:V,h:e,m:!0,_:0}}function D(e){var t=e[Y];0===t.i||1===t.i?t.j():t.O=!0}function E(e,t){t._=t.p.length;var n=t.p[0],o=void 0!==e&&e!==n;return t.h.g||y("ES5").S(t,e,o),o?(n[Y].P&&(S(t),r(4)),i(e)&&(e=P(t,e),t.l||b(t,e)),t.u&&y("Patches").M(n[Y].t,e,t.u,t.s)):e=P(t,n,[]),S(t),t.u&&t.v(t.u,t.s),e!==q?e:void 0}function P(e,t,n){if(v(t))return t;var r=t[Y];if(!r)return s(t,(function(o,i){return x(e,r,t,o,i,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return b(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var o=4===r.i||5===r.i?r.o=g(r.k):r.o;s(3===r.i?new Set(o):o,(function(t,i){return x(e,r,o,t,i,n)})),b(e,o,!1),n&&e.u&&y("Patches").R(r,n,e.u,e.s)}return r.o}function x(e,t,n,r,a,s){if(o(a)){var d=P(e,a,s&&t&&3!==t.i&&!c(t.D,r)?s.concat(r):void 0);if(u(n,r,d),!o(d))return;e.m=!1}if(i(a)&&!v(a)){if(!e.h.F&&e._<1)return;P(e,a),t&&t.A.l||b(e,a)}}function b(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&C(t,n)}function k(e,t){var n=e[Y];return(n?p(n):e)[t]}function w(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function R(e){e.P||(e.P=!0,e.l&&R(e.l))}function F(e){e.o||(e.o=g(e.t))}function N(e,t,n){var r=m(t)?y("MapSet").N(t,n):f(t)?y("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:T(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=r,i=Z;n&&(o=[r],i=J);var a=Proxy.revocable(o,i),s=a.revoke,d=a.proxy;return r.k=d,r.j=s,d}(t,n):y("ES5").J(t,n);return(n?n.A:T()).p.push(r),r}function M(e){return o(e)||r(22,e),function e(t){if(!i(t))return t;var n,r=t[Y],o=d(t);if(r){if(!r.P&&(r.i<4||!y("ES5").K(r)))return r.t;r.I=!0,n=L(t,o),r.I=!1}else n=L(t,o);return s(n,(function(t,o){r&&function(e,t){return 2===d(e)?e.get(t):e[t]}(r.t,t)===o||u(n,t,e(o))})),3===o?new Set(n):n}(e)}function L(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return g(e)}function O(){function e(e,t){var n=i[e];return n?n.enumerable=t:i[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[Y];return Z.get(t,e)},set:function(t){var n=this[Y];Z.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var o=e[t][Y];if(!o.P)switch(o.i){case 5:r(o)&&R(o);break;case 4:n(o)&&R(o)}}}function n(e){for(var t=e.t,n=e.k,r=X(n),o=r.length-1;o>=0;o--){var i=r[o];if(i!==Y){var a=t[i];if(void 0===a&&!c(t,i))return!0;var s=n[i],d=s&&s[Y];if(d?d.t!==a:!l(s,a))return!0}}var u=!!t[Y];return r.length!==X(t).length+(u?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var i={};!function(e,t){$[e]||($[e]=t)}("ES5",{J:function(t,n){var r=Array.isArray(t),o=function(t,n){if(t){for(var r=Array(n.length),o=0;o<n.length;o++)Object.defineProperty(r,""+o,e(o,!0));return r}var i=K(n);delete i[Y];for(var a=X(i),s=0;s<a.length;s++){var d=a[s];i[d]=e(d,t||!!i[d].enumerable)}return Object.create(Object.getPrototypeOf(n),i)}(r,t),i={i:r?5:4,A:n?n.A:T(),P:!1,I:!1,D:{},l:n,t,k:o,o:null,O:!1,C:!1};return Object.defineProperty(o,Y,{value:i,writable:!0}),o},S:function(e,n,i){i?o(n)&&n[Y].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[Y];if(n){var o=n.t,i=n.k,a=n.D,d=n.i;if(4===d)s(i,(function(t){t!==Y&&(void 0!==o[t]||c(o,t)?a[t]||e(i[t]):(a[t]=!0,R(n)))})),s(o,(function(e){void 0!==i[e]||c(i,e)||(a[e]=!1,R(n))}));else if(5===d){if(r(n)&&(R(n),a.length=!0),i.length<o.length)for(var u=i.length;u<o.length;u++)a[u]=!1;else for(var l=o.length;l<i.length;l++)a[l]=!0;for(var m=Math.min(i.length,o.length),f=0;f<m;f++)i.hasOwnProperty(f)||(a[f]=!0),void 0===a[f]&&e(i[f])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}n.d(t,{Ay:function(){return ne},c2:function(){return a},rF:function(){return O}});var B,V,U="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),H="undefined"!=typeof Map,G="undefined"!=typeof Set,z="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,q=U?Symbol.for("immer-nothing"):((B={})["immer-nothing"]=!0,B),W=U?Symbol.for("immer-draftable"):"__$immer_draftable",Y=U?Symbol.for("immer-state"):"__$immer_state",j=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),X="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,K=Object.getOwnPropertyDescriptors||function(e){var t={};return X(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},$={},Z={get:function(e,t){if(t===Y)return e;var n=p(e);if(!c(n,t))return function(e,t,n){var r,o=w(t,n);return o?"value"in o?o.value:null===(r=o.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!i(r)?r:r===k(e.t,t)?(F(e),e.o[t]=N(e.A.h,r,e)):r},has:function(e,t){return t in p(e)},ownKeys:function(e){return Reflect.ownKeys(p(e))},set:function(e,t,n){var r=w(p(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var o=k(p(e),t),i=null==o?void 0:o[Y];if(i&&i.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(l(n,o)&&(void 0!==n||c(e.t,t)))return!0;F(e),R(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==k(e.t,t)||t in e.t?(e.D[t]=!1,F(e),R(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=p(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){r(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){r(12)}},J={};s(Z,(function(e,t){J[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),J.deleteProperty=function(e,t){return J.set.call(this,e,t,void 0)},J.set=function(e,t,n){return Z.set.call(this,e[0],t,n,e[0])};var Q=function(){function e(e){var t=this;this.g=z,this.F=!0,this.produce=function(e,n,o){if("function"==typeof e&&"function"!=typeof n){var a=n;n=e;var s=t;return function(e){var t=this;void 0===e&&(e=a);for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return s.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(o))}))}}var d;if("function"!=typeof n&&r(6),void 0!==o&&"function"!=typeof o&&r(7),i(e)){var c=_(t),u=N(t,e,void 0),l=!0;try{d=n(u),l=!1}finally{l?S(c):A(c)}return"undefined"!=typeof Promise&&d instanceof Promise?d.then((function(e){return I(c,o),E(e,c)}),(function(e){throw S(c),e})):(I(c,o),E(d,c))}if(!e||"object"!=typeof e){if(void 0===(d=n(e))&&(d=e),d===q&&(d=void 0),t.F&&C(d,!0),o){var m=[],f=[];y("Patches").M(e,d,m,f),o(m,f)}return d}r(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(o))}))};var r,o,i=t.produce(e,n,(function(e,t){r=e,o=t}));return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(e){return[e,r,o]})):[i,r,o]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){i(e)||r(8),o(e)&&(e=M(e));var t=_(this),n=N(this,e,void 0);return n[Y].C=!0,A(t),n},t.finishDraft=function(e,t){var n=(e&&e[Y]).A;return I(n,t),E(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!z&&r(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var i=y("Patches").$;return o(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),ee=new Q,te=ee.produce;ee.produceWithPatches.bind(ee),ee.setAutoFreeze.bind(ee),ee.setUseProxies.bind(ee),ee.applyPatches.bind(ee),ee.createDraft.bind(ee),ee.finishDraft.bind(ee);const ne=te},24779:function(e){"use strict";e.exports=JSON.parse('{"SharedCommentsVersion":"3.74.8"}')}}]);
//# sourceMappingURL=sharedComments.min.js.map