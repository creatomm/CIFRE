function asyncGeneratorStep(e,t,o,r,s,n,i){try{var a=e[n](i),l=a.value}catch(e){return void o(e)}a.done?t(l):Promise.resolve(l).then(r,s)}function _async_to_generator(e){return function(){var t=this,o=arguments;return new Promise((function(r,s){var n=e.apply(t,o);function i(e){asyncGeneratorStep(n,r,s,i,a,"next",e)}function a(e){asyncGeneratorStep(n,r,s,i,a,"throw",e)}i(void 0)}))}}function _define_property(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _object_spread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},r=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(o).filter((function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})))),r.forEach((function(t){_define_property(e,t,o[t])}))}return e}function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function _object_spread_props(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))})),e}(globalThis.webpackChunk_1js_powerpoint_online_wp5=globalThis.webpackChunk_1js_powerpoint_online_wp5||[]).push([[5035],{46256:function(e,t,o){"use strict";o.d(t,{j:function(){return l}});var r=o(90853),s=o(76149),n=o(36071),i=o(63063),a=o(85190),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.render=function(){return s.createElement(a.Y,(0,r.__assign)({},this.props,{primary:!0,onRenderDescription:n.K}))},(0,r.__decorate)([(0,i.T)("PrimaryButton",["theme","styles"],!0)],t)}(s.Component)},7821:function(e,t,o){"use strict";var r,s,n;o.r(t),o.d(t,{FactoryGlobal:function(){return ct}}),function(e){e[e.None=0]="None",e[e.VHUnknown=1]="VHUnknown",e[e.VHFailedToLoadVersionList=100]="VHFailedToLoadVersionList",e[e.VHFailedToGetDownloadToken=101]="VHFailedToGetDownloadToken",e[e.VHFailedToParseVersionList=102]="VHFailedToParseVersionList",e[e.VHFetchFailed=103]="VHFetchFailed",e[e.VHVersioningNotEnabled=104]="VHVersioningNotEnabled",e[e.VHFileNotFound=105]="VHFileNotFound",e[e.VHVersionTooOld=106]="VHVersionTooOld",e[e.VHFetchException=107]="VHFetchException",e[e.VHServiceUnavailable=108]="VHServiceUnavailable",e[e.VHBadGateway=109]="VHBadGateway",e[e.VHUnauthorized=110]="VHUnauthorized",e[e.VHInternalServerError=111]="VHInternalServerError",e[e.VHEmptyVersionMetadatas=112]="VHEmptyVersionMetadatas",e[e.VHFailedHostDownload=113]="VHFailedHostDownload",e[e.VHFailedToAddDownloadToVersionStore=114]="VHFailedToAddDownloadToVersionStore",e[e.VHFailedToCacheParts=115]="VHFailedToCacheParts",e[e.VHFailedToDownloadVersionMetadata=116]="VHFailedToDownloadVersionMetadata",e[e.VHFailedToDownloadParts=117]="VHFailedToDownloadParts",e[e.VHInvalidDocID=118]="VHInvalidDocID",e[e.VHMissingDocID=119]="VHMissingDocID",e[e.VHNullDocID=120]="VHNullDocID",e[e.VHNullHashedDocID=121]="VHNullHashedDocID",e[e.VHNullGetDownloadAccessTokenRequest=122]="VHNullGetDownloadAccessTokenRequest",e[e.VHFailedToDownloadVersionFromHost=123]="VHFailedToDownloadVersionFromHost",e[e.VHNullResponseFromFetch=124]="VHNullResponseFromFetch",e[e.VHGetTipVersionException=125]="VHGetTipVersionException",e[e.VHGetVersionsException=126]="VHGetVersionsException",e[e.VHGetDownloadTokenException=127]="VHGetDownloadTokenException",e[e.VHFetchRetryException=128]="VHFetchRetryException",e[e.VHNullResponseFromRequestVersionHistory=129]="VHNullResponseFromRequestVersionHistory",e[e.VHNullResponseFromRequestDownloadToken=130]="VHNullResponseFromRequestDownloadToken",e[e.VHXhrJsonParseFailed=131]="VHXhrJsonParseFailed",e[e.VHXhrException=132]="VHXhrException",e[e.VHNullResponseFromXhr=133]="VHNullResponseFromXhr",e[e.VHFileGone=134]="VHFileGone",e[e.VHNullRevisionIDs=135]="VHNullRevisionIDs",e[e.VHRequestDeleteVersionsException=136]="VHRequestDeleteVersionsException",e[e.VHNullResponseFromRequestDeleteVersions=137]="VHNullResponseFromRequestDeleteVersions",e[e.VHVersionInfoFromTipVersionException=138]="VHVersionInfoFromTipVersionException"}(r||(r={})),function(e){e[e.NotSet=0]="NotSet",e[e.PowerPoint=100]="PowerPoint",e[e.Word=110]="Word",e[e.Excel=120]="Excel",e[e.OneNote=130]="OneNote"}(s||(s={})),function(e){e[e.None=0]="None",e[e.Share=1]="Share",e[e.Rename=2]="Rename",e[e.Restore=3]="Restore"}(n||(n={}));var i=o(8189),a=o(52271),l=o(95716);class c{static setDisabledChangeGates(e){e&&e.length>0?c.disabledChangeGates=e.toLowerCase().split(","):c.disabledChangeGates=[]}static getDisabledChangeGates(){return c.disabledChangeGates.toString()}static isChangeGateEnabled(e){return!(e.length<1)&&(c.disabledChangeGates.length<1||c.disabledChangeGates.indexOf(e.toLowerCase())<0)}}c.disabledChangeGates=[];class d{}d.FetchTelemetryChange="FetchTelemetryChange",d.ResolvingWholeGridSelectedOnIteration="ResolvingWholeGridSelectedOnIteration",d.IteratorNoChangesTooltipFix="IteratorNoChangesTooltipFix";class p{constructor(e,t,o,r){this.correlationId=e||"",this.errorType=t,this.status=o,this.statusText=r}}class h{updateDocId(e){i.Hv.shipAssertTag(520173205,a.n.msoulscat_Wac_VersionHistory,Boolean(e),"New docId should not be empty"),e&&(this._docId=e)}versionInfoFromTipVersion(e){try{if(!e)return;if(!e.data)return{data:null,errorCode:e.errorCode,message:e.message,isDirty:!1};const t={};return e.data.downloadUrl?(t.DownloadUrl=e.data.downloadUrl,{correlationID:e.correlationID,data:t,isDirty:"true"===e.data.isDirty}):(t.DownloadUrl=null,{data:t,errorCode:e.errorCode,message:"null download url",isDirty:!1})}catch(t){const o=`versionInfoFromTipVersion exception: ${t.message}`;return i.Hv.sendTraceTag(579342617,a.n.msoulscat_Wac_VersionHistory,l.k.Error,o),{data:e.data,errorCode:r.VHVersionInfoFromTipVersionException,message:o,isDirty:!1}}}getAppIdHeader(e){switch(e){case s.Excel:return"Excel";case s.PowerPoint:return"PPT";case s.Word:return"Word"}return"None"}requestTipVersionAsync(){var e=this;return _async_to_generator((function*(){const t={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":e.getAppIdHeader(e._appId),"X-UserSessionId":e._userSessionId,"X-WacCluster":e._wacCluster}},o="&waccluster="+e._wacCluster;try{const r=yield e.fetchRetry(e._latestStreamServiceBase+o,t,e._retryCount);return e.versionInfoFromTipVersion(r)}catch(e){const t=`requestTipVersionAsync fetchRetry exception: ${e.message}`;return i.Hv.sendTraceTag(591934727,a.n.msoulscat_Wac_VersionHistory,l.k.Error,t),{errorCode:r.VHFetchRetryException,message:t,isDirty:!1}}}))()}requestTipVersion(){return this.requestTipVersionAsync()}requestVersionHistory(){const e={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-ServerSessionId":this._serverSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1","X-NoSpoCache":this._wdDisableSPOFileCache?"1":"0","X-NoOdcCache":this._wdDisableODCFileCache?"1":"0","X-NoFileStoreApi":this._wdDisableFileStoreAPI?"1":"0"}},t="&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(e.method,this._theUri+t,e.headers,null,this._retryCount):this.fetchRetry(this._theUri+t,e,this._retryCount)}requestDownloadToken(e,t){const o={method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"},body:JSON.stringify({RevisionIDs:e,OptionalIDs:t})},r="&action=GetDownloadToken&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(o.method,this._theUri+r,o.headers,o.body,this._retryCount):this.fetchRetry(this._theUri+r,o,this._retryCount)}requestDeleteVersions(e){if(!e||0===e.length||e.includes(void 0)){const e={errorCode:r.VHNullRevisionIDs,message:"requestDeleteVersions: revisionIDs list is null."};return Promise.resolve(e)}const t={method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","X-AppId":this.getAppIdHeader(this._appId),"X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"},body:JSON.stringify({RevisionIDs:e})},o="&action=DeleteVersions&wdEnableDeleteVersions="+this._wdEnableDeleteVersions.toString();return this._useXhr?this.xhrRetry(t.method,this._theUri+o,t.headers,t.body,1):this.fetchRetry(this._theUri+o,t,1)}buildVersionHistoryRequestUri(){this._wdEnableAppVHProvider?this._serviceBase.indexOf(this._vhHandlerName)<0?this._theUri=this._serviceBase+this._vhHandlerName+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId):this._theUri=this._serviceBase+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId):this._serviceBase.indexOf(this._handlerName)<0?this._theUri=this._serviceBase+this._handlerName+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId):this._theUri=this._serviceBase+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId)}xhrRetry(e,t,o,s,n){var u=this;return _async_to_generator((function*(){let g,m=!1,v="",_=r.VHUnknown,f=0,C=0;for(let V=0;V<n;V+=1){c.isChangeGateEnabled(d.FetchTelemetryChange)&&(C+=1);try{g=yield u.xhr(e,t,o,s),g?(m=!1,_=r.None):(m=!0,_=r.VHNullResponseFromXhr,v=c.isChangeGateEnabled(d.FetchTelemetryChange)?`VersionHistoryRequestManager::xhrRetry: unexpected null response from xhr, tryNumber: ${C} of ${n}`:"xhrRetry: unexpected null response from xhr.",i.Hv.sendTraceTag(591934728,a.n.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(d.FetchTelemetryChange)?l.k.Warning:l.k.Error,v))}catch(e){v=c.isChangeGateEnabled(d.FetchTelemetryChange)?"VersionHistoryRequestManager::xhrRetry xhr exception: ":"xhrRetry xhr exception: ",e instanceof p?(m=h.isRetriableError(e.errorType),_=e.errorType,v+=e.statusText,f=e.status):(m=!0,_=r.VHXhrException,v+=e.message),c.isChangeGateEnabled(d.FetchTelemetryChange)&&(v+=`, tryNumber: ${C} of ${n}, isRetriableError: ${m}`),i.Hv.sendTraceTag(591934729,a.n.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(d.FetchTelemetryChange)?l.k.Warning:l.k.Error,v)}if(!m)break}if(c.isChangeGateEnabled(d.FetchTelemetryChange)){const e=!g||_!==r.None;i.Hv.sendTraceTag(574128981,a.n.msoulscat_Wac_VersionHistory,e?l.k.Error:l.k.Info,`VersionHistoryRequestManager::xhrRetry exiting loop; tryNumber: ${C} of ${n}, isError: ${e}`)}return g?_!==r.None?{errorCode:_,responseStatusCode:f,message:v,correlationId:g.headers.get("X-CorrelationId")}:g:{errorCode:_,message:v}}))()}xhr(e,t,o,s){return new Promise(((n,i)=>{const a=new XMLHttpRequest;a.open(e,t,!0),a.onload=function(){if(200===this.status)try{const e=JSON.parse(a.response);n({errorCode:r.None,data:e,correlationId:this.getResponseHeader("X-CorrelationId")})}catch(e){i(new p(this.getResponseHeader("X-CorrelationId"),r.VHXhrJsonParseFailed,this.status,`xhr: exception, statusText: ${this.statusText}, error: ${e.message}`))}else{const e=this.getResponseHeader("X-ErrorCode");i(new p(this.getResponseHeader("X-CorrelationId"),h.parseResponseError(this.status,null!=e?e:""),this.status,`xhr: failed, statusText: ${this.statusText}, X-ErrorCode: ${e}`))}},a.onerror=function(){const e=this.getResponseHeader("X-ErrorCode");i(new p(this.getResponseHeader("X-CorrelationId"),h.parseResponseError(this.status,null!=e?e:""),this.status,`xhr: onerror, statusText: ${this.statusText}, X-ErrorCode: ${e}`))},this.addXhrHeaders(o,a),a.send(s)}))}addXhrHeaders(e,t){if(e)for(const o in e)e.hasOwnProperty(o)&&t.setRequestHeader(o,e[o])}fetchRetry(e,t,o){var s=this;return _async_to_generator((function*(){let n=null,p=r.VHUnknown,u="",g=!1,m=0;for(let v=0;v<o;v+=1){c.isChangeGateEnabled(d.FetchTelemetryChange)&&(m+=1);try{n=yield fetch(e,t),n?n.ok?g=!1:(g=h.isRetriableError(s.parseServerError(n)),u=c.isChangeGateEnabled(d.FetchTelemetryChange)?`VersionHistoryRequestManager::fetchRetry status: ${n.status}, statusText: ${n.statusText}, errorCode: ${h.getResponseErrorCode(n)}, correlationId: ${n.headers.get("X-CorrelationId")}, tryNumber: ${m} of ${o}, isRetriableError: ${g}`:`fetchRetry status: ${n.status}, statusText: ${n.statusText}, errorCode: ${h.getResponseErrorCode(n)}, correlationId: ${n.headers.get("X-CorrelationId")}`,i.Hv.sendTraceTag(591934731,a.n.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(d.FetchTelemetryChange)?l.k.Warning:l.k.Error,u)):(g=!0,p=r.VHNullResponseFromFetch,u=c.isChangeGateEnabled(d.FetchTelemetryChange)?`VersionHistoryRequestManager::fetchRetry: unexpected null response from fetch, tryNumber: ${m} of ${o}`:"fetchRetry: unexpected null response from fetch.",i.Hv.sendTraceTag(591934730,a.n.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(d.FetchTelemetryChange)?l.k.Warning:l.k.Error,u))}catch(e){g=!0,p=r.VHFetchException,u=c.isChangeGateEnabled(d.FetchTelemetryChange)?`VersionHistoryRequestManager::fetchRetry fetch exception: ${e.message}}, tryNumber: ${m} of ${o}`:`fetchRetry fetch exception: ${e.message}`,i.Hv.sendTraceTag(591934732,a.n.msoulscat_Wac_VersionHistory,c.isChangeGateEnabled(d.FetchTelemetryChange)?l.k.Warning:l.k.Error,u)}if(!g)break}if(c.isChangeGateEnabled(d.FetchTelemetryChange)){const e=!n||p!==r.VHUnknown;i.Hv.sendTraceTag(574128982,a.n.msoulscat_Wac_VersionHistory,e?l.k.Error:l.k.Info,`VersionHistoryRequestManager::fetchRetry exiting loop; tryNumber: ${m} of ${o}, isError: ${e}`)}if(!n)return{errorCode:p,message:u};if(!n.ok)return{errorCode:s.parseServerError(n),responseStatusCode:n.status,message:u,correlationId:n.headers.get("X-CorrelationId")};try{const e=yield n.json();return{errorCode:r.None,data:e,correlationId:n.headers.get("X-CorrelationId")}}catch(e){return u=`fetchRetry response.json exception: ${e.message}, status: ${n.status}, statusText: ${n.statusText}`,i.Hv.sendTraceTag(591934733,a.n.msoulscat_Wac_VersionHistory,l.k.Error,u),{errorCode:r.VHFailedToParseVersionList,responseStatusCode:n.status,message:u,correlationId:n.headers.get("X-CorrelationId")}}}))()}parseServerError(e){var t;return h.parseResponseError(e.status,null!==(t=e.headers.get("X-ErrorCode"))&&void 0!==t?t:"")}static parseResponseError(e,t){let o=r.VHUnknown;switch(e){case 503:o=r.VHServiceUnavailable;break;case 502:o=r.VHBadGateway;break;case 401:o=r.VHUnauthorized;break;case 410:o=r.VHFileGone}if(o!==r.VHUnknown)return o;switch(t){case"VersioningNotEnabled":o=r.VHVersioningNotEnabled;break;case"FileNotFound":case"FileNotFound":o=r.VHFileNotFound;break;case"VersionTooOld":o=r.VHVersionTooOld;break;case"ServiceUnavailable":o=r.VHServiceUnavailable;break;case"BadGateway":o=r.VHBadGateway;break;case"Unauthorized":o=r.VHUnauthorized;break;case"InternalServerError":o=r.VHInternalServerError;break;case"EmptyVersionMetadatas":o=r.VHEmptyVersionMetadatas;break;case"FailedHostDownload":o=r.VHFailedHostDownload;break;case"FailedToAddDownloadToVersionStore":o=r.VHFailedToAddDownloadToVersionStore;break;case"FailedToCacheParts":o=r.VHFailedToCacheParts;break;case"FailedToDownloadVersionMetadata":o=r.VHFailedToDownloadVersionMetadata;break;case"FailedToDownloadParts":o=r.VHFailedToDownloadParts;break;case"InvalidDocID":o=r.VHInvalidDocID;break;case"MissingDocID":o=r.VHMissingDocID;break;case"NullDocID":o=r.VHNullDocID;break;case"NullHashedDocID":o=r.VHNullHashedDocID;break;case"NullGetDownloadAccessTokenRequest":o=r.VHNullGetDownloadAccessTokenRequest;break;case"FailedToDownloadVersionFromHost":o=r.VHFailedToDownloadVersionFromHost;break;default:o=r.VHUnknown}return o}static getResponseErrorCode(e){var t,o;return null!==(o=null!==(t=h.getResponseStatusError(e.status))&&void 0!==t?t:e.headers.get("X-ErrorCode"))&&void 0!==o?o:""}static getResponseStatusError(e){switch(e){case 503:return"ServiceUnavailable";case 502:return"BadGateway";case 401:return"Unauthorized";case 410:return"Gone"}return null}static isRetriableError(e){switch(e){case r.VHVersioningNotEnabled:case r.VHFileNotFound:case r.VHFileGone:case r.VHVersionTooOld:case r.VHInvalidDocID:case r.VHMissingDocID:case r.VHNullDocID:case r.VHNullHashedDocID:case r.VHNullHashedDocID:case r.VHUnauthorized:return!1}return!0}constructor(e,t,o,r){this._theUri="",this._serviceBase="",this._docId="",this._retryCount=3,this._wdEnableDownloadTokens=!1,this._handlerName="versions.ashx",this._vhHandlerName="versionhistory.ashx",this._handlerQueryParam="DocID",this._appId=s.NotSet,this._userSessionId="",this._serverSessionId="",this._wacCluster="",this._latestStreamServiceBase="",this._useXhr=!1,this._wdEnableDeleteVersions=!1,this._wdDisableSPOFileCache=!1,this._wdDisableODCFileCache=!1,this._wdEnableAppVHProvider=!1,this._wdDisableFileStoreAPI=!1,this._serviceBase=e,this._docId=t,this._wdEnableDownloadTokens=!!o.wdEnableDownloadTokens&&o.wdEnableDownloadTokens,this._retryCount=o.retryCount?o.retryCount:3,this._appId=o.appName?o.appName:s.NotSet,this._userSessionId=o.userSessionId?o.userSessionId:"",this._serverSessionId=o.serverSessionId?o.serverSessionId:"",this._wacCluster=o.wacCluster?o.wacCluster:"",this._latestStreamServiceBase=r||"",this._useXhr=!!o.useXhr&&o.useXhr,this._wdEnableDeleteVersions=!!o.wdEnableDeleteVersions&&o.wdEnableDeleteVersions,this._wdDisableSPOFileCache=!!o.wdDisableSPOFileCache,this._wdDisableODCFileCache=!!o.wdDisableODCFileCache,this._wdEnableAppVHProvider=!!o.wdEnableAppVHProvider,this._wdDisableFileStoreAPI=!!o.wdDisableFileStoreAPI,this.buildVersionHistoryRequestUri()}}const u=["#0078d4","#4f6bed","#e3008c","#004e8c","#005b70","#750b1c","#0b6a0b","#8764b8","#a4262c","#038387","#c239b3","#d13438","#498205","#5c2e91","#ca5010","#986f0b","#881798","#8e562e"];class g{static getInitialsColorFromName(e){if(!e)return this.getColorByIndex(0);for(let t=0;t<this.nameColorMap.length;t+=1){const o=this.nameColorMap[t];if(o.name===e)return this.getColorByIndex(o.colorIndex)}const t={name:e,colorIndex:this.getNextColorIndex()};return this.nameColorMap.push(t),this.getColorByIndex(t.colorIndex)}static getNextColorIndex(){return this.currentColorIndex=(this.currentColorIndex+1)%u.length,this.currentColorIndex}static getColorByIndex(e){return u[e%u.length]}}g.currentColorIndex=0,g.nameColorMap=[];class m{static set UILocale(e){this.uiLocale=e}static get UILocale(){return null!=this.uiLocale&&""!==this.uiLocale?this.uiLocale:"en-us"}}function v(e,t,o){return!(!e||null===t||null===o||e.length<=t||e.length<=o)&&(e.length-1!==t&&e.length-1!==o&&Intl.DateTimeFormat(m.UILocale,{month:"long",day:"numeric",year:"numeric"}).format(e[t].Time)===Intl.DateTimeFormat(m.UILocale,{month:"long",day:"numeric",year:"numeric"}).format(e[o].Time))}m.uiLocale="";class _{updateDocId(e){this._versionHistoryRequestManager.updateDocId(e)}getTipVersion(){var e=this;return _async_to_generator((function*(){const t=Date.now();i.Hv.sendTraceTag(590144346,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({event:"getTipVersion: started",startTime:t})),null!=e._perfTelemetryInfos&&e._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionStart",TelemetryEventData:t.toString()});const o=Date.now();let r=0;e._tipVersionResponse=null;let s=null;try{s=yield e._versionHistoryRequestManager.requestTipVersion()}catch(e){return r=Date.now(),i.Hv.sendTraceTag(591934734,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getTipVersion:: requestTipVersion exception",error:e.message,startTime:t,duration:r-t,versionReqDuration:r-o})),!1}const n=Date.now();if(e._tipVersionResponse=s,null!=e._perfTelemetryInfos&&e._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionEnd",TelemetryEventData:Date.now().toString()}),!s)return i.Hv.sendTraceTag(591934735,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getTipVersion: !response",error:"null response",startTime:t,duration:Date.now()-t,versionReqDuration:n-o})),!1;if(!s.data)return i.Hv.sendTraceTag(591934736,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getTipVersion: !response.data",error:`errorCode: ${s.errorCode}, errorMessage: ${s.message}`,startTime:t,duration:Date.now()-t,versionReqDuration:n-o})),!1;if(!s.data.DownloadUrl)return i.Hv.sendTraceTag(591934737,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getTipVersion: !response.data.DownloadUrl",error:"null download url",startTime:t,duration:Date.now()-t,versionReqDuration:n-o})),!1;e.Versions&&e.Versions.length>0&&!e.Versions[0].DownloadUrl&&!s.isDirty?(i.Hv.sendTraceTag(595882755,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"Storing First Version Download Url, sending TipVersionTokenReadyEvent"),_.updateVersionInfo(e.Versions[0],s.data)):i.Hv.sendTraceTag(595882756,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"No Versions list, sending TipVersionTokenReadyEvent");const c=Date.now();return e.fireTipVersionTokenReadyEvent(s.data,s.correlationID),r=Date.now(),i.Hv.sendTraceTag(590144347,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({event:"getTipVersion: ended",error:"None",startTime:t,duration:r-t,versionReqDuration:n-o,eventFireDuration:r-c,versionCount:e.Versions.length})),!0}))()}getVersions(){var e=this;return _async_to_generator((function*(){const t=Date.now();i.Hv.sendTraceTag(590144348,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({noCache:e._disableFileCache,event:"getVersions: started",startTime:t})),null!=e._perfTelemetryInfos&&e._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListStart",TelemetryEventData:t.toString()});const o=Date.now();let s=0,n=0,c=null;for(let d=0;d<3;d+=1){try{c=yield e._versionHistoryRequestManager.requestVersionHistory()}catch(c){return s=Date.now(),e.fireFullAppErrorEvent(r.VHGetVersionsException),n=Date.now(),i.Hv.sendTraceTag(591934738,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:e._disableFileCache,event:"getVersions: requestVersionHistory exception",error:c.message,startTime:t,duration:n-t,versionReqDuration:s-o,eventFireDuration:n-s})),!1}if(c&&c.data&&c.data.Versions&&c.data.Versions[0]||c&&!h.isRetriableError(c.errorCode))break}const d=Date.now();if(null!=e._perfTelemetryInfos&&e._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListEnd",TelemetryEventData:Date.now().toString()}),!c)return s=Date.now(),e.fireFullAppErrorEvent(r.VHNullResponseFromRequestVersionHistory),n=Date.now(),i.Hv.sendTraceTag(591934739,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:e._disableFileCache,event:"getVersions: !response",error:"null response",startTime:t,duration:n-t,versionReqDuration:d-o,eventFireDuration:n-s})),!1;if(!c.data)return s=Date.now(),e.fireFullAppErrorEventWithDefaultCode(c.errorCode),n=Date.now(),i.Hv.sendTraceTag(591934740,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:e._disableFileCache,event:"getVersions: !response.data",error:`errorCode: ${c.errorCode}, errorMessage: ${c.message}`,startTime:t,duration:n-t,versionReqDuration:d-o,eventFireDuration:n-s})),!1;if(!c.data.Versions)return s=Date.now(),e.fireFullAppErrorEventWithDefaultCode(c.errorCode),n=Date.now(),i.Hv.sendTraceTag(595682909,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:e._disableFileCache,event:"getVersions: !response.data.Versions",error:"null Versions",startTime:t,duration:n-t,versionReqDuration:d-o,eventFireDuration:n-s})),!1;if(!c.data.Versions[0])return s=Date.now(),e.fireFullAppErrorEventWithDefaultCode(c.errorCode),n=Date.now(),i.Hv.sendTraceTag(595682910,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:e._disableFileCache,event:"getVersions: !response.data.Versions[0]",error:"null Versions[0]",startTime:t,duration:n-t,versionReqDuration:d-o,eventFireDuration:n-s})),!1;if(e._isDisposed)return i.Hv.sendTraceTag(590127842,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:e._disableFileCache,event:"getVersions: this._isDisposed",error:"this object is disposed",startTime:t,duration:Date.now()-t,versionReqDuration:d-o})),!1;if(e.Versions=c.data.Versions?c.data.Versions.filter((e=>e.Time=new Date(e.Time.toString()))):[],e.Versions.sort(((e,t)=>e&&t&&e.Time&&t.Time?t.Time.getTime()-e.Time.getTime():0)),e.Versions.forEach((e=>_.updateAuthorColorInfo(e))),e.Versions.length>0){if(!e.Versions[0].RevisionID||e._disableFileCache||e.Versions[0].DownloadUrl||e._tipVersionResponse&&e._tipVersionResponse.data.DownloadUrl&&!e._tipVersionResponse.isDirty&&(i.Hv.sendTraceTag(595882271,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"Using stored tip version as first version downloadurl"),e.Versions[0].DownloadUrl=e._tipVersionResponse.data.DownloadUrl,e.Versions[0].WopiInfo=e._tipVersionResponse.data.WopiInfo),s=Date.now(),!e._disableFileCache&&e._cachedTokensPrefetchCount<1){const t=[];setTimeout((()=>{e.getDownloadToken(t,void 0).then((()=>{}),(()=>{}))}),500),e._cachedTokensPrefetchCount+=1,i.Hv.sendTraceTag(574660755,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"getVersions: prefetching cached URLs after version list request complete")}e.fireVersionsReadyEvent(e.Versions,c.correlationID)}return n=Date.now(),i.Hv.sendTraceTag(590144349,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({noCache:e._disableFileCache,event:"getVersions: ended",error:"None",startTime:t,duration:n-t,versionReqDuration:d-o,eventFireDuration:n-s,versionCount:e.Versions.length})),!0}))()}getDownloadToken(e,t){var o=this;return _async_to_generator((function*(){const s=Date.now();i.Hv.sendTraceTag(590144350,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({event:"getDownloadToken: started",startTime:s})),null!=o._perfTelemetryInfos&&e.length>0&&o._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenStart",TelemetryEventData:s.toString()});const n=o.getOrderedOptionalTokenList(e),c=Date.now();let d=0,p=0,h=null;try{h=yield o._versionHistoryRequestManager.requestDownloadToken(e,n),o._getCachedTokensCount+=1}catch(e){return d=Date.now(),o.fireFullAppErrorEvent(r.VHGetDownloadTokenException),p=Date.now(),i.Hv.sendTraceTag(591934741,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getDownloadToken: requestDownloadToken exception",error:e.message,startTime:s,duration:p-s,versionReqDuration:d-c,eventFireDuration:p-d})),!1}const u=Date.now();return null!=o._perfTelemetryInfos&&e.length>0&&o._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenEnd",TelemetryEventData:Date.now().toString()}),h?h.data?h.data.Versions&&h.data.Versions[0]?(t&&(t.correlationID=h.correlationID),o._isDisposed?(i.Hv.sendTraceTag(590127872,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getDownloadToken: this._isDisposed",error:"this object is disposed",startTime:s,duration:Date.now()-s,versionReqDuration:u-c})),!1):(h.data.Versions.forEach((e=>{if(e&&e.DownloadUrl){const r=o.Versions.filter((t=>t.RevisionID===e.RevisionID));r[0]&&(r[0].DownloadUrl=e.DownloadUrl,null!==e.WopiInfo&&(r[0].WopiInfo=e.WopiInfo),t&&(t.baseVersion&&t.baseVersion.RevisionID===e.RevisionID?_.updateVersionInfo(t.baseVersion,e):t.currentVersion&&t.currentVersion.RevisionID===e.RevisionID&&_.updateVersionInfo(t.currentVersion,e)))}})),d=Date.now(),o.fireDownloadTokenReadyEvent(o.Versions,t),p=Date.now(),i.Hv.sendTraceTag(590144351,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({event:"getDownloadToken ended",error:"None",startTime:s,duration:p-s,versionReqDuration:u-c,eventFireDuration:p-d,versionCount:e.length})),!0)):(h.data.Versions&&!h.data.Versions[0]&&0===e.length||(d=Date.now(),h&&h.errorCode?o.fireFullAppErrorEvent(h.errorCode):o.fireFullAppErrorEvent(r.VHFailedToGetDownloadToken),p=Date.now(),h.data.Versions?i.Hv.sendTraceTag(590127843,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getDownloadToken: !response.data.Versions[0]",error:"null Versions[0]",startTime:s,duration:p-s,versionReqDuration:u-c,eventFireDuration:p-d})):i.Hv.sendTraceTag(595907533,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getDownloadToken: !response.data.Version",error:"null Versions",startTime:s,duration:p-s,versionReqDuration:u-c,eventFireDuration:p-d}))),!1):(d=Date.now(),o.fireFullAppErrorEventWithDefaultCode(h.errorCode),p=Date.now(),i.Hv.sendTraceTag(591934743,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getDownloadToken: !response.data",error:`errorCode: ${h.errorCode}, errorMessage: ${h.message}`,startTime:s,duration:p-s,versionReqDuration:u-c,eventFireDuration:p-d})),!1):(d=Date.now(),o.fireFullAppErrorEvent(r.VHNullResponseFromRequestDownloadToken),p=Date.now(),i.Hv.sendTraceTag(591934742,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({event:"getDownloadToken: !response",error:"null response",startTime:s,duration:p-s,versionReqDuration:u-c,eventFireDuration:p-d})),!1)}))()}getOrderedOptionalTokenList(e){const t=[],o=e.length>0?e[0]:"-1",r=[],s=[];let n=!1,i=-1;const a=[];this.Versions.forEach(((e,t)=>{e.RevisionID===o?(n=!0,i=t):t>0&&!e.DownloadUrl&&!v(this.Versions,t,t-1)&&(n?r.push(e.RevisionID):s.unshift(e.RevisionID)),this._getCachedTokensCount<2&&a.length<15&&!e.DownloadUrl&&t!==i&&a.push(e.RevisionID)}));for(let e=0;e<1;e+=1){r.length>e&&!t.includes(r[e])&&t.push(r[e]),s.length>e&&!t.includes(s[e])&&t.push(s[e]);const o=i-1-e,n=i+1+e;o>=0&&!t.includes(this.Versions[o].RevisionID)&&!this.Versions[o].DownloadUrl&&t.push(this.Versions[o].RevisionID),i>=0&&n<this.Versions.length&&!t.includes(this.Versions[n].RevisionID)&&!this.Versions[n].DownloadUrl&&t.push(this.Versions[n].RevisionID)}return a.forEach((e=>{t.includes(e)||t.push(e)})),t}dispose(){this._isDisposed=!0,this.Versions=[]}deleteVersions(e){var t=this;return _async_to_generator((function*(){let o;null!=t._perfTelemetryInfos&&t._perfTelemetryInfos.push({TelemetryEventKey:"DeleteVersionsStart",TelemetryEventData:Date.now().toString()});const s=[];try{o=yield t._versionHistoryRequestManager.requestDeleteVersions(e)}catch(e){return i.Hv.sendTraceTag(589312513,a.n.msoulscat_Wac_VersionHistory,l.k.Error,`deleteVersions requestDeleteVersions exception: ${e.message}`),t.fireFullAppErrorEvent(r.VHRequestDeleteVersionsException),null}if(null!=t._perfTelemetryInfos&&t._perfTelemetryInfos.push({TelemetryEventKey:"DeleteVersionsEnd",TelemetryEventData:Date.now().toString()}),!o)return i.Hv.sendTraceTag(589312514,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"deleteVersions: unexpected null response."),t.fireFullAppErrorEvent(r.VHNullResponseFromRequestDeleteVersions),null;if(!o.data)return i.Hv.sendTraceTag(589312515,a.n.msoulscat_Wac_VersionHistory,l.k.Error,`deleteVersions: null response.data, errorCode: ${o.errorCode}, errorMessage: ${o.message}`),t.fireFullAppErrorEventWithDefaultCode(o.errorCode),null;if(!o.data.Versions)return i.Hv.sendTraceTag(589312516,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"deleteVersions failed: !response.data.Versions"),t.fireFullAppErrorEventWithDefaultCode(o.errorCode),null;o.data.Versions.forEach((e=>(null==e?void 0:e.RevisionID)?s.push(e.RevisionID):void 0));const n=e.filter((e=>!s.includes(e)));return t.Versions=t.Versions.filter((e=>!e.RevisionID||!n.includes(e.RevisionID))),s}))()}fireTipVersionTokenReadyEvent(e,t){if(this._isDisposed)return;const o={tipVersion:e,updatedVersions:this.Versions,containerDiv:document.getElementById("vhViewer"),correlationID:t};i.Hv.sendTraceTag(595882757,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"fireTipVersionTokenReadyEvent"),this._tipVersionTokenReadyEvent.fireEvent(o)}fireVersionsReadyEvent(e,t){if(this._isDisposed)return;const o={versions:e,containerDiv:document.getElementById("vhViewer"),correlationID:t};i.Hv.sendTraceTag(595914892,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"fireVersionsReadyEvent"),this._versionHistoryReadyEvent.fireEvent(o)}fireDownloadTokenReadyEvent(e,t){if(this._isDisposed)return;const o={updatedVersions:e,versionSelected:t};i.Hv.sendTraceTag(595907532,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"fireDownloadTokenReadyEvent"),this._downloadTokenReadyEvent.fireEvent(o)}fireFullAppErrorEventWithDefaultCode(e){e?this.fireFullAppErrorEvent(e):(this.fireFullAppErrorEvent(r.VHFailedToLoadVersionList),i.Hv.sendTraceTag(577380355,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:this._disableFileCache,event:"Failed to load version list"})))}fireFullAppErrorEvent(e){this._isDisposed||(i.Hv.sendTraceTag(595906849,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:this._disableFileCache,event:"Fire full app error event",error:`errorCode: ${e}`})),this._fullAppErrorEvent.fireEvent(e))}static updateVersionInfo(e,t){null!=e?null!=t?(e.DownloadUrl=t.DownloadUrl,e.WopiInfo=t.WopiInfo):i.Hv.sendTraceTag(595858567,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"updateVersionInfo, currentVersionInfo is null"):i.Hv.sendTraceTag(595858566,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"currentVersionInfo, currentVersionInfo is null")}static updateAuthorColorInfo(e){e.Authors&&e.Authors.forEach((e=>{e&&(e.InitialsColor=g.getInitialsColorFromName(e.UserName))}))}constructor(e,t,o,r,s,n,i,a,l,c){this.Versions=[],this._isDisposed=!1,this._getCachedTokensCount=0,this._cachedTokensPrefetchCount=0,this._disableFileCache=!1,this._versionHistoryRequestManager=l||new h(s,n,i,a),this._versionHistoryReadyEvent=e,this._perfTelemetryInfos=c,this._downloadTokenReadyEvent=t,this._fullAppErrorEvent=o,this._tipVersionTokenReadyEvent=r,this._disableFileCache=!!i.wdDisableSPOFileCache||!!i.wdDisableODCFileCache}}class f{fireEvent(e){this._listeners.forEach((t=>t(e)))}addListener(e){e&&this._listeners.push(e)}removeListener(e){this._listeners=this._listeners.filter((t=>t!==e))}constructor(){this._listeners=[]}}var C=o(76149),V=o(38035),D=o(5074),S=o(13163),y=o(35566);const T=(e,t=!1)=>{const o=e?H:b;return t&&(o.vhHeaderBackground=e?"#141414":"#F5F5F5"),o},b={versionCardRootSelectedBackgroundColor:"#D2D0CE",versionCardRootBackgroundColor:"#EDEBE9",versionCardRootSelectedBoxShadow:"",versionCardRootFocusSelectedBackgroundColor:"#D2D0CE",versionCardRootFocusBackgroundColor:"#EDEBE9",versionCardRootFocusBorder:"#000000",versionCardRootHoverBackground:"#E1DFDD",versionCardRootActiveBackground:"#C8C6C4",versionCardAuthorNameColor:"#252423",versionCardTimestampColor:"#252423",versionCardExpandCollapseIconColor:"#303030",errorDefaultButtonColor:"",errorDefaultButtonBorder:"",errorDefaultButtonHoverColor:"",errorDefaultButtonFocusBorder:"",errorDefaultButtonActiveColor:"",headerDefaultButtonColor:"",headerDefaultButtonBorder:"rgba(200, 198, 196, 1.0)",headerDefaultButtonFont:"",headerDefaultButtonHoverBorderColor:"",headerDefaultButtonHoverBackground:"",headerDefaultButtonHoverFont:"",headerDefaultButtonFocusBorder:"#000000",headerDefaultButtonActiveColor:"",headerDefaultButtonActiveFont:"",headerDefaultButtonActiveBorder:"",headerDefaultButtonDisabledBackground:"",headerDefaultButtonDisabledText:"",headerDefaultButtonDisabledBorder:"",spinnerBorder:"#dddddd",spinnerTopColor:"",vhViewerBackground:"#EDEBE9",vhHeaderBackground:"#F4F3F1",headerBackArrowAndIterator:"#4A4A4A",headerText:"#4A4A4A",headerIteratorTooltip:"#252423",viewerNoSelectionBackground:"#E4E4E4",viewerNoSelectionText:"#4A4A4A",viewerErrorBackground:"#EDEBE9",viewerErrorMessage:"#252423",viewerLoadingBackground:"#EDEBE9",paneBorder:"#DEDEDE",paneBackground:"#EDEBE9",paneHeaderColor:"#505050",dialogBackgroundColor:"#F3F3F3",fullAppErrorBackground:"#FFFFFF",fullAppErrorText:"#252423",appColors:{shade30:"#0e336a",shade20:"#13458f",shade10:"#1651aa",primary:"#185abd",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4"}},H={versionCardRootSelectedBackgroundColor:"#000000",versionCardRootBackgroundColor:"#1B1A19",versionCardRootSelectedBoxShadow:"",versionCardRootFocusSelectedBackgroundColor:"#000000",versionCardRootFocusBackgroundColor:"#1B1A19",versionCardRootFocusBorder:"white",versionCardRootHoverBackground:"#201F1E",versionCardRootActiveBackground:"#000000",versionCardAuthorNameColor:"#F3F2F1",versionCardTimestampColor:"#F3F2F1",versionCardExpandCollapseIconColor:"#F3F2F1",errorDefaultButtonColor:"white",errorDefaultButtonBorder:"",errorDefaultButtonHoverColor:"#F3F2F1",errorDefaultButtonFocusBorder:"",errorDefaultButtonActiveColor:"#E1DFDD",headerDefaultButtonColor:"#1B1A19",headerDefaultButtonBorder:"#484644",headerDefaultButtonFont:"#F3F2F1",headerDefaultButtonHoverBorderColor:"#161514",headerDefaultButtonHoverBackground:"#161514",headerDefaultButtonHoverFont:"#F3F2F1",headerDefaultButtonFocusBorder:"white",headerDefaultButtonActiveColor:"#000000",headerDefaultButtonActiveFont:"#F3F2F1",headerDefaultButtonActiveBorder:"#484644",headerDefaultButtonDisabledBackground:"#797775",headerDefaultButtonDisabledText:"#605E5C",headerDefaultButtonDisabledBorder:"#3B3A39",spinnerBorder:"#3B3A39",spinnerTopColor:"",vhViewerBackground:"#1B1A19",vhHeaderBackground:"#252423",headerBackArrowAndIterator:"#E1DFDD",headerText:"#E1DFDD",headerIteratorTooltip:"#F3F2F1",viewerNoSelectionBackground:"#1B1A19",viewerNoSelectionText:"#F3F2F1",viewerErrorBackground:"#1B1A19",viewerErrorMessage:"#F3F2F1",viewerLoadingBackground:"#1B1A19",paneBorder:"transparent",paneBackground:"#1B1A19",paneHeaderColor:"#F3F2F1",dialogBackgroundColor:"#000000",fullAppErrorBackground:"#1B1A19",fullAppErrorText:"#F3F2F1",appColors:{shade30:"#0e336a",shade20:"#13458f",shade10:"#1651aa",primary:"#185abd",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4"}},E=(0,S.J9)(((e,t=!1)=>({root:(0,y.Zq)({backgroundColor:T(t).dialogBackgroundColor,display:"flex",flexFlow:"row",width:"100%",height:"100%",overflow:"auto",direction:e?"rtl":"ltr"}),dialog:(0,y.Zq)({display:"flex",flexFlow:"row",width:"100%",height:"100%",minWidth:"1000px",minHeight:"200px"}),hidden:(0,y.Zq)({display:"none"}),fullAppErrorDiv:(0,y.Zq)({display:"flex",flexFlow:"column",width:"100%",height:"100%"})})));var w=o(24676),x=o(41294),I=o(83814);const F=(0,S.J9)(((e,t,o,r)=>{const s=T(e);return{root:(0,y.Zq)({display:"flex",flexFlow:"column",flexBasis:"22%",flexGrow:1,flexShrink:1.5,maxWidth:"338px",minWidth:"338px",height:"calc(100% - 2px)",border:"1px solid "+s.paneBorder,backgroundColor:s.paneBackground}),scrollRegion:(0,y.Zq)({flexFlow:"column",overflowY:"auto",overflowX:"hidden",marginBottom:"40px",marginTop:"16px"}),loadingDiv:(0,y.Zq)({display:"flex",flexGrow:1,justifyContent:"center",alignItems:"center"}),loadingSpinner:(0,y.Zq)({selectors:{"& .ms-Spinner-circle":{borderColor:s.spinnerBorder,borderTopColor:s.spinnerTopColor}}}),paneHeader:(0,y.Zq)({width:"",color:s.paneHeaderColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"15px",fontWeight:600,lineHeight:"17px",marginLeft:"12px",marginRight:"12px",marginTop:"14px",marginBottom:"4px"}),showChangesDiv:(0,y.Zq)({display:r?"block":t?"flex":"none",height:t?"":"0px",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:600,marginTop:"16px"},r?{clear:"both",width:"100%"}:{}),hidden:(0,y.Zq)({display:"none"}),changesDiv:(0,y.Zq)({display:"flex",marginBottom:"8px",paddingLeft:"16px",float:"right",marginRight:"9px"}),changesText:(0,y.Zq)({display:r?"flex":"none",height:"16px",color:s.headerText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"13px",lineHeight:"14px",marginLeft:"4px",marginRight:"4px"}),iteratorTooltip:(0,y.Zq)({color:s.headerIteratorTooltip,fontFace:"ms-fontSize-Secondary12",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px",paddingTop:"4px",shadow:"ms-depth-8"}),iteratorIcon:(0,y.Zq)({display:r?"flex":"none",height:"16px",width:"16px",color:"",justifyContent:"center",lineHeight:"14px",marginLeft:"4px",marginRight:"3px",cursor:"pointer",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{fill:"ButtonText"})}},{"svg > path.OfficeIconColors_DynamicColor":{fill:s?s.headerBackArrowAndIterator:""}}),changesCountText:(0,y.Zq)({display:r?"flex":"none",height:"16px",width:"fill-content",color:s.headerText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"13px",lineHeight:"16px",cursor:"pointer"})}}));var k=o(93339),R=o(4753);const B={overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},A=(0,S.J9)(((e,t,o,r)=>{const s=T(o);return{root:(0,y.Zq)({backgroundColor:e?s.versionCardRootSelectedBackgroundColor:s.versionCardRootBackgroundColor,marginLeft:"",marginRight:"",marginBottom:(0,R.lT)()?"-3px":"",padding:"12px 0 12px 16px",display:"flex",flexFlow:"row",outline:"none",boxShadow:e?(t?"inset -4px 0 0 ":"inset 4px 0 0 ")+s.versionCardRootSelectedBoxShadow:"",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:e?"Highlight":"ButtonFace",color:e?"HighlightText":"ButtonText",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+((0,R.lT)()?"GrayText":"LinkText"):""}),":focus":{backgroundColor:e?s.versionCardRootFocusSelectedBackgroundColor:s.versionCardRootFocusBackgroundColor,padding:"11px 0 11px 15px",border:"1px solid "+s.versionCardRootFocusBorder,boxShadow:e?(t?"inset -3px 0 0 ":"inset 3px 0 0 ")+s.versionCardRootSelectedBoxShadow:"",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText",padding:"12px 0 12px 16px",border:"none",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+((0,R.lT)()?"GrayText":"LinkText"):""})}},":hover":{backgroundColor:s.versionCardRootHoverBackground,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText"})}},":active":{backgroundColor:s.versionCardRootActiveBackground,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight"})}}}},B),cardMouseDownStyleForIE:(0,y.Zq)({position:"relative",padding:"11px 0 11px 15px",boxShadow:e?(t?"inset -3px 0 0":"inset 3px 0 0 ")+s.versionCardRootSelectedBoxShadow:"",border:"1px solid "+s.versionCardRootFocusBorder,selectors:{":hover":{backgroundColor:s.versionCardRootActiveBackground,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText",padding:"12px 0 12px 16px",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+"GrayText":"",border:"none"})}}}}),body:(0,y.Zq)({width:"100%",display:"flex",flexFlow:"column",cursor:"pointer",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"inherit"})}}),authorBold:(0,y.Zq)({display:"inline-block",fontWeight:"inherit",marginTop:""}),miniAuthorDiv:(0,y.Zq)({display:"flex",flexFlow:"row",marginLeft:"20px",marginRight:"20px",marginTop:"4px",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"inherit"})}}),authorName:(0,y.Zq)({color:s.versionCardAuthorNameColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"11px",marginLeft:"6px",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"inherit"})}}),groupContextMenuDiv:(0,y.Zq)({display:"inline-block",position:"relative",float:"right",marginRight:"16px",height:"14px",maxWidth:(0,R.lT)()?"22px":"14px"}),groupTimestampDiv:(0,y.Zq)({display:"inline-block"}),groupTimestampMenuDiv:(0,y.Zq)({display:"inline-block",width:"auto",color:s.versionCardTimestampColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontWeight:e?"600":"normal",fontSize:"11px",marginTop:"",marginLeft:"20px",marginRight:"",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"inherit"})}})}}));var N=o(31717);const L=864e5,W=6e4;function P(e,t,o){const r=t||new Date,s=(r.getTime()-e.getTime())/1e3,n=Math.floor((r.getTime()-r.getTimezoneOffset()*W)/L),c=Math.floor((e.getTime()-e.getTimezoneOffset()*W)/L),d=r.getTime()-(36e5*r.getHours()+r.getMinutes()*W+1e3*r.getSeconds())-(r.getDay()+6)%7*L,p=d-6048e5,h=p-6048e5,u=h-6048e5,g=N.namespace();if(g.setup({locale:O(),missingTranslation:"ignore"}),null!=o){if(e<=r){if(s<120)return{friendlyDateString:o.JustNow,friendlyGroupString:o.TodayVersionsLabel};if(s<3600){const t=Math.floor(s/60);return isNaN(t)?(i.Hv.sendTraceTag(594883874,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"Minutes ago is NaN, input date was: "+e.toUTCString()),{friendlyDateString:G(e),friendlyGroupString:o.TodayVersionsLabel}):{friendlyDateString:g(o.MinutesAgo,{mins:t}),friendlyGroupString:o.TodayVersionsLabel}}if(c===n){const t=Math.floor(s/3600);return isNaN(t)?(i.Hv.sendTraceTag(594883875,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"Hours ago is NaN, input date was: "+e.toUTCString()),{friendlyDateString:G(e),friendlyGroupString:o.TodayVersionsLabel}):{friendlyDateString:g(o.HoursAgo,{hours:t}),friendlyGroupString:o.TodayVersionsLabel}}if(c===n-1)return{friendlyDateString:o.YesterdayWithTime.replace("{0}",G(e)),friendlyGroupString:o.YesterdayVersionsLabel};if(e.getTime()>=d){const t=Intl.DateTimeFormat(O(),{weekday:"long"}).format(e);return{friendlyDateString:o.DateTimeComboNoAt.replace("{0}",t).replace("{1}",G(e)),friendlyGroupString:t}}if(e.getTime()>=p)return M(e,o);if(e.getTime()>=h&&e.getMonth()===r.getMonth())return M(e,o);if(e.getTime()>=u&&e.getMonth()===r.getMonth())return M(e,o);if(function(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}(e,r))return M(e,o);if(function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()-1}(e,r))return M(e,o);if(e.getFullYear()===r.getFullYear())return M(e,o);const t=Intl.DateTimeFormat(O(),{month:"long",day:"numeric",year:"numeric"}).format(e);return{friendlyDateString:o.DateTimeComboNoAt.replace("{0}",t).replace("{1}",G(e)),friendlyGroupString:t}}return{friendlyDateString:o.JustNow,friendlyGroupString:o.TodayVersionsLabel}}return i.Hv.sendTraceTag(595682912,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"localizedStrings is null. Version date: "+e.toUTCString()+", Now: "+r.toUTCString()),{friendlyDateString:Intl.DateTimeFormat(O(),{month:"long",day:"numeric",year:"numeric"}).format(e>r?r:e),friendlyGroupString:Intl.DateTimeFormat(O(),{month:"long",day:"numeric",year:"numeric"}).format(e>r?r:e)}}function M(e,t){const o=Intl.DateTimeFormat(O(),{month:"long",day:"numeric"}).format(e);return{friendlyDateString:t.DateTimeComboNoAt.replace("{0}",o).replace("{1}",G(e)),friendlyGroupString:o}}function G(e){return Intl.DateTimeFormat(O(),{hour:"numeric",minute:"numeric"}).format(e)}function O(){return m.UILocale}class U extends C.PureComponent{componentDidMount(){z.register(this)}componentWillUnmount(){z.unregister(this)}render(){return P(this.props.date,void 0,this.props.localizedStrings).friendlyDateString}}const z=new class{register(e){this.components.push(e),void 0===this.timerId&&(this.timerId=window.setInterval((()=>this.onTimerFired()),6e4))}unregister(e){this.components=this.components.filter((t=>t!==e)),this.components.length||window.clearInterval(this.timerId)}onTimerFired(){this.components.forEach((e=>e.forceUpdate()))}constructor(){this.components=[]}},j=(0,S.J9)(((e,t=!1)=>{const o=T(t).versionCardAuthorNameColor;return{authorRole:(0,y.Zq)({fontWeight:"normal",fontSize:"12px",color:o,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"inherit"})}}),authorName:(0,y.Zq)({color:o,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:600,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"inherit"})}}),colorBlock:(0,y.Zq)({backgroundColor:e,width:"8px",height:"8px",marginRight:"4px",display:"inline-block"})}}));var q,Z=o(4004);function J(e,t){return e.EmailAddress==t.EmailAddress&&e.LogOnName==t.LogOnName&&e.UserName==t.UserName}function X(e){switch(e){case n.Rename:return q.Renamed;case n.Restore:return q.Restored}return q.None}!function(e){e[e.None=0]="None",e[e.Modified=1]="Modified",e[e.Restored=2]="Restored",e[e.Renamed=4]="Renamed",e[e.ModifiedAndRestored=3]="ModifiedAndRestored",e[e.ModifiedAndRenamed=5]="ModifiedAndRenamed",e[e.RestoredAndRenamed=6]="RestoredAndRenamed",e[e.ModifiedAndRestoredAndRenamed=7]="ModifiedAndRestoredAndRenamed"}(q||(q={}));var $=o(63661);function Q(e,t){return t||e.GuestUserDisplayName}const K=C.memo((e=>{const t=Q(e.localizedStrings,e.name),o=function(e,t){return t||g.getInitialsColorFromName(e)}(t,e.color),r=j(o,(0,$.BZ)()),s=e.role?e.role:e.actionType?function(e,t){switch(e){case q.Modified:return t.UserAction;case q.Renamed:return t.UserRenameAction;case q.Restored:case q.ModifiedAndRestored:return t.UserRestoreAction}}(e.actionType,e.localizedStrings):void 0;if(s){const o=(0,Z.n)(e.localizedStrings.UserActionComboString,(e=>"0"===e?C.createElement("span",{className:r.authorName},C.createElement("span",{className:r.colorBlock,"data-is-focusable":!1}),t):"1"===e?C.createElement("span",{className:r.authorRole},s):""));return C.createElement("span",null,o)}const n=e.actionType?function(e,t){switch(e){case q.ModifiedAndRenamed:return t.UserModifyRenameActions;case q.RestoredAndRenamed:case q.ModifiedAndRestoredAndRenamed:return t.UserRestoreRenameActions}}(e.actionType,e.localizedStrings):void 0;if(n){const e=(0,Z.n)(n,(e=>"0"===e?C.createElement("span",{className:r.authorName},C.createElement("span",{className:r.colorBlock,"data-is-focusable":!1}),t):""));return C.createElement("span",{className:r.authorRole},e)}return C.createElement("span",{className:r.authorName},C.createElement("span",{className:r.colorBlock}),t)}));var Y=o(94638),ee=o(27382),te=o(30931),oe=o(51796),re=o.n(oe);const se=(0,S.J9)((e=>({contextMenuButtonStyles:{rootHasMenu:{display:"inline-flex",position:"relative",height:"16px",width:"16px",padding:"0",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"ButtonText",fill:"ButtonText"}),":hover":{selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"HighlightText",fill:"HighlightText"})}},":focus":{selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{outline:"1px Solid HighlightText"})}}},direction:e?"rtl":"ltr"},menuIcon:{width:"12px",margin:"0 2px"}},contextMenuItemStyles:{root:{fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",fontWeight:"normal",height:"auto",width:"auto",direction:e?"rtl":"ltr"}},tooltipStyle:{root:{borderWidth:"1px",borderStyle:"solid",padding:"3px",margin:0},content:{fontSize:"10px"}}}))),ne="versionHistorySprite";function ie(e,t=ne){return t+"."+e}class ae{static isEnableMenu(e,t){return ae.isDownloadEnabled(e)||ae.isDeleteEnabled(e,t)}static isDownloadEnabled(e){return!e.disableSaveACopy}static isDeleteEnabled(e,t){return e.wdEnableDeleteVersions&&!t}}class le extends C.Component{render(){const e=se(this.props.appSettings.isRtl),t=[];if(this.props.onDownloadVersionClicked&&t.push({key:"vh-download-version",name:this.props.localizedStrings.Download,styles:e.contextMenuItemStyles,onClick:this.props.onDownloadVersionClicked}),this.props.onDeleteVersionsClicked&&t.push({key:"vh-delete-versions",name:this.props.localizedStrings.Delete,styles:e.contextMenuItemStyles,onClick:this.props.onDeleteVersionsClicked}),t.length<1)return null;const o={iconName:ie(re()?re().Ellipsis_12:"")},r={items:t},s={styles:e.tooltipStyle},n={gapSpace:0,beakWidth:5,directionalHint:Y.A.topAutoEdge};return C.createElement(ee.S,{content:this.props.localizedStrings.MoreOptions,calloutProps:n,tooltipProps:s},C.createElement(te.K,{id:"vh-context-menu",componentRef:this._contextMenuRef,styles:e.contextMenuButtonStyles,ariaLabel:this.props.localizedStrings.MoreOptions,menuProps:r,menuIconProps:o}))}openMenu(){var e;null===(e=this._contextMenuRef.current)||void 0===e||e.openMenu()}constructor(){super(...arguments),this._contextMenuRef=C.createRef()}}var ce=o(30896),de=o(85073);class pe extends C.Component{render(){const{currentVersion:e,isSelected:t,ariaPosinset:o,ariaSetsize:r}=this.props,s=A(t,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName),n=[],c=function(e){const t=[];return e.Authors&&e.Authors.length>0?e.Authors.forEach((e=>{e&&t.push({type:q.Modified,author:e})})):t.push({type:q.Modified,author:{UserName:e.AuthorID}}),e.Events&&e.Events.forEach((e=>{if(e&&e.Author){let o=!1;for(const r of t)J(r.author,e.Author)&&(o=!0,r.type|=X(e.Type));o||t.push({author:e.Author,type:X(e.Type)})}})),{time:e.Time,events:t}}(e);if(!c.time)return i.Hv.sendTraceTag(594367690,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({msg:"Version missing timestamp or author",id:e.RevisionID})),!1;c.events.forEach((t=>{if(t){const o=`${e.RevisionID}_${(0,D.O)()}`;n.push(C.createElement("div",{className:s.miniAuthorDiv},C.createElement(K,{key:o,name:t.author.UserName,color:t.author.InitialsColor,actionType:t.type,localizedStrings:this.props.localizedStrings})))}}));const d=C.createElement(U,{date:c.time,localizedStrings:this.props.localizedStrings});return C.createElement("div",_object_spread({ref:this._root,id:"vhCard"+this.props.currentVersion.RevisionID,onClick:this.onClick,className:s.root,"data-is-focusable":!0,"data-unique-id":this.props.currentVersion.RevisionID,"aria-selected":t,role:"treeitem","aria-posinset":o,"aria-setsize":r,onKeyDown:this.onKeyDownInCard},(0,ce.lT)()?{onMouseDown:this.onCardMouseDownHandlerForIE,onMouseUp:this.onCardMouseUpHandlerForIE}:{}),C.createElement("div",{className:s.body},C.createElement("div",{className:s.groupTimestampMenuDiv},C.createElement("div",{className:s.groupTimestampDiv},d),this.isShowContextMenu()&&C.createElement("div",{className:s.groupContextMenuDiv},this.getVersionHistoryContextMenu())),C.createElement("div",{className:s.authorBold},n)))}isShowContextMenu(){return ae.isEnableMenu(this.props.appSettings,this.props.isTipVersion)&&this.props.isSelected}getVersionHistoryContextMenu(){return C.createElement(le,{ref:this._contextMenu,appSettings:this.props.appSettings,localizedStrings:this.props.localizedStrings,onDownloadVersionClicked:ae.isDownloadEnabled(this.props.appSettings)?this.onDownloadVersionClicked:void 0,onDeleteVersionsClicked:ae.isDeleteEnabled(this.props.appSettings,this.props.isTipVersion)?this.onDeleteVersionsClicked:void 0})}constructor(e){super(e),this._root=C.createRef(),this._rootHTMLElement=null,this._contextMenu=C.createRef(),this.onFocus=()=>{this._root.current&&(this._root.current.tabIndex=-1,this._root.current.focus(),this._rootHTMLElement||(this._rootHTMLElement=document.getElementById(this._root.current.id)),this._rootHTMLElement&&(0,k.Fy)(!0,this._rootHTMLElement))},this.onClick=()=>{const e={currentVersion:this.props.currentVersion,baseVersion:this.props.baseVersion,noBaseToCompareTo:!this.props.baseVersion};this.props.onVersionSelectedAction(e),i.Hv.sendTraceTag(595632832,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"User manually selected a version"),(0,de.logUserAction)("VersionHistorySelectVersion")},this.onContextMenu=e=>{var t;e.preventDefault(),null===(t=this._contextMenu.current)||void 0===t||t.openMenu()},this.onKeyDownInCard=e=>{e.shiftKey&&(e.which||e.keyCode)===w.c.f10?this.onContextMenu(e):(e.which===w.c.left&&!this.props.appSettings.isRtl||e.which===w.c.right&&this.props.appSettings.isRtl)&&this.props.onLeftButton&&this.props.onLeftButton()},this.onCardMouseDownHandlerForIE=()=>{const e=A(this.props.isSelected,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName);this._root&&this._root.current&&this._root.current.classList.toggle(e.cardMouseDownStyleForIE)},this.onCardMouseUpHandlerForIE=()=>{const e=A(this.props.isSelected,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName);this._root&&this._root.current&&(this._root.current.classList.toggle(e.cardMouseDownStyleForIE),this._root.current.focus())},this.onDownloadVersionClicked=()=>{var e;this.props.onDownloadVersionSelectedAction&&(i.Hv.sendTraceTag(592316623,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"Download clicked."),this.props.onDownloadVersionSelectedAction(null!==(e=this.props.currentVersion.DownloadUrl)&&void 0!==e?e:""))},this.onDeleteVersionsClicked=()=>{this.props.onDeleteVersionsSelectedAction&&this.props.currentVersion.RevisionID&&(i.Hv.sendTraceTag(590147736,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"DeleteVersions clicked."),this.props.onDeleteVersionsSelectedAction([this.props.currentVersion.RevisionID]))}}}var he=o(40114);const ue=(0,S.J9)(((e,t,o,r)=>{const s=T(o),n={height:"16px",width:"16px",color:s.versionCardExpandCollapseIconColor,lineHeight:"16px",verticalAlign:"center",display:"none",cursor:"pointer"},i={display:"flex",width:"auto",padding:"15px 0 15px 11px",border:"1px solid transparent",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:e?"Highlight":"ButtonFace",color:e?"HighlightText":"ButtonText",fill:e?"HighlightText":"ButtonText"}),"svg > path.OfficeIconColors_m22":{selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{fill:e?"HighlightText !important":"ButtonText !important"})}},":hover":{backgroundColor:s.versionCardRootHoverBackground,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText",fill:"HighlightText"})}},":hover svg > path.OfficeIconColors_m22":{selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{fill:"HighlightText !important"})}},":focus":{outline:"0",border:"1px solid "+s.versionCardRootFocusBorder,boxShadow:e?(t?"inset -3px 0 0 ":"inset 3px 0 0 ")+s.versionCardRootSelectedBoxShadow:"",padding:"15px 0 15px 11px",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText",fill:"HighlightText",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+((0,R.lT)()?"GrayText":"LinkText"):"",border:"none",padding:"16px 0 16px 12px"})}},":focus svg > path.OfficeIconColors_m22":{selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{fill:"HighlightText !important"})}},":active":{backgroundColor:s.versionCardRootActiveBackground,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText",fill:"HighlightText"})}},":active svg > path.OfficeIconColors_m22":{selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{fill:"HighlightText !important"})}}}};return{toggleSpan:(0,y.Zq)({flexBasis:"16px",height:"16px",width:"16px"}),sectionName:(0,y.Zq)({display:"inline-flex",color:s.versionCardTimestampColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"15px",fontWeight:"normal",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"inherit"})}}),sectionHeaderFocusBackground:(0,y.Zq)({padding:"15px 0 15px 11px",boxShadow:e?(t?"inset -3px 0 0 ":"inset 3px 0 0 ")+s.versionCardRootSelectedBoxShadow:"",backgroundColor:e?s.versionCardRootSelectedBackgroundColor:s.versionCardRootFocusBackgroundColor,border:"1px solid "+s.versionCardRootFocusBorder,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{boxShadow:e?(t?"inset -6px 0 0":"inset 6px 0 0 ")+((0,R.lT)()?"GrayText":"LinkText"):"",border:"none",padding:"16px 0 16px 12px"})}},i),sectionHeader:(0,y.Zq)({boxShadow:e?(t?"inset -4px 0 0 ":"inset 4px 0 0 ")+s.versionCardRootSelectedBoxShadow:"",backgroundColor:e?s.versionCardRootSelectedBackgroundColor:s.versionCardRootBackgroundColor,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{boxShadow:e?(t?"inset -6px 0 0":"inset 6px 0 0 ")+((0,R.lT)()?"GrayText":"LinkText"):""})}},i),sectionHeaderMouseDownStyleForIE:(0,y.Zq)({position:"relative",padding:"15px 0 15px 11px",boxShadow:e?(t?"inset -3px 0 0 ":"inset 3px 0 0 ")+s.versionCardRootSelectedBoxShadow:"",border:"1px solid "+s.versionCardRootFocusBorder,selectors:{":hover":{backgroundColor:s.versionCardRootActiveBackground,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText",padding:"16px 0 16px 12px",boxShadow:e?(t?"inset -6px 0 0 ":"inset 6px 0 0 ")+"GrayText":"",border:"none"})}}}}),sectionNameDiv:(0,y.Zq)({width:"",flexBasis:"calc(100% - 20px)",color:s.versionCardTimestampColor,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",verticalAlign:"center",lineHeight:"16px",cursor:"pointer",marginRight:"8px",marginLeft:"8px",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"inherit"})}}),currentVersionDiv:(0,y.Zq)({fontSize:"12px",paddingTop:"4px",fontWeight:"normal",paddingBottom:"2px"}),authorsList:(0,y.Zq)({fontSize:"12px",marginTop:"4px",fontWeight:"normal"}),expand:(0,y.Zq)(_object_spread_props(_object_spread({},n),{display:"none"}),{"svg > path.OfficeIconColors_m22":{fill:s?s.versionCardExpandCollapseIconColor:""}}),collapse:(0,y.Zq)(_object_spread_props(_object_spread({},n),{display:"inline-block"}),{"svg > path.OfficeIconColors_m22":{fill:s?s.versionCardExpandCollapseIconColor:""}}),versionList:(0,y.Zq)({display:"none"}),contextMenuDiv:(0,y.Zq)({display:"inline-block",position:"relative",float:"right",top:"",marginRight:"8px",height:"16px",width:"16px",maxWidth:(0,R.lT)()?"22px":"16px"}),timestampDiv:(0,y.Zq)({display:"inline-block"}),versionItemDiv:(0,y.Zq)({display:"inline-block",width:"100%",padding:0,border:"none"})}}));var ge=o(11965);class me extends C.PureComponent{render(){const e=ue(this.props.selectedGroupName===this.props.label,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName),{versions:t}=this.props;this._groupVersion=_object_spread({},this.props.currentSectionVersion);const o=this.renderAndSetAuthorList();this.props.selectedGroupName===this._groupVersion.RevisionID&&this.onSectionSelected(),this.setDescribedBy();let r="";this.props.versions.forEach((e=>{r+="vhCard"+e.RevisionID+" "}));let s=this.props.clickableGroupDisplayString;return this.props.containsTip&&(s=this.props.localizedStrings.CurrentVersionGroupHeaderAriaText.replace("{0}",this.props.clickableGroupDisplayString)),C.createElement(C.Fragment,null,t.length>0&&C.createElement("div",{id:this._id+"GroupDiv"},C.createElement("div",_object_spread_props(_object_spread({id:this._id+"GroupHeaderDiv",className:1===this.props.positionInSet?[e.sectionHeader,this.props.classNameForItemToBeDefaultFocused].join(" "):e.sectionHeader,onKeyDown:this.onKeyDownInSectionHeader,"aria-label":s,role:"treeitem","aria-expanded":"false",ref:this._header,"aria-level":1,"aria-owns":r,"aria-posinset":this.props.positionInSet,"aria-setsize":this.props.subsectionCount,"data-is-focusable":!0,onClick:this.onSectionClicked},(0,ce.lT)()?{onMouseDown:this.onSectionHeaderMouseDownHandlerForIE,onMouseUp:this.onSectionHeaderMouseUpHandlerForIE}:{onFocus:this.onSectionHeaderFocus,onBlur:this.onSectionHeaderBlur}),{"aria-describedby":this._headerDescribedBy,"aria-selected":this.props.selectedGroupName===this.props.label}),this.renderToggleSpan(e),C.createElement("div",{className:e.sectionNameDiv},C.createElement("div",{className:e.sectionName,id:this._id+"DisplayString"},C.createElement("div",{className:e.timestampDiv},this.props.clickableGroupDisplayString)),this.isShowContextMenu()&&C.createElement("div",{className:e.contextMenuDiv},C.createElement(le,{ref:this._contextMenu,appSettings:this.props.appSettings,localizedStrings:this.props.localizedStrings,onDownloadVersionClicked:ae.isDownloadEnabled(this.props.appSettings)?this.onDownloadVersionClicked:void 0,onDeleteVersionsClicked:ae.isDeleteEnabled(this.props.appSettings,this.props.containsTip)?this.onDeleteVersionsClicked:void 0})),this.props.containsTip&&C.createElement("div",{className:e.currentVersionDiv,id:this._id+"Tip"},this.props.localizedStrings.CurrentVersion),o)),this.renderVersionCardList(e)))}componentDidUpdate(){}expandOrCollapseSubsection(e){this.displayElement(!e,document.getElementById(this._id+"IconCollapse")),this.displayElement(!e,document.getElementById(this._id+"AuthorList")),this.displayElement(e,document.getElementById(this._id)),this.displayElement(e,document.getElementById(this._id+"IconExpand"));const t=this._header.current;this.setAriaExpanded(e,t);const o=this._chevronButton.current;this.setAriaExpanded(e,o),this._isExpanded=e,this.setDescribedBy(),e?i.Hv.sendTraceTag(595632607,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"group section expanded"):i.Hv.sendTraceTag(595632608,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"group section collapsed")}constructor(){super(...arguments),this._list=C.createRef(),this._id=(0,D.O)(),this._header=C.createRef(),this._chevronButton=C.createRef(),this._headerHTMLElement=null,this._groupVersion=void 0,this._isExpanded=!1,this._firstVersionCard=void 0,this._headerDescribedBy="",this._contextMenu=C.createRef(),this.isShowContextMenu=()=>ae.isEnableMenu(this.props.appSettings,this.props.containsTip)&&this.props.selectedGroupName===this.props.label,this.onDownloadVersionClicked=()=>{var e;i.Hv.sendTraceTag(593293320,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"Download clicked."),this.props.onDownloadVersionSelectedAction(null!==(e=this.props.currentSectionVersion.DownloadUrl)&&void 0!==e?e:"")},this.onDeleteVersionsClicked=()=>{i.Hv.sendTraceTag(590147735,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"DeleteVersions clicked.");const e=[];this.props.versions.forEach((t=>t.RevisionID?e.push(t.RevisionID):void 0)),this.props.onDeleteVersionsSelectedAction(e)},this.setDescribedBy=()=>{this._isExpanded?this._headerDescribedBy="":this._headerDescribedBy=this._id+"DisplayString "+this._id+"AuthorList",this.props.containsTip&&(this._headerDescribedBy+=" "+this._id+"Tip"),this._header&&this._header.current&&this._header.current.setAttribute("aria-describedby",this._headerDescribedBy)},this.onSectionHeaderFocus=()=>{const e=ue(this.props.selectedGroupName===this.props.label,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName);this._header&&this._header.current&&(this._header.current.className=e.sectionHeaderFocusBackground)},this.onSectionHeaderBlur=()=>{const e=ue(this.props.selectedGroupName===this.props.label,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName);this._header&&this._header.current&&(this._header.current.className=e.sectionHeader)},this.onSectionHeaderMouseDownHandlerForIE=()=>{const e=ue(this.props.selectedGroupName===this.props.label,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName);this._header&&this._header.current&&this._header.current.classList.toggle(e.sectionHeaderMouseDownStyleForIE)},this.onSectionHeaderMouseUpHandlerForIE=()=>{const e=ue(this.props.selectedGroupName===this.props.label,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName);this._header&&this._header.current&&(this._header.current.classList.toggle(e.sectionHeaderMouseDownStyleForIE),this._header.current.focus())},this.renderToggleSpan=e=>C.createElement("span",{className:e.toggleSpan,ref:this._chevronButton,"aria-expanded":"false",role:"button",onClick:this.onSectionIconClick,"aria-label":this.props.localizedStrings.ExpandCollapseChevronButtonAriaLabel.replace("{0}",this.props.clickableGroupChevronAriaLabel)},C.createElement(ge.I,{id:this._id+"IconExpand",className:e.expand,iconName:ie(re()?re().CommonControlChevronDown_16:"")}),C.createElement(ge.I,{id:this._id+"IconCollapse",className:e.collapse,iconName:ie(re()?this.props.appSettings.isRtl?re().CommonControlChevronLeft_16:re().CommonControlChevronRight_16:"")})),this.renderVersionCardList=e=>C.createElement(he.B,{id:this._id,className:e.versionList,ref:this._list,items:this.props.versions,onRenderCell:this.onRenderListItem,onShouldVirtualize:this.onShouldVirtualize,getKey:this.getListItemKey,role:"presentation"}),this.renderAndSetAuthorList=()=>{const e=ue(this.props.selectedGroupName===this.props.label,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName),t=function(e,t){const o=[];return e.forEach((e=>{if(e.Authors&&e.Authors.length>0)e.Authors.forEach((e=>{e&&(o.some((t=>J(t,e)))||o.push(e))}));else{const r=Q(t,e.AuthorID);if(o.some((e=>e.UserName===r)))return;const s={UserName:r};o.push(s)}e.Events&&e.Events.forEach((e=>{if(e&&e.Author){const r=e.Author;if(void 0===r.UserName||null===r.UserName){const e=Q(t,r.UserName);if(o.some((t=>t.UserName===e)))return}if(o.some((e=>J(e,r))))return;o.push(r)}}))})),o}(this.props.versions,this.props.localizedStrings);let o=[];switch(t.length){case 0:i.Hv.sendTraceTag(595644672,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"there were no authors to display");break;case 1:o=this.render1To4Authors(this.props.localizedStrings.OneUserAuthorList,t);break;case 2:o=this.render1To4Authors(this.props.localizedStrings.TwoUserAuthorList,t);break;case 3:o=this.render1To4Authors(this.props.localizedStrings.ThreeUserAuthorList,t);break;case 4:o=this.render1To4Authors(this.props.localizedStrings.FourUserAuthorList,t);break;default:o=(0,Z.n)(this.props.localizedStrings.FivePlusUserAuthorList,(e=>"3"===e?(t.length-3).toString():this.renderAuthor(t[parseInt(e,10)])))}return this._groupVersion&&(this._groupVersion.Authors=t),C.createElement("div",{id:this._id+"AuthorList",className:e.authorsList},o)},this.render1To4Authors=(e,t)=>(0,Z.n)(e,(e=>this.renderAuthor(t[parseInt(e,10)]))),this.renderAuthor=e=>C.createElement(K,{name:e.UserName,color:e.InitialsColor,localizedStrings:this.props.localizedStrings}),this.getListItemKey=(e,t)=>e.RevisionID||"",this.getBaseVersion=(e,t,o)=>{let r=null;return t.forEach(((s,n)=>{s===e&&(r=n!==t.length-1?t[n+1]:o)})),r},this.onShouldVirtualize=()=>!1,this._commonCardProps={localizedStrings:this.props.localizedStrings,onVersionSelectedAction:this.props.onVersionSelectedAction},this.onRenderListItem=(e,t)=>{if(void 0===e)return;const o=ue(this.props.selectedGroupName===this.props.label,this.props.appSettings.isRtl,(0,$.BZ)(),this.props.appSettings.appName),r=new pe({localizedStrings:this._commonCardProps.localizedStrings,currentVersion:e,baseVersion:this.getBaseVersion(e,this.props.versions,this.props.finalBaseVersion),isSelected:!this.props.selectedGroupName&&this.props.selectedVersionId===e.RevisionID,ariaPosinset:void 0!==t?t+1:0,ariaSetsize:this.props.versions.length,appSettings:this.props.appSettings,isTipVersion:0===t&&this.props.containsTip,onVersionSelectedAction:this._commonCardProps.onVersionSelectedAction,onLeftButton:this.programaticFocus,onDownloadVersionSelectedAction:this.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:this.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:this.props.onDeleteVersionsSelectedAction});return 0===t&&(this._firstVersionCard=r),C.createElement("div",{className:o.versionItemDiv,role:"presentation"},r.render())},this.onSectionIconClick=e=>{this.expandOrCollapseSubsection(!this.isListVisible()),e.stopPropagation()},this.onSectionClicked=()=>{i.Hv.sendTraceTag(595632606,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"group section header manually selected"),(0,de.logUserAction)("VersionHistorySelectVersionGroup"),this.onSectionSelected()},this.onSectionSelected=()=>{const e={currentVersion:this._groupVersion?this._groupVersion:this.props.currentSectionVersion,baseVersion:this.props.finalBaseVersion,groupName:this.props.label,noBaseToCompareTo:!this.props.finalBaseVersion};this.props.onVersionSelectedAction(e),this.isListVisible()&&this.expandOrCollapseSubsection(!1),this.props.appSettings.wdEnableDeleteVersions&&this.programaticFocus()},this.isListVisible=()=>{const e=document.getElementById(this._id);return null!=e&&"block"===e.style.display},this.onContextMenu=e=>{var t;e.preventDefault(),null===(t=this._contextMenu.current)||void 0===t||t.openMenu()},this.onKeyDownInSectionHeader=e=>{e.shiftKey&&(e.which||e.keyCode)===w.c.f10?this.onContextMenu(e):(e.which===w.c.left&&!this.props.appSettings.isRtl||e.which===w.c.right&&this.props.appSettings.isRtl?this.expandOrCollapseSubsection(!1):(e.which===w.c.right&&!this.props.appSettings.isRtl||e.which===w.c.left&&this.props.appSettings.isRtl)&&(this._isExpanded?this._firstVersionCard&&this._firstVersionCard.onFocus():this.expandOrCollapseSubsection(!0)),e.which===w.c.enter&&this.onSectionSelected())},this.programaticFocus=()=>{this._header&&this._header.current&&(this._header.current.focus(),this._headerHTMLElement||(this._headerHTMLElement=document.getElementById(this._header.current.id)),this._headerHTMLElement&&(0,k.Fy)(!0,this._headerHTMLElement))},this.displayElement=(e,t)=>{t&&(t.style.display=e?"block":"none")},this.setAriaExpanded=(e,t)=>{null==t||t.setAttribute("aria-expanded",e?"true":"false")}}}const ve=(0,S.J9)((()=>({nothingFoundRoot:(0,y.Zq)({display:"flex",flex:"none",margin:"1px 8px"}),nothingFoundText:(0,y.Zq)({padding:"14px",textAlign:"center",margin:"0 auto"})})));var _e=o(10457),fe=o(56226);class Ce extends C.PureComponent{render(){const e=ve(),{localizedStrings:t,versions:o}=this.props,r=[];o.forEach(((e,s)=>{const n=P(e.Time,void 0,t),i=n.friendlyGroupString,a=r.length,l=a>0&&r[a-1].versions.length>0?r[a-1].startIndex:null;0===a?r.push({versions:[e],label:i,startIndex:s,clickableGroupDisplayString:n.friendlyDateString,clickableGroupChevronAriaLabel:n.friendlyGroupString,finalBaseVersion:null,currentSectionVersion:e,containsTip:!0}):v(o,l,s)?r[a-1].versions.push(e):(r[a-1].finalBaseVersion=e,r.push({versions:[e],label:s===o.length-1?i+"_2":i,startIndex:s,clickableGroupDisplayString:n.friendlyDateString,clickableGroupChevronAriaLabel:n.friendlyGroupString,finalBaseVersion:null,currentSectionVersion:e,containsTip:!1}))})),this.props.selectedVersionId||i.Hv.sendTraceTag(587544262,a.n.msoulscat_Wac_VersionHistory,l.k.Info,JSON.stringify({msg:"Grouped section generated",versionCount:o.length,groupCount:r.length}));const s={selectedVersionId:this.props.selectedVersionId,localizedStrings:this.props.localizedStrings,appSettings:this.props.appSettings,onVersionSelectedAction:this.props.onVersionSelectedAction,onDownloadVersionSelectedAction:this.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:this.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:this.props.onDeleteVersionsSelectedAction};return C.createElement(C.Fragment,null,o.length?C.createElement(_e.R,{direction:fe.E.vertical,role:"tree"},r.length>0&&r.map(((e,t)=>C.createElement(me,_object_spread({key:e.label,label:e.label,clickableGroupDisplayString:e.clickableGroupDisplayString,clickableGroupChevronAriaLabel:e.clickableGroupChevronAriaLabel,versions:e.versions,finalBaseVersion:e.finalBaseVersion,currentSectionVersion:e.currentSectionVersion,selectedGroupName:this.props.selectedGroupName,containsTip:e.containsTip,positionInSet:t+1,subsectionCount:r.length,classNameForItemToBeDefaultFocused:this.props.classNameForItemToBeDefaultFocused},s))))):C.createElement("div",{className:e.nothingFoundRoot,tabIndex:0,"aria-labelledby":this._nothingFoundId,role:"note"},C.createElement("div",{className:e.nothingFoundText,id:this._nothingFoundId,"aria-hidden":!0},t.VersionHistoryTitle)))}constructor(){super(...arguments),this._nothingFoundId=(0,D.O)()}}var Ve=o(47786),De=o(24803),Se=o(1464);class ye extends C.PureComponent{render(){const e=F((0,$.BZ)(),this.props.appSettings.wdEnableShowVersionChanges,this.props.appSettings.appName,this.isIteratorEnabled()),{localizedStrings:t}=this.props;return C.createElement(Ve.Y,{componentRef:this._ftzone,onKeyDown:this.onKeyDown,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,firstFocusableSelector:this._classNameForItemToBeDefaultFocused,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._paneDescribedById,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderStandardListView(),C.createElement("div",{id:this._paneDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle))}iteratorBackIcon(){return re()?this.props.appSettings.isRtl?re().NextChevronPaddle_24:re().BackChevronPaddle_24:""}iteratorNextIcon(){return re()?this.props.appSettings.isRtl?re().BackChevronPaddle_24:re().NextChevronPaddle_24:""}renderIteratorSection(e,t,o,r){if(!r)return;const s=0===this.props.totalChangesCount?this.props.localizedStrings.IteratorPreviousButtonNoEditsString:this.props.localizedStrings.IteratorPreviousButtonXEditsString.replace("{0}",this.props.totalChangesCount.toString()),n={styles:{content:{color:T((0,$.BZ)()).headerIteratorTooltip}}},i={root:{display:"inline-block"}};return C.createElement("div",{ref:this._iteratorRef,className:e.changesDiv},C.createElement("div",{id:"CountText",className:e.changesCountText,title:t,"aria-label":o},this.props.localizedStrings.IteratorEditsCountLabel.replace("{0}",this.props.currentChange.toString()).replace("{1}",this.props.totalChangesCount.toString())),C.createElement(ee.S,{content:0===this.props.totalChangesCount?t:this.props.localizedStrings.IteratorPreviousEditButtonLabel,directionalHint:Y.A.topCenter,className:e.iteratorTooltip,tooltipProps:n,styles:i},C.createElement(ge.I,{id:"iterateBack",className:e.iteratorIcon,tabIndex:0,"aria-label":this.props.localizedStrings.IteratorPreviousEditButtonLabel+" . "+s,role:"button",iconName:ie(this.iteratorBackIcon()),onClick:this.onIteratorPrevClick,onKeyDown:this.onIteratorPrevKeyDown})),C.createElement(ee.S,{content:0===this.props.totalChangesCount?void 0:this.props.localizedStrings.IteratorNextEditButtonLabel,directionalHint:Y.A.topCenter,className:e.iteratorTooltip,tooltipProps:n,styles:i},C.createElement(ge.I,{id:"iterateFront",className:e.iteratorIcon,title:t,"aria-label":this.props.localizedStrings.IteratorNextEditButtonLabel,role:"button",tabIndex:0===this.props.totalChangesCount?void 0:0,iconName:ie(this.iteratorNextIcon()),onClick:this.onIteratorNextClick,onKeyDown:this.onIteratorNextKeyDown})))}constructor(){super(...arguments),this._ftzone=C.createRef(),this._paneDescribedById="versionHistoryPane",this._classNameForItemToBeDefaultFocused="classNameForItemToBeDefaultFocused",this._iteratorRef=C.createRef(),this.getToggleStyles=()=>({root:{height:16,marginLeft:12,float:"left",display:"flex"},label:{fontSize:13,order:0,marginLeft:0,marginRight:5,marginBottom:4,color:(0,$.BZ)()?"white":""},pill:{width:32,height:14,borderRadius:7,marginBottom:1},thumb:{width:4,height:4,borderRadius:"50%"},text:{display:"none"}}),this.getToggleTheme=()=>{const e=T((0,$.BZ)());return(0,$.BZ)()?{palette:{themePrimary:e.appColors.primary,themeSecondary:e.appColors.tint10,themeDark:e.appColors.shade10,neutralDark:e.appColors.shade20}}:{palette:{themePrimary:e.appColors.primary,themeSecondary:e.appColors.tint10,themeDark:e.appColors.shade10,neutralDark:e.appColors.shade20},semanticColors:{inputBackgroundChecked:e.appColors.tint10}}},this.renderStandardListView=()=>{const e=F((0,$.BZ)(),this.props.appSettings.wdEnableShowVersionChanges,this.props.appSettings.appName,this.isIteratorEnabled()),{paneLoading:t,versions:o,viewerLoading:r,viewerError:s,selectedVersionId:n}=this.props,i=!!this.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete&&(r||s),a={localizedStrings:this.props.localizedStrings,selectedVersionId:this.props.selectedVersionId,onVersionSelectedAction:this.props.onVersionSelectedAction,appSettings:this.props.appSettings},l=!(t||void 0===n||i),c=this.isIteratorEnabled()&&l&&this.props.totalChangesCount>=0&&this.props.currentChange<=this.props.totalChangesCount&&!this.props.viewerLoading,d=0===this.props.totalChangesCount?this.props.localizedStrings.IteratorNoEditsToolTip:"",p=0===this.props.totalChangesCount?d:this.props.localizedStrings.IteratorTotalEditsLabel.replace("{0}",this.props.localizedStrings.IteratorEditsCountLabel.replace("{0}",this.props.currentChange.toString()).replace("{1}",this.props.totalChangesCount.toString())),h=C.createElement(De.l,{theme:(0,Se.a)(this.getToggleTheme()),styles:this.getToggleStyles(),defaultChecked:!0,label:this.props.localizedStrings.ShowEditsText,inlineLabel:!0,onChange:this.onShowVersionChangesChange,disabled:!l});return C.createElement(C.Fragment,null,C.createElement("div",{className:e.paneHeader},a.localizedStrings.VersionHistoryTitle),C.createElement("div",{className:e.showChangesDiv},h,c&&this.props.isChangesToggleOn?this.renderIteratorSection(e,d,p,this.isIteratorEnabled()):""),t?C.createElement("div",{className:e.loadingDiv},C.createElement(x.y,{className:e.loadingSpinner,size:I.H.large})):C.createElement("div",{className:e.scrollRegion},C.createElement(Ce,_object_spread_props(_object_spread({versions:o,selectedGroupName:this.props.selectedGroupName,classNameForItemToBeDefaultFocused:this._classNameForItemToBeDefaultFocused},a),{onDownloadVersionSelectedAction:this.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:this.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:this.props.onDeleteVersionsSelectedAction}))))},this.focus=()=>this._ftzone.current&&this._ftzone.current.focus(),this.isIteratorEnabled=()=>!!this.props.appSettings.wdEnableIterator&&this.props.appSettings.wdEnableIterator,this.onIteratorPrevKeyDown=e=>{e.which!==w.c.enter&&e.which!==w.c.space||this.onIteratorPrevClick()},this.onIteratorNextKeyDown=e=>{e.which!==w.c.enter&&e.which!==w.c.space||this.onIteratorNextClick()},this.onIteratorNextClick=()=>{this.props.totalChangesCount>0&&(i.Hv.sendTraceTag(595648670,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"Iterator Next clicked-current count:"+this.props.currentChange.toString()+" ,total count:"+this.props.totalChangesCount.toString()),(0,de.logUserAction)("IteratorClicked"),this.props.onIteratorSelectedAction(!0))},this.onIteratorPrevClick=()=>{this.props.totalChangesCount>0&&(i.Hv.sendTraceTag(595648671,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"Iterator Previous clicked-current count:"+this.props.currentChange.toString()+" ,total count:"+this.props.totalChangesCount.toString()),(0,de.logUserAction)("IteratorClicked"),this.props.onIteratorSelectedAction(!1))},this.onKeyDown=e=>{e.which!==w.c.up&&e.which!==w.c.down||e.preventDefault()},this.onShowVersionChangesChange=(e,t)=>{void 0!==t&&(t?(i.Hv.sendTraceTag(595637793,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"Toggle Changes diffs turned on"),this._iteratorRef&&this._iteratorRef.current&&(this._iteratorRef.current.style.display="flex")):(i.Hv.sendTraceTag(595637794,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"Toggle Changes diffs turned off"),this._iteratorRef&&this._iteratorRef.current&&(this._iteratorRef.current.style.display="none")),this.props.onShowVersionChangesToggledAction(t),this.props.onShowChangesToggle(t))}}}var Te=o(46278),be=o(17813);const He=(0,S.J9)(((e,t,o,r,s,n=!1,i=!1,a=!1)=>{const l=T(o,r);return{root:(0,y.Zq)({display:"flex",flexBasis:"78%",flexFlow:"column",minWidth:"400px",flexGrow:1.5,flexShrink:1,height:"100%"}),vhHeader:(0,y.Zq)({height:"48px",width:"100%",backgroundColor:l.vhHeaderBackground,display:"flex"}),vhViewContainer:(0,y.Zq)({backgroundColor:l.vhViewerBackground,flexDirection:"column",flexGrow:1,width:"100%",display:"flex",position:a?"relative":"static"}),vhViewer:(0,y.Zq)({backgroundColor:l.vhViewerBackground,flexDirection:"column",flexGrow:1,width:"100%",display:e||t?"none":"flex",position:a?"relative":"static"}),backArrow:(0,y.Zq)({height:"20px",width:"20px",color:"",marginLeft:"8px",marginRight:"8px",minWidth:"20px",cursor:"pointer",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{fill:"ButtonText"})}}),icon:(0,y.Zq)({flex:"none",marginTop:"3px",width:"16px",height:"16px"}),backToDoc:(0,y.Zq)({height:"16px",whiteSpace:"nowrap",color:l.headerBackArrowAndIterator,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"16px",cursor:"pointer",marginRight:"8px",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"ButtonText"})}}),unselectedVersion:(0,y.Zq)({fontStyle:"italic"}),selectedVersionTime:(0,y.Zq)({color:l.headerText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",fontWeight:600,lineHeight:"16px",marginLeft:"10px",marginRight:"10px"}),IteratorIconButton:(0,y.Zq)({display:"flex",height:"16px",width:"16px",color:"",justifyContent:"center",lineHeight:"16px",marginLeft:"12px",marginRight:"12px",cursor:"pointer",selectors:{"svg > path.OfficeIconColors_DynamicColor":{fill:l?l.headerBackArrowAndIterator:""},[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{selectors:{"svg > path.OfficeIconColors_DynamicColor":{fill:"ButtonText"}}}),":hover, :active":{backgroundColor:"transparent"},":focus::after":{outline:"none !important"},":focus":{outlineWidth:"2px",outlineStyle:"solid",outlineColor:l?l.headerBackArrowAndIterator:"",outlineOffset:"1px",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{outline:"2px solid ButtonText"})}},":focus:not(:focus-visible)":{outline:"none"}}}),viewerNoSelection:(0,y.Zq)({display:"flex",flexFlow:"column",alignItems:"center",backgroundColor:l.viewerNoSelectionBackground,color:l.viewerNoSelectionText,height:"100%",width:"100%",paddingTop:"20vh",boxSizing:"border-box",fontSize:"18px"}),viewerError:(0,y.Zq)({display:t?"flex":"none",flexFlow:"column",justifyContent:"center",alignItems:"center",backgroundColor:l.viewerErrorBackground,height:"100%",width:"100%"}),viewerErrorMessage:(0,y.Zq)({height:"16px",width:"371px",color:l.viewerErrorMessage,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"22px"}),loadingDiv:(0,y.Zq)({display:e&&!t?"flex":"none",justifyContent:"center",alignItems:"center",backgroundColor:l.viewerLoadingBackground,height:"100%",width:"100%",flexFlow:"column"}),loadingSpinner:(0,y.Zq)({selectors:{"& .ms-Spinner-circle":{borderColor:l.spinnerBorder,borderTopColor:l.spinnerTopColor}}}),hidden:(0,y.Zq)({display:"none"}),saveACopyButton:(0,y.Zq)({display:n?"flex":"none",lineHeight:"16px",marginLeft:"5px",marginRight:"5px",whiteSpace:"nowrap"}),restoreButton:(0,y.Zq)({display:i?"flex":"none",lineHeight:"16px",marginLeft:"5px",marginRight:"5px"}),headerContent:(0,y.Zq)({display:"flex",flexGrow:"1",justifyContent:"space-between",width:"100%",overflow:"auto"}),headerContentGroup:(0,y.Zq)({display:"flex",justifyContent:"flex-start",alignItems:"center",marginTop:"5px",marginBottom:"5px",marginLeft:"5px",marginRight:"5px",selectors:{":focus":{outline:"1px solid ButtonText",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{outline:"1px solid ButtonText"})}}}},{"#vhHeaderBackArrow svg > path.OfficeIconColors_m24":{fill:l.headerBackArrowAndIterator}})}}));var Ee=o(85190);const we=(0,S.J9)(((e,t,o,r,s,n,i,a,l,c,d,p,h,u)=>({defaultButton:(0,y.Zq)((0,ce.lT)()?{overflow:"visible"}:{},{color:r,borderColor:o,background:t,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"ButtonFace",color:"ButtonText",border:"1px solid ButtonText"}),":hover":{color:i,background:n,borderColor:s,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText"})}},":focus":{borderColor:a,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{borderColor:"ButtonText"})}},":active":{color:c,background:l,borderColor:d,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"ButtonText"})}},":disabled":{color:h,background:p,borderColor:u,selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Window",color:"GrayText",border:"1px solid GrayText"})}},":focus::after":{outline:e?"none !important":"",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{outline:"1px solid ButtonText !important"})}}}})})));class xe extends C.PureComponent{render(){const e=function(e,t){const o=T(t);let r="",s="",n="",i="",a="",l="",c="",d="",p="",h="",u="",g="",m="";return e?(r=o.headerDefaultButtonColor,s=o.headerDefaultButtonBorder,n=o.headerDefaultButtonFont,i=o.headerDefaultButtonHoverBorderColor,a=o.headerDefaultButtonHoverBackground,l=o.headerDefaultButtonHoverFont,c=o.headerDefaultButtonFocusBorder,d=o.headerDefaultButtonActiveColor,p=o.headerDefaultButtonActiveFont,h=o.headerDefaultButtonActiveBorder,u=o.headerDefaultButtonDisabledBackground,g=o.headerDefaultButtonDisabledText,m=o.headerDefaultButtonDisabledBorder):(r=o.errorDefaultButtonColor,s=o.errorDefaultButtonBorder,a=o.errorDefaultButtonHoverColor,c=o.errorDefaultButtonFocusBorder,d=o.errorDefaultButtonActiveColor),we(e,r,s,n,i,a,l,c,d,p,h,u,g,m)}(this.props.isHeaderButton,(0,$.BZ)());return C.createElement(Ee.Y,{componentRef:this.button,text:this.props.text,className:[this.props.className,e.defaultButton].join(" "),id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy})}constructor(){super(...arguments),this.button=C.createRef(),this.focus=()=>{if(this.button.current){this.button.current.focus();const e=document.getElementById(this.props.id);e&&(0,k.Fy)(!0,e)}}}}const Ie=(0,S.J9)(((e=!1)=>{const t=T(e);return{backArrow:(0,y.Zq)({height:"20px",width:"20px",color:"",lineHeight:"16px",marginLeft:"19px",marginRight:"19px",marginTop:"16px",minWidth:"20px",cursor:"pointer",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{fill:"ButtonText"})}}),fullAppError:(0,y.Zq)({display:"flex",flexFlow:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",backgroundColor:t.fullAppErrorBackground}),fullAppErrorTop:(0,y.Zq)({height:"24px",width:"284px",color:t.fullAppErrorText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"18px",fontWeight:"300",lineHeight:"24px",textAlign:"center",marginTop:"38px"}),fullAppErrorSub:(0,y.Zq)({height:"32px",width:"239px",color:t.fullAppErrorText,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"15px"}),fullAppErrorButtons:(0,y.Zq)({display:"flex",flexFlow:"row",marginTop:"33px"}),vhHeader:(0,y.Zq)({height:"48px",width:"100%",backgroundColor:t.vhHeaderBackground,display:"flex"},{"#vhHeaderBackArrow svg > path.OfficeIconColors_m24":{fill:t.headerBackArrowAndIterator}}),backToDoc:(0,y.Zq)({height:"16px",width:"97px",color:t.headerBackArrowAndIterator,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginTop:"16px",cursor:"pointer",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{color:"ButtonText"})}}),errorButtons:(0,y.Zq)({marginLeft:"5px",marginRight:"5px"})}}));var Fe=o(46256);const ke=(0,S.J9)((()=>({primaryButton:(0,y.Zq)((0,ce.lT)()?{overflow:"visible"}:{},{minWidth:"auto",selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"ButtonText",color:"ButtonFace",border:"1px solid ButtonFace"}),":hover":{selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"HighlightText"})}},":active":{selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"Highlight",color:"HighlightText",borderColor:"HighlightText"})}},":disabled":{selectors:{[y.up]:_object_spread_props(_object_spread({},(0,y.Qg)()),{backgroundColor:"ButtonFace",color:"GrayText",border:"1px solid GrayText"})}}}})})));class Re extends C.PureComponent{render(){const e=ke();return C.createElement(Fe.j,{componentRef:this.button,text:this.props.text,theme:(0,Se.a)(this.getPrimaryButtonTheme()),className:[this.props.primaryClassName,e.primaryButton].join(" "),id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy})}constructor(){super(...arguments),this.button=C.createRef(),this.focus=()=>{if(this.button.current){this.button.current.focus();const e=document.getElementById(this.props.id);e&&(0,k.Fy)(!0,e)}},this.getPrimaryButtonTheme=()=>(0,$.BZ)()?{semanticColors:{primaryButtonBackground:T(!0).appColors.primary,primaryButtonBorder:T(!0).appColors.primary,primaryButtonText:"#F3F2F1",primaryButtonBackgroundHovered:T(!0).appColors.shade10,primaryButtonTextHovered:"#F3F2F1",primaryButtonBackgroundPressed:T(!0).appColors.shade30,primaryButtonTextPressed:"#F3F2F1",focusBorder:"white",primaryButtonBackgroundDisabled:"#797775",primaryButtonTextDisabled:"#605E5C",buttonBorderDisabled:"#3B3A39"}}:{semanticColors:{primaryButtonBackground:T(!1).appColors.primary,primaryButtonBackgroundHovered:T(!1).appColors.shade10,primaryButtonBackgroundPressed:T(!1).appColors.shade20}}}}function Be(e){let t;switch(e){case s.Excel:t="xlsx";break;case s.PowerPoint:t="pptx";break;case s.Word:t="docx";break;default:return""}return"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+t+"_48x1_5.svg"}class Ae extends C.PureComponent{render(){return this.props.fullAppError===r.VHVersioningNotEnabled?this.renderVersioningDisabled():this.renderGenericError()}componentDidUpdate(){this.setFocusOnLoad()}componentDidMount(){this.setFocusOnLoad()}renderHeader(e){return C.createElement("div",{id:"vhHeader",className:e.vhHeader},C.createElement(ge.I,{id:"vhHeaderBackArrow",className:e.backArrow,iconName:ie(re()?re().ArrowBack_20:""),onClick:this.props.onCloseSelectedAction}),C.createElement("div",{id:"backToDoc",className:e.backToDoc,onClick:this.props.onCloseSelectedAction},this.props.localizedStrings.ReturnToDoc))}renderErrorImage(){return C.createElement("img",{src:Be(this.props.appSettings.appName),role:"presentation",alt:"",width:"62",height:"55"})}renderVersioningDisabled(){const e=Ie((0,$.BZ)()),t=this.props.localizedStrings.VersioningDisabledError,o=this.props.localizedStrings.VersioningDisabledDetails;return this._primaryButtonForFocus=new Re({text:this.props.localizedStrings.BackLabel,primaryClassName:e.errorButtons,id:"VHErrorBackButton",onClick:this.props.onCloseSelectedAction,isDisabled:!1,ariaDescribedBy:t}),C.createElement(C.Fragment,null,this.renderHeader(e),C.createElement("div",{className:e.fullAppError},this.renderErrorImage(),C.createElement("div",{className:e.fullAppErrorTop}," ",t),C.createElement("div",{className:e.fullAppErrorSub},o),C.createElement("div",{className:e.fullAppErrorButtons},C.createElement(Re,{text:this.props.localizedStrings.TryAgainLabel,primaryClassName:e.errorButtons,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!0}),this._primaryButtonForFocus.render())))}renderGenericError(){const e=Ie((0,$.BZ)()),t=this.props.localizedStrings.FullAppErrorTextTop,o=this.props.localizedStrings.FullAppErrorTextSub;return this._primaryButtonForFocus=new Re({text:this.props.localizedStrings.TryAgainLabel,primaryClassName:e.errorButtons,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!1,ariaDescribedBy:t}),this._defaultButtonForFocus=new xe({text:this.props.localizedStrings.BackLabel,id:"VHErrorBackButton",className:e.errorButtons,onClick:this.props.onCloseSelectedAction,isHeaderButton:!1}),C.createElement(C.Fragment,null,this.renderHeader(e),C.createElement("div",{className:e.fullAppError},this.renderErrorImage(),C.createElement("div",{className:e.fullAppErrorTop}," ",t),C.createElement("div",{className:e.fullAppErrorSub},o),C.createElement("div",{className:e.fullAppErrorButtons},this._primaryButtonForFocus.render(),this._defaultButtonForFocus.render())))}setFocusOnLoad(){this._primaryButtonForFocus&&this._primaryButtonForFocus.focus()}}var Ne=o(42169);class Le extends C.PureComponent{render(){const e=He(this.props.viewerLoading,this.props.viewerError,(0,$.BZ)(),(0,Ne.G)(),this.props.appSettings.appName);return C.createElement(C.Fragment,null,C.createElement(Ve.Y,{componentRef:this._ftzoneRoot,id:this._headerId,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0,"aria-label":this.props.localizedStrings.HeaderAriaLabel,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderHeader()))}createRenderHeader(e,t,o){return this.createRenderWithFocusTrapZone(e,t,o)}createRenderWithFocusTrapZone(e,t,o){const r=!!this.getVersionInfoFromId(this.props.selectedVersionId,this.props),s=!this.props.paneLoading&&!r;return C.createElement(C.Fragment,null,C.createElement(Ve.Y,{componentRef:this._ftzoneHeader,id:"vhHeader",className:e.vhHeader,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableRestoreFocus:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},this.renderHeaderComponents(e,t,o)),C.createElement(Ve.Y,{componentRef:this._ftzoneViewer,className:e.vhViewContainer,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableRestoreFocus:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},s?this.renderBlankLoadLabel(e):this.renderErrorHeader(e),C.createElement("div",{id:s?"vhViewerHidden":"vhViewer",className:s?e.hidden:e.vhViewer,tabIndex:0})))}renderBackButtonSection(e){return C.createElement("div",{className:e.headerContentGroup,onClick:this.onBackToDocumentClicked,tabIndex:0,onKeyDown:this.onBackArrowKeyDown,role:"button"},C.createElement(ge.I,{id:"vhHeaderBackArrow",className:e.backArrow,iconName:ie(re()?re().ArrowBack_20:"")}),C.createElement("div",{id:"backToDoc",className:e.backToDoc,"aria-label":this.props.localizedStrings.ReturnToDoc},this.props.localizedStrings.ReturnToDoc))}renderSelectedVersionSection(e,t){return C.createElement(C.Fragment,null,C.createElement("div",{id:"selectedVersionTime",className:e.selectedVersionTime},t))}renderButtonsSection(e,t){let o="";return this.getVersionInfoFromId(this.props.selectedVersionId,this.props)&&(o=P(this.getVersionInfoFromId(this.props.selectedVersionId,this.props).Version.Time,void 0,this.props.localizedStrings).friendlyDateString),C.createElement(C.Fragment,null,C.createElement(xe,{ref:this._saveACopyButton,text:this.props.localizedStrings.SaveACopy,className:e.saveACopyButton,id:"VHSaveACopyButton",onClick:this.onSaveAsClick,isDisabled:t,isHeaderButton:!0,ariaDescribedBy:this.props.localizedStrings.SaveACopyAriaDescribedByText.replace("{0}",o)}),C.createElement(xe,{text:this.props.localizedStrings.RestoreLabel,className:e.restoreButton,id:"VHRestoreButton",onClick:this.onRestoreClick,isDisabled:t,isHeaderButton:!0,ariaDescribedBy:this.props.localizedStrings.RestoreAriaDescribedByText.replace("{0}",o)}))}renderHeaderComponents(e,t,o){return C.createElement(C.Fragment,null,C.createElement("div",{className:e.headerContent},this.renderBackButtonSection(e),C.createElement("div",{className:e.headerContentGroup},this.renderSelectedVersionSection(e,o),this.renderButtonsSection(e,t)),C.createElement("div",{className:e.headerContentGroup})))}renderBlankLoadLabel(e){return C.createElement(C.Fragment,null,C.createElement("div",{id:"vhViewer","aria-live":"polite",className:e.viewerNoSelection,contentEditable:!1,onFocus:e=>{e.preventDefault(),e.stopPropagation()},tabIndex:1},C.createElement(be.P,{delay:50},C.createElement("div",null,this.props.localizedStrings.BlankLoadSelectVersionLabel))))}renderErrorHeader(e){return C.createElement(C.Fragment,null,C.createElement("div",{className:e.viewerError},C.createElement("img",{src:Be(this.props.appSettings.appName),width:"62",height:"55"}),C.createElement("div",{className:e.viewerErrorMessage},this.props.localizedStrings.ViewerAreaErrorText)),C.createElement("div",{className:e.loadingDiv},C.createElement(x.y,{className:e.loadingSpinner,size:I.H.large})))}constructor(){super(...arguments),this._ftzoneRoot=C.createRef(),this._ftzoneHeader=C.createRef(),this._ftzoneViewer=C.createRef(),this._saveACopyButton=C.createRef(),this._headerId="VersionHistoryHeader",this.onSaveAsClick=()=>{this.getVersionInfoFromId(this.props.selectedVersionId,this.props)&&this.props.onSaveACopySelectedAction(this.getVersionInfoFromId(this.props.selectedVersionId,this.props).Version.DownloadUrl)},this.renderHeader=()=>{const e=!!this.getVersionInfoFromId(this.props.selectedVersionId,this.props),t=!this.props.appSettings.disableSaveACopy,o=!!this.props.appSettings.wdEnableRestore&&this.props.appSettings.wdEnableRestore,r=this.props.appSettings.viewerRootPositionRelative,s=!!this.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete&&(this.props.viewerLoading||this.props.viewerError),n=He(this.props.viewerLoading,this.props.viewerError,(0,$.BZ)(),(0,Ne.G)(),this.props.appSettings.appName,t&&e,o&&e&&this.props.versions[0]&&this.props.selectedVersionId!==this.props.versions[0].RevisionID,r);let i;return i=e?C.createElement(U,{date:this.getVersionInfoFromId(this.props.selectedVersionId,this.props).Version.Time,localizedStrings:this.props.localizedStrings}):C.createElement("div",null),this.createRenderHeader(n,s,i)},this.focus=()=>this._ftzoneRoot.current&&this._ftzoneRoot.current.focus(),this.focusHeader=()=>this._ftzoneHeader.current&&this._ftzoneHeader.current.focus(),this.focusViewer=()=>this._ftzoneViewer.current&&this._ftzoneViewer.current.focus(),this.focusSaveACopy=()=>this._saveACopyButton.current&&this._saveACopyButton.current.focus(),this.getVersionInfoFromId=(e,t)=>{if(!e)return;const o=(0,Te.SL)(t.versions,(t=>t.RevisionID===e));return o>=0?{Version:t.versions[o]}:void 0},this.onRestoreClick=()=>{this.getVersionInfoFromId(this.props.selectedVersionId,this.props)&&this.props.onRestoreVersionAction(this.getVersionInfoFromId(this.props.selectedVersionId,this.props).Version.RevisionID)},this.onBackArrowKeyDown=e=>{e.which!==w.c.enter&&e.which!==w.c.space||this.onBackToDocumentClicked()},this.onBackToDocumentClicked=()=>{i.Hv.sendTraceTag(595632281,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,"Back to Document clicked"),this.props.onCloseSelectedAction()}}}const We=function(e){const t=T(e);return Pe(t.spinnerBorder,t.spinnerTopColor)},Pe=(0,S.J9)(((e,t)=>({loadingSpinner:(0,y.Zq)({selectors:{"& .ms-Spinner-circle":{borderColor:e,borderTopColor:t}}})})));var Me,Ge,Oe=o(32732),Ue=o(9781),ze=o(40381);!function(e){e[e.Hidden=1]="Hidden",e[e.CoauthRestoreDisplayed=2]="CoauthRestoreDisplayed",e[e.CoauthRestoreFailedServer=3]="CoauthRestoreFailedServer",e[e.CoauthRestoreInProgress=4]="CoauthRestoreInProgress"}(Me||(Me={}));class je extends C.PureComponent{render(){const e=We((0,$.BZ)());switch(this.props.modalErrorState){case Me.CoauthRestoreDisplayed:return C.createElement(Oe.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.h.normal,title:this.props.localizedStrings.OtherEditors,subText:this.props.localizedStrings.OtherEditorsSubtext,showCloseButton:!1}},C.createElement(ze.E,null,C.createElement(Re,{text:this.props.localizedStrings.RestoreContinue,primaryClassName:"",id:"VHRestorContinue",onClick:this.props.onDismiss,isDisabled:!1})));case Me.CoauthRestoreInProgress:return C.createElement(Oe.l,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,modalProps:{isModeless:!0,dragOptions:void 0},dialogContentProps:{type:Ue.h.normal,title:this.props.localizedStrings.RestoreInProgress,showCloseButton:!1}},C.createElement(x.y,{className:e.loadingSpinner,size:I.H.large,ariaLabel:this.props.localizedStrings.RestoreInProgress}));case Me.CoauthRestoreFailedServer:return C.createElement(Oe.l,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.h.normal,title:this.props.localizedStrings.RestoreFailed,subText:this.props.localizedStrings.RestoreFailedSubtext,showCloseButton:!1}},C.createElement(ze.E,null,C.createElement(Re,{text:this.props.localizedStrings.RestoreContinue,primaryClassName:"",id:"VHRestorContinue",onClick:this.props.refreshCallback,isDisabled:!1})));case Me.Hidden:default:return null}}constructor(e){super(e)}}!function(e){e[e.Hidden=1]="Hidden",e[e.DeleteConfirmation=2]="DeleteConfirmation",e[e.DeleteInProgress=3]="DeleteInProgress",e[e.DeletePartialFailure=4]="DeletePartialFailure",e[e.DeleteFullFailure=5]="DeleteFullFailure"}(Ge||(Ge={}));class qe extends C.PureComponent{render(){const e=We((0,$.BZ)());switch(this.props.deleteModalErrorState){case Ge.DeleteConfirmation:return C.createElement(Oe.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.h.normal,subText:1===this.props.revisionIDsToDeleteCount?this.props.localizedStrings.DeleteIndividualConfirmation:this.props.localizedStrings.DeleteGroupConfirmation.replace("{0}",this.props.revisionIDsToDeleteCount.toString()),title:this.props.localizedStrings.DeleteContinue}},C.createElement(ze.E,null,C.createElement(Re,{text:this.props.localizedStrings.Delete,primaryClassName:"",id:"VHDeleteContinue",onClick:this.props.deleteVersions,isDisabled:!1}),C.createElement(xe,{text:this.props.localizedStrings.DeleteCancel,id:"VHDeleteCancel",className:"",onClick:this.props.onDismiss,isHeaderButton:!1})));case Ge.DeleteInProgress:return C.createElement(Oe.l,{hidden:!1,isBlocking:!0,dialogContentProps:{type:Ue.h.normal,title:this.props.localizedStrings.Deleting}},C.createElement(x.y,{className:e.loadingSpinner,size:I.H.large,ariaLabel:"Deleting"}));case Ge.DeletePartialFailure:return C.createElement(Oe.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.h.normal,title:this.props.localizedStrings.DeleteFailedPartialGroup,subText:this.props.localizedStrings.DeleteFailedPartialGroupFailureCount.replace("{0}",this.props.failedToDeleteCount.toString()).replace("{1}",this.props.revisionIDsToDeleteCount.toString())+" "+this.props.localizedStrings.DeleteFailedTryAgain}},C.createElement(ze.E,null,C.createElement(Re,{text:this.props.localizedStrings.BackLabel,primaryClassName:"",id:"VHDeletePartialFailure",onClick:this.props.onDismiss,isDisabled:!1})));case Ge.DeleteFullFailure:return C.createElement(Oe.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:Ue.h.normal,title:1===this.props.revisionIDsToDeleteCount?this.props.localizedStrings.DeleteFailedIndividual:this.props.localizedStrings.DeleteFailedWholeGroup,subText:this.props.localizedStrings.DeleteFailedTryAgain}},C.createElement(ze.E,null,C.createElement(Re,{text:this.props.localizedStrings.BackLabel,primaryClassName:"",id:"VHDeleteFullFailure",onClick:this.props.onDismiss,isDisabled:!1})));case Ge.Hidden:default:return null}}constructor(e){super(e)}}class Ze extends C.PureComponent{render(){const e=E(this.props.appSettings.isRtl,(0,$.BZ)()),{localizedStrings:t}=this.props;return C.createElement(Ve.Y,{componentRef:this._ftzone,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._dialogDescribedById,role:"group","aria-roledescription":t.VersionHistoryTitle},C.createElement("div",{className:e.dialog},this.renderVersionHistoryDialog(),C.createElement("div",{id:this._dialogDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle)))}focusViewer(){this._vhHeader.current&&this._vhHeader.current.focusViewer()}constructor(e){super(e),this._ftzone=C.createRef(),this._vhPane=C.createRef(),this._vhHeader=C.createRef(),this._dialogDescribedById=(0,D.O)(),this.renderVersionHistoryDialog=()=>{const{versions:e}=this.props,t={localizedStrings:this.props.localizedStrings,selectedVersionId:this.props.selectedVersionId,selectedGroupName:this.props.selectedGroupName,totalChangesCount:this.props.totalChangesCount,currentChange:this.props.currentChange,onVersionSelectedAction:this.props.onVersionSelectedAction,onCloseSelectedAction:this.props.onCloseSelectedAction,onRestoreVersionAction:this.props.onRestoreVersionAction,onDeleteVersionsSelectedAction:this.props.onDeleteVersionsSelectedAction,paneLoading:this.props.paneLoading,viewerLoading:this.props.viewerLoading,viewerError:this.props.viewerError,fullAppError:this.props.fullAppError,appSettings:this.props.appSettings,modalErrorState:this.props.modalErrorState,deleteModalErrorState:this.props.deleteModalErrorState,refreshCallback:this.props.refreshCallback,revisionIDsToDeleteCount:this.props.revisionIDsToDeleteCount,failedToDeleteCount:this.props.failedToDeleteCount,isChangesToggleOn:this.props.isChangesToggleOn},o=E(t.appSettings.isRtl);return C.createElement(C.Fragment,null,this.props.fullAppError?C.createElement(C.Fragment,null,C.createElement("div",{className:o.fullAppErrorDiv},C.createElement(Ae,_object_spread_props(_object_spread({versions:e},t),{getVersions:this.props.getVersions})))):C.createElement(C.Fragment,null,C.createElement(je,_object_spread_props(_object_spread({versions:e},t),{onDismiss:this._onDismiss})),C.createElement(Le,_object_spread_props(_object_spread({versions:e},t),{onSaveACopySelectedAction:this.props.onSaveACopySelectedAction,onRestoreVersionAction:this.props.onRestoreVersionAction,ref:this._vhHeader})),this.props.appSettings.wdEnableDeleteVersions?C.createElement(qe,_object_spread_props(_object_spread({versions:e},t),{onDismiss:this._onDeleteDismiss,deleteVersions:this.props.deleteVersions})):C.createElement(C.Fragment,null),C.createElement(ye,_object_spread_props(_object_spread({versions:e},t),{onShowVersionChangesToggledAction:this.props.onShowVersionChangesToggledAction,onDownloadVersionSelectedAction:this.props.onDownloadVersionSelectedAction,onSaveACopySelectedAction:this.props.onSaveACopySelectedAction,onDeleteVersionsSelectedAction:this.props.onDeleteVersionsSelectedAction,onIteratorSelectedAction:this.props.onIteratorSelectedAction,onShowChangesToggle:this.props.onShowChangesToggle,ref:this._vhPane}))))},this.focus=()=>this._vhPane.current&&this._vhPane.current.focus(),this.focusHeader=()=>{this._vhHeader.current&&this._vhHeader.current.focusHeader()},this.focusSaveACopy=()=>{this._vhHeader.current&&this._vhHeader.current.focusSaveACopy()},this._onDismiss=()=>{e.setModalError(Me.Hidden)},this._onDeleteDismiss=()=>{e.setDeleteModalError(Ge.Hidden)}}}var Je,Xe=o(87673),$e=o(64700),Qe=o(83753),Ke=o(20156);!function(e){e[e.SelectOlderSubsection=1]="SelectOlderSubsection",e[e.SelectNewerSubsection=2]="SelectNewerSubsection",e[e.SelectOlderVersion=3]="SelectOlderVersion",e[e.SelectNewerVersion=4]="SelectNewerVersion",e[e.SelectTipSubsection=5]="SelectTipSubsection"}(Je||(Je={}));class Ye extends C.PureComponent{insertVersions(e){i.Hv.sendTraceTag(595933190,a.n.msoulscat_Wac_VersionHistory,l.k.Info,JSON.stringify({msg:"insertVersions",count:e.length})),this.setState({versions:e})}insertVersionsAndClearLoading(e){i.Hv.sendTraceTag(592066071,a.n.msoulscat_Wac_VersionHistory,l.k.Info,JSON.stringify({msg:"insertVersions and clear pane and viewer loading",count:e.length})),this.setState({versions:e,paneLoading:!1,viewerLoading:!1})}removeVersionsAndSelectNext(e,t){i.Hv.sendTraceTag(589939200,a.n.msoulscat_Wac_VersionHistory,l.k.Info,JSON.stringify({msg:"removeVersionsAndSelectNext",count:e.length-t.length}));let o=!1,r=!1;if(t.length>0&&(o=this.showDeleteFullOrPartialFailure(e.length,t.length),r=!o,o))return;const s=this.state.versions.findIndex((t=>t.RevisionID===e[0])),n=this.removeVersions(e,t),c=this.selectAfterDelete(s,n,r),d=n[s],p=n[s+1],h=n[s-1],u=d;switch(c){case Je.SelectTipSubsection:this.setVersionsAndSelectSubSection(n,n[0]);break;case Je.SelectOlderVersion:this.setVersionsAndSelectVersion(n,{currentVersion:d,baseVersion:p,noBaseToCompareTo:!p});break;case Je.SelectNewerVersion:this.setVersionsAndSelectVersion(n,{currentVersion:h,baseVersion:u,noBaseToCompareTo:!u});break;case Je.SelectOlderSubsection:this.setVersionsAndSelectSubSection(n,d);break;case Je.SelectNewerSubsection:this.setVersionsAndSelectSubSection(n,this.getGroupTipFromVersion(n,s-1))}r||this.setDeleteModalError(Ge.Hidden)}setVersionsAndSelectSubSection(e,t){this._dialog&&this._dialog.current&&t?(i.Hv.sendTraceTag(592066072,a.n.msoulscat_Wac_VersionHistory,l.k.Info,JSON.stringify({msg:"insertVersions and select subsection",count:e.length})),this.setState({versions:e,paneLoading:!1,selectedGroupName:t.RevisionID?t.RevisionID:void 0})):(i.Hv.sendTraceTag(592066073,a.n.msoulscat_Wac_VersionHistory,l.k.Info,JSON.stringify({msg:"insertVersions and clear pane loading",count:e.length})),this.setState({versions:e,paneLoading:!1}))}setTotalChangesCount(e){this._dialog&&this._dialog.current&&this.setState({totalChangesCount:e})}setCurrentChangeCount(e){this._dialog&&this._dialog.current&&this.setState({currentChange:e})}setViewerLoading(e){this.setState({viewerLoading:e})}setViewerError(e){this.setState({viewerError:e})}setFullAppErrorCode(e){this.setState({fullAppError:e})}hitFullAppError(e){this.setState({fullAppError:e,viewerLoading:!1,paneLoading:!1,viewerError:!1})}disableSearchBar(e){(0,Qe.X)(Ke.e)((0,$e.z)(e))}getVersionsTriggered(){this.resetState(),this.disableSearchBar(!0)}setModalError(e){this.setState({modalErrorState:e})}setDeleteModalError(e){this.setState({deleteModalErrorState:e})}setRefreshCallback(e){this.setState({refreshCallback:e})}setRestoreFailedAtServer(e,t){this.setState({modalErrorState:e,refreshCallback:t})}setVersionsAndSelectVersion(e,t){if(!t.currentVersion)return;if(!t.currentVersion.RevisionID)return;let o=this.state.viewerLoading;i.Hv.sendTraceTag(595907534,a.n.msoulscat_Wac_VersionHistory,l.k.Info,this.getLoggableVersionInfoString("selectVersion - Version selected in pane",t.currentVersion.RevisionID,this.state)),this.selectedVersionId=t.currentVersion.RevisionID;const r=this.selectedVersionId,s=t.groupName?t.groupName:void 0;o=!!this.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete,i.Hv.sendTraceTag(592066074,a.n.msoulscat_Wac_VersionHistory,l.k.Info,JSON.stringify({msg:"insertVersions during select",count:e.length})),this.setState({versions:e,paneLoading:!1,viewerLoading:o,selectedVersionId:r,selectedGroupName:s,viewerError:!1},(()=>this.props.onVersionSelectedAction(t)))}render(){return C.createElement(Ze,_object_spread_props(_object_spread({ref:this._dialog,setModalError:this.setModalError,setDeleteModalError:this.setDeleteModalError,setRefreshCallback:this.setRefreshCallback},this.props,this.state),{onVersionSelectedAction:this.onVersionSelectedAction,onCloseSelectedAction:this.onCloseSelectedAction,onSaveACopySelectedAction:this.onSaveACopySelectedAction,onDownloadVersionSelectedAction:this.onDownloadVersionSelectedAction,onRestoreVersionAction:this.onRestoreVersionAction,onDeleteVersionsSelectedAction:this.onDeleteVersionsSelectedAction,getVersions:this.props.getVersions,deleteVersions:this.props.deleteVersions,setSaveACopyCanceled:this.setSaveACopyCanceled,onShowChangesToggle:this.setIsChangesToggleOn}))}enterFocusTrapZone(){this._dialog.current&&this._dialog.current.focus()}enterHeaderFocusTrapZone(){this._dialog.current&&this._dialog.current.focusHeader()}setSaveACopyCanceled(){this._dialog.current&&this._dialog.current.focusSaveACopy()}enterViewerFocusTrapZone(){this._dialog.current&&this._dialog.current.focusViewer()}constructor(e){super(e),this._dialog=C.createRef(),this._disableFileCache=!1,this.selectedVersionId=null,this.setIsChangesToggleOn=e=>{this.setState({isChangesToggleOn:e})},this.onVersionSelectedAction=e=>{if(e.currentVersion&&e.currentVersion.RevisionID){if(i.Hv.sendTraceTag(595933192,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({noCache:this._disableFileCache,event:"Version Selected",message:this.getLoggableVersionInfoString("onVersionSelectedAction - Version selected in pane",e.currentVersion.RevisionID,this.state),time:Date.now()})),this.selectedVersionId=e.currentVersion.RevisionID?e.currentVersion.RevisionID:void 0,this._disableFileCache||e.currentVersion.DownloadUrl)i.Hv.sendTraceTag(595907534,a.n.msoulscat_Wac_VersionHistory,l.k.Info,this.getLoggableVersionInfoString("selectVersion - Version selected in pane",e.currentVersion.RevisionID,this.state)),this.setState({selectedVersionId:this.selectedVersionId,selectedGroupName:e.groupName?e.groupName:void 0,viewerError:!1,viewerLoading:!!this.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete},(()=>this.props.onVersionSelectedAction(e)));else{this.setState({selectedVersionId:this.selectedVersionId,viewerError:!1,viewerLoading:!0});const t=[e.currentVersion.RevisionID];e.baseVersion&&e.baseVersion.RevisionID&&t.push(e.baseVersion.RevisionID),this.props.getDownloadToken(t,e)}if(!this._disableFileCache&&e.currentVersion.DownloadUrl&&e.baseVersion&&e.baseVersion.RevisionID&&!e.baseVersion.DownloadUrl){const t=[e.currentVersion.RevisionID,e.baseVersion.RevisionID];this.props.getDownloadToken(t,e)}}},this.onCloseSelectedAction=()=>{this.props.onCloseSelectedAction(),this.resetState(),this.disableSearchBar(!1)},this.onSaveACopySelectedAction=e=>{i.Hv.sendTraceTag(595903688,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,this.getLoggableVersionInfoString("onSaveACopySelectedAction",this.state.selectedVersionId,this.state)),this.props.onSaveACopySelectedAction(e)},this.onDownloadVersionSelectedAction=e=>{i.Hv.sendTraceTag(593072918,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,this.getLoggableVersionInfoString("onDownloadVersionSelectedAction",this.state.selectedVersionId,this.state)),this.props.onDownloadVersionSelectedAction(e)},this.onRestoreVersionAction=e=>{i.Hv.sendTraceTag(595892446,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,this.getLoggableVersionInfoString("onRestoreVersionAction",e,this.state)),this.props.onRestoreVersionAction(e)},this.onDeleteVersionsSelectedAction=e=>{i.Hv.sendTraceTag(590147609,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,1===e.length?this.getLoggableVersionInfoString("onDeleteVersionsSelectedAction",e[0],this.state):this.getLoggableVersionInfoString("onDeleteVersionsSelectedAction with {0} versions, info for most recent version in group".replace("{0}",e.length.toString()),e[0],this.state));const t=e.length;this.setState({revisionIDsToDeleteCount:t}),this.props.onDeleteVersionsSelectedAction(e)},this.getInitState=()=>({versions:[],selectedVersionId:void 0,selectedGroupName:void 0,totalChangesCount:0,currentChange:0,paneLoading:!0,viewerLoading:!0,viewerError:!1,fullAppError:r.None,modalErrorState:Me.Hidden,deleteModalErrorState:Ge.Hidden,revisionIDsToDeleteCount:0,failedToDeleteCount:0,isChangesToggleOn:!0,refreshCallback:()=>{}}),this.resetState=()=>{this.setState(this.getInitState())},this.getAgeOfTime=e=>Date.now()-e.getTime(),this.getVersionInfoFromId=(e,t)=>{if(!e)return;const o=(0,Te.SL)(t.versions,(t=>t.RevisionID===e));return o>=0?{version:t.versions[o],index:o}:void 0},this.getLoggableVersionInfoString=(e,t,o)=>{const r=this.getVersionInfoFromId(t,o);if(r){const{version:t,index:o}=r,s=t.Time?this.getAgeOfTime(t.Time):"-1";return JSON.stringify({msg:e,revisionId:t.RevisionID,revisionAge:s,revisionIndex:o})}return""},this.getGroupTipFromVersion=(e,t)=>{if(t<0||t>e.length)return i.Hv.sendTraceTag(589312481,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"getGroupTipFromVersion: index out of bounds: currIndex = {0}".replace("{0}",t.toString())),e[0];if(0===t)return e[0];let o=e[t],r=t-1,s=e[r];for(r-=1;s&&this.areVersionsInSameGroup(o,s);)o=s,s=e[r],r-=1;return o},this.areVersionsInSameGroup=(e,t)=>{var o,r,s,n,i,a;return e===t||(null==e||null===(o=e.Time)||void 0===o?void 0:o.getDate())===(null==t||null===(r=t.Time)||void 0===r?void 0:r.getDate())&&(null==e||null===(s=e.Time)||void 0===s?void 0:s.getMonth())===(null==t||null===(n=t.Time)||void 0===n?void 0:n.getMonth())&&(null==e||null===(i=e.Time)||void 0===i?void 0:i.getFullYear())===(null==t||null===(a=t.Time)||void 0===a?void 0:a.getFullYear())},this.showDeleteFullOrPartialFailure=(e,t)=>e<=0?(i.Hv.sendTraceTag(589312482,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"showDeleteFullOrPartialFailure: no versions to delete: toDelete = {0}".replace("{0}",e.toString())),!0):e===t?(this.setDeleteModalError(Ge.DeleteFullFailure),!0):(t>0&&(this.setState({failedToDeleteCount:t}),this.setDeleteModalError(Ge.DeletePartialFailure)),!1),this.removeVersions=(e,t)=>{const o=e.filter((e=>!t.includes(e)));return this.state.versions.filter((e=>!e.RevisionID||!o.includes(e.RevisionID)))},this.selectAfterDelete=(e,t,o)=>{let r,s;if(0===e)return i.Hv.sendTraceTag(589312483,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"selectAfterDelete: attempting to delete tip version"),Je.SelectTipSubsection;if(e<0||e-1>=t.length)return i.Hv.sendTraceTag(589312512,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"selectAfterDelete: firstIndexDeleted out of bounds: currIndex = {0}".replace("{0}",e.toString())),Je.SelectTipSubsection;r=t[e-1],s=e>=t.length?void 0:t[e];const n=this.state.versions[e];return o?s?Je.SelectOlderSubsection:Je.SelectNewerSubsection:this.areVersionsInSameGroup(n,s)?Je.SelectOlderVersion:this.areVersionsInSameGroup(n,r)?Je.SelectNewerVersion:s?Je.SelectOlderSubsection:Je.SelectNewerSubsection},this.state=this.getInitState(),this.setModalError=this.setModalError.bind(this),this.setDeleteModalError=this.setDeleteModalError.bind(this),this.setRefreshCallback=this.setRefreshCallback.bind(this),this._disableFileCache=!!e.appSettings.wdDisableSPOFileCache||!!e.appSettings.wdDisableODCFileCache,this.disableSearchBar(!0),i.Hv.sendTraceTag(595933189,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"Pane constructed")}}const et={shade30:"#0e336a",shade20:"#13458f",shade10:"#1651aa",primary:"#185abd",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4"},tt={shade30:"#0e336a",shade20:"#002050",shade10:"#124078",primary:"#2b579a",tint10:"#3c65a4",tint20:"#4a78b0",tint30:"#7da3c6",tint40:"#a5b9d1"},ot={shade30:"#6e220f",shade20:"#740912",shade10:"#a92b1a",primary:"#b7472a",tint10:"#c75033",tint20:"#e86e58",tint30:"#ed9583",tint40:"#fdc9b5"},rt={shade30:"#094624",shade20:"#0C5F32",shade10:"#0F703B",primary:"#107C41",tint10:"#218D51",tint20:"#55B17E",tint30:"#A0D8B9",tint40:"#CAEAD8"};class st{createVersionHistoryDialog(e){const t=Date.now();if(i.Hv.sendTraceTag(590144343,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({noCache:this._disableFileCache,event:"createVersionHistoryDialog: started",startTime:t})),e){null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogStart",TelemetryEventData:t.toString()});const r={onVersionSelectedAction:this._onVersionSelectedEvent.fireEvent.bind(this._onVersionSelectedEvent),onCloseSelectedAction:this._onCloseSelectedEvent.fireEvent.bind(this._onCloseSelectedEvent),onSaveACopySelectedAction:this._onSaveACopySelectedEvent.fireEvent.bind(this._onSaveACopySelectedEvent),onDownloadVersionSelectedAction:this._onDownloadVersionSelectedEvent.fireEvent.bind(this._onDownloadVersionSelectedEvent),onRestoreVersionAction:this._onRestoreVersionSelectedEvent.fireEvent.bind(this._onRestoreVersionSelectedEvent),onDeleteVersionsSelectedAction:e=>this.onDeleteVersionsSelectedEvent(e),onIteratorSelectedAction:this._onIteratorSelectedEvent.fireEvent.bind(this._onIteratorSelectedEvent),onShowVersionChangesToggledAction:this._onShowVersionChangesToggledEvent.fireEvent.bind(this._onShowVersionChangesToggledEvent),getVersions:()=>this.getVersions(),getDownloadToken:(e,t)=>this.getDownloadToken(e,t),deleteVersions:()=>this.deleteVersions()};let n=tt;if(this._appSettings.appName)switch(this._appSettings.appName){case s.Word:n=this._appSettings.wdEnableAppColorUpdate?et:tt;break;case s.PowerPoint:n=ot;break;case s.Excel:n=rt;break;default:i.Hv.sendTraceTag(592548236,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:this._disableFileCache,error:"invalid app name used"}))}else i.Hv.sendTraceTag(592548237,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:this._disableFileCache,error:"no app name was passed in"}));return o=n,H.versionCardRootSelectedBoxShadow=o.primary,H.spinnerTopColor=o.primary,H.appColors=o,b.versionCardRootSelectedBoxShadow=o.primary,b.headerDefaultButtonFont=o.primary,b.headerDefaultButtonHoverFont=o.shade10,b.headerDefaultButtonActiveFont=o.shade10,b.spinnerTopColor=o.primary,b.appColors=o,function(e,t,o){return versionHistorySprite&&(versionHistorySprite.icons=versionHistorySprite.icons.map((e=>_object_spread_props(_object_spread({},e),{id:ie(e.id)}))),(0,y.K1)({icons:(0,Xe.t)(versionHistorySprite)}),versionHistorySprite=void 0),new Promise((r=>{V.render(C.createElement(Ye,_object_spread({ref:e=>r(e)},t,o)),e)}))}(e,{localizedStrings:this._versionHistoryStringsBag,appSettings:this._appSettings},r).then((e=>(this._versionHistoryDialog=e,this._versionHistoryDialog.insertVersions(this._versionHistoryCache.Versions),null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogEnd",TelemetryEventData:Date.now().toString()}),i.Hv.sendTraceTag(590144344,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({noCache:this._disableFileCache,event:"createVersionHistoryDialog: ended",error:"None",startTime:t,duration:Date.now()-t,versionCount:this._versionHistoryCache.Versions.length})),e)))}var o;return i.Hv.sendTraceTag(590144345,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:this._disableFileCache,event:"createVersionHistoryDialog: ended",error:"no containerElement",startTime:t,duration:Date.now()-t})),Promise.reject(void 0)}getTipVersion(){var e=this;return _async_to_generator((function*(){try{yield e._versionHistoryCache.getTipVersion()}catch(e){i.Hv.sendTraceTag(591680147,a.n.msoulscat_Wac_VersionHistory,l.k.Error,`VersionHistoryController.getTipVersion: unexpected exception, error: ${e.message}`)}}))()}updateDocId(e){this._versionHistoryCache.updateDocId(e)}getVersions(){var e=this;return _async_to_generator((function*(){e._versionHistoryDialog&&e._versionHistoryDialog.getVersionsTriggered();try{yield e._versionHistoryCache.getVersions()}catch(t){i.Hv.sendTraceTag(591680148,a.n.msoulscat_Wac_VersionHistory,l.k.Error,JSON.stringify({noCache:e._disableFileCache,error:`VersionHistoryController.getVersions: unexpected exception, error: ${t.message}`}))}}))()}setVersionLoadComplete(){var e=this;return _async_to_generator((function*(){e._versionHistoryDialog&&(i.Hv.sendTraceTag(588335171,a.n.msoulscat_Wac_VersionHistory,l.k.Warning,JSON.stringify({noCache:e._disableFileCache,event:"Version done loading",time:Date.now()})),e._versionHistoryDialog.setViewerLoading(!1))}))()}setTotalChangesCount(e){var t=this;return _async_to_generator((function*(){t._versionHistoryDialog&&(i.Hv.sendTraceTag(595658889,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"setTotalChangesCount with count:"+e.toString()),t._versionHistoryDialog.setTotalChangesCount(e))}))()}setCurrentChangeCount(e){var t=this;return _async_to_generator((function*(){t._versionHistoryDialog&&(i.Hv.sendTraceTag(595658890,a.n.msoulscat_Wac_VersionHistory,l.k.Info,"setCurrentChangeCount with count:"+e.toString()),t._versionHistoryDialog.setCurrentChangeCount(e))}))()}setFullAppErrorCode(e){var t=this;return _async_to_generator((function*(){t._versionHistoryDialog&&t._versionHistoryDialog.setFullAppErrorCode(e)}))()}setViewerError(e){var t=this;return _async_to_generator((function*(){e&&i.Hv.sendTraceTag(587309088,a.n.msoulscat_Wac_VersionHistory,l.k.Error,"setViewerError with true"),t._versionHistoryDialog&&t._versionHistoryDialog.setViewerError(e)}))()}setCoauthRestoreError(){var e=this;return _async_to_generator((function*(){e._versionHistoryDialog&&(e._versionHistoryDialog.setModalError(Me.Hidden),e._versionHistoryDialog.setModalError(Me.CoauthRestoreDisplayed))}))()}setRestoreFailedAtServer(e){var t=this;return _async_to_generator((function*(){t._versionHistoryDialog&&e&&t._versionHistoryDialog.setRestoreFailedAtServer(Me.CoauthRestoreFailedServer,e)}))()}setRestoreInProgress(){var e=this;return _async_to_generator((function*(){e._versionHistoryDialog&&e._versionHistoryDialog.setModalError(Me.CoauthRestoreInProgress)}))()}setDeleteConfirmation(){this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(Ge.DeleteConfirmation)}setDeleteInProgress(){this._versionHistoryDialog&&this._versionHistoryDialog.setDeleteModalError(Ge.DeleteInProgress)}setDeletePartialFailure(){var e=this;return _async_to_generator((function*(){e._versionHistoryDialog&&e._versionHistoryDialog.setDeleteModalError(Ge.DeletePartialFailure)}))()}setDeleteFullFailure(){var e=this;return _async_to_generator((function*(){e._versionHistoryDialog&&e._versionHistoryDialog.setDeleteModalError(Ge.DeleteFullFailure)}))()}setDisableSaveACopy(e){var t=this;return _async_to_generator((function*(){t._appSettings&&(t._appSettings.disableSaveACopy=e)}))()}setSaveACopyCanceled(){var e=this;return _async_to_generator((function*(){e._versionHistoryDialog&&e._versionHistoryDialog.setSaveACopyCanceled()}))()}getDownloadToken(e,t){var o=this;return _async_to_generator((function*(){if(o._versionHistoryDialog){o._versionHistoryDialog.setFullAppErrorCode(r.None);try{yield o._versionHistoryCache.getDownloadToken(e,t)}catch(e){i.Hv.sendTraceTag(591680149,a.n.msoulscat_Wac_VersionHistory,l.k.Error,`VersionHistoryController.getDownloadToken: unexpected exception, error: ${e.message}`)}}}))()}deleteVersions(){var e=this;return _async_to_generator((function*(){var t;e.setDeleteInProgress();const o=yield e._versionHistoryCache.deleteVersions(e._revisionIDsToDelete);var r;null===(t=e._versionHistoryDialog)||void 0===t||t.setDeleteModalError(Ge.Hidden),o&&(null===(r=e._versionHistoryDialog)||void 0===r||r.removeVersionsAndSelectNext(e._revisionIDsToDelete,o))}))()}getVersionSelectedEvent(){return this._onVersionSelectedEvent}getCloseSelectedEvent(){return this._onCloseSelectedEvent}getSaveACopySelectedEvent(){return this._onSaveACopySelectedEvent}getDownloadVersionSelectedEvent(){return this._onDownloadVersionSelectedEvent}getRestoreVersionSelectedEvent(){return this._onRestoreVersionSelectedEvent}getIteratorSelectedEvent(){return this._onIteratorSelectedEvent}getVersionsReadyEvent(){return this._onVersionsReadyEvent}getAppRefreshTriggeredEvent(){return this._onAppRefreshTriggeredEvent}getDownloadTokenReadyEvent(){return this._onDownloadTokenReadyEvent}getTipVersionTokenReadyEvent(){return this._onTipVersionTokenReadyEvent}getFullAppErrorEvent(){return this._fullAppErrorEvent}getShowVersionChangesToggledEvent(){return this._onShowVersionChangesToggledEvent}onVersionsReady(e){this._versionHistoryDialog&&e&&e.versions&&this._versionHistoryDialog.insertVersionsAndClearLoading(e.versions.filter((e=>e)))}onDownloadTokenReady(e){if(!this._versionHistoryDialog||!e||!e.updatedVersions)return;const t=e.updatedVersions.filter((e=>e));!e.versionSelected||!e.versionSelected.currentVersion||this._versionHistoryDialog.selectedVersionId&&this._versionHistoryDialog.selectedVersionId!==e.versionSelected.currentVersion.RevisionID?this._versionHistoryDialog.insertVersions(t):this._versionHistoryDialog.setVersionsAndSelectVersion(t,e.versionSelected)}onTipVersionTokenReady(e){if(this._versionHistoryDialog&&e&&e.tipVersion&&e.tipVersion.DownloadUrl&&e.updatedVersions&&e.updatedVersions[0]&&e.tipVersion.DownloadUrl===e.updatedVersions[0].DownloadUrl){const t=e.updatedVersions.filter((e=>e));this._versionHistoryDialog.selectedVersionId&&this._versionHistoryDialog.selectedVersionId!==e.updatedVersions[0].RevisionID?this._versionHistoryDialog.insertVersions(t):this._versionHistoryDialog.setVersionsAndSelectVersion(t,{currentVersion:e.updatedVersions[0],noBaseToCompareTo:!1})}}onDeleteVersionsSelectedEvent(e){this._revisionIDsToDelete=e,this.setDeleteConfirmation()}fullAppError(e){this._versionHistoryDialog&&this._versionHistoryDialog.hitFullAppError(e)}constructor(e,t,o,r,n,a,l,d){this._onVersionsReadyEvent=new f,this._onDownloadTokenReadyEvent=new f,this._fullAppErrorEvent=new f,this._onVersionSelectedEvent=new f,this._onTipVersionTokenReadyEvent=new f,this._onCloseSelectedEvent=new f,this._onSaveACopySelectedEvent=new f,this._onDownloadVersionSelectedEvent=new f,this._onRestoreVersionSelectedEvent=new f,this._onIteratorSelectedEvent=new f,this._onAppRefreshTriggeredEvent=new f,this._onShowVersionChangesToggledEvent=new f,this._disableFileCache=!1,i.Hv.setLogger(t),this._perfTelemetryInfos=d,this._appSettings=l||{appName:s.NotSet,wdEnableDownloadTokens:!1,retryCount:3,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:"",serverSessionId:"",wacCluster:"",uiLocale:"en-us",isRtl:!1,useXhr:!1,viewerRootPositionRelative:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,disabledChangeGates:"",wdEnableAppColorUpdate:!1,wdDisableSPOFileCache:!1,wdDisableODCFileCache:!1,wdEnableAppVHProvider:!1,wdDisableFileStoreAPI:!1},m.UILocale=this._appSettings.uiLocale,this._versionHistoryStringsBag=e,this._versionHistoryCache=new _(this._onVersionsReadyEvent,this._onDownloadTokenReadyEvent,this._fullAppErrorEvent,this._onTipVersionTokenReadyEvent,o,r,this._appSettings,n,a,this._perfTelemetryInfos),this._revisionIDsToDelete=[],this._onVersionsReadyEvent.addListener(this.onVersionsReady.bind(this)),this._onDownloadTokenReadyEvent.addListener(this.onDownloadTokenReady.bind(this)),this._fullAppErrorEvent.addListener(this.fullAppError.bind(this)),this._onTipVersionTokenReadyEvent.addListener(this.onTipVersionTokenReady.bind(this)),c.setDisabledChangeGates(this._appSettings.disabledChangeGates||""),this._disableFileCache=!!this._appSettings.wdDisableSPOFileCache||!!this._appSettings.wdDisableODCFileCache}}class nt{static createVersionHistoryController(e,t,o,r,s,n,i){const a=_object_spread({},OfficeVersionHistoryStrings,FriendlyDatesStrings);return new st(a,e,t,o,r,s,n,i)}}var it,at,lt;!function(e){e[e.None=0]="None",e[e.VHUnknown=1]="VHUnknown",e[e.VHFailedToLoadVersionList=100]="VHFailedToLoadVersionList",e[e.VHFailedToGetDownloadToken=101]="VHFailedToGetDownloadToken",e[e.VHFailedToParseVersionList=102]="VHFailedToParseVersionList",e[e.VHFetchFailed=103]="VHFetchFailed",e[e.VHVersioningNotEnabled=104]="VHVersioningNotEnabled",e[e.VHFileNotFound=105]="VHFileNotFound",e[e.VHVersionTooOld=106]="VHVersionTooOld",e[e.VHFetchException=107]="VHFetchException",e[e.VHServiceUnavailable=108]="VHServiceUnavailable",e[e.VHBadGateway=109]="VHBadGateway",e[e.VHUnauthorized=110]="VHUnauthorized",e[e.VHInternalServerError=111]="VHInternalServerError",e[e.VHEmptyVersionMetadatas=112]="VHEmptyVersionMetadatas",e[e.VHFailedHostDownload=113]="VHFailedHostDownload",e[e.VHFailedToAddDownloadToVersionStore=114]="VHFailedToAddDownloadToVersionStore",e[e.VHFailedToCacheParts=115]="VHFailedToCacheParts",e[e.VHFailedToDownloadVersionMetadata=116]="VHFailedToDownloadVersionMetadata",e[e.VHFailedToDownloadParts=117]="VHFailedToDownloadParts",e[e.VHInvalidDocID=118]="VHInvalidDocID",e[e.VHMissingDocID=119]="VHMissingDocID",e[e.VHNullDocID=120]="VHNullDocID",e[e.VHNullHashedDocID=121]="VHNullHashedDocID",e[e.VHNullGetDownloadAccessTokenRequest=122]="VHNullGetDownloadAccessTokenRequest",e[e.VHFailedToDownloadVersionFromHost=123]="VHFailedToDownloadVersionFromHost",e[e.VHNullResponseFromFetch=124]="VHNullResponseFromFetch",e[e.VHGetTipVersionException=125]="VHGetTipVersionException",e[e.VHGetVersionsException=126]="VHGetVersionsException",e[e.VHGetDownloadTokenException=127]="VHGetDownloadTokenException",e[e.VHFetchRetryException=128]="VHFetchRetryException",e[e.VHNullResponseFromRequestVersionHistory=129]="VHNullResponseFromRequestVersionHistory",e[e.VHNullResponseFromRequestDownloadToken=130]="VHNullResponseFromRequestDownloadToken",e[e.VHXhrJsonParseFailed=131]="VHXhrJsonParseFailed",e[e.VHXhrException=132]="VHXhrException",e[e.VHNullResponseFromXhr=133]="VHNullResponseFromXhr",e[e.VHFileGone=134]="VHFileGone",e[e.VHNullRevisionIDs=135]="VHNullRevisionIDs",e[e.VHRequestDeleteVersionsException=136]="VHRequestDeleteVersionsException",e[e.VHNullResponseFromRequestDeleteVersions=137]="VHNullResponseFromRequestDeleteVersions",e[e.VHVersionInfoFromTipVersionException=138]="VHVersionInfoFromTipVersionException"}(it||(it={})),function(e){e[e.NotSet=0]="NotSet",e[e.PowerPoint=100]="PowerPoint",e[e.Word=110]="Word",e[e.Excel=120]="Excel",e[e.OneNote=130]="OneNote"}(at||(at={})),function(e){e[e.None=0]="None",e[e.Share=1]="Share",e[e.Rename=2]="Rename",e[e.Restore=3]="Restore"}(lt||(lt={}));const ct=new class{getVersionHistoryControllerInstance(e){if(e&&e.docId&&e.ulsLogger)return nt.createVersionHistoryController(e.ulsLogger,null===e.serviceBase||void 0===e.serviceBase?"":e.serviceBase,e.docId,null===e.latestStreamServiceBase||void 0===e.latestStreamServiceBase?"":e.latestStreamServiceBase,void 0,e.appSettings,e.perfTelemetryInfos)}}},44923:function(e,t,o){"use strict";o.d(t,{G7:function(){return c},J9:function(){return l},Kf:function(){return g},SH:function(){return h},ZI:function(){return u},Zb:function(){return a},Zp:function(){return p},gI:function(){return d}});var r=o(38757);let s,n,i;function a(e){s=e;try{n=JSON.parse(p("DisabledChangeGates","{}"))}catch(e){n={}}}function l(e){i=e}function c(e,t=!1){return(i?i(e):!!s&&!!s[e]&&"true"===s[e].toLowerCase())||(0,r.iP)(e,t)}function d(e,t){return(0,r.Z8)(e,t)}function p(e,t){return s&&s[e]?s[e]:t}function h(e){const t=p(e,"[]");return JSON.parse(t)}function u(e,t){const o=p(e,"");return!(n&&t in n||o.split(",").some((e=>e===t)))}function g(e,t,o){const r=p(e,"");return!(n&&t in n||r.split(o).some((e=>e.trim()===t)))}},38757:function(e,t,o){"use strict";let r;o.d(t,{Z8:function(){return n},be:function(){return a},iP:function(){return i},jE:function(){return s}});const s=e=>{r=e},n=(e,t)=>r?r.getIntFeatureGate(e,t):t,i=(e,t=!1)=>r?r.getBooleanFeatureGate(e,t):t,a=(e,t)=>r?r.getStringFeatureGate(e,t):t},51796:function(e){e.exports={CancelGlyph_16:"CancelGlyph_16",ArrowStyle3_20:"ArrowStyle3_20",ArrowBack_20:"ArrowBack_20",BackChevronPaddle_24:"BackChevronPaddle_24",NextChevronPaddle_24:"NextChevronPaddle_24",CommonControlChevronRight_16:"CommonControlChevronRight_16",CommonControlChevronLeft_16:"CommonControlChevronLeft_16",CommonControlChevronDown_16:"CommonControlChevronDown_16",UpChevronMedium_20:"UpChevronMedium_20",DownChevronMedium_20:"DownChevronMedium_20",CommonControlMore_12:"CommonControlMore_12",Ellipsis_12:"Ellipsis_12",HintBarEllipses_20:"HintBarEllipses_20",CancelGlyph_16:"CancelGlyph_16",CommonControlChevronDown_8:"CommonControlChevronDown_8",CommonControlChevronDownGlyph_8:"CommonControlChevronDownGlyph_8",CommonControlChevronDownGlyph_12:"CommonControlChevronDownGlyph_12",CommonControlChevronUp_8:"CommonControlChevronUp_8",CommonControlChevronRight_12:"CommonControlChevronRight_12",CommonControlChevronRight_16:"CommonControlChevronRight_16",CommonControlChevronLeft_16:"CommonControlChevronLeft_16",CommonControlCheckboxCheck_16:"CommonControlCheckboxCheck_16",CheckmarkWithDynamicColor_16:"CheckmarkWithDynamicColor_16",CommonControlDialogLauncher_8:"CommonControlDialogLauncher_8"}}}]);
//# sourceMappingURL=versionHistory.min.js.map