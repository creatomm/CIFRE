var $jscomp={scope:{},getGlobal:function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.patches={};$jscomp.patch=function(a,b){($jscomp.patches[a]=$jscomp.patches[a]||[]).push(b);for(var e=$jscomp.global,d=a.split("."),k=0;k<d.length-1&&e;k++)e=e[d[k]];d=d[d.length-1];e&&e[d]instanceof Function&&(e[d]=b(e[d]))};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global.Symbol){$jscomp.global.Symbol=$jscomp.Symbol;var a=[],b=function(b){return function(d){a=[];d=b(d);for(var k=[],h=0,C=d.length;h<C;h++){var y;a:if(y=d[h],y.length<$jscomp.SYMBOL_PREFIX.length)y=!1;else{for(var l=0;l<$jscomp.SYMBOL_PREFIX.length;l++)if(y[l]!=$jscomp.SYMBOL_PREFIX[l]){y=!1;break a}y=!0}y?a.push(d[h]):k.push(d[h])}return k}};$jscomp.patch("Object.keys",b);$jscomp.patch("Object.getOwnPropertyNames",b);$jscomp.patch("Object.getOwnPropertySymbols",
function(e){return function(d){b.unused=Object.getOwnPropertyNames(d);a.push.apply(e(d));return a}})}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+a+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};
function getLogger(a,b){var e=new bUlsCache(a,b);return{ULS:{trace:function(a,k,h){return traceTagImpl(e,0,a,k,h)},traceTag:function(a,k,h,b){return traceTagImpl(e,a,k,h,b)},flush:e.flush,flushOnClose:e.flushOnClose}}}function getExperimentLogger(a,b,e,d){var k=new bUlsCache(a,b);return k.configure(e,d),{ULS:{trace:function(a,d,b){return traceTagImpl(k,0,a,d,b)},traceTag:function(a,d,b,e){return traceTagImpl(k,a,d,b,e)},flush:k.flush,flushOnClose:k.flushOnClose}}}
function traceTagImpl(a,b,e,d,k){d>currentLevel||(b={timestamp:Date.now(),category:e,tag:b,level:d,type:logType.Trace,message:k},a.handleTrace(b))}function formatForUpload(a,b,e,d){a=a.map(function(a){return getLogEntryInWireFormat(a,d)});b=getLogBatchInWireFormat(d,a,b,e);return JSON.stringify(b)}function getLogEntryInWireFormat(a,b){var e={},d;return e.G=a.tag,e.T=a.timestamp-b,e.M=a.message,e.C=a.category,d=a.type*shiftFactory+a.level,e.D=d,e}
function getLogBatchInWireFormat(a,b,e,d){var k={};return k.T=a,k.L=b,k.S=e,k.I=d,k.V=1,k}function uploadLogs(a,b,e){if(""!==b){var d=new XMLHttpRequest;d.readyState!==XMLHttpRequest.UNSENT&&d.readyState!==XMLHttpRequest.DONE||(d.open("POST",b,e),d.send(a))}}var logLevel,ULS,currentLevel,bUlsCache,shiftFactory,logCategory,logType,PowerPointOnline;(function(a){a[a.Spam=200]="Spam";a[a.Verbose=100]="Verbose";a[a.Info=50]="Info";a[a.Warning=15]="Warning";a[a.Error=10]="Error"})(logLevel||(logLevel={}));
ULS={getLogger:getLogger,getExperimentLogger:getExperimentLogger};currentLevel=logLevel.Info;
bUlsCache=function(){function a(a,e){var d=this;this.uploadCadenceInMsSec=3E4;this.uploadTriggerSize=30;this.uploadId=0;this.logCache=[];this.timestampBase=Date.now();this.userSessionId="00000000-0000-0000-0000-000000000000";this.flushOnClose=function(){d.triggerUpload(!1,!1)};this.flush=function(){d.triggerUploadAsync()};this.triggerUploadAsync=function(){window.setTimeout(function(){return d.triggerUpload(!0,!0)},0)};this.triggerUpload=function(a,h){if(window.clearTimeout(d.timeoutId),0<d.logCache.length){d.uploadId+=
1;var b=formatForUpload(d.logCache,d.userSessionId,d.uploadId,d.timestampBase);uploadLogs(b,d.remoteUrlEndpoint,h);d.logCache=[];d.timestampBase=Date.now()}a&&(d.timeoutId=window.setTimeout(d.triggerUploadAsync,d.uploadCadenceInMsSec))};this.userSessionId=a;this.remoteUrlEndpoint=e+"?usid="+a;window.setTimeout(function(){return d.triggerUpload(!0,!0)},0)}return a.prototype.configure=function(a,e){this.uploadCadenceInMsSec=a;this.uploadTriggerSize=e},a.prototype.handleTrace=function(b){b.message.length>
a.messageMaxChars&&(b.message=b.message.substr(0,a.messageMaxChars-a.trimedMessage.length)+a.trimedMessage);this.logCache.push(b);(this.logCache.length>this.uploadTriggerSize||b.level===logLevel.Error)&&this.triggerUploadAsync()},a.messageMaxChars=3072,a.trimedMessage="... [Trimmed]",a}();shiftFactory=1E3;
(function(a){a[a.WordViewer=301]="WordViewer";a[a.WopiPendingApplication=379]="WopiPendingApplication";a[a.VisioApp=700]="VisioApp";a[a.PptNavigation=810]="PptNavigation";a[a.PptSession=817]="PptSession";a[a.PptVersionHistory=832]="PptVersionHistory";a[a.PptLive=833]="PptLive"})(logCategory||(logCategory={}));(function(a){a[a.Trace=0]="Trace";a[a.Assert=1]="Assert"})(logType||(logType={}));
(function(a){(function(a){var e=function(){function a(){}return a.prototype.trace=function(a,h,d){this.traceTag(0,a,h,d)},a.prototype.traceTag=function(a,h,d,b){switch(d){case logLevel.Verbose:a=console.debug;break;case logLevel.Info:a=console.log;break;case logLevel.Warning:case logLevel.Error:a=console.error;break;default:a=console.error}a(b)},a}();a.ConsoleSessionLogger=e;e=function(){function a(d,h){try{this.logger=ULS.getLogger(d,h+"RemoteUls.ashx")}catch(b){}}return a.prototype.trace=function(a,
h,d){null!=this.logger&&this.logger.ULS.trace(a,h,d)},a.prototype.traceTag=function(a,h,d,b){null!=this.logger&&this.logger.ULS.traceTag(a,h,d,b)},a.prototype.flush=function(){null!=this.logger&&this.logger.ULS.flush()},a.prototype.flushOnClose=function(){null!=this.logger&&this.logger.ULS.flushOnClose()},a}();a.UlsSessionLogger=e;e=function(){function a(){}return a.init=function(a){this.logger=a},a.trace=function(a,h,b){null!=this.logger&&this.logger.trace(a,h,b)},a.traceTag=function(a,h,b,d){null!=
this.logger&&this.logger.traceTag(a,h,b,d)},a}();a.SessionLogger=e})(a.Telemetry||(a.Telemetry={}))})(PowerPointOnline||(PowerPointOnline={}));var __awaiter=this&&this.__awaiter||function(a,b,e,d){function k(a){return a instanceof e?a:new e(function(b){b(a)})}return new (e||(e=Promise))(function(h,e){function y(a){try{z(d.next(a))}catch(G){e(G)}}function l(a){try{z(d["throw"](a))}catch(G){e(G)}}function z(a){a.done?h(a.value):k(a.value).then(y,l)}z((d=d.apply(a,b||[])).next())})},SHA1=function(){};
SHA1.RotateLeft=function(a,b){return a<<b|a>>32-b};SHA1.ConvertHex=function(a){var b=[],e,d;for(e=7;0<=e;e--)d=a>>4*e&15,b.push(d.toString(16));return b.join("")};SHA1.Utf8Encode=function(a){a=a.replace("\r\n","\n");for(var b="",e=0;e<a.length;e++){var d=a.charCodeAt(e);128>d?b+=String.fromCharCode(d):(127<d&&2048>d?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128))}return b};
SHA1.GenerateSHA1=function(a){var b,e,d=1732584193,k=4023233417,h=2562383102,C=271733878,y=3285377520,l,z,m,G,K=0,f=Array(80);a=SHA1.Utf8Encode(a);l=a.length;var c=[];for(b=0;b<l-3;b+=4)e=a.charCodeAt(b)<<24|a.charCodeAt(b+1)<<16|a.charCodeAt(b+2)<<8|a.charCodeAt(b+3),c.push(e);switch(l%4){case 0:K=2147483648;break;case 1:K=a.charCodeAt(l-1)<<24|8388608;break;case 2:K=a.charCodeAt(l-2)<<24|a.charCodeAt(l-1)<<16|32768;break;case 3:K=a.charCodeAt(l-3)<<24|a.charCodeAt(l-2)<<16|a.charCodeAt(l-1)<<8|
128}for(c.push(K);14!=c.length%16;)c.push(0);c.push(l>>29);c.push(l<<3&4294967295);for(a=0;a<c.length;a+=16){for(b=0;16>b;b++)f[b]=c[a+b];for(b=16;79>=b;b++)f[b]=SHA1.RotateLeft(f[b-3]^f[b-8]^f[b-14]^f[b-16],1);e=d;l=k;z=h;m=C;G=y;for(b=0;19>=b;b++)K=SHA1.RotateLeft(e,5)+(l&z|~l&m)+G+f[b]+1518500249&4294967295,G=m,m=z,z=SHA1.RotateLeft(l,30),l=e,e=K;for(b=20;39>=b;b++)K=SHA1.RotateLeft(e,5)+(l^z^m)+G+f[b]+1859775393&4294967295,G=m,m=z,z=SHA1.RotateLeft(l,30),l=e,e=K;for(b=40;59>=b;b++)K=SHA1.RotateLeft(e,
5)+(l&z|l&m|z&m)+G+f[b]+2400959708&4294967295,G=m,m=z,z=SHA1.RotateLeft(l,30),l=e,e=K;for(b=60;79>=b;b++)K=SHA1.RotateLeft(e,5)+(l^z^m)+G+f[b]+3395469782&4294967295,G=m,m=z,z=SHA1.RotateLeft(l,30),l=e,e=K;d=d+e&4294967295;k=k+l&4294967295;h=h+z&4294967295;C=C+m&4294967295;y=y+G&4294967295}return(SHA1.ConvertHex(d)+SHA1.ConvertHex(k)+SHA1.ConvertHex(h)+SHA1.ConvertHex(C)+SHA1.ConvertHex(y)).toLowerCase()};var UlsSessionLogger=PowerPointOnline.Telemetry.UlsSessionLogger,PowerPointLive;
(function(a){var b=function(){};a.StartLiveSessionResult=b;var e=function(){};a.RendezvousSessionInfo=e;a.RendezvousSessionConfig=function(){};var d=function(){this.sessionStartUtc=this.action=this.sessionId="";this.accessControl="Anyone";this.sessionExitPoint=this.sessionEntryPoint=this.transcriberSessionIds=this.rendezvousServiceEnvironment=this.hostAuthType=this.pragueDocId="";this.startAttemptCount=this.sessionDurationInMS=this.sessionActiveDurationInMS=0;this.documentDownloadUrlOnStartLiveFetchTimeInMS=
this.pragueInitCallTimeInMS=this.rendezvousSessionCreationTimeInMS=this.authTokenOnStartLiveFetchTimeInMS=this.sessionCreationWebServiceCallTimeInMS=-1;this.calloutShownCount=this.welcomeShownCount=this.sessionResumeCount=this.sessionPauseCount=this.maxParticipantCount=0;this.isSubtitleStartedByLive=!1;this.errorMessage=this.errorCode="";this.hasUnexpectedError=!1;this.welcomeScreenDurations=[];this.welcomeScreenFirstTimeDuration=0;this.sessionEndedBeforePragueInitialized=!1;this.stateServiceMetrics=
""};d.prototype.SetErrorCode=function(a,m){0==this.errorCode.length&&a!=l.ErrorNone&&(this.errorCode=l[a],this.errorMessage=void 0===m?"":m)};a.LiveSessionTelemetryData=d;var k=function(){this.liveBroadcaster=null;this.telemetryData=new d};k.prototype.SetLiveBroadcast=function(a){this.liveBroadcaster=a};k.prototype.SetStateServiceMetrics=function(){null!=this.liveBroadcaster&&(this.telemetryData.stateServiceMetrics=JSON.stringify(this.liveBroadcaster.getServiceTelemetry()))};a.LiveSessionTelemetry=
k;var h=function(){},C=function(){};a.SurveyInfo=C;var y=function(){};a.LiveReaction=y;(function(a){a[a.Disconnected=0]="Disconnected";a[a.Connected=1]="Connected";a[a.Connecting=2]="Connecting"})(a.ConnectionState||(a.ConnectionState={}));var l;(function(a){a[a.ErrorNone=0]="ErrorNone";a[a.ErrorFailedToFetchDocumentDownloadURL=1]="ErrorFailedToFetchDocumentDownloadURL";a[a.ErrorFailedToInitializePrague=2]="ErrorFailedToInitializePrague";a[a.ErrorDisconnectedToPrague=3]="ErrorDisconnectedToPrague";
a[a.ErrorFailedToStartLiveBroadcast=4]="ErrorFailedToStartLiveBroadcast";a[a.ErrorFailedToPauseLiveBroadcast=5]="ErrorFailedToPauseLiveBroadcast";a[a.ErrorFailedToResumeLiveBroadcast=6]="ErrorFailedToResumeLiveBroadcast";a[a.ErrorFailedToEndLiveBroadcast=7]="ErrorFailedToEndLiveBroadcast";a[a.ErrorFailedToFetchAuthToken=8]="ErrorFailedToFetchAuthToken";a[a.ErrorFailedToCreateRendezvousSession=9]="ErrorFailedToCreateRendezvousSession";a[a.ErrorFailedToPauseRendezvousSession=10]="ErrorFailedToPauseRendezvousSession";
a[a.ErrorFailedToResumeRendezvousSession=11]="ErrorFailedToResumeRendezvousSession";a[a.ErrorFailedToEndRendezvousSession=12]="ErrorFailedToEndRendezvousSession";a[a.ErrorFailedToCreateSurvey=13]="ErrorFailedToCreateSurvey";a[a.ErrorFailedToRefreshFileUrl=14]="ErrorFailedToRefreshFileUrl";a[a.ErrorFailedToTriggerSaveThumbnails=15]="ErrorFailedToTriggerSaveThumbnails";a[a.ErrorFailedToCollectShowInfoForAudienceFeedback=16]="ErrorFailedToCollectShowInfoForAudienceFeedback";a[a.ErrorFailedToTryTriggerAudienceFeedback=
17]="ErrorFailedToTryTriggerAudienceFeedback"})(l=a.ErrorCode||(a.ErrorCode={}));a.PPTBroadcastMonitorSettings=function(){this.delayInSecsToCloseBroadcasterOnPause=-1;this.documentSnapshotFileSnapDownloadUrlGenerator=this.documentSnapshotRequestUrlGenerator=null;this.enableTransientSessionHandling=!1};k=function(a){this.fileInfo=null;this.welcomeScreenState=!0;this.liveBroadcaster=null;this.participantsCount=0;this.connectionStateEventListener=this.newReactionEventListener=this.participantsCountChangeEventListener=
null;this.sessionId="";this.logger=null;this.documentDownloadUrlLastFetchTimeInMS=-1;this.telemetry=null;this.deferredBroadcasterClosingTimerId=0;this.correlationId="";this.presenterState=this.sessionState=this.sessionStarterAuthTokenPromise=null;this.settings=a;this.pragueSessionInfo=this.rendezvousSessionInfo=null};k.prototype.SetCurrentPosition=function(a,m,G){this.currentSlideState={location:{slideId:{sid:a,cid:0},slideIndex:m},timelineMappings:G?G.map(function(a){return{timelineId:a.TimeLineId,
step:a.Step,sequenceId:""}}):null};this.SetSlideState()};k.prototype.RegisterParticipantsCountChangeEventListener=function(a){null==this.participantsCountChangeEventListener?this.participantsCountChangeEventListener=a:this.traceTag(50455765,logCategory.PptLive,logLevel.Error,"Currently we only support single listener for participant count change event!")};k.prototype.RegisterNewReactionEventListener=function(a){null==this.newReactionEventListener?this.newReactionEventListener=a:this.traceTag(51406347,
logCategory.PptLive,logLevel.Error,"Currently we only support single listener for new reaction event!")};k.prototype.RegisterConnectionStateEventListener=function(a){null==this.connectionStateEventListener?this.connectionStateEventListener=a:this.traceTag(594416988,logCategory.PptLive,logLevel.Error,"Currently we only support single listener for connection state!")};k.prototype.SetDefaultSubtitlesLanguage=function(a){try{null!=this.liveBroadcaster&&(this.liveBroadcaster.defaultSubtitleLanguage=a)}catch(m){this.traceTag(595140928,
logCategory.PptLive,logLevel.Error,"Exception thrown in PPTBroadCastMonitor::SetDefaultSubtitlesLanguage: ",m.message)}};k.prototype.UpdateFinalSubtitles=function(a){try{if(this.isBroadcastSessionActive){var m=new Map;a.forEach(function(a){m.set(a.language,{subtitle:a.transript})});this.liveBroadcaster.finalSubtitles=m}else this.traceTag(50455769,logCategory.PptLive,logLevel.Error,"UpdateFinalSubtitles called while live session is inactive!")}catch(G){this.traceTag(50455770,logCategory.PptLive,logLevel.Error,
"Exception thrown in UpdateFinalSubtitles: ",G.message)}};k.prototype.UpdatePartialSubtitles=function(a){try{if(this.isBroadcastSessionActive){var m=new Map;a.forEach(function(a){m.set(a.language,a.transript)});this.liveBroadcaster.partialSubtitles=m}else this.traceTag(50455771,logCategory.PptLive,logLevel.Error,"UpdatePartialSubtitles called while live session is inactive!")}catch(b){this.traceTag(50455772,logCategory.PptLive,logLevel.Error,"Exception thrown in UpdatePartialSubtitles: ",b.message)}};
k.prototype.FetchDocumentDownloadURL=function(a){return __awaiter(this,void 0,void 0,function(){function m(c,g){for(;;)switch(b){case 0:h=f;try{var m=(new Date).getTime(),d=f.downloadRequestUrl==a;f.downloadRequestUrl=a;f.downloadUrlPromise=fetch(f.downloadRequestUrl).then(function(a){return __awaiter(h,void 0,void 0,function(){function c(h,b){for(;;)switch(g){case 0:if(a.ok){g=1;break}g=2;return{value:a.text(),done:!1};case 2:if(void 0===b){g=3;break}g=-1;throw b;case 3:throw m=z=h,f="Unavailable",
null!=a.headers&&a.headers.has("X-CorrelationId")&&(f=a.headers.get("X-CorrelationId")),g=-1,Error("Document download URL request failed with statusText: "+a.statusText+", statusCode: "+a.status+", responseText: "+m+", correlationId: "+f+" !");case 1:return g=-1,{value:a.json(),done:!0};default:return{value:void 0,done:!0}}}var g=0,f,m,z,h={next:function(a){return c(a,void 0)},"throw":function(a){return c(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();
h[Symbol.iterator]=function(){return this};return h})}).then(function(a){a=a.downloadUrl;var c=h.documentDownloadUrl==a,g=h.CalculateUrlHash(a),f=(new Date).getTime()-m;h.documentDownloadUrlLastFetchTimeInMS=f;h.traceTag(50734992,logCategory.PptLive,logLevel.Info,"RefreshDocumentDownloadURL Info: isDownloadRequestUrlSame: "+d+" isDownloadUrlSame: "+c+" requestTime (in MS) :"+f+" urlHash: "+g);return a})["catch"](function(a){h.traceTag(50872784,logCategory.PptLive,logLevel.Error,"Error catched in document download Url request promise: ",
a.toString());throw Error("Document download URL request failed with error of "+a.toString()+"!");})}catch(e){f.traceTag(50455773,logCategory.PptLive,logLevel.Error,"Exception thrown in FetchDocumentDownloadURL: ",e.message)}b=-1;default:return{value:void 0,done:!0}}}var b=0,h,f=this,c={next:function(a){return m(a,void 0)},"throw":function(a){return m(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();c[Symbol.iterator]=function(){return this};return c})};
k.prototype.InitializePrague=function(){return __awaiter(this,void 0,void 0,function(){function a(c,g){for(;;)switch(m){case 0:return f.liveBroadcaster=PPTLiveBroadcast.createPPTLiveBroadcast(),b={pragueDocID:f.pragueSessionInfo.pragueDocId,preferredSubtitleLanguage:f.settings.preferredSubtitleLanguage,isPresenter:!0,routerlicious:f.pragueSessionInfo.pragueRouterlicious,historian:f.pragueSessionInfo.pragueHistorian,tenant:f.pragueSessionInfo.pragueTenant,secret:f.pragueSessionInfo.pragueSecret,timeoutDurationInMs:f.settings.pragueInitTimeoutInMS,
batchedRequestsEnabled:f.settings.batchedRequestsEnabled,logger:new OfficeOnline.Telemetry.ProxyLogger(f.logger),websocketAliveTimeAfterLoseFocusInMS:f.settings.websocketAliveTimeAfterLoseFocusInMs,pingTimeoutInMs:f.settings.pingTimeoutInMs,pongTimeoutInMs:f.settings.pongTimeoutInMs,correlationId:f.correlationId,isAutomation:f.telemetry.telemetryData.isAutomation,maxRoundtripRaw:f.settings.maxStateServiceRoundtripRaw},h=Date.now(),m=1,{value:f.liveBroadcaster.init(b),done:!1};case 1:if(void 0===g){m=
2;break}m=-1;throw g;case 2:f.telemetry.telemetryData.pragueInitCallTimeInMS=Date.now()-h,f.telemetry.SetLiveBroadcast(f.liveBroadcaster),f.traceTag(50455774,logCategory.PptLive,logLevel.Info,"Prague initialized: ",{HashedDocid:f.pragueSessionInfo.pragueDocId,HashedRouterlicious:f.pragueSessionInfo.pragueRouterlicious,HashedHistorian:f.pragueSessionInfo.pragueHistorian,HashedPragueClientId:f.liveBroadcaster.clientId}),m=-1;default:return{value:void 0,done:!0}}}var m=0,h,b,f=this,c={next:function(c){return a(c,
void 0)},"throw":function(c){return a(void 0,c)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();c[Symbol.iterator]=function(){return this};return c})};k.prototype.RefreshDownloadUrlPromiseIfNeeded=function(){return __awaiter(this,void 0,void 0,function(){function a(g,z){for(;;)switch(m){case 0:if(null==c.settings.documentSnapshotRequestUrlGenerator){m=1;break}try{b=c.settings.documentSnapshotRequestUrlGenerator();if(!b||b===c.downloadRequestUrl){m=4;break}if(!c.downloadUrlPromise){m=
5;break}m=6;return{value:c.downloadUrlPromise,done:!1}}catch(d){f=d;m=2;break}case 6:try{if(void 0===z){m=7;break}m=-1;throw z;}catch(d){f=d;m=2;break}case 7:case 5:try{return c.traceTag(592310492,logCategory.PptLive,logLevel.Warning,"Refetching download url ..."),m=8,{value:c.FetchDocumentDownloadURL(b),done:!1}}catch(d){f=d;m=2;break}case 8:try{if(void 0===z){m=9;break}m=-1;throw z;}catch(d){f=d;m=2;break}case 9:case 4:try{m=3;break}catch(d){f=d;m=2;break}case 2:h=f,c.traceTag(592310491,logCategory.PptLive,
logLevel.Error,"Exception threw when checking and refetching download url:",h.message);case 3:case 1:m=-1;default:return{value:void 0,done:!0}}}var m=0,h,b,f,c=this,d={next:function(c){return a(c,void 0)},"throw":function(c){return a(void 0,c)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();d[Symbol.iterator]=function(){return this};return d})};k.prototype.SetupPrague=function(a){return __awaiter(this,void 0,void 0,function(){function h(g,m){for(;;)switch(b){case 0:f=
c;if(!c.settings.fileSnapDownloadUrl){b=1;break}c.settings.documentSnapshotFileSnapDownloadUrlGenerator&&(c.settings.fileSnapDownloadUrl=c.settings.documentSnapshotFileSnapDownloadUrlGenerator());c.documentDownloadUrl=c.settings.fileSnapDownloadUrl;b=2;break;case 1:return b=3,{value:c.RefreshDownloadUrlPromiseIfNeeded(),done:!1};case 3:if(void 0===m){b=4;break}b=-1;throw m;case 4:return b=5,{value:c.downloadUrlPromise["catch"](function(a){f.traceTag(593281174,logCategory.PptLive,logLevel.Info,"Refetch document download url");
f.FetchDocumentDownloadURL(f.settings.fileDownloadUrl);f.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchDocumentDownloadURL,a.toString());throw Error("Failed to get download Url on intializing Prague!");}),done:!1};case 5:if(void 0===m){b=6;break}b=-1;throw m;case 6:d=g,c.documentDownloadUrl=d;case 2:c.fileInfo.fileUrl=c.documentDownloadUrl,c.liveBroadcaster.fileInfo=c.fileInfo,c.telemetry.telemetryData.documentDownloadUrlOnStartLiveFetchTimeInMS=c.documentDownloadUrlLastFetchTimeInMS,c.isBroadcastSessionActive=
!0,c.SetSlideState(),c.settings.enableTransientSessionHandling?(c.SetSessionState("paused"!=c.sessionState?"active":c.sessionState),c.SetPresenterState(null!=c.presenterState?c.presenterState:"unmuted")):(c.SetSessionState("active"),c.SetPresenterState("unmuted")),c.SetWelcomeScreenState(!a&&c.welcomeScreenState),c.liveBroadcaster.on("activeParticipantCountChanged",function(a){null!=f.participantsCountChangeEventListener&&(f.participantsCount=a,f.participantsCountChangeEventListener(f.participantsCount))}),
c.liveBroadcaster.on("newReaction",function(a,c){if(null!=f.newReactionEventListener){var g=new y;g.react=a.react;a.slideId&&(g.slideId=a.slideId.sid);f.traceTag(51406348,logCategory.PptLive,logLevel.Info,"Received new reaction: ",{SlideId:g.slideId,HashedDocid:f.pragueSessionInfo.pragueDocId,HashedPragueClientId:f.liveBroadcaster.clientId});f.newReactionEventListener(g)}}),c.liveBroadcaster.on("connectionStateChanged",function(a){null!=f.connectionStateEventListener&&f.connectionStateEventListener(a)}),
b=-1;default:return{value:void 0,done:!0}}}var b=0,d,f,c=this,e={next:function(a){return h(a,void 0)},"throw":function(a){return h(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();e[Symbol.iterator]=function(){return this};return e})};k.prototype.ClosePrague=function(a){if(null!==this.liveBroadcaster){this.traceTag(593037071,logCategory.PptLive,logLevel.Info,"Closing Live broadcaster under context of "+a);try{this.liveBroadcaster.close()}catch(b){this.traceTag(593037070,
logCategory.PptLive,logLevel.Warning,"Exception thrown when closing Live boradcaster ...",b.message)}this.liveBroadcaster=null}};k.prototype.GetPragueSessionInfoJSONString=function(){return null!=this.pragueSessionInfo?JSON.stringify(this.pragueSessionInfo):""};k.prototype.SetSlideState=function(){return __awaiter(this,void 0,void 0,function(){function a(f,c){for(;;)switch(b){case 0:try{h.isBroadcastSessionActive&&(h.liveBroadcaster.navigationState={to:h.currentSlideState},h.traceTag(50455776,logCategory.PptLive,
logLevel.Info,"Slide set to: "+h.liveBroadcaster.navigationState.to.location.slideId.sid))}catch(d){h.traceTag(50455778,logCategory.PptLive,logLevel.Error,"Exception thrown in SetSlideState: ",d.message)}b=-1;default:return{value:void 0,done:!0}}}var b=0,h=this,d={next:function(b){return a(b,void 0)},"throw":function(b){return a(void 0,b)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();d[Symbol.iterator]=function(){return this};return d})};k.prototype.SetSessionState=
function(a){try{this.sessionState=a,null==this.liveBroadcaster||this.settings.enableTransientSessionHandling&&!this.isBroadcastSessionActive||(this.liveBroadcaster.sessionState=a,this.traceTag(50455779,logCategory.PptLive,logLevel.Info,"Live Session state set to: "+a))}catch(b){this.traceTag(50455808,logCategory.PptLive,logLevel.Error,"Exception thrown in SetSessionState: ",b.message)}};k.prototype.SetPresenterState=function(a){try{this.presenterState=a,null==this.liveBroadcaster||this.settings.enableTransientSessionHandling&&
!this.isBroadcastSessionActive||(this.liveBroadcaster.presenterState=a,this.traceTag(592307297,logCategory.PptLive,logLevel.Info,"Live presenter state set to: "+a))}catch(b){this.traceTag(592307296,logCategory.PptLive,logLevel.Error,"Exception thrown in SetPresenterState: ",b.message)}};k.prototype.SetWelcomeScreenState=function(a){try{this.welcomeScreenState=a,null!=this.liveBroadcaster&&this.isBroadcastSessionActive&&(this.liveBroadcaster.welcomeScreenState=a,this.traceTag(595191057,logCategory.PptLive,
logLevel.Info,"Live welcome screen state set to: "+a))}catch(b){this.traceTag(595191056,logCategory.PptLive,logLevel.Error,"Exception thrown in SetWelcomeScreenState: ",b.message)}};k.prototype.SetCurrentPollInfoState=function(a,b){try{null!=this.liveBroadcaster&&this.isBroadcastSessionActive&&(this.liveBroadcaster.pollInfoState={pollId:a,slideId:b})}catch(h){this.traceTag(556619101,logCategory.PptLive,logLevel.Error,"Exception thrown in SetCurrentPollIdState: ",h.message)}};k.prototype.TriggerSurvey=
function(a){try{this.isBroadcastSessionActive&&null!=this.liveBroadcaster?(this.liveBroadcaster.lastTriggeredSurveyInfo=a,this.traceTag(50858203,logCategory.PptLive,logLevel.Info,"Triggering survey")):this.traceTag(50858204,logCategory.PptLive,logLevel.Error,"TriggerSurvey called while live session is inactive!")}catch(b){this.traceTag(50858205,logCategory.PptLive,logLevel.Error,"Exception thrown in TriggerSurvey: ",b.message)}};k.prototype.CreateSurvey=function(a,b,h,d){var f=this;return null==this.rendezvousSessionInfo?
null:new Promise(function(c,e){return __awaiter(f,void 0,void 0,function(){function g(g,q){for(;;)switch(f){case 0:try{if(null!=a||null==x.sessionStarterAuthTokenPromise){f=3;break}f=4;return{value:x.sessionStarterAuthTokenPromise,done:!1}}catch(D){B=D;f=1;break}case 4:try{if(void 0===q){f=5;break}f=-1;throw q;}catch(D){B=D;f=1;break}case 5:try{a=Q=g}catch(D){B=D;f=1;break}case 3:try{f=2;break}catch(D){B=D;f=1;break}case 1:return p=B,x.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,
p.toString()),x.traceTag(590189791,logCategory.PptLive,logLevel.Error,"Exception thrown in CreateSurvey: ",p.toString()),e(p),f=-1,{value:void 0,done:!0};case 2:try{return x.traceTag(51168927,logCategory.PptLive,logLevel.Info,"Creating survey form"),J=null==h?x.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=CreateSurvey&sessionid="+x.rendezvousSessionInfo.sessionId+"&isusersurvey="+(null!=b)+"&cid="+x.correlationId:x.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=DuplicateSurvey&sessionid="+
x.rendezvousSessionInfo.sessionId+"&templatepollid="+h+"&pollorderindex="+d+"&cid="+x.correlationId,n=new Headers,x.settings.isBlueChicken&&n.append("OriginType","Test"),null!=a&&n.append("Authorization","Bearer "+a),t=fetch(J,{method:"POST",mode:"cors",headers:n,body:null!=b?JSON.stringify(b):""}),f=8,{value:t,done:!1}}catch(D){B=D;f=6;break}case 8:try{if(void 0===q){f=9;break}f=-1;throw q;}catch(D){B=D;f=6;break}case 9:try{v=w=g;if(1!=v.ok){f=10;break}x.traceTag(51168928,logCategory.PptLive,logLevel.Info,
"Rendezvous CreateSurvey service call succeeded!");f=12;return{value:v.json(),done:!1}}catch(D){B=D;f=6;break}case 12:try{if(void 0===q){f=13;break}f=-1;throw q;}catch(D){B=D;f=6;break}case 13:try{I=P=g;E=new C;E.isUserSurvey=I.IsUserSurvey;E.surveyId=I.SurveyId;E.surveyResponseUrl=I.SurveyResponseUrl;c(E);f=11;break}catch(D){B=D;f=6;break}case 10:try{u=v.headers&&v.headers.has("X-ErrorCode")?v.headers.get("X-ErrorCode"):"Unavailable",H=v.headers&&v.headers.has("X-FailureReason")?v.headers.get("X-FailureReason"):
"Unavailable",x.traceTag(51168929,logCategory.PptLive,logLevel.Error,"Rendezvous CreateSurvey service call failed with status of "+v.status+", X-ErrorCode: "+u+", X-FailureReason: "+H),e(Error(u))}catch(D){B=D;f=6;break}case 11:try{f=7;break}catch(D){B=D;f=6;break}case 6:k=B,x.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToCreateSurvey,k.toString()),x.traceTag(51168930,logCategory.PptLive,logLevel.Error,"Exception thrown in Rendezvous survey creation Promise!",k.toString()),e(k);case 7:f=-1;
default:return{value:void 0,done:!0}}}var f=0,k,H,u,E,I,P,v,w,t,n,J,p,Q,B,x=this,q={next:function(a){return g(a,void 0)},"throw":function(a){return g(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();q[Symbol.iterator]=function(){return this};return q})})};k.prototype.SetAudienceFeedbackInfo=function(a){try{this.liveBroadcaster&&(this.liveBroadcaster.audienceFeedbackInfo=a)}catch(b){this.traceTag(595122207,logCategory.PptLive,logLevel.Error,"Exception thrown in SetAudienceFeedbackInfo.",
b.message)}};k.prototype.CreateRendezvousSession=function(a,b){return __awaiter(this,void 0,void 0,function(){function h(G,H){for(;;)switch(d){case 0:return k=l.settings.rendezvousSvcBaseUri+"RendezvousHandler.ashx?action=CreateSession&accesscontrol="+a.accessControl+"&sessionid="+a.sessionId+"&cid="+l.correlationId,a.presenterTenantId&&(k=k+"&tenantid="+a.presenterTenantId),g=new Headers,l.settings.isBlueChicken&&g.append("OriginType","Test"),null!=b&&g.append("Authorization","Bearer "+b),l.traceTag(50455809,
logCategory.PptLive,logLevel.Info,"Creating a Live session",{AccessControl:a.accessControl}),e=new Date,c=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),d=1,{value:fetch(k,{method:"POST",mode:"cors",headers:g,body:JSON.stringify({Locale:a.locale,PresentationName:a.presentationName,LocalCreationTime:c,PodsUrl:a.webServiceBase,UseStateService:l.settings.useStateService,SharedSessionSettings:l.settings.sharedSessionSettings})}),done:!1};case 1:if(void 0===
H){d=2;break}d=-1;throw H;case 2:return f=G,d=-1,{value:f,done:!0};default:return{value:void 0,done:!0}}}var d=0,f,c,e,g,k,l=this,H={next:function(a){return h(a,void 0)},"throw":function(a){return h(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();H[Symbol.iterator]=function(){return this};return H})};k.prototype.StartLiveBroadcasting=function(a,h,d){var e=this;null!=this.rendezvousSessionInfo&&(this.traceTag(50857108,logCategory.PptLive,logLevel.Warning,
"Creating a new Live session while last end was not cleaned up/ended properly!"),this.rendezvousSessionInfo=null);this.settings.fileSnapDownloadUrl?null!=this.settings.documentSnapshotFileSnapDownloadUrlGenerator&&(this.settings.fileSnapDownloadUrl=this.settings.documentSnapshotFileSnapDownloadUrlGenerator()):void 0==this.downloadUrlPromise&&(null!=this.settings.documentSnapshotRequestUrlGenerator&&(this.settings.fileDownloadUrl=this.settings.documentSnapshotRequestUrlGenerator()),this.FetchDocumentDownloadURL(this.settings.fileDownloadUrl));
this.ClosePrague("StartLiveBroadcast");this.logger=new UlsSessionLogger(a.userSessionId,a.webServiceBase);this.telemetry=h;this.sessionId=a.sessionId;this.correlationId=a.correlationId;this.welcomeScreenState=!0;this.fileInfo={fileUrl:"",podsUrl:a.webServiceBase,bootstrapperUrl:a.bootstrapperUrl,applicationUrl:a.webServiceBase.replace("/pods","/p/PowerPointFrame.aspx?PowerPointView=ReadingView&<ui=UI_LLCC&><rs=DC_LLCC&><dchat=DISABLE_CHAT&><hid=HOST_SESSION_ID&><IsLicensedUser=BUSINESS_USER&><actnavid=ACTIVITY_NAVIGATION_ID&>"),
fileName:a.fileName,fileSize:a.fileSize,slideHeight:a.slideHeight,slideWidth:a.slideWidth,fileSource:a.fileSource,presentUrl:a.presentUrlEndpoint};return new Promise(function(f,c){return __awaiter(e,void 0,void 0,function(){function h(R,L){for(;;)switch(g){case 0:N=l.ErrorNone,M="",O=null,S=1;case 1:if(!(S<=F.settings.numMaxAttempts)){g=3;break}F.rendezvousSessionInfo=null;try{D=null;if(!a.presenterTenantId){g=6;break}F.traceTag(591955083,logCategory.PptLive,logLevel.Info,"Use presenter tenant Id and skip getting auth token");
F.sessionStarterAuthTokenPromise=a.authTokenFunc();g=7;break}catch(r){A=r;g=4;break}case 6:try{return C=Date.now(),g=10,{value:a.authTokenFunc(),done:!1}}catch(r){A=r;g=8;break}case 10:try{if(void 0===L){g=11;break}g=-1;throw L;}catch(r){A=r;g=8;break}case 11:try{D=y=R;F.telemetry.telemetryData.authTokenOnStartLiveFetchTimeInMS=Date.now()-C;g=9;break}catch(r){A=r;g=8;break}case 8:try{q=A;N=l.ErrorFailedToFetchAuthToken;M=q.toString();O=Error("Failed to get auth token on creating Live session: "+M);
F.traceTag(51479690,logCategory.PptLive,logLevel.Error,"Exception thrown in getting auth token: "+M);g=2;break}catch(r){A=r;g=4;break}case 9:case 7:try{x=void 0}catch(r){A=r;g=4;break}try{return B=Date.now(),g=14,{value:F.CreateRendezvousSession(a,D),done:!1}}catch(r){A=r;g=12;break}case 14:try{if(void 0===L){g=15;break}g=-1;throw L;}catch(r){A=r;g=12;break}case 15:try{x=Q=R;F.telemetry.telemetryData.rendezvousSessionCreationTimeInMS=Date.now()-B;g=13;break}catch(r){A=r;g=12;break}case 12:try{p=A;
J=F.settings.rendezvousSvcBaseUri.replace("http://","").replace("https://","");N=l.ErrorFailedToCreateRendezvousSession;M=p.message;O=p;F.traceTag(51479691,logCategory.PptLive,logLevel.Error,"Exception thrown in creating rendezvous session! Domain: "+J+", Online: "+navigator.onLine,p.message);g=2;break}catch(r){A=r;g=4;break}case 13:try{if(!x.ok){g=16;break}g=18;return{value:x.json(),done:!1}}catch(r){A=r;g=4;break}case 18:try{if(void 0===L){g=19;break}g=-1;throw L;}catch(r){A=r;g=4;break}case 19:try{if(t=
n=R,F.SetSessionInfo(t),F.traceTag(50455810,logCategory.PptLive,logLevel.Info,"Rendezvous CreateSession service call succeeded!"),w=new b,w.sessionInfo=F.rendezvousSessionInfo,w.authToken=D,w.numAttempt=S,!d){g=20;break}}catch(r){A=r;g=4;break}try{return g=24,{value:F.InitializePrague(),done:!1}}catch(r){A=r;g=22;break}case 24:try{if(void 0===L){g=25;break}g=-1;throw L;}catch(r){A=r;g=22;break}case 25:try{g=23;break}catch(r){A=r;g=22;break}case 22:try{v=A;N=l.ErrorFailedToInitializePrague;M=v.message;
O=v;F.traceTag(51479692,logCategory.PptLive,logLevel.Error,"Exception thrown in initializing prague session!",v.message);g=2;break}catch(r){A=r;g=4;break}case 23:try{if(!a.showQRCodeAfterFetchingDocDownloadUrl){g=26;break}g=27;return{value:F.EnsureDocumentDownloadUrlForNewLiveSession(),done:!1}}catch(r){A=r;g=4;break}case 27:try{if(void 0===L){g=28;break}g=-1;throw L;}catch(r){A=r;g=4;break}case 28:try{I=P=R;if(null==I){g=29;break}N=l.ErrorFailedToFetchDocumentDownloadURL;M=I.message;O=I;g=2;break}catch(r){A=
r;g=4;break}case 29:case 26:try{try{F.SetupPrague(!1)}catch(r){F.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToInitializePrague,r.message),F.traceTag(50455775,logCategory.PptLive,logLevel.Error,"Exception thrown in SetupPrague: ",r.message)}f(w);g=-1;return{value:void 0,done:!0}}catch(r){A=r;g=4;break}case 20:try{if(!a.showQRCodeAfterFetchingDocDownloadUrl){g=30;break}g=31;return{value:F.EnsureDocumentDownloadUrlForNewLiveSession(),done:!1}}catch(r){A=r;g=4;break}case 31:try{if(void 0===L){g=
32;break}g=-1;throw L;}catch(r){A=r;g=4;break}case 32:try{u=K=R;if(null==u){g=33;break}N=l.ErrorFailedToFetchDocumentDownloadURL;M=u.message;O=u;g=2;break}catch(r){A=r;g=4;break}case 33:case 30:try{return f(w),g=-1,{value:void 0,done:!0}}catch(r){A=r;g=4;break}case 21:try{g=17;break}catch(r){A=r;g=4;break}case 16:try{k=x.headers?x.headers.get("X-ErrorCode"):"";m=x.headers?x.headers.get("X-FailureReason"):"";N=l.ErrorFailedToCreateRendezvousSession;M=k;F.traceTag(50455811,logCategory.PptLive,logLevel.Error,
"Rendezvous CreateSession service call failed with status of "+x.status+", X-ErrorCode: "+k+", X-FailureReason: "+m);O=Error(x);g=2;break}catch(r){A=r;g=4;break}case 17:try{g=5;break}catch(r){A=r;g=4;break}case 4:e=A,N=l.ErrorFailedToStartLiveBroadcast,M=e.message(),F.traceTag(50455812,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous session creation Promise!",e.message),O=e;case 5:case 2:S+=1;g=1;break;case 3:F.telemetry.telemetryData.SetErrorCode(N,M),F.telemetry.telemetryData.startAttemptCount=
S,c(O),g=-1;default:return{value:void 0,done:!0}}}var g=0,e,m,k,u,K,I,P,v,w,t,n,J,p,Q,B,x,q,y,C,D,A,S,O,M,N,F=this,T={next:function(a){return h(a,void 0)},"throw":function(a){return h(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();T[Symbol.iterator]=function(){return this};return T})})};k.prototype.InitializeStateService=function(){var a=this;return new Promise(function(b,h){return __awaiter(a,void 0,void 0,function(){function a(K,v){for(;;)switch(f){case 0:u=
l.ErrorNone,z=null,k=1,e=E.telemetry.telemetryData.sessionId;case 1:if(!(k<=E.settings.numMaxAttempts)){f=3;break}if(!E.telemetry.telemetryData.sessionEndedBeforePragueInitialized&&e==E.telemetry.telemetryData.sessionId){f=4;break}E.traceTag(591738527,logCategory.PptLive,logLevel.Warning,"Live session ended or not started yet. Cancelling StateService!");f=3;break;case 4:try{return f=7,{value:E.InitializePrague(),done:!1}}catch(w){g=w;f=5;break}case 7:try{if(void 0===v){f=8;break}f=-1;throw v;}catch(w){g=
w;f=5;break}case 8:try{f=6;break}catch(w){g=w;f=5;break}case 5:d=g;u=l.ErrorFailedToInitializePrague;z=d;E.traceTag(594330503,logCategory.PptLive,logLevel.Error,"Exception thrown in initializing prague session!",d.message);f=2;break;case 6:try{return f=11,{value:E.SetupPrague(!1),done:!1}}catch(w){g=w;f=9;break}case 11:try{if(void 0===v){f=12;break}f=-1;throw v;}catch(w){g=w;f=9;break}case 12:try{f=10;break}catch(w){g=w;f=9;break}case 9:c=g;u=l.ErrorFailedToInitializePrague;z=c;E.traceTag(594330502,
logCategory.PptLive,logLevel.Error,"Exception thrown in SetupPrague: ",c.message);f=2;break;case 10:return b(!0),f=-1,{value:void 0,done:!0};case 2:k+=1;f=1;break;case 3:E.telemetry.telemetryData.sessionEndedBeforePragueInitialized||e!=E.telemetry.telemetryData.sessionId||E.telemetry.telemetryData.SetErrorCode(u,null!=z?u.toString():""),E.telemetry.telemetryData.startAttemptCount=k,h(z),f=-1;default:return{value:void 0,done:!0}}}var f=0,c,d,g,e,k,z,u,E=this,I={next:function(c){return a(c,void 0)},
"throw":function(c){return a(void 0,c)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();I[Symbol.iterator]=function(){return this};return I})})};k.prototype.PauseLiveBroadcasting=function(a){var b=this;return null==this.rendezvousSessionInfo?null:new Promise(function(h,d){return __awaiter(b,void 0,void 0,function(){function b(f,p){for(;;)switch(c){case 0:w=t;try{y=null;if(I=t.rendezvousSessionInfo.presenterToken){c=3;break}c=4;return{value:a()["catch"](function(a){w.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,
a.toString());throw Error("Failed to get auth token on pausing Live session:"+a.toString());}),done:!1}}catch(n){v=n;c=1;break}case 4:try{if(void 0===p){c=5;break}c=-1;throw p;}catch(n){v=n;c=1;break}case 5:try{y=E=f}catch(n){v=n;c=1;break}case 3:try{return t.traceTag(50455813,logCategory.PptLive,logLevel.Info,"Pausing current Live session"),t.SetSessionState("paused"),u=t.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=PauseSession&sessionid="+t.rendezvousSessionInfo.sessionId+"&cid="+t.correlationId,
I&&(u+="&presentertoken="+I),H=new Headers,t.settings.isBlueChicken&&H.append("OriginType","Test"),null!=y&&H.append("Authorization","Bearer "+y),k=fetch(u,{method:"POST",mode:"cors",headers:H}),c=6,{value:k,done:!1}}catch(n){v=n;c=1;break}case 6:try{if(void 0===p){c=7;break}c=-1;throw p;}catch(n){v=n;c=1;break}case 7:try{g=m=f;1==g.ok&&204==g.status?(t.traceTag(50602783,logCategory.PptLive,logLevel.Info,"Rendezvous PauseSession service call succeeded!"),h(g),0<=t.settings.delayInSecsToCloseBroadcasterOnPause&&
(t.deferredBroadcasterClosingTimerId=window.setTimeout(function(){w.ClosePrague("LongPauseLiveBroadcast");w.deferredBroadcasterClosingTimerId=0},1E3*t.settings.delayInSecsToCloseBroadcasterOnPause))):(t.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToPauseRendezvousSession,"Rendezvous PauseSession service call failed with statusCode: "+g.status+" and statusText: "+g.statusText),t.traceTag(50602784,logCategory.PptLive,logLevel.Error,"Rendezvous PauseSession service call failed with status of "+
g.status),d(g));c=2;break}catch(n){v=n;c=1;break}case 1:e=v,t.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToPauseLiveBroadcast,e.message),t.traceTag(50729373,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous session pause Promise!",e.message),d(e);case 2:c=-1;default:return{value:void 0,done:!0}}}var c=0,e,g,m,k,H,u,E,I,y,v,w,t=this,n={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();
n[Symbol.iterator]=function(){return this};return n})})};k.prototype.ResumeLiveBroadcasting=function(a){var b=this;return null==this.rendezvousSessionInfo?null:new Promise(function(h,d){return __awaiter(b,void 0,void 0,function(){function b(f,x){for(;;)switch(c){case 0:J=p;try{t=null;if(w=p.rendezvousSessionInfo.presenterToken){c=3;break}c=4;return{value:a()["catch"](function(a){J.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,a.toString());throw Error("Failed to get auth token on resuming Live session: "+
a.toString());}),done:!1}}catch(q){n=q;c=1;break}case 4:try{if(void 0===x){c=5;break}c=-1;throw x;}catch(q){n=q;c=1;break}case 5:try{t=v=f}catch(q){n=q;c=1;break}case 3:try{p.traceTag(50455814,logCategory.PptLive,logLevel.Info,"Resuming paused Live session");0!=p.deferredBroadcasterClosingTimerId&&(window.clearTimeout(p.deferredBroadcasterClosingTimerId),p.deferredBroadcasterClosingTimerId=0);if(null!=p.liveBroadcaster){c=6;break}p.traceTag(594554962,logCategory.PptLive,logLevel.Info,"Re-initializing Prague for session resuming ...");
C=0}catch(q){n=q;c=1;break}case 7:try{if(!(C<p.settings.numMaxAttempts)){c=9;break}}catch(q){n=q;c=1;break}try{return c=12,{value:p.InitializePrague(),done:!1}}catch(q){n=q;c=10;break}case 12:try{if(void 0===x){c=13;break}c=-1;throw x;}catch(q){n=q;c=10;break}case 13:try{c=9;break}catch(q){n=q;c=10;break}case 10:try{y=n;p.traceTag(594554961,logCategory.PptLive,logLevel.Error,"Exception thrown when re-initializing prague session!",y.message);if(C+1!=p.settings.numMaxAttempts){c=14;break}p.traceTag(594554960,
logCategory.PptLive,logLevel.Error,"Failed to re-initializing Prague after maxium attempts!");c=-1;throw y;}catch(q){n=q;c=1;break}case 14:try{c=8;break}catch(q){n=q;c=1;break}case 11:case 8:try{C++;c=7;break}catch(q){n=q;c=1;break}case 9:try{return p.traceTag(594554959,logCategory.PptLive,logLevel.Info,"Setup Prague for session resuming ..."),c=15,{value:p.SetupPrague(!0),done:!1}}catch(q){n=q;c=1;break}case 15:try{if(void 0===x){c=16;break}c=-1;throw x;}catch(q){n=q;c=1;break}case 16:case 6:try{return p.SetSessionState("active"),
p.SetWelcomeScreenState(!1),p.participantsCountChangeEventListener&&p.participantsCountChangeEventListener(p.participantsCount),E=p.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=ResumeSession&sessionid="+p.rendezvousSessionInfo.sessionId+"&cid="+p.correlationId,w&&(E+="&presentertoken="+w),u=new Headers,p.settings.isBlueChicken&&u.append("OriginType","Test"),null!=t&&u.append("Authorization","Bearer "+t),H=fetch(E,{method:"POST",mode:"cors",headers:u}),c=17,{value:H,done:!1}}catch(q){n=q;
c=1;break}case 17:try{if(void 0===x){c=18;break}c=-1;throw x;}catch(q){n=q;c=1;break}case 18:try{k=m=f;if(1!=k.ok||204!=k.status){c=19;break}if(!p.settings.fileSnapDownloadUrl){c=21;break}p.settings.documentSnapshotFileSnapDownloadUrlGenerator&&(p.settings.fileSnapDownloadUrl=p.settings.documentSnapshotFileSnapDownloadUrlGenerator());p.documentDownloadUrl=p.settings.fileSnapDownloadUrl;c=22;break}catch(q){n=q;c=1;break}case 21:try{return c=23,{value:p.RefreshDownloadUrlPromiseIfNeeded(),done:!1}}catch(q){n=
q;c=1;break}case 23:try{if(void 0===x){c=24;break}c=-1;throw x;}catch(q){n=q;c=1;break}case 24:try{return c=25,{value:p.downloadUrlPromise["catch"](function(a){J.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchDocumentDownloadURL,a.toString());throw Error("Failed to get download Url on resuming session!");}),done:!1}}catch(q){n=q;c=1;break}case 25:try{if(void 0===x){c=26;break}c=-1;throw x;}catch(q){n=q;c=1;break}case 26:try{g=f,p.documentDownloadUrl=g}catch(q){n=q;c=1;break}case 22:try{p.fileInfo.fileUrl=
p.documentDownloadUrl;p.liveBroadcaster.fileInfo=Object.assign({},p.fileInfo);p.traceTag(50602785,logCategory.PptLive,logLevel.Info,"Rendezvous ResumeSession service call succeeded!");h(k);c=20;break}catch(q){n=q;c=1;break}case 19:try{p.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToResumeRendezvousSession,"Rendezvous ResumeSession service call failed with statusCode: "+k.status+" and statusText: "+k.statusText),p.traceTag(50602786,logCategory.PptLive,logLevel.Error,"Rendezvous ResumeSession service call failed with status of "+
k.status),d(k)}catch(q){n=q;c=1;break}case 20:try{c=2;break}catch(q){n=q;c=1;break}case 1:e=n,p.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToResumeLiveBroadcast,e.toString()),p.traceTag(50729374,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous session resume Promise!",e.toString()),d(e);case 2:c=-1;default:return{value:void 0,done:!0}}}var c=0,e,g,k,m,H,u,E,y,C,v,w,t,n,J,p=this,Q={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();Q[Symbol.iterator]=function(){return this};return Q})})};k.prototype.EndLiveBroadcasting=function(a){var b=this;return new Promise(function(h,d){return __awaiter(b,void 0,void 0,function(){function b(f,p){for(;;)switch(c){case 0:w=t;if(null==t.rendezvousSessionInfo){c=1;break}try{t.traceTag(50455815,logCategory.PptLive,logLevel.Info,"Ending current Live session!");C=t.rendezvousSessionInfo.presenterToken;I=t.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=EndSession&sessionid="+
t.rendezvousSessionInfo.sessionId+"&cid="+t.correlationId;C&&(I+="&presentertoken="+C);t.settings.enableTransientSessionHandling&&(t.telemetry.telemetryData.sessionEndedBeforePragueInitialized=null==t.liveBroadcaster||!t.isBroadcastSessionActive);t.CleanUpBroadcastBeforeEnd();y=new Headers;t.settings.isBlueChicken&&y.append("OriginType","Test");if(C){c=4;break}c=5;return{value:a()["catch"](function(a){w.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,a.toString());throw Error("Failed to get auth token on ending Live session: "+
a.toString());}),done:!1}}catch(n){v=n;c=2;break}case 5:try{if(void 0===p){c=6;break}c=-1;throw p;}catch(n){v=n;c=2;break}case 6:try{H=u=f,null!=H&&y.append("Authorization","Bearer "+H)}catch(n){v=n;c=2;break}case 4:try{return m=fetch(I,{method:"POST",mode:"cors",headers:y}),c=7,{value:m,done:!1}}catch(n){v=n;c=2;break}case 7:try{if(void 0===p){c=8;break}c=-1;throw p;}catch(n){v=n;c=2;break}case 8:try{g=k=f;1==g.ok&&204==g.status?(t.traceTag(50455816,logCategory.PptLive,logLevel.Info,"Rendezvous EndSession service call succeeded!"),
h(g)):(t.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToEndRendezvousSession,"Rendezvous EndSession service call failed with statusCode: "+g.status+" and statusText: "+g.statusText),t.traceTag(50455817,logCategory.PptLive,logLevel.Error,"Rendezvous EndSession service call failed with status of "+g.status),d(g));0!=t.deferredBroadcasterClosingTimerId&&(window.clearTimeout(t.deferredBroadcasterClosingTimerId),t.deferredBroadcasterClosingTimerId=0);t.ClosePrague("EndLiveBroadcast");c=3;break}catch(n){v=
n;c=2;break}case 2:e=v,t.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToEndLiveBroadcast,e.toString()),t.traceTag(50729375,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous session end Promise!",e.toString()),d(e);case 3:case 1:c=-1;default:return{value:void 0,done:!0}}}var c=0,e,g,k,m,H,u,y,I,C,v,w,t=this,n={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();n[Symbol.iterator]=
function(){return this};return n})})};k.prototype.CleanUpBroadcastBeforeEnd=function(){this.SetSessionState("stopped");this.rendezvousSessionInfo=this.pragueSessionInfo=null;this.isBroadcastSessionActive=!1;this.participantsCount=0;this.welcomeScreenState=!0;this.sessionId=""};k.prototype.OnPodSessionUpdated=function(a){return __awaiter(this,void 0,void 0,function(){function b(k,m){for(;;)switch(h){case 0:e=g;try{if(!g.downloadUrlPromise){h=5;break}h=6;return{value:g.downloadUrlPromise,done:!1}}catch(u){c=
u;h=3;break}case 6:try{if(void 0===m){h=7;break}h=-1;throw m;}catch(u){c=u;h=3;break}case 7:case 5:try{h=4;break}catch(u){c=u;h=3;break}case 3:try{g.traceTag(594117345,logCategory.PptLive,logLevel.Info,"Session updated while old download request was not finished. Now fetching new download url...")}catch(u){c=u;h=1;break}case 4:try{return h=8,{value:g.FetchDocumentDownloadURL(a),done:!1}}catch(u){c=u;h=1;break}case 8:try{if(void 0===m){h=9;break}h=-1;throw m;}catch(u){c=u;h=1;break}case 9:try{return h=
10,{value:g.downloadUrlPromise["catch"](function(a){e.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchDocumentDownloadURL,a.toString());throw Error("Failed to get download Url on handing pods session updateing!");}),done:!1}}catch(u){c=u;h=1;break}case 10:try{if(void 0===m){h=11;break}h=-1;throw m;}catch(u){c=u;h=1;break}case 11:try{f=k;g.documentDownloadUrl=f;g.fileInfo.fileUrl=g.documentDownloadUrl;null!=g.liveBroadcaster&&(g.liveBroadcaster.fileInfo=Object.assign({},g.fileInfo));h=2;break}catch(u){c=
u;h=1;break}case 1:d=c,g.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToRefreshFileUrl,d.toString()),g.traceTag(51423305,logCategory.PptLive,logLevel.Error,"Exception thrown in OnPodSessionUpdated!",d.toString());case 2:h=-1;default:return{value:void 0,done:!0}}}var h=0,d,f,c,e,g=this,k={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();k[Symbol.iterator]=function(){return this};
return k})};k.prototype.OnPodSessionUpdatedFileSnapDownloadUrl=function(a){return __awaiter(this,void 0,void 0,function(){function b(c,f){for(;;)switch(h){case 0:d.documentDownloadUrl=a,d.fileInfo.fileUrl=d.documentDownloadUrl,null!=d.liveBroadcaster&&(d.liveBroadcaster.fileInfo=Object.assign({},d.fileInfo)),h=-1;default:return{value:void 0,done:!0}}}var h=0,d=this,f={next:function(a){return b(a,void 0)},"throw":function(a){return b(void 0,a)},"return":function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();f[Symbol.iterator]=function(){return this};return f})};k.prototype.TriggerSaveThumbnails=function(a,b){var h=this;return new Promise(function(d,f){return __awaiter(h,void 0,void 0,function(){function c(c,J){for(;;)switch(h){case 0:t=n;if(null==n.rendezvousSessionInfo){h=1;break}try{n.traceTag(595121313,logCategory.PptLive,logLevel.Info,"Trigger save thumbnails request");v=n.rendezvousSessionInfo.presenterToken;P=n.getRendezvousEndpoint()+"RendezvousHandler.ashx?action=SaveThumbnails&sessionid="+
n.rendezvousSessionInfo.sessionId+"&fileUrl="+encodeURIComponent(n.fileInfo.fileUrl)+"&slideId="+b+"&cid="+n.correlationId;v&&(P+="&presentertoken="+v);C=new Headers;n.settings.isBlueChicken&&C.append("OriginType","Test");if(v){h=4;break}h=5;return{value:a()["catch"](function(a){t.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToFetchAuthToken,a.toString());throw Error("Failed to get auth token on trigger save thumbnails: "+a.toString());}),done:!1}}catch(B){w=B;h=2;break}case 5:try{if(void 0===
J){h=6;break}h=-1;throw J;}catch(B){w=B;h=2;break}case 6:try{u=G=c,null!=u&&C.append("Authorization","Bearer "+u)}catch(B){w=B;h=2;break}case 4:try{return y=fetch(P,{method:"POST",mode:"cors",headers:C}),h=7,{value:y,done:!1}}catch(B){w=B;h=2;break}case 7:try{if(void 0===J){h=8;break}h=-1;throw J;}catch(B){w=B;h=2;break}case 8:try{e=k=c;1==e.ok?(n.traceTag(595121312,logCategory.PptLive,logLevel.Info,"Rendezvous SaveThumbnails service call succeeded!"),d(e)):(n.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToTriggerSaveThumbnails,
"Rendezvous SaveThumbnails service call failed with statusCode: "+e.status+" and statusText: "+e.statusText),n.traceTag(595121311,logCategory.PptLive,logLevel.Error,"Rendezvous SaveThumbnails service call failed with status of "+e.status),f(e));h=3;break}catch(B){w=B;h=2;break}case 2:g=w,n.telemetry.telemetryData.SetErrorCode(l.ErrorFailedToTriggerSaveThumbnails,g.toString()),n.traceTag(595121310,logCategory.PptLive,logLevel.Error,"Exception thrown in rendezvous save thumbnails Promise!",g.toString()),
f(g);case 3:case 1:h=-1;default:return{value:void 0,done:!0}}}var h=0,g,e,k,y,u,G,C,P,v,w,t,n=this,J={next:function(a){return c(a,void 0)},"throw":function(a){return c(void 0,a)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();J[Symbol.iterator]=function(){return this};return J})})};k.prototype.EnsureDocumentDownloadUrlForNewLiveSession=function(){return __awaiter(this,void 0,void 0,function(){function a(g,k){for(;;)switch(h){case 0:c=null;try{if(!e.settings.fileSnapDownloadUrl){h=
3;break}e.documentDownloadUrl=e.settings.fileSnapDownloadUrl;h=4;break}catch(l){f=l;h=1;break}case 3:try{return h=5,{value:e.downloadUrlPromise,done:!1}}catch(l){f=l;h=1;break}case 5:try{if(void 0===k){h=6;break}h=-1;throw k;}catch(l){f=l;h=1;break}case 6:try{d=g,e.documentDownloadUrl=d}catch(l){f=l;h=1;break}case 4:try{h=2;break}catch(l){f=l;h=1;break}case 1:b=f,e.traceTag(592042071,logCategory.PptLive,logLevel.Error,"Exception thrown when fetching document download url!",b.message),c=b,e.settings.fileSnapDownloadUrl?
null!=e.settings.documentSnapshotFileSnapDownloadUrlGenerator?(e.settings.fileSnapDownloadUrl=e.settings.documentSnapshotFileSnapDownloadUrlGenerator(),e.documentDownloadUrl=e.settings.fileSnapDownloadUrl):e.traceTag(507248665,logCategory.PptLive,logLevel.Error,"EnsureDocumentDownloadUrlForNewLiveSession: Not refreshing download url because documentSnapshotFileSnapDownloadUrlGenerator is empty"):null!=e.settings.documentSnapshotRequestUrlGenerator&&(e.settings.fileDownloadUrl=e.settings.documentSnapshotRequestUrlGenerator(),
e.FetchDocumentDownloadURL(e.settings.fileDownloadUrl));case 2:return h=-1,{value:c,done:!0};default:return{value:void 0,done:!0}}}var h=0,b,d,f,c,e=this,g={next:function(h){return a(h,void 0)},"throw":function(h){return a(void 0,h)},"return":function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();g[Symbol.iterator]=function(){return this};return g})};k.prototype.SetSessionInfo=function(a){this.rendezvousSessionInfo=new e;this.sessionId!=a.SessionId&&this.traceTag(594392212,
logCategory.PptLive,logLevel.Error,"Rendezvous created new SessionId:"+a.SessionId);this.rendezvousSessionInfo.sessionId=this.sessionId;this.rendezvousSessionInfo.participantUrl=a.ParticipantUrl;this.rendezvousSessionInfo.shortParticipantUrl=a.ShortParticipantUrl;if(void 0==this.rendezvousSessionInfo.shortParticipantUrl||null==this.rendezvousSessionInfo.shortParticipantUrl)this.rendezvousSessionInfo.shortParticipantUrl=this.rendezvousSessionInfo.participantUrl;this.rendezvousSessionInfo.sessionQRCode=
a.QRCode;this.rendezvousSessionInfo.pragueDocId=a.PragueDocId;this.rendezvousSessionInfo.presenterToken=a.PresenterToken;this.rendezvousSessionInfo.rendezvousEndpoint=a.RendezvousEndpoint;this.pragueSessionInfo=new h;this.pragueSessionInfo.pragueDocId=a.PragueDocId;this.pragueSessionInfo.pragueRouterlicious=a.PragueRouterlicious;this.pragueSessionInfo.pragueHistorian=a.PragueHistorian;this.pragueSessionInfo.pragueTenant=a.PragueTenant;this.pragueSessionInfo.pragueSecret=a.PragueSecret;this.pragueSessionInfo.broadcastSubtitlesInFD=
this.settings.broadcastSubtitlesFromSpeechFrontDoor};k.prototype.getRendezvousEndpoint=function(){return this.rendezvousSessionInfo&&this.rendezvousSessionInfo.rendezvousEndpoint&&0<this.rendezvousSessionInfo.rendezvousEndpoint.length?this.rendezvousSessionInfo.rendezvousEndpoint:this.settings.rendezvousSvcBaseUri};k.prototype.traceTag=function(a,h,b,d,f){null!=this.logger&&(d={LiveSessionId:this.sessionId,Message:d},void 0!=f&&(d.Details=f),this.logger.traceTag(a,h,b,JSON.stringify(d)))};k.prototype.CalculateUrlHash=
function(a){for(var h=0,b=0;b<a.length;b++)h=(h<<5)-h+a.charCodeAt(b),h&=h;return h};a.PPTBroadcastMonitor=k})(PowerPointLive||(PowerPointLive={}));var OfficeOnline;
(function(a){(function(a){var e;(function(a){a[a.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS";a[a.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid";a[a.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart";a[a.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer";a[a.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral";a[a.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane";a[a.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral";a[a.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon";
a[a.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication";a[a.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry";a[a.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities";a[a.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation";a[a.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync";a[a.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp";a[a.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache";a[a.msoulscat_Wac_PptAnimation=
800]="msoulscat_Wac_PptAnimation";a[a.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive";a[a.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb";a[a.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape";a[a.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession";a[a.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow";a[a.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory";a[a.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence";a[a.msoulscat_Wac_WordVersionHistory=3005]=
"msoulscat_Wac_WordVersionHistory";a[a.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard";a[a.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout"})(e||(e={}));var d;(function(a){a[a.Error=10]="Error";a[a.Warning=15]="Warning";a[a.Info=50]="Info";a[a.Verbose=100]="Verbose";a[a.Spam=200]="Spam"})(d||(d={}));var k=function(a){this.m_logger=a};k.prototype.sendTraceTag=function(a,b,d,e){null!=this.m_logger&&this.m_logger.traceTag(a,this.CovertToPowerPointOnlineTelemetryLogCategory(b),
this.CovertToPowerPointOnlineTelemetryLogLevel(d),e)};k.prototype.shipAssertTag=function(a,b,d,e){d&&null!=this.m_logger&&this.m_logger.traceTag(a,this.CovertToPowerPointOnlineTelemetryLogCategory(b),logLevel.Error,e)};k.prototype.debugAssertTag=function(a,b,d,e){d&&null!=this.m_logger&&this.m_logger.traceTag(a,this.CovertToPowerPointOnlineTelemetryLogCategory(b),logLevel.Warning,e)};k.prototype.CovertToPowerPointOnlineTelemetryLogCategory=function(a){switch(a){case e.msoulscat_Wac_WordViewer:return logCategory.WordViewer;
case e.msoulscat_Wac_WopiPendingApplication:return logCategory.WopiPendingApplication;case e.msoulscat_Wac_VisioApp:return logCategory.VisioApp;case e.msoulscat_Wac_PptSession:return logCategory.PptSession;case e.msoulscat_Wac_PptLive:return logCategory.PptLive;default:return logCategory.PptSession}};k.prototype.CovertToPowerPointOnlineTelemetryLogLevel=function(a){switch(a){case d.Spam:return logLevel.Spam;case d.Verbose:return logLevel.Verbose;case d.Info:return logLevel.Info;case d.Warning:return logLevel.Warning;
case d.Error:return logLevel.Error}};a.ProxyLogger=k})(a.Telemetry||(a.Telemetry={}))})(OfficeOnline||(OfficeOnline={}));
